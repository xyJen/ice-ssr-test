{"version":3,"file":"index.js","sources":["../../src/index.ts"],"sourcesContent":["const loadingMap = new Map();\nconst loadedMap = new Map();\n\nexport default function getAsync<T = any, I = any>(\n  id: I,\n  getter: () => Promise<T>,\n): Promise<T> {\n  if (isLoaded(id)) {\n    return getLoaded(id);\n  }\n  let promise = loadingMap.get(id);\n  if (promise) {\n    return promise;\n  }\n  promise = getter();\n  loadingMap.set(id, promise);\n  promise.then(\n    value => {\n      loadedMap.set(id, value);\n      loadingMap.delete(id);\n    },\n    () => {\n      loadingMap.delete(id);\n    },\n  );\n  return promise;\n}\n\nexport function isLoaded(id: any) {\n  return loadedMap.has(id);\n}\n\nexport function isLoading(id: any) {\n  return loadingMap.has(id);\n}\n\nexport function getLoaded(id: any) {\n  return loadedMap.get(id);\n}\n\nexport function removeLoaded(id: any) {\n  if (isLoaded(id)) {\n    loadedMap.delete(id);\n  }\n  if (isLoading(id)) {\n    loadingMap.get(id).then(() => {\n      loadedMap.delete(id);\n    });\n  }\n}\n"],"names":["loadingMap","Map","loadedMap","getAsync","id","getter","isLoaded","getLoaded","promise","get","set","then","value","has","isLoading","removeLoaded"],"mappings":"AAAA,IAAMA,UAAU,GAAG,IAAIC,GAAJ,EAAnB;AACA,IAAMC,SAAS,GAAG,IAAID,GAAJ,EAAlB;AAEe,SAASE,QAAT,CACbC,EADa,EAEbC,MAFa,EAGD;AACZ,MAAIC,QAAQ,CAACF,EAAD,CAAZ,EAAkB;AAChB,WAAOG,SAAS,CAACH,EAAD,CAAhB;AACD;;AACD,MAAII,OAAO,GAAGR,UAAU,CAACS,GAAX,CAAeL,EAAf,CAAd;;AACA,MAAII,OAAJ,EAAa;AACX,WAAOA,OAAP;AACD;;AACDA,EAAAA,OAAO,GAAGH,MAAM,EAAhB;AACAL,EAAAA,UAAU,CAACU,GAAX,CAAeN,EAAf,EAAmBI,OAAnB;AACAA,EAAAA,OAAO,CAACG,IAAR,CACE,UAAAC,KAAK,EAAI;AACPV,IAAAA,SAAS,CAACQ,GAAV,CAAcN,EAAd,EAAkBQ,KAAlB;AACAZ,IAAAA,UAAU,UAAV,CAAkBI,EAAlB;AACD,GAJH,EAKE,YAAM;AACJJ,IAAAA,UAAU,UAAV,CAAkBI,EAAlB;AACD,GAPH;AASA,SAAOI,OAAP;AACD;AAEM,SAASF,QAAT,CAAkBF,EAAlB,EAA2B;AAChC,SAAOF,SAAS,CAACW,GAAV,CAAcT,EAAd,CAAP;AACD;AAEM,SAASU,SAAT,CAAmBV,EAAnB,EAA4B;AACjC,SAAOJ,UAAU,CAACa,GAAX,CAAeT,EAAf,CAAP;AACD;AAEM,SAASG,SAAT,CAAmBH,EAAnB,EAA4B;AACjC,SAAOF,SAAS,CAACO,GAAV,CAAcL,EAAd,CAAP;AACD;AAEM,SAASW,YAAT,CAAsBX,EAAtB,EAA+B;AACpC,MAAIE,QAAQ,CAACF,EAAD,CAAZ,EAAkB;AAChBF,IAAAA,SAAS,UAAT,CAAiBE,EAAjB;AACD;;AACD,MAAIU,SAAS,CAACV,EAAD,CAAb,EAAmB;AACjBJ,IAAAA,UAAU,CAACS,GAAX,CAAeL,EAAf,EAAmBO,IAAnB,CAAwB,YAAM;AAC5BT,MAAAA,SAAS,UAAT,CAAiBE,EAAjB;AACD,KAFD;AAGD;AACF;;;;;"}