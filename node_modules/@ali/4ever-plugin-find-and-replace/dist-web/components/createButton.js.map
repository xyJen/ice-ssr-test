{"version":3,"sources":["../../../src/components/createButton.tsx"],"names":["React","SearchButton","Button","toggleFindAndReplace","updateFindFragment","environment","MOD","IS_MAC","SHORTCUT","createButton","ctlManager","FindAndReplaceButton","props","controller","locale","rest","value","data","isVisible","findAndReplaceVisible","isDisabled","query","handleClick","useCallback","mainController","run","fragment","ctl","text"],"mappings":";;AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;qBAC4B,a;AAA5B,SAASC,YAAY,IAAIC,MAAzB,QAAuC,iBAAvC;AACA,SAASC,oBAAT,EAA+BC,kBAA/B;AACA,SAASC,WAAT,QAA4B,oBAA5B;AAGA,IAAMC,GAAG,GAAGD,WAAW,CAACE,MAAZ,GAAqB,GAArB,GAA2B,MAAvC;AACA,IAAMC,QAAQ,GAAMF,GAAN,OAAd;AAEA,eAAe,SAASG,YAAT,CAAsBC,UAAtB,EAAqD;AAClE,SAAO,SAASC,oBAAT,CAA8BC,KAA9B,EAAqC;AAAA,QAClCC,UADkC,GACFD,KADE,CAClCC,UADkC;AAAA,QACtBC,MADsB,GACFF,KADE,CACtBE,MADsB;AAAA,QACXC,IADW,iCACFH,KADE;;AAAA,gCAEpBC,UAAU,CAACG,KAFS,CAElCC,IAFkC;AAAA,QAElCA,IAFkC,sCAE3B,EAF2B;AAI1C,QAAMC,SAAS,GAAGD,IAAI,CAACE,qBAAL,IAA8B,KAAhD;AACA,QAAMC,UAAU,GAAGP,UAAU,CAACQ,KAAX,CAAiB,yBAAjB,CAAnB;AAEA,QAAMC,WAAW,GAAGtB,KAAK,CAACuB,WAAN,CAAkB,YAAM;AAAA,UAClCC,cADkC,GACfd,UADe,CAClCc,cADkC;;AAE1C,UAAI,CAACA,cAAL,EAAqB;AACnB;AACD;;AAEDA,MAAAA,cAAc,CAACC,GAAf,CAAmB,UAAnB,EAA+BtB,oBAAoB,EAAnD;AAEA,UAAIuB,QAAQ,GAAG,EAAf;AACAhB,MAAAA,UAAU,CAACe,GAAX,CAAe,UAACE,GAAD,EAAS;AAAA;;AACtB,YAAMC,IAAI,0BAAGD,GAAG,CAACX,KAAJ,CAAUU,QAAb,qBAAG,oBAAoBE,IAAjC;;AACA,YAAIA,IAAJ,EAAU;AACRF,UAAAA,QAAQ,GAAGE,IAAX;AACD;AACF,OALD;;AAMA,UAAIF,QAAJ,EAAc;AACZF,QAAAA,cAAc,CAACC,GAAf,CAAmB,UAAnB,EAA+BrB,kBAAkB,CAACsB,QAAD,CAAjD;AACD;AACF,KAlBmB,EAkBjB,EAlBiB,CAApB;AAoBA,wBACE,eAAC,MAAD,eACMX,IADN;AAEE,MAAA,MAAM,EAAC,mBAFT;AAGE,MAAA,MAAM,EAAEG,SAHV;AAIE,MAAA,OAAO,EAAEI,WAJX;AAKE,MAAA,YAAY,EAAEd,QALhB;AAME,MAAA,QAAQ,EAAEY,UANZ;AAOE,MAAA,IAAI,EAAE;AAPR,OADF;AAWD,GAtCD;AAuCD","sourcesContent":["import * as React from 'react';\nimport { SearchButton as Button } from '@ali/we-toolbar';\nimport { toggleFindAndReplace, updateFindFragment } from '../common/actions';\nimport { environment } from '@ali/4ever-cangjie';\nimport type { ControllerManager } from '../utils';\n\nconst MOD = environment.IS_MAC ? 'âŒ˜' : 'Ctrl';\nconst SHORTCUT = `${MOD}+F`;\n\nexport default function createButton(ctlManager: ControllerManager) {\n  return function FindAndReplaceButton(props) {\n    const { controller, locale, ...rest } = props;\n    const { data = {} } = controller.value;\n\n    const isVisible = data.findAndReplaceVisible || false;\n    const isDisabled = controller.query('isDisableFindAndReplace');\n\n    const handleClick = React.useCallback(() => {\n      const { mainController } = ctlManager;\n      if (!mainController) {\n        return;\n      }\n\n      mainController.run('onAction', toggleFindAndReplace());\n\n      let fragment = '';\n      ctlManager.run((ctl) => {\n        const text = ctl.value.fragment?.text;\n        if (text) {\n          fragment = text;\n        }\n      });\n      if (fragment) {\n        mainController.run('onAction', updateFindFragment(fragment));\n      }\n    }, []);\n\n    return (\n      <Button\n        {...rest}\n        testid=\"bi-toolbar-search\"\n        active={isVisible}\n        onClick={handleClick}\n        shortcutText={SHORTCUT}\n        disabled={isDisabled}\n        role={'findandreplace'}\n      />\n    );\n  };\n}\n"],"file":"createButton.js"}