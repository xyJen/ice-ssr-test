{"version":3,"sources":["../../../src/utils/transferKey.ts"],"names":["isPi","transferKey","key","controller","findText","viewKeys","query","length","targetKey","document","value","forEach","k","node","getNode","text","includes"],"mappings":"AAEA,OAAOA,IAAP;;AAEA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,GAAD,EAAcC,UAAd,EAAsCC,QAAtC,EAA4D;AAC9E,MAAI,CAACJ,IAAI,CAACG,UAAD,CAAT,EAAuB;AACrB,WAAOD,GAAP;AACD;;AAED,MAAMG,QAAkB,GAAGF,UAAU,CAACG,KAAX,CAAiB,aAAjB,EAAgCJ,GAAhC,CAA3B;;AACA,MAAI,CAACG,QAAD,IAAaA,QAAQ,CAACE,MAAT,KAAoB,CAArC,EAAwC;AACtC,WAAOL,GAAP;AACD;;AAED,MAAIM,SAAS,GAAGH,QAAQ,CAAC,CAAD,CAAxB;AAV8E,MAWtEI,QAXsE,GAWzDN,UAAU,CAACO,KAX8C,CAWtED,QAXsE;;AAa9E,MAAIL,QAAJ,EAAc;AACZC,IAAAA,QAAQ,CAACM,OAAT,CAAiB,UAACC,CAAD,EAAO;AACtB,UAAMC,IAAI,GAAGJ,QAAQ,CAACK,OAAT,CAAiBF,CAAjB,CAAb;;AACA,UAAIC,IAAJ,EAAU;AACR,YAAIA,IAAI,CAACE,IAAL,CAAUC,QAAV,CAAmBZ,QAAnB,CAAJ,EAAkC;AAChCI,UAAAA,SAAS,GAAGI,CAAZ;AACD;AACF;AACF,KAPD;AAQD;;AAED,SAAOJ,SAAP;AACD,CAzBD;;AA2BA,eAAeP,WAAf","sourcesContent":["import { Controller } from '@ali/4ever-cangjie';\n\nimport isPi from './isPi';\n\nconst transferKey = (key: string, controller: Controller, findText?: string) => {\n  if (!isPi(controller)) {\n    return key;\n  }\n\n  const viewKeys: string[] = controller.query('getViewKeys', key);\n  if (!viewKeys || viewKeys.length === 0) {\n    return key;\n  }\n\n  let targetKey = viewKeys[0];\n  const { document } = controller.value;\n\n  if (findText) {\n    viewKeys.forEach((k) => {\n      const node = document.getNode(k);\n      if (node) {\n        if (node.text.includes(findText)) {\n          targetKey = k;\n        }\n      }\n    });\n  }\n\n  return targetKey;\n};\n\nexport default transferKey;\n"],"file":"transferKey.js"}