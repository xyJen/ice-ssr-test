{"version":3,"sources":["../../../src/common/createFindAndReplacePlugin.tsx"],"names":["createButton","createMenu","onAction","createOnChange","createRenderContent","createContextMenu","renderMark","DEFAULT_CONFIG","actions","ControllerManager","createRenderToolbar","key","ctlManager","factory","config","cache","prevDocument","prevFocusIndex","findAndReplace","renderContent","onChange","contextMenu","toolbar","buttons","locale","menubar","menu","renderToolbar","onCleanup","createFindAndReplacePlugin"],"mappings":"AAAA,OAAOA,YAAP;AACA,OAAOC,UAAP;AACA,OAAOC,QAAP;AACA,OAAOC,cAAP;AACA,OAAOC,mBAAP;AACA,OAAOC,iBAAP;AACA,OAAOC,UAAP;AACA,SAASC,cAAT;AACA,OAAO,KAAKC,OAAZ;AACA,SAASC,iBAAT;AACA,OAAOC,mBAAP;AAGA,SAASC,GAAT;AAEA,IAAMC,UAAU,GAAG,IAAIH,iBAAJ,EAAnB;AAEA,OAAO,IAAMI,OAAmB,GAAG,SAAtBA,OAAsB,CAACC,MAAD,EAAY;AAC7C,MAAIC,KAAa,GAAG;AAClBC,IAAAA,YAAY,EAAE,IADI;AAElBC,IAAAA,cAAc,EAAE,CAAC;AAFC,GAApB;AAD6C,8BAKDH,MALC,CAKrCI,cALqC;AAAA,MAKrCA,cALqC,sCAKpBX,cALoB;AAM7C,MAAMY,aAAa,GAAGf,mBAAmB,CAACc,cAAD,EAAiBN,UAAjB,CAAzC;AACA,MAAMQ,QAAQ,GAAGjB,cAAc,CAACe,cAAD,EAAiBH,KAAjB,CAA/B;AAEA,SAAO;AACLJ,IAAAA,GAAG,EAAHA,GADK;AAELU,IAAAA,WAAW,EAAEhB,iBAAiB,CAACa,cAAD,EAAiBN,UAAjB,CAFzB;AAGLU,IAAAA,OAAO,EAAE;AACPC,MAAAA,OAAO,EAAE;AACP,mBAASvB,YAAY,CAACY,UAAD;AADd,OADF;AAIPY,MAAAA,MAAM,EAAE,CAAAN,cAAc,QAAd,YAAAA,cAAc,CAAEM,MAAhB,KAA0B;AAJ3B,KAHJ;AASLC,IAAAA,OAAO,EAAE;AACPC,MAAAA,IAAI,EAAEzB,UAAU,CAACW,UAAD;AADT,KATJ;AAYLN,IAAAA,UAAU,EAAVA,UAZK;AAaLa,IAAAA,aAAa,EAAbA,aAbK;AAcLQ,IAAAA,aAAa,EAAEjB,mBAAmB,CAAC,CAAAQ,cAAc,QAAd,YAAAA,cAAc,CAAEM,MAAhB,KAA0B,EAA3B,EAA+BZ,UAA/B,CAd7B;AAeLV,IAAAA,QAAQ,EAARA,QAfK;AAgBLkB,IAAAA,QAAQ,EAARA,QAhBK;AAiBLQ,IAAAA,SAAS,EAAE,qBAAM;AACf;AACAb,MAAAA,KAAK,GAAG,IAAR;AACD;AApBI,GAAP;AAsBD,CA/BM;AAiCP,OAAO,IAAMc,0BAA0B,GAAG,SAA7BA,0BAA6B,CAACf,MAAD;AAAA,SAA4BD,OAAO,CAACC,MAAD,CAAnC;AAAA,CAAnC;AAEPe,0BAA0B,CAACrB,OAA3B,GAAqCA,OAArC","sourcesContent":["import createButton from '../components/createButton';\nimport createMenu from '../components/createMenu';\nimport onAction from './handlers/onAction';\nimport createOnChange from './handlers/createOnChange';\nimport createRenderContent from './createRenderContent';\nimport createContextMenu from './createContextMenu';\nimport renderMark from './renderMark';\nimport { DEFAULT_CONFIG } from '../utils/constants';\nimport * as actions from './actions';\nimport { ControllerManager } from '../utils';\nimport createRenderToolbar from './createRenderToolbar';\nimport type { ICache } from '../utils/types';\nimport type { BiPluginConfig, ZhiFactory } from '@ali/4ever-cangjie';\nimport { key } from '../utils/meta';\n\nconst ctlManager = new ControllerManager();\n\nexport const factory: ZhiFactory = (config) => {\n  let cache: ICache = {\n    prevDocument: null,\n    prevFocusIndex: -1,\n  };\n  const { findAndReplace = DEFAULT_CONFIG } = config;\n  const renderContent = createRenderContent(findAndReplace, ctlManager);\n  const onChange = createOnChange(findAndReplace, cache);\n\n  return {\n    key,\n    contextMenu: createContextMenu(findAndReplace, ctlManager),\n    toolbar: {\n      buttons: {\n        default: createButton(ctlManager),\n      },\n      locale: findAndReplace?.locale || {},\n    },\n    menubar: {\n      menu: createMenu(ctlManager),\n    },\n    renderMark,\n    renderContent,\n    renderToolbar: createRenderToolbar(findAndReplace?.locale || {}, ctlManager),\n    onAction,\n    onChange,\n    onCleanup: () => {\n      // @ts-ignore 清理缓存\n      cache = null;\n    },\n  };\n};\n\nexport const createFindAndReplacePlugin = (config: BiPluginConfig) => factory(config);\n\ncreateFindAndReplacePlugin.actions = actions;\n"],"file":"createFindAndReplacePlugin.js"}