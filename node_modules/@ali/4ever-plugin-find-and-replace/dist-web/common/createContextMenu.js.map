{"version":3,"sources":["../../../src/common/createContextMenu.ts"],"names":["toggleFindAndReplace","updateFindFragment","crateContextMenu","config","ctlManager","locale","controller","next","menus","selection","value","tableSelection","query","handleClick","mainController","run","fragment","ctl","text","isExpanded","push","name","buttonTitle","onClick","key","options","hotKey","group","others"],"mappings":"AAEA,SAASA,oBAAT,EAA+BC,kBAA/B;AAIA,eAAe,SAASC,gBAAT,CAA0BC,MAA1B,EAAwDC,UAAxD,EAAuF;AAAA,aACjFD,MAAM,IAAI,EADuE;AAAA,MAC5FE,MAD4F,QAC5FA,MAD4F;;AAGpG,SAAO,UAAUC,UAAV,EAAkCC,IAAlC,EAAwC;AAC7C,QAAMC,KAAK,GAAG,EAAd;AAD6C,QAErCC,SAFqC,GAEvBH,UAAU,CAACI,KAFY,CAErCD,SAFqC;AAG7C,QAAME,cAAc,GAAGL,UAAU,CAACM,KAAX,CAAiB,gBAAjB,CAAvB;;AAEA,QAAMC,WAAW,GAAG,SAAdA,WAAc,GAAM;AAAA,UAChBC,cADgB,GACGV,UADH,CAChBU,cADgB;;AAExB,UAAI,CAACA,cAAL,EAAqB;AACnB;AACD;;AAEDA,MAAAA,cAAc,CAACC,GAAf,CAAmB,UAAnB,EAA+Bf,oBAAoB,EAAnD;AAEA,UAAIgB,QAAQ,GAAG,EAAf;AACAZ,MAAAA,UAAU,CAACW,GAAX,CAAe,UAACE,GAAD,EAAS;AAAA;;AACtB,YAAMC,IAAI,0BAAGD,GAAG,CAACP,KAAJ,CAAUM,QAAb,qBAAG,oBAAoBE,IAAjC;;AACA,YAAIA,IAAJ,EAAU;AACRF,UAAAA,QAAQ,GAAGE,IAAX;AACD;AACF,OALD;;AAMA,UAAIF,QAAJ,EAAc;AACZF,QAAAA,cAAc,CAACC,GAAf,CAAmB,UAAnB,EAA+Bd,kBAAkB,CAACe,QAAD,CAAjD;AACD;AACF,KAlBD;;AAoBA,QAAIP,SAAS,IAAIA,SAAS,CAACU,UAAvB,IAAqC,CAACR,cAA1C,EAA0D;AACxDH,MAAAA,KAAK,CAACY,IAAN,CAAW;AACTC,QAAAA,IAAI,EAAEhB,MAAF,oBAAEA,MAAM,CAAEiB,WADL;AAETC,QAAAA,OAAO,EAAEV,WAFA;AAGTW,QAAAA,GAAG,EAAE,MAHI;AAITC,QAAAA,OAAO,EAAE;AACPC,UAAAA,MAAM,EAAE,OADD;AAEPC,UAAAA,KAAK,EAAE;AAFA;AAJA,OAAX;AASD;;AACD,QAAMC,MAAM,GAAGrB,IAAI,MAAM,EAAzB;AACA,qBAAWC,KAAX,EAAqBoB,MAArB;AACD,GAtCD;AAuCD","sourcesContent":["import { Controller } from '@ali/4ever-cangjie';\n\nimport { toggleFindAndReplace, updateFindFragment } from './actions';\nimport { FindAndReplaceConfig } from '../utils/types';\nimport type { ControllerManager } from '../utils';\n\nexport default function crateContextMenu(config: FindAndReplaceConfig, ctlManager: ControllerManager) {\n  const { locale } = config || {};\n\n  return function (controller: Controller, next) {\n    const menus = [] as any;\n    const { selection } = controller.value;\n    const tableSelection = controller.query('tableSelection');\n\n    const handleClick = () => {\n      const { mainController } = ctlManager;\n      if (!mainController) {\n        return;\n      }\n\n      mainController.run('onAction', toggleFindAndReplace());\n\n      let fragment = '';\n      ctlManager.run((ctl) => {\n        const text = ctl.value.fragment?.text;\n        if (text) {\n          fragment = text;\n        }\n      });\n      if (fragment) {\n        mainController.run('onAction', updateFindFragment(fragment));\n      }\n    };\n\n    if (selection && selection.isExpanded && !tableSelection) {\n      menus.push({\n        name: locale?.buttonTitle,\n        onClick: handleClick,\n        key: 'find',\n        options: {\n          hotKey: 'mod+f',\n          group: 6,\n        },\n      });\n    }\n    const others = next() || [];\n    return [...menus, ...others];\n  };\n}\n"],"file":"createContextMenu.js"}