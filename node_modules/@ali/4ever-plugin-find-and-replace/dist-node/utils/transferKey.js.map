{"version":3,"sources":["../../../src/utils/transferKey.ts"],"names":["transferKey","key","controller","findText","viewKeys","query","length","targetKey","document","value","forEach","k","node","getNode","text","includes"],"mappings":";;;;;;;;;AAEA;;AAEA,MAAMA,WAAW,GAAG,CAACC,GAAD,EAAcC,UAAd,EAAsCC,QAAtC,KAA4D;AAC9E,MAAI,CAAC,mBAAKD,UAAL,CAAL,EAAuB;AACrB,WAAOD,GAAP;AACD;;AAED,QAAMG,QAAkB,GAAGF,UAAU,CAACG,KAAX,CAAiB,aAAjB,EAAgCJ,GAAhC,CAA3B;;AACA,MAAI,CAACG,QAAD,IAAaA,QAAQ,CAACE,MAAT,KAAoB,CAArC,EAAwC;AACtC,WAAOL,GAAP;AACD;;AAED,MAAIM,SAAS,GAAGH,QAAQ,CAAC,CAAD,CAAxB;AACA,QAAM;AAAEI,IAAAA;AAAF,MAAeN,UAAU,CAACO,KAAhC;;AAEA,MAAIN,QAAJ,EAAc;AACZC,IAAAA,QAAQ,CAACM,OAAT,CAAkBC,CAAD,IAAO;AACtB,YAAMC,IAAI,GAAGJ,QAAQ,CAACK,OAAT,CAAiBF,CAAjB,CAAb;;AACA,UAAIC,IAAJ,EAAU;AACR,YAAIA,IAAI,CAACE,IAAL,CAAUC,QAAV,CAAmBZ,QAAnB,CAAJ,EAAkC;AAChCI,UAAAA,SAAS,GAAGI,CAAZ;AACD;AACF;AACF,KAPD;AAQD;;AAED,SAAOJ,SAAP;AACD,CAzBD;;eA2BeP,W","sourcesContent":["import { Controller } from '@ali/4ever-cangjie';\n\nimport isPi from './isPi';\n\nconst transferKey = (key: string, controller: Controller, findText?: string) => {\n  if (!isPi(controller)) {\n    return key;\n  }\n\n  const viewKeys: string[] = controller.query('getViewKeys', key);\n  if (!viewKeys || viewKeys.length === 0) {\n    return key;\n  }\n\n  let targetKey = viewKeys[0];\n  const { document } = controller.value;\n\n  if (findText) {\n    viewKeys.forEach((k) => {\n      const node = document.getNode(k);\n      if (node) {\n        if (node.text.includes(findText)) {\n          targetKey = k;\n        }\n      }\n    });\n  }\n\n  return targetKey;\n};\n\nexport default transferKey;\n"],"file":"transferKey.js"}