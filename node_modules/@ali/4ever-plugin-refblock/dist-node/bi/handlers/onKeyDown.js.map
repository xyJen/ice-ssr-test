{"version":3,"sources":["../../../../src/bi/handlers/onKeyDown.ts"],"names":["onKeyDown","event","controller","next","hotkeys","isSelectAll","refblock","value","nodes","length","query","preventDefault","firstChild","lastChild","command","Commands","moveAnchorToStartOfNode","moveFocusToEndOfNode"],"mappings":";;;;;;;AAAA;;AACA;;AAEe,SAASA,SAAT,CACbC,KADa,EAEbC,UAFa,EAGbC,IAHa,EAIb;AACA;AACA,MAAIC,qBAAQC,WAAR,CAAoBJ,KAApB,CAAJ,EAAgC;AAC9B,UAAMK,QAAQ,GAAG,0CAA8BJ,UAAU,CAACK,KAAzC,CAAjB;;AACA,QACE,CAACD,QAAD,IACA,CAACA,QAAQ,CAACE,KAAT,CAAeC,MADhB,IAEAP,UAAU,CAACQ,KAAX,CAAiB,iBAAjB,EAAoCJ,QAApC,CAHF,EAIE;AACA,aAAOH,IAAI,EAAX;AACD;;AACDF,IAAAA,KAAK,CAACU,cAAN;AACA,UAAMC,UAAU,GAAGN,QAAQ,CAACE,KAAT,CAAe,CAAf,CAAnB;AACA,UAAMK,SAAS,GAAGP,QAAQ,CAACE,KAAT,CAAeF,QAAQ,CAACE,KAAT,CAAeC,MAAf,GAAwB,CAAvC,CAAlB;AACA,WAAOP,UAAU,CACdY,OADI,CACIC,sBAASC,uBADb,EACsCJ,UADtC,EAEJE,OAFI,CAEIC,sBAASE,oBAFb,EAEmCJ,SAFnC,CAAP;AAGD;;AACD,SAAOV,IAAI,EAAX;AACD","sourcesContent":["import { Controller, Commands, hotkeys } from '@ali/4ever-cangjie';\nimport { getClosestRefBlockInSelection } from '../../utils/logic';\n\nexport default function onKeyDown(\n  event: React.KeyboardEvent,\n  controller: Controller,\n  next: () => void,\n) {\n  // 全选选中引用块\n  if (hotkeys.isSelectAll(event)) {\n    const refblock = getClosestRefBlockInSelection(controller.value);\n    if (\n      !refblock ||\n      !refblock.nodes.length ||\n      controller.query('shouldSelectAll', refblock)\n    ) {\n      return next();\n    }\n    event.preventDefault();\n    const firstChild = refblock.nodes[0];\n    const lastChild = refblock.nodes[refblock.nodes.length - 1];\n    return controller\n      .command(Commands.moveAnchorToStartOfNode, firstChild)\n      .command(Commands.moveFocusToEndOfNode, lastChild);\n  }\n  return next();\n}\n"],"file":"onKeyDown.js"}