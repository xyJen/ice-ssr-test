{"version":3,"sources":["../../../src/mo/normalizeNode.ts"],"names":["normalizeNode","node","controller","next","RefBlock","isRefBlock","nodes","length","Text","isText","text","create","command","Commands","replaceNodeByKey","key","Paragraph","moveToStartOfNode"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AAEA,MAAMA,aAAsC,GAAG,CAACC,IAAD,EAAOC,UAAP,EAAmBC,IAAnB,KAA4B;AACzE,MAAI,CAACC,gBAASC,UAAT,CAAoBJ,IAApB,CAAL,EAAgC;AAC9B,WAAOE,IAAI,EAAX;AACD;;AAEF,MAAIF,IAAI,CAACK,KAAL,CAAWC,MAAX,KAAsB,CAAtB,IAA2BC,kBAAKC,MAAL,CAAYR,IAAI,CAACK,KAAL,CAAW,CAAX,CAAZ,CAA/B,EAA2D;AACxD,WAAO,MAAM;AACX,YAAMI,IAAI,GAAGF,kBAAKG,MAAL,CAAY,EAAZ,CAAb;;AACAT,MAAAA,UAAU,CACPU,OADH,CAEIC,sBAASC,gBAFb,EAGIb,IAAI,CAACK,KAAL,CAAW,CAAX,EAAcS,GAHlB,EAIIC,+BAAUL,MAAV,CAAiB;AACfL,QAAAA,KAAK,EAAE,CAACI,IAAD;AADQ,OAAjB,CAJJ,EAQGE,OARH,CAQWC,sBAASI,iBARpB,EAQuCP,IARvC;AASD,KAXD;AAYD;;AACD,SAAOP,IAAI,EAAX;AACD,CApBD;;eAsBeH,a","sourcesContent":["import { Plugin, Text, Commands } from \"@ali/4ever-cangjie\";\nimport { Paragraph } from '@ali/4ever-plugin-paragraph';\nimport RefBlock from \"./models\";\n\nconst normalizeNode: Plugin['normalizeNode'] = (node, controller, next) => {\n  if (!RefBlock.isRefBlock(node)) {\n    return next();\n  }\n\n if (node.nodes.length === 1 && Text.isText(node.nodes[0])) {\n    return () => {\n      const text = Text.create('');\n      controller\n        .command(\n          Commands.replaceNodeByKey,\n          node.nodes[0].key,\n          Paragraph.create({\n            nodes: [text],\n          }),\n        )\n        .command(Commands.moveToStartOfNode, text);\n    }\n  }\n  return next();\n}\n\nexport default normalizeNode;\n"],"file":"normalizeNode.js"}