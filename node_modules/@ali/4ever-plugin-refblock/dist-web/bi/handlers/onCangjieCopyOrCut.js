/* istanbul ignore file */
import { constants, transferUtils } from '@ali/4ever-cangjie';
import { unwrapRefBlock } from "../utils/ccp";
var MIME_TYPES = constants.MIME_TYPES;
export default function onCangjieCopyOrCut(event, controller, next) {
  if (!event.clipboardData) {
    return next();
  }

  var rawFragment = event.clipboardData.getData(MIME_TYPES.FRAGMENT);

  if (!rawFragment) {
    return next();
  }

  var fragment = transferUtils.decodeFragment(rawFragment);
  var newFragment = unwrapRefBlock(fragment); // 没有对 fragment 产生变更，则意味着不含有引用块

  if (newFragment === fragment) {
    return next();
  }

  return next(event.setClipboardData(event.clipboardData.setData(MIME_TYPES.FRAGMENT, transferUtils.encodeFragment(newFragment))));
}
//# sourceMappingURL=onCangjieCopyOrCut.js.map