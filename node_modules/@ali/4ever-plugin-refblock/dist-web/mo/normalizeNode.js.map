{"version":3,"sources":["../../../src/mo/normalizeNode.ts"],"names":["Text","Commands","Paragraph","RefBlock","normalizeNode","node","controller","next","isRefBlock","nodes","length","isText","text","create","command","replaceNodeByKey","key","moveToStartOfNode"],"mappings":"AAAA,SAAiBA,IAAjB,EAAuBC,QAAvB,QAAuC,oBAAvC;AACA,SAASC,SAAT,QAA0B,6BAA1B;AACA,OAAOC,QAAP;;AAEA,IAAMC,aAAsC,GAAG,SAAzCA,aAAyC,CAACC,IAAD,EAAOC,UAAP,EAAmBC,IAAnB,EAA4B;AACzE,MAAI,CAACJ,QAAQ,CAACK,UAAT,CAAoBH,IAApB,CAAL,EAAgC;AAC9B,WAAOE,IAAI,EAAX;AACD;;AAEF,MAAIF,IAAI,CAACI,KAAL,CAAWC,MAAX,KAAsB,CAAtB,IAA2BV,IAAI,CAACW,MAAL,CAAYN,IAAI,CAACI,KAAL,CAAW,CAAX,CAAZ,CAA/B,EAA2D;AACxD,WAAO,YAAM;AACX,UAAMG,IAAI,GAAGZ,IAAI,CAACa,MAAL,CAAY,EAAZ,CAAb;AACAP,MAAAA,UAAU,CACPQ,OADH,CAEIb,QAAQ,CAACc,gBAFb,EAGIV,IAAI,CAACI,KAAL,CAAW,CAAX,EAAcO,GAHlB,EAIId,SAAS,CAACW,MAAV,CAAiB;AACfJ,QAAAA,KAAK,EAAE,CAACG,IAAD;AADQ,OAAjB,CAJJ,EAQGE,OARH,CAQWb,QAAQ,CAACgB,iBARpB,EAQuCL,IARvC;AASD,KAXD;AAYD;;AACD,SAAOL,IAAI,EAAX;AACD,CApBD;;AAsBA,eAAeH,aAAf","sourcesContent":["import { Plugin, Text, Commands } from \"@ali/4ever-cangjie\";\nimport { Paragraph } from '@ali/4ever-plugin-paragraph';\nimport RefBlock from \"./models\";\n\nconst normalizeNode: Plugin['normalizeNode'] = (node, controller, next) => {\n  if (!RefBlock.isRefBlock(node)) {\n    return next();\n  }\n\n if (node.nodes.length === 1 && Text.isText(node.nodes[0])) {\n    return () => {\n      const text = Text.create('');\n      controller\n        .command(\n          Commands.replaceNodeByKey,\n          node.nodes[0].key,\n          Paragraph.create({\n            nodes: [text],\n          }),\n        )\n        .command(Commands.moveToStartOfNode, text);\n    }\n  }\n  return next();\n}\n\nexport default normalizeNode;\n"],"file":"normalizeNode.js"}