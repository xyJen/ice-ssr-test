import React from 'react';
var _createElement = /*#__PURE__*/React.createElement;
import classnames from 'classnames';
import { AvatarWrap, AvatarInner, AvatarCorner, NameWrap } from "./styled";
import AvatarImage from "./AvatarImage";
import { isEmojiCharacter } from "./util";
var GROUP_DEFAULT_AVATAR = 'data:image/png;base64,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';
var SINGLE_DEFAULT_AVATAR = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQCAMAAADQmBKKAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAzUExURUdwTODg4OXl5eHh4eDg4ODg4OHh4eLi4uDg4ODg4P///+Dg4N/f3////+rq6vT09Pz8/G6MElsAAAAMdFJOUwBDDlb4xown464Ee4L9HvIAAASbSURBVHjazVzbtqswCGw0V02T/P/Xnup2t7pra4aAR5760IdZMFwkwO3WIIPrRxuCMd5r7b0xIdixd8PtP0inbPA67or2waruRDCDGs0HLCtUZlSnqKrrwyGYJ6jQSytK1aP5xaTk0DjrI4hn+r+3TgZOiFTRwUnA0bFBmCE1aEcCUmcji1gml+t9ZBLfc1jLREYxrXYbbGQW2xK+h85w43mklAYlKR8FxKvLmKvNbALmenGbEACcl8PzqJjcpfAQECkdhQWjdi+O56Gk+rA9qHiG1CNSOp6DqNJq7iQ8UWt3Af/aMrsCUXcinof3H0bIwcRTxRxlERtPFnvgYPF0UUKETrMwE5tOoFTuk5R7yYmRRnQC/eD5kZJBV/tII0eyVM55DWcWENIno6EGS+9IngIZznxI8STafBJIST1DiM73A0EQ7QZsy6geGJHd6V9CeO41kpt4HTjNhTM7tLh8LZ57aVBR4LZXo4ocMSqLqSgIGKxFRU7EYJiKNgW2FVIQpKJ1LAKCNIYHyfyeVCeCCoJorcQpPQGqt5l+0rrTUhbDSKQ7vO5IMCAkofWiUZpAosVmg5aj0EOQ6nqAv8UIgBLsZ6NMHqMAGuHangAIYbVBnR73egzQ7PjQ5zwBEOJmM4msMCDEzeYEG64EKGCZXhyQ9lhYlNfQIzQKfI+1fOY76Is+FQqggiDqpeM06vgj4vXpThSosA7XAhSuB8hcC5CBcj0VEJTv/bW8zEOAMg0Q1Ny76ShOIqgiOgNQggBByb5IUwjkEE1FGQOEte+lcysYh0h+hr17mBs47lZE6zMwl5FYlFFA6BtZEXSxufwYoySigr4vjuijFGg0+L2zJzwjZjECzUX+oOUQ4XimDhHhZbzIEHppDRPmbpMMoZdPacrbeBIh9NJsIE1XZAkCLe2YjjS/VAQI9NupJs1XJAmDLQ/4YxRQEUlBS9OTNqKTBBS0tIUHza8imoKWxvkt8KuIpqBAG/qQA9QTnqfqbEa0WEeZaqgKjrnJYlQ/YwekSI/AcoB86/AZNyDbOH3GTmpHHdaRcXsdWgf0MnPt4ejzTCK5LDTOMB419eH61bWMfNU8MoCIQtuYZ2b/CHItm0C1bzCAkmzDYGUu/J/2u4OVQ00VkjLa/agaZ+6Jw7mk97JyrCZDGl9OxLb5zO8EMvowx8KmQkz3ZU9g32gpNaL5zvBvmxR7SwItpqox3fftF8XCY0hNClk04dTOBy1ZZBVHAM7fnHK4irMK2NzW2rOb74B1rnwXk1xF6LeFtyyNR1eucip9Dod09SKnanxCrKxuge3751opP7GfhNbQNYDXImcWcnkN7pS/kggnotd4dcuyNJ/ZVvGHcAVgtd6emdVDWm/flP0cOW2Vw8h3G1YnElrttsryvuG8zfrGRgukddHReGnDMtRGazjatl5J2hwioUDalGSG4YDMsDnVAlb729qe5VTL+zGbepf7Wxzy3Y9SAf4qevvuEb9AlPInVCW/f1084HDf/No9ijTv3eZSyvTJXKbfe/vSEiejfo9qUfrPQke1Lnh27IqH2aa4dLHTdVc87id6/vAfgBcRONEAbCsAAAAASUVORK5CYII=';

var AvatarContent = function AvatarContent(props) {
  var _ref = props,
      url = _ref.url,
      fallbackUrl = _ref.fallbackUrl,
      style = _ref.style,
      className = _ref.className,
      name = _ref.name,
      color = _ref.color,
      active = _ref.active,
      enableActiveAnimation = _ref.enableActiveAnimation,
      corner = _ref.corner,
      onClick = _ref.onClick,
      size = _ref.size,
      nameWrapStyle = _ref.nameWrapStyle,
      _ref$shape = _ref.shape,
      shape = _ref$shape === void 0 ? 'circle' : _ref$shape;
  /**
   * 头像情况：
   * 1) 名字、蓝底作为头像：url不存在，且名字存在
   * 2）多人头像：url为数组，如果url为空数组，则为默认群聊头像
   * 2）单人头像：url为字符串，如果url不存在，则为默认单人头像
   */

  var urls = []; // 过滤 emoji

  var avatarFilterName = Array.from(name || '').reverse().find(function (element) {
    return !isEmojiCharacter(element);
  });
  var isNameAvatar = !url && !!avatarFilterName; // 是否为名字头像

  if (!isNameAvatar) {
    // 统一转为字符串数组
    urls = (Array.isArray(url) ? url : [url]).filter(function (u) {
      return u;
    }).slice(-4); // 如果数组为空，根据是否群聊设置默认头像

    if (urls.length === 0) {
      urls.push(Array.isArray(url) ? GROUP_DEFAULT_AVATAR : SINGLE_DEFAULT_AVATAR);
    }
  }

  return /*#__PURE__*/_createElement(AvatarWrap, {
    className: classnames(className, shape, {
      'is-active': active,
      'enable-active-animation': enableActiveAnimation
    }),
    onClick: onClick,
    size: size,
    clickable: !!onClick
  }, /*#__PURE__*/_createElement(AvatarInner, {
    color: color,
    className: shape + " avatar-border-wrapper",
    style: style
  }, urls.map(function (src, index) {
    return /*#__PURE__*/_createElement(AvatarImage, {
      key: src,
      className: "avatar_" + urls.length + "_" + (index + 1) + " " + shape,
      url: src,
      nick: name,
      fallbackUrl: fallbackUrl
    });
  }), isNameAvatar && /*#__PURE__*/_createElement(NameWrap, null, /*#__PURE__*/_createElement("span", {
    style: nameWrapStyle
  }, avatarFilterName))), corner && /*#__PURE__*/_createElement(AvatarCorner, null, corner));
};

export default AvatarContent;