{"version":3,"sources":["../../../src/bi/renderMark.tsx"],"names":["React","MentionSuggestionPortal","config","renderMark","props","controller","next","isHidden","query","mark","markText","text","type","value","composing"],"mappings":";AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;qBAC4B,a;AAA5B,OAAOC,uBAAP;AAGA,gBAAe,UAACC,MAAD,EAAiC;AAC9C,SAAO,SAASC,UAAT,CAAoBC,KAApB,EAA2BC,UAA3B,EAAuCC,IAAvC,EAA6C;AAElD;AACA,QAAMC,QAAQ,GAAGF,UAAU,CAACG,KAAX,CAAiB,0BAAjB,CAAjB;AACA,QAAID,QAAJ,EAAc,OAAOD,IAAI,EAAX;AAJoC,QAM1CG,IAN0C,GAMjBL,KANiB,CAM1CK,IAN0C;AAAA,QAM9BC,QAN8B,GAMjBN,KANiB,CAMpCO,IANoC;;AAQlD,QAAIF,IAAI,CAACG,IAAL,KAAc,SAAd,IAA2B,CAACP,UAAU,CAACG,KAAX,CAAiB,uBAAjB,CAAhC,EAA2E;AACzE,UAAMG,IAAI,GAAGN,UAAU,CAACG,KAAX,CAAiB,mBAAjB,CAAb,CADyE,CAEzE;;AACA,UAAIG,IAAI,CAAC,CAAD,CAAJ,KAAYD,QAAQ,CAAC,CAAD,CAAxB,EAA6B,OAAOJ,IAAI,EAAX;AAC7B,0BACE,eAAC,uBAAD,eACMF,KADN,EAEMF,MAFN;AAGE,QAAA,IAAI,EAAES,IAHR;AAIE,QAAA,WAAW,EAAE,CAAC,CAACN,UAAU,CAACQ,KAAX,CAAiBC,SAJlC;AAKE,QAAA,UAAU,EAAET;AALd,SADF;AASD;;AAED,WAAOC,IAAI,EAAX;AACD,GAxBD;AAyBD,CA1BD","sourcesContent":["import * as React from 'react';\nimport MentionSuggestionPortal from './components/suggestionPortal';\nimport { MentionPluginConfig } from './types';\n\nexport default (config: MentionPluginConfig) => {\n  return function renderMark(props, controller, next) {\n\n    // 如果有 quickInsert 面板显示，则不显示 mention 面板\n    const isHidden = controller.query('isSelectionInQuickInsert');\n    if (isHidden) return next();\n\n    const { mark, text: markText } = props;\n\n    if (mark.type === 'mention' && !controller.query('isDisableMentionPanel')) {\n      const text = controller.query('getMentionKeyword');\n      // 某些场景 mark 会被分割，此时需要只有第一个 mark 唤起面板\n      if (text[0] !== markText[0]) return next();\n      return (\n        <MentionSuggestionPortal\n          {...props}\n          {...config}\n          text={text}\n          isComposing={!!controller.value.composing}\n          controller={controller}\n        />\n      );\n    }\n\n    return next();\n  };\n};\n"],"file":"renderMark.js"}