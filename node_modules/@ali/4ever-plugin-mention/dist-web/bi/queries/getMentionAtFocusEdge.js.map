{"version":3,"sources":["../../../../src/bi/queries/getMentionAtFocusEdge.ts"],"names":["Inline","getMentionAtFocusEdge","controller","dir","value","selection","focusText","document","start","getStart","isAtStartOfNode","preNode","getPreviousSibling","key","isInline","type","isAtEndOfNode","nextNode","getNextSibling"],"mappings":"AAAA,SAA8BA,MAA9B,QAA4C,oBAA5C;AACA;AACA;AACA;AACA;AACA;;AACA,eAAe,SAASC,qBAAT,CAA+BC,UAA/B,EAAuDC,GAAvD,EAAoG;AAAA,0BACtED,UAAU,CAACE,KAD2D;AAAA,MACzGC,SADyG,qBACzGA,SADyG;AAAA,MAC9FC,SAD8F,qBAC9FA,SAD8F;AAAA,MACnFC,QADmF,qBACnFA,QADmF;AAEjH,MAAI,CAACF,SAAD,IAAc,CAACC,SAAnB,EAA8B,OAAO,IAAP;AAC9B,MAAME,KAAK,GAAGH,SAAS,CAACI,QAAV,CAAmBF,QAAnB,CAAd;;AACA,MAAIJ,GAAG,KAAK,UAAR,IAAsBK,KAAK,CAACE,eAAN,CAAsBJ,SAAtB,CAA1B,EAA4D;AAC1D,QAAMK,OAAO,GAAGJ,QAAQ,CAACK,kBAAT,CAA4BN,SAAS,CAACO,GAAtC,CAAhB;AACA,QAAIF,OAAO,IAAIX,MAAM,CAACc,QAAP,CAAgBH,OAAhB,CAAX,IAAuCA,OAAO,CAACI,IAAR,KAAiB,SAA5D,EAAuE,OAAOJ,OAAP;AACxE,GAHD,MAGO,IAAIR,GAAG,KAAK,SAAR,IAAqBK,KAAK,CAACQ,aAAN,CAAoBV,SAApB,CAAzB,EAAyD;AAC9D,QAAMW,QAAQ,GAAGV,QAAQ,CAACW,cAAT,CAAwBZ,SAAS,CAACO,GAAlC,CAAjB;AACA,QAAII,QAAQ,IAAIjB,MAAM,CAACc,QAAP,CAAgBG,QAAhB,CAAZ,IAAyCA,QAAQ,CAACF,IAAT,KAAkB,SAA/D,EAA0E,OAAOE,QAAP;AAC3E;;AACD,SAAO,IAAP;AACD","sourcesContent":["import { Controller, Element, Inline } from '@ali/4ever-cangjie';\n/**\n * 获取 focus 边缘的 mention 节点\n * @param controller\n * @param dir 方向\n */\nexport default function getMentionAtFocusEdge(controller: Controller, dir: 'backward' | 'forward'): Element | null {\n  const { selection, focusText, document } = controller.value;\n  if (!selection || !focusText) return null;\n  const start = selection.getStart(document);\n  if (dir === 'backward' && start.isAtStartOfNode(focusText)) {\n    const preNode = document.getPreviousSibling(focusText.key);\n    if (preNode && Inline.isInline(preNode) && preNode.type === 'mention') return preNode;\n  } else if (dir === 'forward' && start.isAtEndOfNode(focusText)) {\n    const nextNode = document.getNextSibling(focusText.key);\n    if (nextNode && Inline.isInline(nextNode) && nextNode.type === 'mention') return nextNode;\n  }\n  return null;\n}\n"],"file":"getMentionAtFocusEdge.js"}