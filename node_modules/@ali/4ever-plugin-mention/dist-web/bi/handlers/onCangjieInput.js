import removeMention from "../commands/removeMention";
import insertMentionSuggestion from "../commands/insertMention";
import isSelectionInMention from "../queries/isSelectionInMentionSuggestion";
export default function onCangjieInput(event, controller, next) {
  // 当输入 @ 的时候，触发
  if (event.detail.data !== '@') {
    return next();
  }

  if (controller.query('isCollapsedInBlockVoid')) {
    return next();
  }

  if (isSelectionInMention(controller)) {
    var decorations = controller.value.decorations; // 若此时仍尝试呼出相同插入，则重新呼出

    var quickInsertDecoration = decorations.find(function (_ref) {
      var mark = _ref.mark;
      return mark.type === 'mention';
    });

    if (quickInsertDecoration) {
      controller.command(removeMention);
    }

    return insertMentionSuggestion(controller);
  } // 限制行首、或者前面有空格


  event.preventDefault();
  return insertMentionSuggestion(controller);
}
//# sourceMappingURL=onCangjieInput.js.map