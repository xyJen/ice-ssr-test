{"version":3,"sources":["../../../../src/bi/quickInsert/index.tsx"],"names":["creatMentionPlugin","config","mentionLocale","mention","locale","mentionConfig","quickInsertMention","mentionId","getMentionId","onAction","renderNode","onCangjiePaste","action","controller","next","type","payload","QUICK_INSERT_SET","plugin","command","insertMention","onKeyDown","onSelect","quickInsert","menubar","queries","isSelectionInMentionSuggestion","models"],"mappings":";;;;;;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AAEe,SAASA,kBAAT,CAA4BC,MAA5B,EAGZ;AACD,QAAMC,aAAa,GAAGD,MAAM,CAACE,OAAP,EAAgBC,MAAhB,IAA0B,EAAhD;AAEA,QAAMC,aAAkC,GAAG;AACzCD,IAAAA,MAAM,EAAEF,aADiC;AAEzC,OAAGD,MAAM,CAACK;AAF+B,GAA3C;AAIA,QAAMC,SAAS,GACbF,aAAa,IAAIA,aAAa,CAACG,YAA/B,GACIH,aAAa,CAACG,YAAd,EADJ,GAEI,EAHN;AAIA,QAAMC,QAAQ,GAAG,6BAAeJ,aAAf,CAAjB;AAEA,SAAO;AACLK,IAAAA,UAAU,EAAE,yBAAcH,SAAd,EAAyBF,aAAzB,CADP;AAELM,IAAAA,cAAc,EAAE,6BAAqBV,MAArB,CAFX;AAGLQ,IAAAA,QAAQ,EAAE,CAACG,MAAD,EAAiBC,UAAjB,EAAyCC,IAAzC,KAAkD;AAC1D,YAAM;AAAEC,QAAAA,IAAF;AAAQC,QAAAA;AAAR,UAAoBJ,MAA1B;;AACA,UACEG,IAAI,KAAKE,uCAAT,IACAD,OAAO,EAAEE,MAAT,KAAoB,oBAFtB,EAGE;AACA,eAAOL,UAAU,CAACM,OAAX,CAAmBC,sBAAnB,CAAP;AACD;;AACD,aAAOX,QAAQ,CAACG,MAAD,EAASC,UAAT,EAAqBC,IAArB,CAAf;AACD,KAZI;AAaLO,IAAAA,SAAS,EAATA,kBAbK;AAcLC,IAAAA,QAAQ,EAARA,iBAdK;AAeLC,IAAAA,WAAW,EAAE,sCAAwBlB,aAAxB,CAfR;AAgBLmB,IAAAA,OAAO,EAAPA,gBAhBK;AAiBLC,IAAAA,OAAO,EAAE;AACPC,MAAAA,8BAA8B,EAA9BA;AADO,KAjBJ;AAoBLC,IAAAA,MAAM,EAAE;AApBH,GAAP;AAsBD","sourcesContent":["import { Controller, Action } from '@ali/4ever-cangjie';\nimport renderMention from '../renderNode';\nimport onKeyDown from '../handlers/onKeyDown';\nimport createOnAction from '../handlers/createOnAction';\nimport onSelect from '../handlers/onSelect';\nimport { QUICK_INSERT_SET } from '@ali/4ever-plugin-quickinsert';\nimport { MentionPluginConfig } from '../types';\nimport insertMention from '../commands/insertMention';\nimport createQuickInsertConfig from './createQuickInsertConfig';\nimport menubar from './menubar';\nimport isSelectionInMentionSuggestion from '../queries/isSelectionInMentionSuggestion';\nimport createOnCangjiePaste from '../handlers/onCangjiePaste';\n\nexport default function creatMentionPlugin(config: {\n  quickInsertMention: MentionPluginConfig;\n  mention: Record<string, any>;\n}) {\n  const mentionLocale = config.mention?.locale || {}\n\n  const mentionConfig: MentionPluginConfig = {\n    locale: mentionLocale,\n    ...config.quickInsertMention,\n  };\n  const mentionId =\n    mentionConfig && mentionConfig.getMentionId\n      ? mentionConfig.getMentionId()\n      : '';\n  const onAction = createOnAction(mentionConfig);\n\n  return {\n    renderNode: renderMention(mentionId, mentionConfig),\n    onCangjiePaste: createOnCangjiePaste(config),\n    onAction: (action: Action, controller: Controller, next) => {\n      const { type, payload } = action;\n      if (\n        type === QUICK_INSERT_SET &&\n        payload?.plugin === 'quickInsertMention'\n      ) {\n        return controller.command(insertMention);\n      }\n      return onAction(action, controller, next);\n    },\n    onKeyDown,\n    onSelect,\n    quickInsert: createQuickInsertConfig(mentionConfig),\n    menubar,\n    queries: {\n      isSelectionInMentionSuggestion,\n    },\n    models: [],\n  };\n}\n"],"file":"index.js"}