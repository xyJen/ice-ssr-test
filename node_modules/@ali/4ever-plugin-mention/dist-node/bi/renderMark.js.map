{"version":3,"sources":["../../../src/bi/renderMark.tsx"],"names":["config","renderMark","props","controller","next","isHidden","query","mark","text","markText","type","value","composing"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;uBAA4B,a;;eAGZA,MAAD,IAAiC;AAC9C,SAAO,SAASC,UAAT,CAAoBC,KAApB,EAA2BC,UAA3B,EAAuCC,IAAvC,EAA6C;AAElD;AACA,UAAMC,QAAQ,GAAGF,UAAU,CAACG,KAAX,CAAiB,0BAAjB,CAAjB;AACA,QAAID,QAAJ,EAAc,OAAOD,IAAI,EAAX;AAEd,UAAM;AAAEG,MAAAA,IAAF;AAAQC,MAAAA,IAAI,EAAEC;AAAd,QAA2BP,KAAjC;;AAEA,QAAIK,IAAI,CAACG,IAAL,KAAc,SAAd,IAA2B,CAACP,UAAU,CAACG,KAAX,CAAiB,uBAAjB,CAAhC,EAA2E;AACzE,YAAME,IAAI,GAAGL,UAAU,CAACG,KAAX,CAAiB,mBAAjB,CAAb,CADyE,CAEzE;;AACA,UAAIE,IAAI,CAAC,CAAD,CAAJ,KAAYC,QAAQ,CAAC,CAAD,CAAxB,EAA6B,OAAOL,IAAI,EAAX;AAC7B,0BACE,eAAC,yBAAD,6BACMF,KADN,EAEMF,MAFN;AAGE,QAAA,IAAI,EAAEQ,IAHR;AAIE,QAAA,WAAW,EAAE,CAAC,CAACL,UAAU,CAACQ,KAAX,CAAiBC,SAJlC;AAKE,QAAA,UAAU,EAAET;AALd,SADF;AASD;;AAED,WAAOC,IAAI,EAAX;AACD,GAxBD;AAyBD,C","sourcesContent":["import * as React from 'react';\nimport MentionSuggestionPortal from './components/suggestionPortal';\nimport { MentionPluginConfig } from './types';\n\nexport default (config: MentionPluginConfig) => {\n  return function renderMark(props, controller, next) {\n\n    // 如果有 quickInsert 面板显示，则不显示 mention 面板\n    const isHidden = controller.query('isSelectionInQuickInsert');\n    if (isHidden) return next();\n\n    const { mark, text: markText } = props;\n\n    if (mark.type === 'mention' && !controller.query('isDisableMentionPanel')) {\n      const text = controller.query('getMentionKeyword');\n      // 某些场景 mark 会被分割，此时需要只有第一个 mark 唤起面板\n      if (text[0] !== markText[0]) return next();\n      return (\n        <MentionSuggestionPortal\n          {...props}\n          {...config}\n          text={text}\n          isComposing={!!controller.value.composing}\n          controller={controller}\n        />\n      );\n    }\n\n    return next();\n  };\n};\n"],"file":"renderMark.js"}