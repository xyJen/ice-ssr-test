{"version":3,"sources":["../../../../src/bi/handlers/onCangjiePaste.ts"],"names":["createOnCangjiePaste","config","onCangjiePaste","event","controller","next","environment","IS_MOBILE","hasPopup","value","decorations","some","d","mark","type","clipboardData","query","fragment","getFragment","command","Commands","insertText","text"],"mappings":";;;;;;;AAAA;;AAEe,SAASA,oBAAT,CACbC,MADa,EAEa;AAC1B,SAAO,SAASC,cAAT,CAAwBC,KAAxB,EAA+BC,UAA/B,EAAuDC,IAAvD,EAA6D;AAClE,QAAIC,yBAAYC,SAAhB,EAA2B;AACzB,aAAOF,IAAI,EAAX;AACD;;AACD,UAAMG,QAAQ,GAAGJ,UAAU,CAACK,KAAX,CAAiBC,WAAjB,CAA6BC,IAA7B,CACdC,CAAD,IAAOA,CAAC,CAACC,IAAF,CAAOC,IAAP,KAAgB,SAAhB,IAA6BF,CAAC,CAACC,IAAF,CAAOC,IAAP,KAAgB,cADrC,CAAjB;;AAGA,QAAI,CAACN,QAAL,EAAe;AACb,aAAOH,IAAI,EAAX;AACD;;AACD,UAAMU,aAAa,GAAGX,UAAU,CAACY,KAAX,CAAiB,kBAAjB,EAAqCb,KAArC,CAAtB;AAEA,UAAMc,QAAQ,GAAGF,aAAa,EAAEG,WAAf,EAAjB;;AACA,QAAI,CAACD,QAAL,EAAe;AACb,aAAOZ,IAAI,EAAX;AACD;;AACD,WAAOD,UAAU,CAACe,OAAX,CAAmBC,sBAASC,UAA5B,EAAwCJ,QAAQ,CAACK,IAAjD,CAAP;AACD,GAjBD;AAkBD","sourcesContent":["import { Commands, Controller, Plugin, environment, BiPluginConfig } from '@ali/4ever-cangjie';\n\nexport default function createOnCangjiePaste(\n  config: BiPluginConfig,\n): Plugin['onCangjiePaste'] {\n  return function onCangjiePaste(event, controller: Controller, next) {\n    if (environment.IS_MOBILE) {\n      return next();\n    }\n    const hasPopup = controller.value.decorations.some(\n      (d) => d.mark.type === 'mention' || d.mark.type === 'quick-insert',\n    );\n    if (!hasPopup) {\n      return next();\n    }\n    const clipboardData = controller.query('getClipboardData', event);\n\n    const fragment = clipboardData?.getFragment();\n    if (!fragment) {\n      return next();\n    }\n    return controller.command(Commands.insertText, fragment.text);\n  };\n}\n"],"file":"onCangjiePaste.js"}