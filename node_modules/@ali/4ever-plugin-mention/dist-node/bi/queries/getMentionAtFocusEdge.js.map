{"version":3,"sources":["../../../../src/bi/queries/getMentionAtFocusEdge.ts"],"names":["getMentionAtFocusEdge","controller","dir","selection","focusText","document","value","start","getStart","isAtStartOfNode","preNode","getPreviousSibling","key","Inline","isInline","type","isAtEndOfNode","nextNode","getNextSibling"],"mappings":";;;;;;;AAAA;;AACA;AACA;AACA;AACA;AACA;AACe,SAASA,qBAAT,CAA+BC,UAA/B,EAAuDC,GAAvD,EAAoG;AACjH,QAAM;AAAEC,IAAAA,SAAF;AAAaC,IAAAA,SAAb;AAAwBC,IAAAA;AAAxB,MAAqCJ,UAAU,CAACK,KAAtD;AACA,MAAI,CAACH,SAAD,IAAc,CAACC,SAAnB,EAA8B,OAAO,IAAP;AAC9B,QAAMG,KAAK,GAAGJ,SAAS,CAACK,QAAV,CAAmBH,QAAnB,CAAd;;AACA,MAAIH,GAAG,KAAK,UAAR,IAAsBK,KAAK,CAACE,eAAN,CAAsBL,SAAtB,CAA1B,EAA4D;AAC1D,UAAMM,OAAO,GAAGL,QAAQ,CAACM,kBAAT,CAA4BP,SAAS,CAACQ,GAAtC,CAAhB;AACA,QAAIF,OAAO,IAAIG,oBAAOC,QAAP,CAAgBJ,OAAhB,CAAX,IAAuCA,OAAO,CAACK,IAAR,KAAiB,SAA5D,EAAuE,OAAOL,OAAP;AACxE,GAHD,MAGO,IAAIR,GAAG,KAAK,SAAR,IAAqBK,KAAK,CAACS,aAAN,CAAoBZ,SAApB,CAAzB,EAAyD;AAC9D,UAAMa,QAAQ,GAAGZ,QAAQ,CAACa,cAAT,CAAwBd,SAAS,CAACQ,GAAlC,CAAjB;AACA,QAAIK,QAAQ,IAAIJ,oBAAOC,QAAP,CAAgBG,QAAhB,CAAZ,IAAyCA,QAAQ,CAACF,IAAT,KAAkB,SAA/D,EAA0E,OAAOE,QAAP;AAC3E;;AACD,SAAO,IAAP;AACD","sourcesContent":["import { Controller, Element, Inline } from '@ali/4ever-cangjie';\n/**\n * 获取 focus 边缘的 mention 节点\n * @param controller\n * @param dir 方向\n */\nexport default function getMentionAtFocusEdge(controller: Controller, dir: 'backward' | 'forward'): Element | null {\n  const { selection, focusText, document } = controller.value;\n  if (!selection || !focusText) return null;\n  const start = selection.getStart(document);\n  if (dir === 'backward' && start.isAtStartOfNode(focusText)) {\n    const preNode = document.getPreviousSibling(focusText.key);\n    if (preNode && Inline.isInline(preNode) && preNode.type === 'mention') return preNode;\n  } else if (dir === 'forward' && start.isAtEndOfNode(focusText)) {\n    const nextNode = document.getNextSibling(focusText.key);\n    if (nextNode && Inline.isInline(nextNode) && nextNode.type === 'mention') return nextNode;\n  }\n  return null;\n}\n"],"file":"getMentionAtFocusEdge.js"}