{"version":3,"sources":["../../../src/zhi/mention.tsx"],"names":["Mention","props","node","onMentionClick","onMentionHover","getCurrentUser","locale","rest","name","login","id","isPlaceholder","data","text","getFirstText","leaf","leaves","marks","style","isSelf","handleMentionClick","event","preventDefault","stopPropagation","handleMentionHover","mentionPlaceholder","type"],"mappings":";;;;;;;;;;;;;AAAA;;AAEA;;AAEA;;AACA;;AACA;;uBAL4B,a;;AAeb,SAASA,OAAT,CAAiBC,KAAjB,EAAsC;AACnD,QAAM;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,cAAR;AAAwBC,IAAAA,cAAxB;AAAwCC,IAAAA,cAAxC;AAAwDC,IAAAA,MAAxD;AAAgE,OAAGC;AAAnE,MAA4EN,KAAlF;AACA,QAAM;AAAEO,IAAAA,IAAF;AAAQC,IAAAA,KAAR;AAAeC,IAAAA,EAAf;AAAmBC,IAAAA;AAAnB,MAAqCT,IAAI,CAACU,IAAhD;AACA,QAAMC,IAAI,GAAGX,IAAI,CAACY,YAAL,EAAb;AACA,QAAMC,IAAI,GAAGF,IAAI,IAAIA,IAAI,CAACG,MAAL,CAAY,CAAZ,CAArB;AACA,QAAMC,KAAK,GAAGF,IAAI,GAAGA,IAAI,CAACE,KAAR,GAAgB,EAAlC;AACA,QAAMC,KAAK,GAAG,mCAAaD,KAAb,CAAd;AAEA,QAAME,MAAM,GAAGd,cAAc,GAAGA,cAAc,OAAOI,KAAxB,GAAgC,KAA7D;AAEA,QAAMW,kBAAkB,GAAG,wBAAaC,KAAD,IAA6B;AAClEA,IAAAA,KAAK,CAACC,cAAN;AACAD,IAAAA,KAAK,CAACE,eAAN;;AACA,QAAIpB,cAAJ,EAAoB;AAClB;AACAA,MAAAA,cAAc,CAACD,IAAI,CAACU,IAAN,CAAd;AACD;AACF,GAP0B,EAOxB,CAACV,IAAI,CAACU,IAAN,EAAYT,cAAZ,CAPwB,CAA3B;AASA,QAAMqB,kBAAkB,GAAG,wBAAaH,KAAD,IAA6B;AAClE,QAAIjB,cAAJ,EAAoB;AAClB;AACAA,MAAAA,cAAc,CAACF,IAAI,CAACU,IAAN,CAAd;AACD;AACF,GAL0B,EAKxB,CAACV,IAAI,CAACU,IAAN,EAAYR,cAAZ,CALwB,CAA3B;;AAQA,MAAIO,aAAJ,EAAmB;AACjB,wBACE,eAAC,uBAAD;AAAY,MAAA,QAAQ;AAApB,aACKL,MAAM,CAACmB,kBADZ,CADF;AAKD;;AAED,sBACE,eAAC,gBAAD,6BACMlB,IADN;AAEE;AACA,IAAA,EAAE,EAAEG,EAHN;AAIE,iBAAWR,IAAI,CAACwB,IAJlB;AAKE,IAAA,KAAK,EAAER,KALT;AAME,IAAA,OAAO,EAAEE,kBANX;AAOE,IAAA,YAAY,EAAEI,kBAPhB;AAQE,IAAA,MAAM,EAAEL,MARV;AASE,IAAA,IAAI,EAAEjB;AATR,wBAYE,eAAC,0BAAD,QAAqBM,IAArB,CAZF,CADF;AAgBD","sourcesContent":["import React, {useCallback} from 'react';\nimport { Inline } from '@ali/4ever-cangjie';\nimport { marksToStyle as convertMarks } from '@ali/4ever-plugin-marks';\nimport type { MentionPluginLocale, onMentionClickType } from '../utils/types';\nimport { BtnWrapper } from '../components/placeholder';\nimport MentionComponent from '../components/mention';\nimport { MentionNameWrapper } from '../components/styled';\n\nexport interface MentionProps {\n  node: Inline;\n  onMentionClick?: onMentionClickType;\n  onMentionHover?: onMentionClickType;\n  getCurrentUser?: () => string;\n  locale: MentionPluginLocale;\n}\n\nexport default function Mention(props: MentionProps) {\n  const { node, onMentionClick, onMentionHover, getCurrentUser, locale, ...rest } = props;\n  const { name, login, id, isPlaceholder } = node.data;\n  const text = node.getFirstText();\n  const leaf = text && text.leaves[0];\n  const marks = leaf ? leaf.marks : [];\n  const style = convertMarks(marks);\n\n  const isSelf = getCurrentUser ? getCurrentUser() === login : false;\n\n  const handleMentionClick = useCallback((event: React.MouseEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (onMentionClick) {\n      // @ts-ignore\n      onMentionClick(node.data);\n    }\n  }, [node.data, onMentionClick]);\n\n  const handleMentionHover = useCallback((event: React.MouseEvent) => {\n    if (onMentionHover) {\n      // @ts-ignore\n      onMentionHover(node.data);\n    }\n  }, [node.data, onMentionHover]);\n\n\n  if (isPlaceholder) {\n    return (\n      <BtnWrapper isReader>\n        @ {locale.mentionPlaceholder}\n      </BtnWrapper>\n    );\n  }\n\n  return (\n    <MentionComponent\n      {...rest}\n      // @ts-ignore\n      id={id}\n      data-type={node.type}\n      style={style}\n      onClick={handleMentionClick}\n      onMouseEnter={handleMentionHover}\n      isSelf={isSelf}\n      node={node}\n    >\n      @\n      <MentionNameWrapper>{name}</MentionNameWrapper>\n    </MentionComponent>\n  );\n}\n"],"file":"mention.js"}