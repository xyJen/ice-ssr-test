{"version":3,"sources":["../../src/changeNullSelectionMark.ts"],"names":["Commands","Mark","changeNullSelectionMark","controller","markType","currentMark","ranges","document","selection","value","documentMarks","getMarksAtRange","filter","mark","type","length","forEach","command","removeMark","marks","addMark","create","data","ascii","hAnsi","cs","eastAsia","szUnit"],"mappings":"AAAA,SAAqBA,QAArB,EAA+BC,IAA/B,QAA2C,oBAA3C;AAEA,eAAe,SAASC,uBAAT,CAAiCC,UAAjC,EAAyDC,QAAzD,EAAmEC,WAAnE,EAAgFC,MAAhF,EAAwFC,QAAxF,EAAkG;AAAA,MACvGC,SADuG,GACzFL,UAAU,CAACM,KAD8E,CACvGD,SADuG;AAE/G,MAAME,aAAa,GAAGH,QAAQ,CAACI,eAAT,CAAyBL,MAAzB,EAAiCM,MAAjC,CAAwC,UAAAC,IAAI;AAAA,WAAIA,IAAI,CAACC,IAAL,KAAcV,QAAlB;AAAA,GAA5C,CAAtB;AAEA;;AACA,MAAIM,aAAa,CAACK,MAAlB,EAA0B;AACxBL,IAAAA,aAAa,CAACM,OAAd,CAAsB,UAACH,IAAD,EAAU;AAC9BV,MAAAA,UAAU,CAACc,OAAX,CAAmBjB,QAAQ,CAACkB,UAA5B,EAAwCL,IAAxC;AACD,KAFD;AAGD;AACD;;;AACA,MAAIL,SAAS,CAACW,KAAd,EAAqB;AACnB,QAAMA,KAAK,GAAGX,SAAS,CAACW,KAAxB;AACAA,IAAAA,KAAK,CAACH,OAAN,CAAc,UAACH,IAAD,EAAU;AACtB,UAAIA,IAAI,CAACC,IAAL,KAAcV,QAAlB,EAA4B;AAC1BD,QAAAA,UAAU,CAACc,OAAX,CAAmBjB,QAAQ,CAACkB,UAA5B,EAAwCL,IAAxC;AACD;AACF,KAJD;AAKD;;AACD,MAAIT,QAAQ,KAAK,OAAjB,EAA0B;AACxBD,IAAAA,UAAU,CAACc,OAAX,CAAmBjB,QAAQ,CAACoB,OAA5B,EAAqCnB,IAAI,CAACoB,MAAL,CAAY;AAC/CP,MAAAA,IAAI,EAAEV,QADyC;AAE/CkB,MAAAA,IAAI,EAAE;AACJC,QAAAA,KAAK,EAAElB,WADH;AAEJmB,QAAAA,KAAK,EAAEnB,WAFH;AAGJoB,QAAAA,EAAE,EAAEpB,WAHA;AAIJqB,QAAAA,QAAQ,EAAErB;AAJN;AAFyC,KAAZ,CAArC;AASD,GAVD,MAUO,IAAID,QAAQ,KAAK,IAAjB,EAAuB;AAC5BD,IAAAA,UAAU,CAACc,OAAX,CAAmBjB,QAAQ,CAACoB,OAA5B,EAAqCnB,IAAI,CAACoB,MAAL,CAAY;AAC/CP,MAAAA,IAAI,EAAEV,QADyC;AAE/CkB,MAAAA,IAAI,EAAE;AACJb,QAAAA,KAAK,EAAEJ,WADH;AAEJsB,QAAAA,MAAM,EAAE;AAFJ;AAFyC,KAAZ,CAArC;AAOD,GARM,MAQA,IAAIvB,QAAQ,KAAK,WAAjB,EAA8B;AACnC,QAAIC,WAAW,IAAI,OAAOA,WAAP,KAAuB,QAA1C,EAAoD;AAClDF,MAAAA,UAAU,CAACc,OAAX,CAAmBjB,QAAQ,CAACoB,OAA5B,EAAqCnB,IAAI,CAACoB,MAAL,CAAY;AAC/CP,QAAAA,IAAI,EAAEV,QADyC;AAE/CkB,QAAAA,IAAI,EAAE;AACJb,UAAAA,KAAK,EAAEJ;AADH;AAFyC,OAAZ,CAArC;AAMD;AACF,GATM,MASA;AACLF,IAAAA,UAAU,CAACc,OAAX,CAAmBjB,QAAQ,CAACoB,OAA5B,EAAqCnB,IAAI,CAACoB,MAAL,CAAY;AAC/CP,MAAAA,IAAI,EAAEV,QADyC;AAE/CkB,MAAAA,IAAI,EAAE;AACJb,QAAAA,KAAK,EAAEJ;AADH;AAFyC,KAAZ,CAArC;AAMD;;AAED,SAAOF,UAAP;AACD","sourcesContent":["import { Controller, Commands, Mark } from '@ali/4ever-cangjie';\n\nexport default function changeNullSelectionMark(controller: Controller, markType, currentMark, ranges, document) {\n  const { selection } = controller.value;\n  const documentMarks = document.getMarksAtRange(ranges).filter(mark => mark.type === markType);\n\n  /* 删除document的mark */\n  if (documentMarks.length) {\n    documentMarks.forEach((mark) => {\n      controller.command(Commands.removeMark, mark);\n    });\n  }\n  /* 删除selection的mark */\n  if (selection.marks) {\n    const marks = selection.marks;\n    marks.forEach((mark) => {\n      if (mark.type === markType) {\n        controller.command(Commands.removeMark, mark);\n      }\n    });\n  }\n  if (markType === 'fonts') {\n    controller.command(Commands.addMark, Mark.create({\n      type: markType,\n      data: {\n        ascii: currentMark,\n        hAnsi: currentMark,\n        cs: currentMark,\n        eastAsia: currentMark,\n      },\n    }));\n  } else if (markType === 'sz') {\n    controller.command(Commands.addMark, Mark.create({\n      type: markType,\n      data: {\n        value: currentMark,\n        szUnit: 'pt',\n      },\n    }));\n  } else if (markType === 'highlight') {\n    if (currentMark && typeof currentMark === 'string') {\n      controller.command(Commands.addMark, Mark.create({\n        type: markType,\n        data: {\n          value: currentMark,\n        },\n      }));\n    }\n  } else {\n    controller.command(Commands.addMark, Mark.create({\n      type: markType,\n      data: {\n        value: currentMark,\n      },\n    }));\n  }\n\n  return controller;\n}\n"],"file":"changeNullSelectionMark.js"}