{"version":3,"sources":["../../src/sectionDataUtils.ts"],"names":["defaultSectPr","pgSz","h","w","orient","pgMar","top","bottom","left","right","header","footer","gutter","getSectPrFromJson","data","sectPr","defaultFooterId","defaultHeaderId","footerRefs","defaultRefId","headerRefs","getSectPr","documentData","field","result","getMaxPageWidth","document","sectPrPgSz","sectPrPageWidth","nodes","filter","node","type","reduce","maxWidth","Math","max","getMaxPageWidthSection"],"mappings":"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","sourcesContent":["import { Document } from '@ali/4ever-cangjie';\n/**\n * 纸张的属性\n */\nexport interface SectionPr {\n  type?: string;\n  effectiveType?: string;\n  background?: {\n    color: string;\n  };\n  defaultFooterId?: string;\n  defaultHeaderId?: string;\n  pgMar: {\n    top: number;\n    bottom: number;\n    left: number;\n    right: number;\n    header: number;\n    footer: number;\n    gutter: number;\n  };\n  pgSz: {\n    h: number;\n    w: number;\n    orient: string;\n  };\n}\n\nconst defaultSectPr: SectionPr = {\n  pgSz: {\n    h: 1122.67,\n    w: 793.33,\n    orient: 'portrait',\n  },\n  pgMar: {\n    top: 96,\n    bottom: 96,\n    left: 72,\n    right: 72,\n    header: 56.73,\n    footer: 66.13,\n    gutter: 0,\n  },\n};\n\n/**\n * Pi-1.0 使用\n * @returns\n * @deprecated\n */\nexport const getSectPrFromJson = (data: Record<string, any>): SectionPr => {\n  if (!data.sectPr) return defaultSectPr;\n  const { pgMar } = defaultSectPr;\n  const { pgSz } = defaultSectPr;\n  const { w = pgSz.w, h = pgSz.h, orient = pgSz.orient } =\n    data.sectPr.pgSz || {};\n  const {\n    header = pgMar.header,\n    footer = pgMar.footer,\n    top = pgMar.top,\n    bottom = pgMar.bottom,\n    left = pgMar.left,\n    right = pgMar.right,\n    gutter = pgMar.gutter,\n  } = data.sectPr.pgMar || {};\n\n  let defaultFooterId;\n  let defaultHeaderId;\n  if (data.sectPr.footerRefs) {\n    defaultFooterId = data.sectPr.footerRefs.defaultRefId;\n  }\n  if (data.sectPr.headerRefs) {\n    defaultHeaderId = data.sectPr.headerRefs.defaultRefId;\n  }\n\n  return {\n    defaultHeaderId,\n    defaultFooterId,\n    pgMar: { header, footer, top, bottom, left, right, gutter },\n    pgSz: { w, h, orient },\n  };\n};\n\n// Get sectPr from document.data\nexport const getSectPr = (\n  documentData: Record<string, any>,\n  field = '',\n): Record<string, any> => {\n  const { sectPr } = documentData;\n  if (!sectPr) {\n    if (field && defaultSectPr[field]) {\n      return defaultSectPr[field];\n    }\n    return defaultSectPr;\n  }\n\n  let { pgSz, pgMar } = defaultSectPr;\n  if (sectPr.pgSz) {\n    const { w = pgSz.w, h = pgSz.h, orient = pgSz.orient } = sectPr.pgSz;\n    pgSz = { w, h, orient };\n  }\n  if (sectPr.pgMar) {\n    const {\n      top = pgMar.top,\n      bottom = pgMar.bottom,\n      left = pgMar.left,\n      right = pgMar.right,\n      header = pgMar.header,\n      footer = pgMar.footer,\n      gutter = pgMar.gutter,\n    } = sectPr.pgMar;\n    pgMar = { header, footer, top, bottom, left, right, gutter };\n  }\n\n  const result = {\n    ...sectPr,\n    pgSz,\n    pgMar,\n  };\n  if (field && result[field]) {\n    return result[field];\n  }\n  return result;\n};\n\nexport function getMaxPageWidth(document: Document) {\n  const sectPr = getSectPr(document.data);\n  const sectPrPgSz = sectPr.pgSz;\n  const sectPrPageWidth: number = sectPrPgSz.w;\n  return document.nodes.filter((node) => {\n    return node && node.type === 'sectionBr';\n  }).reduce((maxWidth, node) => {\n    if (node.data.pgSz?.w) {\n      return Math.max(node.data.pgSz.w, maxWidth);\n    }\n    return maxWidth;\n  }, sectPrPageWidth);\n}\n\n// FIX: 重命名 getMaxPageWidthSection 导致 we-word 中无法找到该方法 to @白昱\nexport const getMaxPageWidthSection = getMaxPageWidth;\n"],"file":"sectionDataUtils.js"}