import { Selection, Point } from '@ali/4ever-cangjie';
export default function generateRangesFromTableSelection(controller, tableSelections) {
  var document = controller.value.document;
  var ranges = [];
  if (!tableSelections) return undefined;
  tableSelections.forEach(function (tableSelection) {
    if (!tableSelection) {
      return undefined;
    }

    var key = tableSelection.key,
        startRowIndex = tableSelection.startRowIndex,
        startColIndex = tableSelection.startColIndex,
        endRowIndex = tableSelection.endRowIndex,
        endColIndex = tableSelection.endColIndex;
    var table = document.getNode(key);

    if (!table) {
      return [];
    }

    for (var rowIndex = startRowIndex; rowIndex <= endRowIndex; rowIndex += 1) {
      var row = table.nodes[rowIndex];

      if (!row) {
        return undefined;
      }

      for (var colIndex = startColIndex; colIndex <= endColIndex; colIndex += 1) {
        var cell = row.nodes[colIndex];

        if (!cell) {
          continue;
        }

        var anchorText = cell.getFirstText();
        var focusText = cell.getLastText();

        if (!anchorText || !focusText) {
          break;
        }

        ranges.push(Selection.create({
          anchor: Point.create({
            key: anchorText.key,
            // @ts-ignore
            offset: 0
          }),
          focus: Point.create({
            key: focusText.key,
            // @ts-ignore
            offset: focusText.text.length
          })
        }));
      }
    }

    return undefined;
  });
  return ranges;
}
//# sourceMappingURL=generateRangesFromTableSelection.js.map