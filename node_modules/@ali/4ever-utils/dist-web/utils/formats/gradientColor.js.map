{"version":3,"sources":["../../../../src/utils/formats/gradientColor.ts"],"names":["environment","GRADIENT_FLAG","GRADIENT_COLOR_STYLE","WebkitBackgroundClip","backgroundClip","WebkitTextFillColor","backgroundImage","GRADIENT_STYLE_FLAG","CHROME_VERSION_DIVIDE","isGradientColor","color","includes","transferGradientColor","split","notSupportClipText","getChromeVersion","IS_SAFARI","chromeVersion","isOldChrome","setGradientStyle","style","startColor","endColor","Object","keys","forEach","key","WebkitBoxDecorationBreak","shouldDegradeGradient","hasLineDecoration","hasBackground","backgroundColor"],"mappings":"AAAA,SAASA,WAAT,QAA4B,oBAA5B;AAGA,OAAO,IAAMC,aAAa,GAAG,IAAtB;AACP,OAAO,IAAMC,oBAAoB,GAAG;AAClC;AACA;AACAC,EAAAA,oBAAoB,EAAE,MAHY;AAIlCC,EAAAA,cAAc,EAAE,MAJkB;AAKlCC,EAAAA,mBAAmB,EAAE,aALa;AAMlCC,EAAAA,eAAe,EAAE;AANiB,CAA7B;AAQP,OAAO,IAAMC,mBAAmB,GAAG,sBAA5B;AACP,IAAMC,qBAAqB,GAAG,EAA9B;AAGA,OAAO,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACC,KAAD,EAAmB;AAChD;AACA,SAAOA,KAAK,IAAIA,KAAK,CAACC,QAAN,CAAeV,aAAf,CAAhB;AACD,CAHM,C,CAKP;;AACA,OAAO,IAAMW,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACF,KAAD,EAAmB;AACtD,MAAI,CAACD,eAAe,CAACC,KAAD,CAApB,EAA6B;AAC3B,WAAO,EAAP;AACD;;AACD,SAAOA,KAAK,CAACG,KAAN,CAAYZ,aAAZ,CAAP;AACD,CALM,C,CAOP;;AACA,OAAO,IAAMa,kBAAkB,GAAG,SAArBA,kBAAqB,GAAM;AAAA,MAC9BC,gBAD8B,GACEf,WADF,CAC9Be,gBAD8B;AAAA,MACZC,SADY,GACEhB,WADF,CACZgB,SADY;AAEtC,MAAMC,aAAa,GAAGF,gBAAgB,EAAtC;AACA,MAAMG,WAAW,GAAGD,aAAa,KAAK,CAAC,CAAnB,IAAwBA,aAAa,GAAGT,qBAA5D;AACA,SAAOU,WAAW,IAAIF,SAAtB;AACD,CALM;AAOP,OAAO,IAAMG,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACT,KAAD,EAAgBU,KAAhB,EAA+C;AAC7E;AAD6E,8BAE9CR,qBAAqB,CAACF,KAAD,CAFyB;AAAA,MAEtEW,UAFsE;AAAA,MAE1DC,QAF0D;;AAG7EC,EAAAA,MAAM,CAACC,IAAP,CAAYtB,oBAAZ,EAAkCuB,OAAlC,CAA0C,UAACC,GAAD,EAAS;AACjDN,IAAAA,KAAK,CAACM,GAAD,CAAL,GAAaxB,oBAAoB,CAACwB,GAAD,CAAjC;AACD,GAFD;AAIAN,EAAAA,KAAK,CAACd,eAAN,+BAAkDe,UAAlD,UAAiEC,QAAjE,OAP6E,CAQ7E;;AACAF,EAAAA,KAAK,CAACV,KAAN,GAAcW,UAAd,CAT6E,CAW7E;;AACA,MAAIP,kBAAkB,EAAtB,EAA0B;AACxBM,IAAAA,KAAK,CAACO,wBAAN,GAAiC,OAAjC;AACD;AACF,CAfM,C,CAiBP;;AACA,OAAO,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACR,KAAD,EAAgC;AACnE,MAAI,EAAEb,mBAAmB,IAAIa,KAAzB,CAAJ,EAAqC;AACnC,WAAO,KAAP;AACD;;AACD,MAAMS,iBAAiB,IAAG,wBAAwBT,KAA3B,CAAvB;AACA,MAAMU,aAAa,GAAGV,KAAK,CAACW,eAAN,IAAyBX,KAAK,CAACW,eAAN,KAA0B,aAAzE;AACA,SAAOF,iBAAiB,IAAIC,aAA5B;AACD,CAPM;AASP,eAAe;AACb5B,EAAAA,oBAAoB,EAApBA,oBADa;AAEbK,EAAAA,mBAAmB,EAAnBA,mBAFa;AAGbE,EAAAA,eAAe,EAAfA,eAHa;AAIbG,EAAAA,qBAAqB,EAArBA,qBAJa;AAKbO,EAAAA,gBAAgB,EAAhBA,gBALa;AAMbL,EAAAA,kBAAkB,EAAlBA,kBANa;AAObc,EAAAA,qBAAqB,EAArBA;AAPa,CAAf","sourcesContent":["import { environment } from '@ali/4ever-cangjie';\nimport React from 'react';\n\nexport const GRADIENT_FLAG = '__';\nexport const GRADIENT_COLOR_STYLE = {\n  // chrome 会自动去掉 webkit 前缀，需在 snapshot 和 全局 手动处理\n  // https://github.com/facebook/react/issues/14200\n  WebkitBackgroundClip: 'text',\n  backgroundClip: 'text',\n  WebkitTextFillColor: 'transparent',\n  backgroundImage: 'linear-gradient(90deg, #404040, #404040)',\n};\nexport const GRADIENT_STYLE_FLAG = 'WebkitBackgroundClip';\nconst CHROME_VERSION_DIVIDE = 72;\n\n\nexport const isGradientColor = (color: string) => {\n  // 判断是否为渐变色，渐变色格式为 ‘#color1__#color2’\n  return color && color.includes(GRADIENT_FLAG);\n};\n\n// 将 #color1_#color2 转换为 [color1, color2]\nexport const transferGradientColor = (color: string) => {\n  if (!isGradientColor(color)) {\n    return [];\n  }\n  return color.split(GRADIENT_FLAG);\n};\n\n// safari 和 低版本(72-) chrome 对 -webkit-text-clip 支持有问题, 导致渐变色换行不显示，需特殊处理\nexport const notSupportClipText = () => {\n  const { getChromeVersion, IS_SAFARI } = environment;\n  const chromeVersion = getChromeVersion();\n  const isOldChrome = chromeVersion !== -1 && chromeVersion < CHROME_VERSION_DIVIDE;\n  return isOldChrome || IS_SAFARI;\n};\n\nexport const setGradientStyle = (color: string, style: React.CSSProperties) => {\n  // 渐变色\n  const [startColor, endColor] = transferGradientColor(color);\n  Object.keys(GRADIENT_COLOR_STYLE).forEach((key) => {\n    style[key] = GRADIENT_COLOR_STYLE[key];\n  });\n\n  style.backgroundImage = `linear-gradient(90deg, ${startColor}, ${endColor})`;\n  // 使用第一个颜色兜底\n  style.color = startColor;\n\n  // safari 和 低版本(72-) chrome 渐变色换行不显示，需添加一个属性\n  if (notSupportClipText()) {\n    style.WebkitBoxDecorationBreak = 'clone';\n  }\n};\n\n// 存在下划线/删除线/非透明背景时，渐变色降级为第一个颜色\nexport const shouldDegradeGradient = (style: React.CSSProperties) => {\n  if (!(GRADIENT_STYLE_FLAG in style)) {\n    return false;\n  }\n  const hasLineDecoration = 'textDecorationLine' in style;\n  const hasBackground = style.backgroundColor && style.backgroundColor !== 'transparent';\n  return hasLineDecoration || hasBackground;\n};\n\nexport default {\n  GRADIENT_COLOR_STYLE,\n  GRADIENT_STYLE_FLAG,\n  isGradientColor,\n  transferGradientColor,\n  setGradientStyle,\n  notSupportClipText,\n  shouldDegradeGradient,\n};\n"],"file":"gradientColor.js"}