{"version":3,"sources":["../../../../src/utils/formats/gradientColor.ts"],"names":["GRADIENT_FLAG","GRADIENT_COLOR_STYLE","WebkitBackgroundClip","backgroundClip","WebkitTextFillColor","backgroundImage","GRADIENT_STYLE_FLAG","CHROME_VERSION_DIVIDE","isGradientColor","color","includes","transferGradientColor","split","notSupportClipText","getChromeVersion","IS_SAFARI","environment","chromeVersion","isOldChrome","setGradientStyle","style","startColor","endColor","Object","keys","forEach","key","WebkitBoxDecorationBreak","shouldDegradeGradient","hasLineDecoration","hasBackground","backgroundColor"],"mappings":";;;;;;;AAAA;;AAGO,MAAMA,aAAa,GAAG,IAAtB;;AACA,MAAMC,oBAAoB,GAAG;AAClC;AACA;AACAC,EAAAA,oBAAoB,EAAE,MAHY;AAIlCC,EAAAA,cAAc,EAAE,MAJkB;AAKlCC,EAAAA,mBAAmB,EAAE,aALa;AAMlCC,EAAAA,eAAe,EAAE;AANiB,CAA7B;;AAQA,MAAMC,mBAAmB,GAAG,sBAA5B;;AACP,MAAMC,qBAAqB,GAAG,EAA9B;;AAGO,MAAMC,eAAe,GAAIC,KAAD,IAAmB;AAChD;AACA,SAAOA,KAAK,IAAIA,KAAK,CAACC,QAAN,CAAeV,aAAf,CAAhB;AACD,CAHM,C,CAKP;;;;;AACO,MAAMW,qBAAqB,GAAIF,KAAD,IAAmB;AACtD,MAAI,CAACD,eAAe,CAACC,KAAD,CAApB,EAA6B;AAC3B,WAAO,EAAP;AACD;;AACD,SAAOA,KAAK,CAACG,KAAN,CAAYZ,aAAZ,CAAP;AACD,CALM,C,CAOP;;;;;AACO,MAAMa,kBAAkB,GAAG,MAAM;AACtC,QAAM;AAAEC,IAAAA,gBAAF;AAAoBC,IAAAA;AAApB,MAAkCC,wBAAxC;AACA,QAAMC,aAAa,GAAGH,gBAAgB,EAAtC;AACA,QAAMI,WAAW,GAAGD,aAAa,KAAK,CAAC,CAAnB,IAAwBA,aAAa,GAAGV,qBAA5D;AACA,SAAOW,WAAW,IAAIH,SAAtB;AACD,CALM;;;;AAOA,MAAMI,gBAAgB,GAAG,CAACV,KAAD,EAAgBW,KAAhB,KAA+C;AAC7E;AACA,QAAM,CAACC,UAAD,EAAaC,QAAb,IAAyBX,qBAAqB,CAACF,KAAD,CAApD;AACAc,EAAAA,MAAM,CAACC,IAAP,CAAYvB,oBAAZ,EAAkCwB,OAAlC,CAA2CC,GAAD,IAAS;AACjDN,IAAAA,KAAK,CAACM,GAAD,CAAL,GAAazB,oBAAoB,CAACyB,GAAD,CAAjC;AACD,GAFD;AAIAN,EAAAA,KAAK,CAACf,eAAN,GAAyB,0BAAyBgB,UAAW,KAAIC,QAAS,GAA1E,CAP6E,CAQ7E;;AACAF,EAAAA,KAAK,CAACX,KAAN,GAAcY,UAAd,CAT6E,CAW7E;;AACA,MAAIR,kBAAkB,EAAtB,EAA0B;AACxBO,IAAAA,KAAK,CAACO,wBAAN,GAAiC,OAAjC;AACD;AACF,CAfM,C,CAiBP;;;;;AACO,MAAMC,qBAAqB,GAAIR,KAAD,IAAgC;AACnE,MAAI,EAAEd,mBAAmB,IAAIc,KAAzB,CAAJ,EAAqC;AACnC,WAAO,KAAP;AACD;;AACD,QAAMS,iBAAiB,IAAG,wBAAwBT,KAA3B,CAAvB;AACA,QAAMU,aAAa,GAAGV,KAAK,CAACW,eAAN,IAAyBX,KAAK,CAACW,eAAN,KAA0B,aAAzE;AACA,SAAOF,iBAAiB,IAAIC,aAA5B;AACD,CAPM;;;eASQ;AACb7B,EAAAA,oBADa;AAEbK,EAAAA,mBAFa;AAGbE,EAAAA,eAHa;AAIbG,EAAAA,qBAJa;AAKbQ,EAAAA,gBALa;AAMbN,EAAAA,kBANa;AAObe,EAAAA;AAPa,C","sourcesContent":["import { environment } from '@ali/4ever-cangjie';\nimport React from 'react';\n\nexport const GRADIENT_FLAG = '__';\nexport const GRADIENT_COLOR_STYLE = {\n  // chrome 会自动去掉 webkit 前缀，需在 snapshot 和 全局 手动处理\n  // https://github.com/facebook/react/issues/14200\n  WebkitBackgroundClip: 'text',\n  backgroundClip: 'text',\n  WebkitTextFillColor: 'transparent',\n  backgroundImage: 'linear-gradient(90deg, #404040, #404040)',\n};\nexport const GRADIENT_STYLE_FLAG = 'WebkitBackgroundClip';\nconst CHROME_VERSION_DIVIDE = 72;\n\n\nexport const isGradientColor = (color: string) => {\n  // 判断是否为渐变色，渐变色格式为 ‘#color1__#color2’\n  return color && color.includes(GRADIENT_FLAG);\n};\n\n// 将 #color1_#color2 转换为 [color1, color2]\nexport const transferGradientColor = (color: string) => {\n  if (!isGradientColor(color)) {\n    return [];\n  }\n  return color.split(GRADIENT_FLAG);\n};\n\n// safari 和 低版本(72-) chrome 对 -webkit-text-clip 支持有问题, 导致渐变色换行不显示，需特殊处理\nexport const notSupportClipText = () => {\n  const { getChromeVersion, IS_SAFARI } = environment;\n  const chromeVersion = getChromeVersion();\n  const isOldChrome = chromeVersion !== -1 && chromeVersion < CHROME_VERSION_DIVIDE;\n  return isOldChrome || IS_SAFARI;\n};\n\nexport const setGradientStyle = (color: string, style: React.CSSProperties) => {\n  // 渐变色\n  const [startColor, endColor] = transferGradientColor(color);\n  Object.keys(GRADIENT_COLOR_STYLE).forEach((key) => {\n    style[key] = GRADIENT_COLOR_STYLE[key];\n  });\n\n  style.backgroundImage = `linear-gradient(90deg, ${startColor}, ${endColor})`;\n  // 使用第一个颜色兜底\n  style.color = startColor;\n\n  // safari 和 低版本(72-) chrome 渐变色换行不显示，需添加一个属性\n  if (notSupportClipText()) {\n    style.WebkitBoxDecorationBreak = 'clone';\n  }\n};\n\n// 存在下划线/删除线/非透明背景时，渐变色降级为第一个颜色\nexport const shouldDegradeGradient = (style: React.CSSProperties) => {\n  if (!(GRADIENT_STYLE_FLAG in style)) {\n    return false;\n  }\n  const hasLineDecoration = 'textDecorationLine' in style;\n  const hasBackground = style.backgroundColor && style.backgroundColor !== 'transparent';\n  return hasLineDecoration || hasBackground;\n};\n\nexport default {\n  GRADIENT_COLOR_STYLE,\n  GRADIENT_STYLE_FLAG,\n  isGradientColor,\n  transferGradientColor,\n  setGradientStyle,\n  notSupportClipText,\n  shouldDegradeGradient,\n};\n"],"file":"gradientColor.js"}