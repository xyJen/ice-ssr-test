"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = generateRangesFromTableSelection;

var _everCangjie = require("@ali/4ever-cangjie");

function generateRangesFromTableSelection(controller, tableSelections) {
  const {
    document
  } = controller.value;
  const ranges = [];
  if (!tableSelections) return undefined;
  tableSelections.forEach(tableSelection => {
    if (!tableSelection) {
      return undefined;
    }

    const {
      key,
      startRowIndex,
      startColIndex,
      endRowIndex,
      endColIndex
    } = tableSelection;
    const table = document.getNode(key);

    if (!table) {
      return [];
    }

    for (let rowIndex = startRowIndex; rowIndex <= endRowIndex; rowIndex += 1) {
      const row = table.nodes[rowIndex];

      if (!row) {
        return undefined;
      }

      for (let colIndex = startColIndex; colIndex <= endColIndex; colIndex += 1) {
        const cell = row.nodes[colIndex];

        if (!cell) {
          continue;
        }

        const anchorText = cell.getFirstText();
        const focusText = cell.getLastText();

        if (!anchorText || !focusText) {
          break;
        }

        ranges.push(_everCangjie.Selection.create({
          anchor: _everCangjie.Point.create({
            key: anchorText.key,
            // @ts-ignore
            offset: 0
          }),
          focus: _everCangjie.Point.create({
            key: focusText.key,
            // @ts-ignore
            offset: focusText.text.length
          })
        }));
      }
    }

    return undefined;
  });
  return ranges;
}
//# sourceMappingURL=generateRangesFromTableSelection.js.map