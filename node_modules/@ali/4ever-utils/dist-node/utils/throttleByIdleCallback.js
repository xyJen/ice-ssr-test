"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = throttleByIdleCallback;

/* eslint-disable no-nested-ternary */
const unsupportFunc = () => {
  throw Error('unsupported platform');
};

const nextTick = typeof window !== 'undefined' ? window.requestIdleCallback ? window.requestIdleCallback : window.requestAnimationFrame : unsupportFunc;
const cancelTick = typeof window !== 'undefined' ? nextTick === window.requestIdleCallback ? window.cancelIdleCallback : window.cancelAnimationFrame : unsupportFunc;

function throttleByIdleCallback(fn) {
  let requestId = null;

  const later = args => () => {
    requestId = null;
    fn(...args);
  };

  const throttled = (...args) => {
    if (requestId === null) {
      requestId = nextTick(later(args));
    }
  };

  throttled.cancel = () => cancelTick(requestId);

  return throttled;
}
//# sourceMappingURL=throttleByIdleCallback.js.map