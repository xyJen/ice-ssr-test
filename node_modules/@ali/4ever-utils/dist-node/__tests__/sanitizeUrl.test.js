"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _sanitizeUrl = _interopRequireDefault(require("../sanitizeUrl"));

const whiteList = ['https://docs.dingtalk.com', 'dingtalk://', 'data://', './test/abc', 'blob:', 'alipays://12345'];
describe('Utils.sanitizeUrl', () => {
  whiteList.forEach(p => {
    it(`白名单内正常输出 ${p}'`, () => {
      const result = (0, _sanitizeUrl.default)(p);
      expect(result).toEqual(p);
    });
  });
  it('不在白名单里输出字符', () => {
    const result = (0, _sanitizeUrl.default)('test');
    expect(result).toEqual('test');
  });
  it('安全问题 url 不输出', () => {
    // eslint-disable-next-line no-script-url
    const result = (0, _sanitizeUrl.default)('javascript:alert(cookie)');
    expect(result).toEqual('');
  });
});
//# sourceMappingURL=sanitizeUrl.test.js.map