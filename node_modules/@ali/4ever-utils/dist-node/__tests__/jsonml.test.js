"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var fs = _interopRequireWildcard(require("fs"));

var path = _interopRequireWildcard(require("path"));

var _jsonml = require("../jsonml");

const jsonPath = path.join(__dirname, 'jsonml');
const outputPath1 = path.join(jsonPath, 'image-from-shimo.json');
const outputPath2 = path.join(jsonPath, 'table-from-yuque.json');
const example1 = JSON.parse(fs.readFileSync(outputPath1).toString());
const example2 = JSON.parse(fs.readFileSync(outputPath2).toString());
describe('Utils.jsonml', () => {
  it('getTexts转换文件1', () => {
    const result = (0, _jsonml.getTexts)(example1);
    expect(result).toEqual(['111', '222333444555666', '777']);
  });
  it('getTexts转换文件2，限制段落三段', () => {
    const result = (0, _jsonml.getTexts)((0, _jsonml.getDescription)(example2, {
      maxParagraph: 3
    })); // 第二段因为非文字段落已被去除

    expect(result).toEqual(['aaa', '666']);
  });
  it('getImages转换文件1', () => {
    const result = (0, _jsonml.getImages)(example1);
    expect(result).toEqual(['https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1538923763410&di=6a65e1c2dd84f0077e889eee5b62bf57&imgtype=0&src=http%3A%2F%2Fn1.itc.cn%2Fimg8%2Fwb%2Frecom%2F2016%2F07%2F01%2F146735430694741807.GIF']);
  });
  it('getImages转换文件2', () => {
    const result = (0, _jsonml.getImages)(example2);
    expect(result).toEqual([]);
  });
  it('getTexts转换文件1，限制段落篇幅为2段，排除a', () => {
    const result = (0, _jsonml.getTexts)((0, _jsonml.getDescription)(example1, {
      maxParagraph: 2,
      ignore: ['a']
    }));
    expect(result).toEqual(['111', '222666']);
  });
  it('getDescription转换文件1，排除p与table', () => {
    const result = (0, _jsonml.getDescription)(example1, {
      ignore: ['p', 'table']
    });
    expect(result).toEqual(['root']);
  });
  it('getDescription转换文件2，限制段落篇幅为3段，排除p与table', () => {
    const result = (0, _jsonml.getDescription)(example2, {
      maxParagraph: 3,
      ignore: ['p', 'table']
    });
    expect(result).toEqual(['root', ['h1', ['span', {
      'data-type': 'text'
    }, ['span', {
      'data-type': 'leaf'
    }, 'aaa']]]]);
  });
});
//# sourceMappingURL=jsonml.test.js.map