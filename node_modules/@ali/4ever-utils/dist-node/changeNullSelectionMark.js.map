{"version":3,"sources":["../../src/changeNullSelectionMark.ts"],"names":["changeNullSelectionMark","controller","markType","currentMark","ranges","document","selection","value","documentMarks","getMarksAtRange","filter","mark","type","length","forEach","command","Commands","removeMark","marks","addMark","Mark","create","data","ascii","hAnsi","cs","eastAsia","szUnit"],"mappings":";;;;;;;AAAA;;AAEe,SAASA,uBAAT,CAAiCC,UAAjC,EAAyDC,QAAzD,EAAmEC,WAAnE,EAAgFC,MAAhF,EAAwFC,QAAxF,EAAkG;AAC/G,QAAM;AAAEC,IAAAA;AAAF,MAAgBL,UAAU,CAACM,KAAjC;AACA,QAAMC,aAAa,GAAGH,QAAQ,CAACI,eAAT,CAAyBL,MAAzB,EAAiCM,MAAjC,CAAwCC,IAAI,IAAIA,IAAI,CAACC,IAAL,KAAcV,QAA9D,CAAtB;AAEA;;AACA,MAAIM,aAAa,CAACK,MAAlB,EAA0B;AACxBL,IAAAA,aAAa,CAACM,OAAd,CAAuBH,IAAD,IAAU;AAC9BV,MAAAA,UAAU,CAACc,OAAX,CAAmBC,sBAASC,UAA5B,EAAwCN,IAAxC;AACD,KAFD;AAGD;AACD;;;AACA,MAAIL,SAAS,CAACY,KAAd,EAAqB;AACnB,UAAMA,KAAK,GAAGZ,SAAS,CAACY,KAAxB;AACAA,IAAAA,KAAK,CAACJ,OAAN,CAAeH,IAAD,IAAU;AACtB,UAAIA,IAAI,CAACC,IAAL,KAAcV,QAAlB,EAA4B;AAC1BD,QAAAA,UAAU,CAACc,OAAX,CAAmBC,sBAASC,UAA5B,EAAwCN,IAAxC;AACD;AACF,KAJD;AAKD;;AACD,MAAIT,QAAQ,KAAK,OAAjB,EAA0B;AACxBD,IAAAA,UAAU,CAACc,OAAX,CAAmBC,sBAASG,OAA5B,EAAqCC,kBAAKC,MAAL,CAAY;AAC/CT,MAAAA,IAAI,EAAEV,QADyC;AAE/CoB,MAAAA,IAAI,EAAE;AACJC,QAAAA,KAAK,EAAEpB,WADH;AAEJqB,QAAAA,KAAK,EAAErB,WAFH;AAGJsB,QAAAA,EAAE,EAAEtB,WAHA;AAIJuB,QAAAA,QAAQ,EAAEvB;AAJN;AAFyC,KAAZ,CAArC;AASD,GAVD,MAUO,IAAID,QAAQ,KAAK,IAAjB,EAAuB;AAC5BD,IAAAA,UAAU,CAACc,OAAX,CAAmBC,sBAASG,OAA5B,EAAqCC,kBAAKC,MAAL,CAAY;AAC/CT,MAAAA,IAAI,EAAEV,QADyC;AAE/CoB,MAAAA,IAAI,EAAE;AACJf,QAAAA,KAAK,EAAEJ,WADH;AAEJwB,QAAAA,MAAM,EAAE;AAFJ;AAFyC,KAAZ,CAArC;AAOD,GARM,MAQA,IAAIzB,QAAQ,KAAK,WAAjB,EAA8B;AACnC,QAAIC,WAAW,IAAI,OAAOA,WAAP,KAAuB,QAA1C,EAAoD;AAClDF,MAAAA,UAAU,CAACc,OAAX,CAAmBC,sBAASG,OAA5B,EAAqCC,kBAAKC,MAAL,CAAY;AAC/CT,QAAAA,IAAI,EAAEV,QADyC;AAE/CoB,QAAAA,IAAI,EAAE;AACJf,UAAAA,KAAK,EAAEJ;AADH;AAFyC,OAAZ,CAArC;AAMD;AACF,GATM,MASA;AACLF,IAAAA,UAAU,CAACc,OAAX,CAAmBC,sBAASG,OAA5B,EAAqCC,kBAAKC,MAAL,CAAY;AAC/CT,MAAAA,IAAI,EAAEV,QADyC;AAE/CoB,MAAAA,IAAI,EAAE;AACJf,QAAAA,KAAK,EAAEJ;AADH;AAFyC,KAAZ,CAArC;AAMD;;AAED,SAAOF,UAAP;AACD","sourcesContent":["import { Controller, Commands, Mark } from '@ali/4ever-cangjie';\n\nexport default function changeNullSelectionMark(controller: Controller, markType, currentMark, ranges, document) {\n  const { selection } = controller.value;\n  const documentMarks = document.getMarksAtRange(ranges).filter(mark => mark.type === markType);\n\n  /* 删除document的mark */\n  if (documentMarks.length) {\n    documentMarks.forEach((mark) => {\n      controller.command(Commands.removeMark, mark);\n    });\n  }\n  /* 删除selection的mark */\n  if (selection.marks) {\n    const marks = selection.marks;\n    marks.forEach((mark) => {\n      if (mark.type === markType) {\n        controller.command(Commands.removeMark, mark);\n      }\n    });\n  }\n  if (markType === 'fonts') {\n    controller.command(Commands.addMark, Mark.create({\n      type: markType,\n      data: {\n        ascii: currentMark,\n        hAnsi: currentMark,\n        cs: currentMark,\n        eastAsia: currentMark,\n      },\n    }));\n  } else if (markType === 'sz') {\n    controller.command(Commands.addMark, Mark.create({\n      type: markType,\n      data: {\n        value: currentMark,\n        szUnit: 'pt',\n      },\n    }));\n  } else if (markType === 'highlight') {\n    if (currentMark && typeof currentMark === 'string') {\n      controller.command(Commands.addMark, Mark.create({\n        type: markType,\n        data: {\n          value: currentMark,\n        },\n      }));\n    }\n  } else {\n    controller.command(Commands.addMark, Mark.create({\n      type: markType,\n      data: {\n        value: currentMark,\n      },\n    }));\n  }\n\n  return controller;\n}\n"],"file":"changeNullSelectionMark.js"}