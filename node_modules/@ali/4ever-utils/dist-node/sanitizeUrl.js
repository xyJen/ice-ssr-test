"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = sanitizeUrl;
// 合法协议白名单，只接受业内规范，或阿里系内被广泛接受的协议
const defaultProtocolAllowList = ['http:', 'https:', 'data:', 'dingtalk:', 'ftp:', 'sms:', 'taobao:', 'tel:', 'blob:', 'alipays:', 'iosamap:', 'amapuri:'];

function isURLProtocolValid(url, protocolAllowList) {
  const lowerCaseURL = url.toLowerCase();

  if (protocolAllowList.some(protocol => lowerCaseURL.startsWith(protocol))) {
    return true;
  }

  if (lowerCaseURL.startsWith('./') || lowerCaseURL.startsWith('/')) {
    return true;
  }

  if (lowerCaseURL.indexOf(':') === -1) {
    return true;
  }

  return false;
} // 源自语雀
// 在 Markdown 编辑器里写入 [text]() 后，经过下列步骤，会把 href 解释为 true
// Markdown => HTML => JsonML


function sanitizeUrl(url, protocolAllowList = defaultProtocolAllowList) {
  const protocolList = [...protocolAllowList];

  if (!protocolAllowList.includes('blob:')) {
    protocolList.push('blob:');
  }

  return typeof url === 'string' && isURLProtocolValid(url, protocolList) ? url : '';
}
//# sourceMappingURL=sanitizeUrl.js.map