"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _reactDom = _interopRequireDefault(require("react-dom"));

var _types = require("../types");

var _styled = require("./styled");

var _draggableData = require("../model/draggableData");

var _domUtils = require("../utils/domUtils");

const _createElement = /*#__PURE__*/React.createElement;
const LINE_THICK = 4;
const HORIZ_OFFSET = 20;

const lineStyle = (position, rect) => {
  const style = {};

  if (!rect) {
    return style;
  }

  style.left = rect.left;
  style.top = rect.top;
  const isVertical = position === _types.DROP_POSITION.left || position === _types.DROP_POSITION.right;

  if (isVertical) {
    style.width = LINE_THICK;
    style.height = rect.height;

    if (position === _types.DROP_POSITION.right) {
      style.left = rect.left + (rect.width || 0) + HORIZ_OFFSET;
    } else {
      style.left = rect.left - HORIZ_OFFSET;
    }
  } else {
    style.width = rect.width;
    style.height = LINE_THICK;

    if (position === _types.DROP_POSITION.after) {
      style.top = rect.top + (rect.height || 0);
    }
  }

  return style;
};

const DropHolder = props => {
  const {
    controller,
    dropHolder
  } = props;
  const {
    dragFragment
  } = (0, _draggableData.getDraggableData)(controller) || {};
  const showHolder = dragFragment?.type === _types.DRAG_TYPE.blocks || dragFragment?.fragment?.type === 'image';

  if (!showHolder || !dragFragment || !dropHolder) {
    return null;
  }

  const {
    rect,
    dropPosition,
    pagePosition
  } = dropHolder || {};
  const position = pagePosition !== undefined ? pagePosition : dropPosition;
  const style = lineStyle(position, rect);
  return /*#__PURE__*/_reactDom.default.createPortal( /*#__PURE__*/_createElement(_styled.DropHolderWrapper, {
    className: _domUtils.DRAG_HOLDER_WRAPPER,
    style: { ...style
    }
  }), document.body);
};

var _default = DropHolder;
exports.default = _default;
//# sourceMappingURL=dropHolder.js.map