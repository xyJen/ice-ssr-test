{"version":3,"sources":["../../../../src/bi/components/dropHolder.tsx"],"names":["LINE_THICK","HORIZ_OFFSET","lineStyle","position","rect","style","left","top","isVertical","DROP_POSITION","right","width","height","after","DropHolder","props","controller","dropHolder","dragFragment","showHolder","type","DRAG_TYPE","blocks","fragment","dropPosition","pagePosition","undefined","ReactDOM","createPortal","DRAG_HOLDER_WRAPPER","document","body"],"mappings":";;;;;;;;;;;AAAA;;AAEA;;AACA;;AAOA;;AAGA;;AACA;;uBAb4B,a;AAe5B,MAAMA,UAAU,GAAG,CAAnB;AACA,MAAMC,YAAY,GAAG,EAArB;;AAEA,MAAMC,SAAS,GAAG,CAACC,QAAD,EAA0BC,IAA1B,KAA0C;AAC1D,QAAMC,KAA0B,GAAG,EAAnC;;AACA,MAAI,CAACD,IAAL,EAAW;AACT,WAAOC,KAAP;AACD;;AAEDA,EAAAA,KAAK,CAACC,IAAN,GAAaF,IAAI,CAACE,IAAlB;AACAD,EAAAA,KAAK,CAACE,GAAN,GAAYH,IAAI,CAACG,GAAjB;AACA,QAAMC,UAAU,GAAGL,QAAQ,KAAKM,qBAAcH,IAA3B,IAAmCH,QAAQ,KAAKM,qBAAcC,KAAjF;;AAEA,MAAIF,UAAJ,EAAgB;AACdH,IAAAA,KAAK,CAACM,KAAN,GAAcX,UAAd;AACAK,IAAAA,KAAK,CAACO,MAAN,GAAeR,IAAI,CAACQ,MAApB;;AACA,QAAIT,QAAQ,KAAKM,qBAAcC,KAA/B,EAAsC;AACpCL,MAAAA,KAAK,CAACC,IAAN,GAAaF,IAAI,CAACE,IAAL,IAAaF,IAAI,CAACO,KAAL,IAAc,CAA3B,IAAgCV,YAA7C;AACD,KAFD,MAEO;AACLI,MAAAA,KAAK,CAACC,IAAN,GAAaF,IAAI,CAACE,IAAL,GAAYL,YAAzB;AACD;AACF,GARD,MAQO;AACLI,IAAAA,KAAK,CAACM,KAAN,GAAcP,IAAI,CAACO,KAAnB;AACAN,IAAAA,KAAK,CAACO,MAAN,GAAeZ,UAAf;;AACA,QAAIG,QAAQ,KAAKM,qBAAcI,KAA/B,EAAsC;AACpCR,MAAAA,KAAK,CAACE,GAAN,GAAYH,IAAI,CAACG,GAAL,IAAYH,IAAI,CAACQ,MAAL,IAAe,CAA3B,CAAZ;AACD;AACF;;AAED,SAAOP,KAAP;AACD,CA3BD;;AAiCA,MAAMS,UAA0C,GAAIC,KAAD,IAAW;AAC5D,QAAM;AAAEC,IAAAA,UAAF;AAAcC,IAAAA;AAAd,MAA6BF,KAAnC;AACA,QAAM;AAAEG,IAAAA;AAAF,MAAmB,qCAAiBF,UAAjB,KAAgC,EAAzD;AACA,QAAMG,UAAU,GAAGD,YAAY,EAAEE,IAAd,KAAuBC,iBAAUC,MAAjC,IAA4CJ,YAAY,EAAEK,QAAf,EAA6CH,IAA7C,KAAsD,OAApH;;AAEA,MAAI,CAACD,UAAD,IAAe,CAACD,YAAhB,IAAgC,CAACD,UAArC,EAAiD;AAC/C,WAAO,IAAP;AACD;;AAED,QAAM;AAAEb,IAAAA,IAAF;AAAQoB,IAAAA,YAAR;AAAsBC,IAAAA;AAAtB,MAAuCR,UAAU,IAAI,EAA3D;AACA,QAAMd,QAAQ,GAAGsB,YAAY,KAAKC,SAAjB,GAA6BD,YAA7B,GAA4CD,YAA7D;AAEA,QAAMnB,KAAK,GAAGH,SAAS,CAACC,QAAD,EAAWC,IAAX,CAAvB;AAEA,sBAAOuB,kBAASC,YAAT,eACL,eAAC,yBAAD;AAAmB,IAAA,SAAS,EAAEC,6BAA9B;AAAmD,IAAA,KAAK,EAAE,EAAE,GAAGxB;AAAL;AAA1D,IADK,EAELyB,QAAQ,CAACC,IAFJ,CAAP;AAID,CAlBD;;eAoBejB,U","sourcesContent":["import * as React from 'react';\nimport { Controller } from '@ali/4ever-cangjie';\nimport ReactDOM from 'react-dom';\nimport {\n  DRAG_TYPE,\n  DROP_POSITION,\n  DraggableDataProps,\n  RECT,\n  DragInlineProps,\n} from '../types';\nimport {\n  DropHolderWrapper,\n} from './styled';\nimport { getDraggableData } from '../model/draggableData';\nimport { DRAG_HOLDER_WRAPPER } from '../utils/domUtils';\n\nconst LINE_THICK = 4;\nconst HORIZ_OFFSET = 20;\n\nconst lineStyle = (position: DROP_POSITION, rect?: RECT) => {\n  const style: React.CSSProperties = {};\n  if (!rect) {\n    return style;\n  }\n\n  style.left = rect.left;\n  style.top = rect.top;\n  const isVertical = position === DROP_POSITION.left || position === DROP_POSITION.right;\n\n  if (isVertical) {\n    style.width = LINE_THICK;\n    style.height = rect.height;\n    if (position === DROP_POSITION.right) {\n      style.left = rect.left + (rect.width || 0) + HORIZ_OFFSET;\n    } else {\n      style.left = rect.left - HORIZ_OFFSET;\n    }\n  } else {\n    style.width = rect.width;\n    style.height = LINE_THICK;\n    if (position === DROP_POSITION.after) {\n      style.top = rect.top + (rect.height || 0);\n    }\n  }\n\n  return style;\n};\n\ninterface DropHolderInnerProps extends DraggableDataProps {\n  controller: Controller;\n}\n\nconst DropHolder: React.FC<DropHolderInnerProps> = (props) => {\n  const { controller, dropHolder } = props;\n  const { dragFragment } = getDraggableData(controller) || {};\n  const showHolder = dragFragment?.type === DRAG_TYPE.blocks || (dragFragment?.fragment as DragInlineProps)?.type === 'image';\n\n  if (!showHolder || !dragFragment || !dropHolder) {\n    return null;\n  }\n\n  const { rect, dropPosition, pagePosition } = dropHolder || {};\n  const position = pagePosition !== undefined ? pagePosition : dropPosition;\n\n  const style = lineStyle(position, rect);\n\n  return ReactDOM.createPortal(\n    <DropHolderWrapper className={DRAG_HOLDER_WRAPPER} style={{ ...style }} />,\n    document.body,\n  );\n};\n\nexport default DropHolder;\n"],"file":"dropHolder.js"}