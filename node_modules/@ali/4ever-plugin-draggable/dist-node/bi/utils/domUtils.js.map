{"version":3,"sources":["../../../../src/bi/utils/domUtils.ts"],"names":["DRAG_HIGHLIGHT_CLASSNAME","DISABLE_DRAG_HIGHLIGHT_CLASSNAME","DRAG_THUMBNAIL_ID","DRAG_HIGHLIGHT_SHADOW","DRAG_HOLDER_WRAPPER","DRAG_HIGHLIGHT_TABLE_CLASSNAME","removeDragThumbnail","thumbnail","document","querySelector","body","contains","removeChild","removeDragHolderWrapper","removeDragHightlight","draggingElements","Array","from","querySelectorAll","forEach","ele","classList","remove","addDragHighlight","itemDom","disableHighlight","add","addDragTableHighlight","removeDragTableHightlightSingle","removeDragHightlightSingle","addDargHighlight","blocks","i","length"],"mappings":"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","sourcesContent":["import { findDOMNodeByKey } from '@ali/4ever-utils';\nimport { Block } from '@ali/4ever-cangjie';\nimport getClosestDom from './getClosestDom';\n\nexport const DRAG_HIGHLIGHT_CLASSNAME = 'draggable-highlight';\nexport const DISABLE_DRAG_HIGHLIGHT_CLASSNAME = 'disable-draggable-highlight';\nexport const DRAG_THUMBNAIL_ID = 'drag-custom-thumbnail';\nexport const DRAG_HIGHLIGHT_SHADOW = 'shadow-highlight';\nexport const DRAG_HOLDER_WRAPPER = 'drag-holder-wrapper';\nexport const DRAG_HIGHLIGHT_TABLE_CLASSNAME = 'draggable-highlight-table';\n\nexport function removeDragThumbnail() {\n  const thumbnail = document.querySelector(`#${DRAG_THUMBNAIL_ID}`);\n  if (thumbnail && document.body.contains(thumbnail)) {\n    document.body.removeChild(thumbnail);\n  }\n}\n\nexport function removeDragHolderWrapper() {\n  const thumbnail = document.querySelector(`.${DRAG_HOLDER_WRAPPER}`);\n  if (thumbnail && document.body.contains(thumbnail)) {\n    document.body.removeChild(thumbnail);\n  }\n}\n\n// 移除整个document的所有高亮\n// TODO: 多实例？？\nexport function removeDragHightlight() {\n  const draggingElements = Array.from(document.querySelectorAll(`.${DRAG_HIGHLIGHT_CLASSNAME}`));\n  draggingElements.forEach((ele) => {\n    if (ele.classList?.remove) {\n      ele.classList.remove(DRAG_HIGHLIGHT_CLASSNAME, DRAG_HIGHLIGHT_SHADOW);\n    }\n  });\n}\n\nexport function addDragHighlight(itemDom: Element | null, disableHighlight?: boolean) {\n  if (itemDom?.classList?.add) {\n    itemDom.classList.add(DRAG_HIGHLIGHT_CLASSNAME);\n    disableHighlight && itemDom.classList.add(DISABLE_DRAG_HIGHLIGHT_CLASSNAME);\n    if (itemDom?.querySelector('[data-type=\"card\"]')) {\n      itemDom.classList.add(DRAG_HIGHLIGHT_SHADOW);\n    }\n  }\n}\n\n// 表格需要定制化，不添加背景色\nexport function addDragTableHighlight(itemDom: Element | null) {\n  if (itemDom?.classList?.add) {\n    itemDom.classList.add(DRAG_HIGHLIGHT_TABLE_CLASSNAME);\n    if (itemDom?.querySelector('[data-type=\"card\"]')) {\n      itemDom.classList.add(DRAG_HIGHLIGHT_SHADOW);\n    }\n  }\n}\n\n// 移除表格的高亮\nexport function removeDragTableHightlightSingle(itemDom: Element | null) {\n  if (itemDom?.classList?.remove) {\n    itemDom.classList.remove(DRAG_HIGHLIGHT_TABLE_CLASSNAME, DRAG_HIGHLIGHT_SHADOW);\n  }\n}\n\n// 移除指定节点的高亮\nexport function removeDragHightlightSingle(itemDom: Element | null) {\n  if (itemDom?.classList?.remove) {\n    itemDom.classList.remove(DRAG_HIGHLIGHT_CLASSNAME, DRAG_HIGHLIGHT_SHADOW, DISABLE_DRAG_HIGHLIGHT_CLASSNAME);\n  }\n}\n\n/**\n * @param blocks\n * @deprecated\n */\nexport function addDargHighlight(blocks: Block[], disableHighlight?: boolean) {\n  for (let i = 0; i < blocks.length; i++) {\n    const itemDom = getClosestDom(blocks[i]);\n\n    if (itemDom?.classList?.add) {\n      itemDom.classList.add(DRAG_HIGHLIGHT_CLASSNAME);\n      disableHighlight && itemDom.classList.add(DISABLE_DRAG_HIGHLIGHT_CLASSNAME);\n      if (itemDom?.querySelector('[data-type=\"card\"]')) {\n        itemDom.classList.add(DRAG_HIGHLIGHT_SHADOW);\n      }\n    }\n  }\n}\n\nexport { findDOMNodeByKey }\n"],"file":"domUtils.js"}