"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = dragMenuCutOrCopy;

var _everCangjie = require("@ali/4ever-cangjie");

var _everPluginColorBlocks = require("@ali/4ever-plugin-color-blocks");

var _utils = require("../utils");

function dragMenuCutOrCopy(controller, payload) {
  const {
    node: currentBlock,
    action
  } = payload;
  const blocks = (0, _utils.getSiblingDraggableBlocks)(controller, currentBlock);

  if (!blocks || blocks?.length === 0) {
    return controller;
  }

  let anchor;
  let focus;

  if (_everPluginColorBlocks.ColorBlocks.isColorBlocks(currentBlock)) {
    anchor = _everCangjie.Point.createFromParams(currentBlock.key, 'before');
    focus = _everCangjie.Point.createFromParams(currentBlock.key, 'after');
  } else {
    anchor = _everCangjie.Point.createFromParams(blocks[0].key, 'before');
    focus = _everCangjie.Point.createFromParams(blocks[blocks.length - 1].key, 'after');
  }

  const newSelection = _everCangjie.Selection.create({
    anchor,
    focus
  });

  controller.command(_everCangjie.Commands.select, newSelection);
  controller.run('onAction', {
    type: action
  });
  controller.command(_everCangjie.Commands.blur);
  return controller;
}
//# sourceMappingURL=dragMenuCutOrCopy.js.map