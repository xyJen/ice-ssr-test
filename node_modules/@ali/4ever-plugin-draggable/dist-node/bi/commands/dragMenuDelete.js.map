{"version":3,"sources":["../../../../src/bi/commands/dragMenuDelete.ts"],"names":["dragMenuDelete","controller","payload","node","currentBlock","document","value","blocks","text","Text","create","paragraph","Paragraph","nodes","parent","getParent","key","index","anchor","TextPoint","offset","command","Commands","insertNodeByKey","select","Selection","focus","forEach","block","removeNodeByKey"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AAEA;;AAEe,SAASA,cAAT,CAAwBC,UAAxB,EAAgDC,OAAhD,EAAyE;AACtF,QAAM;AAAEC,IAAAA,IAAI,EAAEC;AAAR,MAAyBF,OAA/B;AACA,QAAM;AAAEG,IAAAA;AAAF,MAAeJ,UAAU,CAACK,KAAhC;AACA,QAAMC,MAAM,GAAG,sCAA0BN,UAA1B,EAAsCG,YAAtC,CAAf,CAHsF,CAItF;;AAEA,QAAMI,IAAI,GAAGC,kBAAKC,MAAL,CAAY,EAAZ,CAAb;;AAEA,QAAMC,SAAS,GAAGC,+BAAUF,MAAV,CAAiB;AACjCG,IAAAA,KAAK,EAAE,CAACL,IAAD;AAD0B,GAAjB,CAAlB;;AAIA,QAAMM,MAAM,GAAGT,QAAQ,CAACU,SAAT,CAAmBX,YAAY,CAACY,GAAhC,CAAf;AACA,MAAI,CAACF,MAAL,EAAa,OAAOb,UAAP;AACb,QAAMgB,KAAK,GAAG,6BAAeb,YAAf,EAA6BU,MAAM,CAACD,KAApC,CAAd;;AACA,QAAMK,MAAM,GAAGC,uBAAUT,MAAV,CAAiB;AAAEM,IAAAA,GAAG,EAAER,IAAI,CAACQ,GAAZ;AAAiBI,IAAAA,MAAM,EAAE;AAAzB,GAAjB,CAAf;;AACAnB,EAAAA,UAAU,CACPoB,OADH,CACWC,sBAASC,eADpB,EACqCT,MAAM,CAACE,GAD5C,EACiDC,KADjD,EACwDN,SADxD,EAEGU,OAFH,CAEWC,sBAASE,MAFpB,EAE4BC,uBAAUf,MAAV,CAAiB;AAAEQ,IAAAA,MAAF;AAAUQ,IAAAA,KAAK,EAAER;AAAjB,GAAjB,CAF5B,EAhBsF,CAoBtF;;AACAX,EAAAA,MAAM,EAAEoB,OAAR,CAAiBC,KAAD,IAAW3B,UAAU,CAACoB,OAAX,CAAmBC,sBAASO,eAA5B,EAA6CD,KAAK,CAACZ,GAAnD,CAA3B;AACA,SAAOf,UAAP;AACD","sourcesContent":["import { Controller, Commands, Text, TextPoint, Selection } from '@ali/4ever-cangjie';\nimport { Paragraph } from '@ali/4ever-plugin-paragraph';\nimport { getSiblingDraggableBlocks } from '../utils';\nimport { DragMenuAction } from '../types';\nimport getIndexOfNode from '../utils/getIndexOfNode';\n\nexport default function dragMenuDelete(controller: Controller, payload: DragMenuAction) {\n  const { node: currentBlock } = payload;\n  const { document } = controller.value;\n  const blocks = getSiblingDraggableBlocks(controller, currentBlock);\n  // 创建空段落聚焦\n\n  const text = Text.create('');\n\n  const paragraph = Paragraph.create({\n    nodes: [text],\n  });\n\n  const parent = document.getParent(currentBlock.key);\n  if (!parent) return controller;\n  const index = getIndexOfNode(currentBlock, parent.nodes);\n  const anchor = TextPoint.create({ key: text.key, offset: 0 });\n  controller\n    .command(Commands.insertNodeByKey, parent.key, index, paragraph)\n    .command(Commands.select, Selection.create({ anchor, focus: anchor }));\n\n  // 删除选中节点\n  blocks?.forEach((block) => controller.command(Commands.removeNodeByKey, block.key));\n  return controller;\n}\n"],"file":"dragMenuDelete.js"}