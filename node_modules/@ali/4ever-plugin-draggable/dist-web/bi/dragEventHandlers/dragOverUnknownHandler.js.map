{"version":3,"sources":["../../../../src/bi/dragEventHandlers/dragOverUnknownHandler.ts"],"names":["CangjieSelectEvent","getRangeFromDragEvent","dragOverUnknownHandler","event","controller","range","value","document","selection","preFocus","convertToTextPoints","focus","nextFocus","key","offset","run"],"mappings":"AAAA,SAAqBA,kBAArB,QAA+C,oBAA/C;AACA,OAAOC,qBAAP;AAGA,eAAe,SAASC,sBAAT,CACbC,KADa,EAEbC,UAFa,EAGb;AACA,MAAMC,KAAK,GAAGJ,qBAAqB,CAACG,UAAD,EAAaD,KAAb,CAAnC;AACA,MAAI,CAACE,KAAL,EAAY;AAFZ,0BAIgCD,UAAU,CAACE,KAJ3C;AAAA,MAIQC,QAJR,qBAIQA,QAJR;AAAA,MAIkBC,SAJlB,qBAIkBA,SAJlB;AAKA,MAAMC,QAAQ,GAAGD,SAAS,CAACE,mBAAV,CAA8BH,QAA9B,EAAwCI,KAAzD;AACA,MAAMC,SAAS,GAAGP,KAAK,CAACK,mBAAN,CAA0BH,QAA1B,EAAoCI,KAAtD;;AACA,MACEF,QAAQ,CAACI,GAAT,KAAiBD,SAAS,CAACC,GAA3B,IACAJ,QAAQ,CAACK,MAAT,KAAoBF,SAAS,CAACE,MAFhC,EAGE;AACA;AACD,GAZD,CAcA;;;AACAV,EAAAA,UAAU,CAACW,GAAX,CAAe,iBAAf,EAAkCf,kBAAkB,CAAC;AACnDQ,IAAAA,SAAS,EAAEH;AADwC,GAAD,CAApD;AAGAD,EAAAA,UAAU,CAACW,GAAX,CAAe,gBAAf;AACD","sourcesContent":["import { Controller, CangjieSelectEvent } from '@ali/4ever-cangjie';\nimport getRangeFromDragEvent from '../utils/getRangeFromDragEvent';\n\n\nexport default function dragOverUnknownHandler(\n  event: DragEvent,\n  controller: Controller,\n) {\n  const range = getRangeFromDragEvent(controller, event);\n  if (!range) return;\n\n  const { document, selection } = controller.value;\n  const preFocus = selection.convertToTextPoints(document).focus;\n  const nextFocus = range.convertToTextPoints(document).focus;\n  if (\n    preFocus.key === nextFocus.key &&\n    preFocus.offset === nextFocus.offset\n  ) {\n    return;\n  }\n\n  // UI 层拿到不到数据层 controller，使用 action 在排版模式下同步更新选区\n  controller.run('onCangjieSelect', CangjieSelectEvent({\n    selection: range,\n  }));\n  controller.run('onCangjieFocus');\n}\n"],"file":"dragOverUnknownHandler.js"}