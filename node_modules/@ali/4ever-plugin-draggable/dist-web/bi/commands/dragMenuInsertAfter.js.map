{"version":3,"sources":["../../../../src/bi/commands/dragMenuInsertAfter.ts"],"names":["Commands","Text","TextPoint","Selection","Paragraph","setNewlineData","getIndexOfNode","dragMenuInsertAfter","controller","payload","currentBlock","node","document","value","text","create","paragraph","nodes","parent","getParent","key","index","anchor","offset","command","insertNodeByKey","select","focus","run","triggered","point"],"mappings":"AAAA,SAAqBA,QAArB,EAA+BC,IAA/B,EAAqCC,SAArC,EAAgDC,SAAhD,QAAiE,oBAAjE;AACA,SAASC,SAAT,QAA0B,6BAA1B;AACA,SAASC,cAAT,QAA+B,kBAA/B;AAEA,OAAOC,cAAP;AAEA,eAAe,SAASC,mBAAT,CAA6BC,UAA7B,EAAqDC,OAArD,EAA8E;AAAA,MAC7EC,YAD6E,GAC5DD,OAD4D,CACnFE,IADmF;AAAA,MAEnFC,QAFmF,GAEtEJ,UAAU,CAACK,KAF2D,CAEnFD,QAFmF;AAI3F,MAAME,IAAI,GAAGb,IAAI,CAACc,MAAL,CAAY,EAAZ,CAAb;AAEA,MAAMC,SAAS,GAAGZ,SAAS,CAACW,MAAV,CAAiB;AACjCE,IAAAA,KAAK,EAAE,CAACH,IAAD;AAD0B,GAAjB,CAAlB;AAIA,MAAMI,MAAM,GAAGN,QAAQ,CAACO,SAAT,CAAmBT,YAAY,CAACU,GAAhC,CAAf;AACA,MAAI,CAACF,MAAL,EAAa,OAAOV,UAAP;AACb,MAAMa,KAAK,GAAGf,cAAc,CAACI,YAAD,EAAeQ,MAAM,CAACD,KAAtB,CAA5B;AACA,MAAMK,MAAM,GAAGpB,SAAS,CAACa,MAAV,CAAiB;AAAEK,IAAAA,GAAG,EAAEN,IAAI,CAACM,GAAZ;AAAiBG,IAAAA,MAAM,EAAE;AAAzB,GAAjB,CAAf;AACAf,EAAAA,UAAU,CACPgB,OADH,CACWxB,QAAQ,CAACyB,eADpB,EACqCP,MAAM,CAACE,GAD5C,EACiDC,KAAK,GAAG,CADzD,EAC4DL,SAD5D,EAEGQ,OAFH,CAEWxB,QAAQ,CAAC0B,MAFpB,EAE4BvB,SAAS,CAACY,MAAV,CAAiB;AAAEO,IAAAA,MAAM,EAANA,MAAF;AAAUK,IAAAA,KAAK,EAAEL;AAAjB,GAAjB,CAF5B,EAGGM,GAHH,CAGO,UAHP,EAGmBvB,cAAc,CAAC;AAC9Be,IAAAA,GAAG,EAAEJ,SAAS,CAACI,GADe;AAE9BS,IAAAA,SAAS,EAAE,IAFmB;AAG9BC,IAAAA,KAAK,EAAER;AAHuB,GAAD,CAHjC;AASA,SAAOd,UAAP;AACD","sourcesContent":["import { Controller, Commands, Text, TextPoint, Selection } from '@ali/4ever-cangjie';\nimport { Paragraph } from '@ali/4ever-plugin-paragraph';\nimport { setNewlineData } from '@ali/4ever-utils';\nimport { DragMenuAction } from '../types';\nimport getIndexOfNode from '../utils/getIndexOfNode';\n\nexport default function dragMenuInsertAfter(controller: Controller, payload: DragMenuAction) {\n  const { node: currentBlock } = payload;\n  const { document } = controller.value;\n\n  const text = Text.create('');\n\n  const paragraph = Paragraph.create({\n    nodes: [text],\n  });\n\n  const parent = document.getParent(currentBlock.key);\n  if (!parent) return controller;\n  const index = getIndexOfNode(currentBlock, parent.nodes);\n  const anchor = TextPoint.create({ key: text.key, offset: 0 });\n  controller\n    .command(Commands.insertNodeByKey, parent.key, index + 1, paragraph)\n    .command(Commands.select, Selection.create({ anchor, focus: anchor }))\n    .run('onAction', setNewlineData({\n      key: paragraph.key,\n      triggered: true,\n      point: anchor,\n    }));\n\n  return controller;\n}\n"],"file":"dragMenuInsertAfter.js"}