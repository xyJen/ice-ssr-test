import { Commands, Text, TextPoint, Selection } from '@ali/4ever-cangjie';
import { Paragraph } from '@ali/4ever-plugin-paragraph';
import { setNewlineData } from '@ali/4ever-utils';
import getIndexOfNode from "../utils/getIndexOfNode";
export default function dragMenuInsertAfter(controller, payload) {
  var currentBlock = payload.node;
  var document = controller.value.document;
  var text = Text.create('');
  var paragraph = Paragraph.create({
    nodes: [text]
  });
  var parent = document.getParent(currentBlock.key);
  if (!parent) return controller;
  var index = getIndexOfNode(currentBlock, parent.nodes);
  var anchor = TextPoint.create({
    key: text.key,
    offset: 0
  });
  controller.command(Commands.insertNodeByKey, parent.key, index + 1, paragraph).command(Commands.select, Selection.create({
    anchor: anchor,
    focus: anchor
  })).run('onAction', setNewlineData({
    key: paragraph.key,
    triggered: true,
    point: anchor
  }));
  return controller;
}
//# sourceMappingURL=dragMenuInsertAfter.js.map