import { Commands, Text, TextPoint, Selection } from '@ali/4ever-cangjie';
import { Paragraph } from '@ali/4ever-plugin-paragraph';
import { getSiblingDraggableBlocks } from "../utils";
import getIndexOfNode from "../utils/getIndexOfNode";
export default function dragMenuDelete(controller, payload) {
  var currentBlock = payload.node;
  var document = controller.value.document;
  var blocks = getSiblingDraggableBlocks(controller, currentBlock); // 创建空段落聚焦

  var text = Text.create('');
  var paragraph = Paragraph.create({
    nodes: [text]
  });
  var parent = document.getParent(currentBlock.key);
  if (!parent) return controller;
  var index = getIndexOfNode(currentBlock, parent.nodes);
  var anchor = TextPoint.create({
    key: text.key,
    offset: 0
  });
  controller.command(Commands.insertNodeByKey, parent.key, index, paragraph).command(Commands.select, Selection.create({
    anchor: anchor,
    focus: anchor
  })); // 删除选中节点

  blocks == null ? void 0 : blocks.forEach(function (block) {
    return controller.command(Commands.removeNodeByKey, block.key);
  });
  return controller;
}
//# sourceMappingURL=dragMenuDelete.js.map