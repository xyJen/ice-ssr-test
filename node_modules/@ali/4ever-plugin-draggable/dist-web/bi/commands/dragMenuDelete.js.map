{"version":3,"sources":["../../../../src/bi/commands/dragMenuDelete.ts"],"names":["Commands","Text","TextPoint","Selection","Paragraph","getSiblingDraggableBlocks","getIndexOfNode","dragMenuDelete","controller","payload","currentBlock","node","document","value","blocks","text","create","paragraph","nodes","parent","getParent","key","index","anchor","offset","command","insertNodeByKey","select","focus","forEach","block","removeNodeByKey"],"mappings":"AAAA,SAAqBA,QAArB,EAA+BC,IAA/B,EAAqCC,SAArC,EAAgDC,SAAhD,QAAiE,oBAAjE;AACA,SAASC,SAAT,QAA0B,6BAA1B;AACA,SAASC,yBAAT;AAEA,OAAOC,cAAP;AAEA,eAAe,SAASC,cAAT,CAAwBC,UAAxB,EAAgDC,OAAhD,EAAyE;AAAA,MACxEC,YADwE,GACvDD,OADuD,CAC9EE,IAD8E;AAAA,MAE9EC,QAF8E,GAEjEJ,UAAU,CAACK,KAFsD,CAE9ED,QAF8E;AAGtF,MAAME,MAAM,GAAGT,yBAAyB,CAACG,UAAD,EAAaE,YAAb,CAAxC,CAHsF,CAItF;;AAEA,MAAMK,IAAI,GAAGd,IAAI,CAACe,MAAL,CAAY,EAAZ,CAAb;AAEA,MAAMC,SAAS,GAAGb,SAAS,CAACY,MAAV,CAAiB;AACjCE,IAAAA,KAAK,EAAE,CAACH,IAAD;AAD0B,GAAjB,CAAlB;AAIA,MAAMI,MAAM,GAAGP,QAAQ,CAACQ,SAAT,CAAmBV,YAAY,CAACW,GAAhC,CAAf;AACA,MAAI,CAACF,MAAL,EAAa,OAAOX,UAAP;AACb,MAAMc,KAAK,GAAGhB,cAAc,CAACI,YAAD,EAAeS,MAAM,CAACD,KAAtB,CAA5B;AACA,MAAMK,MAAM,GAAGrB,SAAS,CAACc,MAAV,CAAiB;AAAEK,IAAAA,GAAG,EAAEN,IAAI,CAACM,GAAZ;AAAiBG,IAAAA,MAAM,EAAE;AAAzB,GAAjB,CAAf;AACAhB,EAAAA,UAAU,CACPiB,OADH,CACWzB,QAAQ,CAAC0B,eADpB,EACqCP,MAAM,CAACE,GAD5C,EACiDC,KADjD,EACwDL,SADxD,EAEGQ,OAFH,CAEWzB,QAAQ,CAAC2B,MAFpB,EAE4BxB,SAAS,CAACa,MAAV,CAAiB;AAAEO,IAAAA,MAAM,EAANA,MAAF;AAAUK,IAAAA,KAAK,EAAEL;AAAjB,GAAjB,CAF5B,EAhBsF,CAoBtF;;AACAT,EAAAA,MAAM,QAAN,YAAAA,MAAM,CAAEe,OAAR,CAAgB,UAACC,KAAD;AAAA,WAAWtB,UAAU,CAACiB,OAAX,CAAmBzB,QAAQ,CAAC+B,eAA5B,EAA6CD,KAAK,CAACT,GAAnD,CAAX;AAAA,GAAhB;AACA,SAAOb,UAAP;AACD","sourcesContent":["import { Controller, Commands, Text, TextPoint, Selection } from '@ali/4ever-cangjie';\nimport { Paragraph } from '@ali/4ever-plugin-paragraph';\nimport { getSiblingDraggableBlocks } from '../utils';\nimport { DragMenuAction } from '../types';\nimport getIndexOfNode from '../utils/getIndexOfNode';\n\nexport default function dragMenuDelete(controller: Controller, payload: DragMenuAction) {\n  const { node: currentBlock } = payload;\n  const { document } = controller.value;\n  const blocks = getSiblingDraggableBlocks(controller, currentBlock);\n  // 创建空段落聚焦\n\n  const text = Text.create('');\n\n  const paragraph = Paragraph.create({\n    nodes: [text],\n  });\n\n  const parent = document.getParent(currentBlock.key);\n  if (!parent) return controller;\n  const index = getIndexOfNode(currentBlock, parent.nodes);\n  const anchor = TextPoint.create({ key: text.key, offset: 0 });\n  controller\n    .command(Commands.insertNodeByKey, parent.key, index, paragraph)\n    .command(Commands.select, Selection.create({ anchor, focus: anchor }));\n\n  // 删除选中节点\n  blocks?.forEach((block) => controller.command(Commands.removeNodeByKey, block.key));\n  return controller;\n}\n"],"file":"dragMenuDelete.js"}