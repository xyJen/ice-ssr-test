{"version":3,"sources":["../../../../src/bi/components/dropHolder.tsx"],"names":["React","ReactDOM","DRAG_TYPE","DROP_POSITION","DropHolderWrapper","getDraggableData","DRAG_HOLDER_WRAPPER","LINE_THICK","HORIZ_OFFSET","lineStyle","position","rect","style","left","top","isVertical","right","width","height","after","DropHolder","props","controller","dropHolder","dragFragment","showHolder","type","blocks","fragment","dropPosition","pagePosition","undefined","createPortal","document","body"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Controller } from '@ali/4ever-cangjie';\nimport ReactDOM from 'react-dom';\nimport {\n  DRAG_TYPE,\n  DROP_POSITION,\n  DraggableDataProps,\n  RECT,\n  DragInlineProps,\n} from '../types';\nimport {\n  DropHolderWrapper,\n} from './styled';\nimport { getDraggableData } from '../model/draggableData';\nimport { DRAG_HOLDER_WRAPPER } from '../utils/domUtils';\n\nconst LINE_THICK = 4;\nconst HORIZ_OFFSET = 20;\n\nconst lineStyle = (position: DROP_POSITION, rect?: RECT) => {\n  const style: React.CSSProperties = {};\n  if (!rect) {\n    return style;\n  }\n\n  style.left = rect.left;\n  style.top = rect.top;\n  const isVertical = position === DROP_POSITION.left || position === DROP_POSITION.right;\n\n  if (isVertical) {\n    style.width = LINE_THICK;\n    style.height = rect.height;\n    if (position === DROP_POSITION.right) {\n      style.left = rect.left + (rect.width || 0) + HORIZ_OFFSET;\n    } else {\n      style.left = rect.left - HORIZ_OFFSET;\n    }\n  } else {\n    style.width = rect.width;\n    style.height = LINE_THICK;\n    if (position === DROP_POSITION.after) {\n      style.top = rect.top + (rect.height || 0);\n    }\n  }\n\n  return style;\n};\n\ninterface DropHolderInnerProps extends DraggableDataProps {\n  controller: Controller;\n}\n\nconst DropHolder: React.FC<DropHolderInnerProps> = (props) => {\n  const { controller, dropHolder } = props;\n  const { dragFragment } = getDraggableData(controller) || {};\n  const showHolder = dragFragment?.type === DRAG_TYPE.blocks || (dragFragment?.fragment as DragInlineProps)?.type === 'image';\n\n  if (!showHolder || !dragFragment || !dropHolder) {\n    return null;\n  }\n\n  const { rect, dropPosition, pagePosition } = dropHolder || {};\n  const position = pagePosition !== undefined ? pagePosition : dropPosition;\n\n  const style = lineStyle(position, rect);\n\n  return ReactDOM.createPortal(\n    <DropHolderWrapper className={DRAG_HOLDER_WRAPPER} style={{ ...style }} />,\n    document.body,\n  );\n};\n\nexport default DropHolder;\n"],"file":"dropHolder.js"}