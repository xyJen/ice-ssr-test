{"version":3,"sources":["../../../../src/bi/utils/autoScroll.ts"],"names":["AUTO_SCROLL_THRESHOLD_TOP","AUTO_SCROLL_THRESHOLD_BOTTOM","AUTO_SCROLL_HEIGHT","scrollableContainer","getScrollParent","element","style","window","getComputedStyle","excludeStaticParent","position","overflowRegex","scrollRoot","document","documentElement","body","parent","test","overflow","overflowY","overflowX","parentElement","autoScroll","event","threshold","clientY","topThreshold","top","undefined","bottomThreshold","bottom","scrollTop","innerHeight","target"],"mappings":"AAAA,IAAMA,yBAAyB,GAAG,GAAlC;AACA,IAAMC,4BAA4B,GAAG,EAArC;AACA,IAAMC,kBAAkB,GAAG,EAA3B;AAEA,IAAIC,mBAAmC,GAAG,IAA1C;AAEA;AACA;AACA;AACA;;AACA,SAASC,eAAT,CAAyBC,OAAzB,EAA2C;AACzC,MAAIC,KAAK,GAAGC,MAAM,CAACC,gBAAP,CAAwBH,OAAxB,CAAZ;AACA,MAAMI,mBAAmB,GAAGH,KAAK,CAACI,QAAN,KAAmB,UAA/C;AACA,MAAMC,aAAa,GAAG,eAAtB;AACA,MAAMC,UAAU,GAAGC,QAAQ,CAACC,eAAT,IAA4BD,QAAQ,CAACE,IAAxD;AAEA,MAAIT,KAAK,CAACI,QAAN,KAAmB,OAAvB,EAAgC,OAAOE,UAAP;AAChC,MAAII,MAAM,GAAGX,OAAb;;AACA,SAAOW,MAAP,EAAe;AACbV,IAAAA,KAAK,GAAGE,gBAAgB,CAACQ,MAAD,CAAxB;;AACA,QACE,EAAEP,mBAAmB,IAAIH,KAAK,CAACI,QAAN,KAAmB,QAA5C,KACAC,aAAa,CAACM,IAAd,CAAmBX,KAAK,CAACY,QAAN,GAAiBZ,KAAK,CAACa,SAAvB,GAAmCb,KAAK,CAACc,SAA5D,CAFF,EAGE;AACA,aAAOJ,MAAP;AACD;;AACDA,IAAAA,MAAM,GAAGA,MAAM,CAACK,aAAhB;AACD;;AAED,SAAOT,UAAP;AACD;;AAED,SAASU,UAAT,CAAoBC,KAApB,EAAsCC,SAAtC,EAGG;AACD,MAAIrB,mBAAJ,EAAyB;AAAA,QACfsB,OADe,GACHF,KADG,CACfE,OADe;AAEvB,QAAMC,YAAY,GAAG,CAAAF,SAAS,QAAT,YAAAA,SAAS,CAAEG,GAAX,MAAmBC,SAAnB,GAA+BJ,SAAS,CAACG,GAAzC,GAA+C3B,yBAApE;AACA,QAAM6B,eAAe,GAAG,CAAAL,SAAS,QAAT,YAAAA,SAAS,CAAEM,MAAX,MAAsBF,SAAtB,GAAkCJ,SAAS,CAACM,MAA5C,GAAqD7B,4BAA7E;;AACA,QAAIE,mBAAmB,CAAC4B,SAApB,IAAiCN,OAAO,GAAGC,YAA/C,EAA6D;AAC3DvB,MAAAA,mBAAmB,CAAC4B,SAApB,IAAiC7B,kBAAjC;AACD,KAFD,MAEO,IAAIuB,OAAO,GAAGlB,MAAM,CAACyB,WAAP,GAAqBH,eAAnC,EAAoD;AACzD1B,MAAAA,mBAAmB,CAAC4B,SAApB,IAAiC7B,kBAAjC;AACD;AACF,GATD,MASO;AACLC,IAAAA,mBAAmB,GAAGC,eAAe,CAACmB,KAAK,CAACU,MAAP,CAArC;AACD;AACF;;AAED,eAAeX,UAAf","sourcesContent":["const AUTO_SCROLL_THRESHOLD_TOP = 100;\nconst AUTO_SCROLL_THRESHOLD_BOTTOM = 50;\nconst AUTO_SCROLL_HEIGHT = 20;\n\nlet scrollableContainer: Element | null = null;\n\n/**\n * 查找第一个滚动容器\n * https://github.com/jquery/jquery-ui/blob/main/ui/scroll-parent.js\n */\nfunction getScrollParent(element): Element {\n  let style = window.getComputedStyle(element);\n  const excludeStaticParent = style.position === 'absolute';\n  const overflowRegex = /(auto|scroll)/;\n  const scrollRoot = document.documentElement || document.body;\n\n  if (style.position === 'fixed') return scrollRoot;\n  let parent = element;\n  while (parent) {\n    style = getComputedStyle(parent);\n    if (\n      !(excludeStaticParent && style.position === 'static') &&\n      overflowRegex.test(style.overflow + style.overflowY + style.overflowX)\n    ) {\n      return parent;\n    }\n    parent = parent.parentElement;\n  }\n\n  return scrollRoot;\n}\n\nfunction autoScroll(event: DragEvent, threshold?: {\n  top?: number;\n  bottom?: number;\n}) {\n  if (scrollableContainer) {\n    const { clientY } = event;\n    const topThreshold = threshold?.top !== undefined ? threshold.top : AUTO_SCROLL_THRESHOLD_TOP;\n    const bottomThreshold = threshold?.bottom !== undefined ? threshold.bottom : AUTO_SCROLL_THRESHOLD_BOTTOM;\n    if (scrollableContainer.scrollTop && clientY < topThreshold) {\n      scrollableContainer.scrollTop -= AUTO_SCROLL_HEIGHT;\n    } else if (clientY > window.innerHeight - bottomThreshold) {\n      scrollableContainer.scrollTop += AUTO_SCROLL_HEIGHT;\n    }\n  } else {\n    scrollableContainer = getScrollParent(event.target);\n  }\n}\n\nexport default autoScroll;\n"],"file":"autoScroll.js"}