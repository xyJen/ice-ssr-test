{"version":3,"sources":["../../../../src/bi/utils/domUtils.ts"],"names":["findDOMNodeByKey","getClosestDom","DRAG_HIGHLIGHT_CLASSNAME","DISABLE_DRAG_HIGHLIGHT_CLASSNAME","DRAG_THUMBNAIL_ID","DRAG_HIGHLIGHT_SHADOW","DRAG_HOLDER_WRAPPER","DRAG_HIGHLIGHT_TABLE_CLASSNAME","removeDragThumbnail","thumbnail","document","querySelector","body","contains","removeChild","removeDragHolderWrapper","removeDragHightlight","draggingElements","Array","from","querySelectorAll","forEach","ele","classList","remove","addDragHighlight","itemDom","disableHighlight","add","addDragTableHighlight","removeDragTableHightlightSingle","removeDragHightlightSingle","addDargHighlight","blocks","i","length"],"mappings":"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","sourcesContent":["import { findDOMNodeByKey } from '@ali/4ever-utils';\nimport { Block } from '@ali/4ever-cangjie';\nimport getClosestDom from './getClosestDom';\n\nexport const DRAG_HIGHLIGHT_CLASSNAME = 'draggable-highlight';\nexport const DISABLE_DRAG_HIGHLIGHT_CLASSNAME = 'disable-draggable-highlight';\nexport const DRAG_THUMBNAIL_ID = 'drag-custom-thumbnail';\nexport const DRAG_HIGHLIGHT_SHADOW = 'shadow-highlight';\nexport const DRAG_HOLDER_WRAPPER = 'drag-holder-wrapper';\nexport const DRAG_HIGHLIGHT_TABLE_CLASSNAME = 'draggable-highlight-table';\n\nexport function removeDragThumbnail() {\n  const thumbnail = document.querySelector(`#${DRAG_THUMBNAIL_ID}`);\n  if (thumbnail && document.body.contains(thumbnail)) {\n    document.body.removeChild(thumbnail);\n  }\n}\n\nexport function removeDragHolderWrapper() {\n  const thumbnail = document.querySelector(`.${DRAG_HOLDER_WRAPPER}`);\n  if (thumbnail && document.body.contains(thumbnail)) {\n    document.body.removeChild(thumbnail);\n  }\n}\n\n// 移除整个document的所有高亮\n// TODO: 多实例？？\nexport function removeDragHightlight() {\n  const draggingElements = Array.from(document.querySelectorAll(`.${DRAG_HIGHLIGHT_CLASSNAME}`));\n  draggingElements.forEach((ele) => {\n    if (ele.classList?.remove) {\n      ele.classList.remove(DRAG_HIGHLIGHT_CLASSNAME, DRAG_HIGHLIGHT_SHADOW);\n    }\n  });\n}\n\nexport function addDragHighlight(itemDom: Element | null, disableHighlight?: boolean) {\n  if (itemDom?.classList?.add) {\n    itemDom.classList.add(DRAG_HIGHLIGHT_CLASSNAME);\n    disableHighlight && itemDom.classList.add(DISABLE_DRAG_HIGHLIGHT_CLASSNAME);\n    if (itemDom?.querySelector('[data-type=\"card\"]')) {\n      itemDom.classList.add(DRAG_HIGHLIGHT_SHADOW);\n    }\n  }\n}\n\n// 表格需要定制化，不添加背景色\nexport function addDragTableHighlight(itemDom: Element | null) {\n  if (itemDom?.classList?.add) {\n    itemDom.classList.add(DRAG_HIGHLIGHT_TABLE_CLASSNAME);\n    if (itemDom?.querySelector('[data-type=\"card\"]')) {\n      itemDom.classList.add(DRAG_HIGHLIGHT_SHADOW);\n    }\n  }\n}\n\n// 移除表格的高亮\nexport function removeDragTableHightlightSingle(itemDom: Element | null) {\n  if (itemDom?.classList?.remove) {\n    itemDom.classList.remove(DRAG_HIGHLIGHT_TABLE_CLASSNAME, DRAG_HIGHLIGHT_SHADOW);\n  }\n}\n\n// 移除指定节点的高亮\nexport function removeDragHightlightSingle(itemDom: Element | null) {\n  if (itemDom?.classList?.remove) {\n    itemDom.classList.remove(DRAG_HIGHLIGHT_CLASSNAME, DRAG_HIGHLIGHT_SHADOW, DISABLE_DRAG_HIGHLIGHT_CLASSNAME);\n  }\n}\n\n/**\n * @param blocks\n * @deprecated\n */\nexport function addDargHighlight(blocks: Block[], disableHighlight?: boolean) {\n  for (let i = 0; i < blocks.length; i++) {\n    const itemDom = getClosestDom(blocks[i]);\n\n    if (itemDom?.classList?.add) {\n      itemDom.classList.add(DRAG_HIGHLIGHT_CLASSNAME);\n      disableHighlight && itemDom.classList.add(DISABLE_DRAG_HIGHLIGHT_CLASSNAME);\n      if (itemDom?.querySelector('[data-type=\"card\"]')) {\n        itemDom.classList.add(DRAG_HIGHLIGHT_SHADOW);\n      }\n    }\n  }\n}\n\nexport { findDOMNodeByKey }\n"],"file":"domUtils.js"}