!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self)["@ali/we-logger-appender-arms"]={})}(this,(function(e){"use strict";function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e,t){return e(t={exports:{}},t.exports),t.exports}var r=t(n((function(e){function t(){return e.exports=t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.default=e.exports,e.exports.__esModule=!0,t.apply(this,arguments)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}))),o=n((function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,t(n,r)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}));t(o);var i,a=t(n((function(e){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0})));!function(e){e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.FATAL=5]="FATAL"}(i||(i={}));var s=i,c=function(){function e(){}var t=e.prototype;return t.ignore=function(e,t){return!1},t.setBaseInfo=function(e){},t.sum=function(e){},t.avg=function(e,t){},t.log=function(e,t,n){},t.api=function(e){},e}();Date.now=Date.now||function(){return(new Date).getTime()};var u=Date.now(),f=function(){},l={noop:f,warn:function(){var e="object"==typeof console?console.warn:f;try{var t={warn:e};t.warn.call(t)}catch(e){return f}return e}(),key:"__bl",win:"object"==typeof window&&window.document?window:void 0,regionMap:{cn:"https://arms-retcode.aliyuncs.com/r.png?",sg:"https://arms-retcode-sg.aliyuncs.com/r.png?",sg_2:"https://retcode-sg-lazada.arms.aliyuncs.com/r.png?",daily:"http://arms-retcode-daily.alibaba.net/r.png?",daily_2:"https://arms-retcode-daily.alibaba.net/r.png?",us:"https://retcode-us-west-1.arms.aliyuncs.com/r.png?"},defaultImgUrl:"https://arms-retcode.aliyuncs.com/r.png?",createObject:function(e){if(Object.create)return Object.create(e);var t=function(){};return t.prototype=e,new t},each:function(e,t){var n=0,r=e.length;if(this.T(e,"Array"))for(;n<r&&!1!==t.call(e[n],e[n],n);n++);else for(n in e)if(!1===t.call(e[n],e[n],n))break;return e},safetyCall:function(e,t,n){if("function"!=typeof e)return n;try{return e.apply(this,t)}catch(e){return n}},T:function(e,t){var n=Object.prototype.toString.call(e).substring(8).replace("]","");return t?n===t:n},filterByRule:function(e,t){if(!e)return"";if(!t)return e;var n=this,r=n.T(t);return"Function"===r?n.safetyCall(t,[e],e):"Array"===r?(this.each(t,(function(t){e=n.filterByRule(e,t)})),e):"Object"===r?e.replace(t.rule,t.target||""):e.replace(t,"")},ignoreByRule:function(e,t){if(!e||!t)return!1;if((this.isString(t)||t.source||"Function"===this.T(t))&&(t=[t]),!this.isArray(t))return l.warn("[arms] invalid rules of ignore config, (list of) String/RegExp/Funcitons are available"),!1;for(var n,r=[],o=0,i=t.length;o<i;o++)if(n=t[o],this.isString(n))r.push(n.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"));else if(n&&n.source)r.push(n.source);else if(n&&"Function"===this.T(n)&&!0===this.safetyCall(n,[e],!1))return!0;var a=new RegExp(r.join("|"),"i");return!!(r.length&&a.test&&a.test(e))},J:function(e){if(!e||"string"!=typeof e)return e;var t=null;try{t=JSON.parse(e)}catch(e){}return t},pick:function(e){return 1===e||1===Math.ceil(Math.random()*e)},verifyConfig:function(e){if("sample"in e){var t=e.sample,n=t;t&&/^\d+(\.\d+)?%$/.test(t)&&(n=parseInt(100/parseFloat(t))),0<n&&1>n&&(n=parseInt(1/n)),n>=1&&n<=100?e.sample=n:delete e.sample}return e},on:function(e,t,n,r,o){return e.addEventListener?(o=o||!1,e.addEventListener(t,(function i(a){r&&e.removeEventListener(t,i,o),n.call(this,a)}),o)):e.attachEvent&&e.attachEvent("on"+t,(function o(i){r&&e.detachEvent("on"+t,o),n.call(this,i)})),this},off:function(e,t,n){return n?(e.removeEventListener?e.removeEventListener(t,n):e.detachEvent&&e.detachEvent(t,n),this):this},delay:function(e,t){return-1===t?(e(),null):setTimeout(e,t||0)},ext:function(e){for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},sub:function(e,t){var n={};return this.each(e,(function(e,r){-1!==t.indexOf(r)&&(n[r]=e)})),n},uu:function(){for(var e,t,n=20,r=new Array(n),o=Date.now().toString(36).split("");n-- >0;)t=(e=36*Math.random()|0).toString(36),r[n]=e%3?t:t.toUpperCase();for(var i=0;i<8;i++)r.splice(3*i+2,0,o[i]);return r.join("")},seq:function(){return(u++).toString(36)},decode:function(e){try{e=decodeURIComponent(e)}catch(e){}return e},encode:function(e,t){try{e=t?encodeURIComponent(e).replace(/\(/g,"%28").replace(/\)/g,"%29"):encodeURIComponent(e)}catch(e){}return e},serialize:function(e){e=e||{};var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&void 0!==e[n]&&t.push(n+"="+this.encode(e[n],"msg"===n));return t.join("&")},checkAPI:function(e,t){if(!e||"string"!=typeof e)return!1;var n=/arms-retcode[\w-]*\.aliyuncs/.test(e);return!n&&t&&(n=/(\.png)|(\.gif)|(alicdn\.com)/.test(e)),!n},checkAutoError:function(e){return!(!e||!e.message||/failed[\w\s]+fetch/i.test(e.message))},cutUrlSearch:function(e){return e&&"string"==typeof e?e.replace(/^(https?:)?\/\//,"").replace(/\?.*$/,""):""},removeUrlSearch:function(e){return e&&"string"==typeof e?e.replace(/\?.*$/,""):""},createFakeToString:function(e){return function(){return e+"() { [native code] }"}},checkSameOrigin:function(e,t){if(!t||!e)return!1;var n="//"+t.split("/")[2];return e===t||e.slice(0,t.length+1)===t+"/"||e===n||e.slice(0,n.length+1)===n+"/"||!/^(\/\/|http:|https:).*/.test(e)},getRandIP:function(){for(var e=[],t=0;t<4;t++){var n=Math.floor(256*Math.random());e[t]=(n>15?"":"0")+n.toString(16)}return e.join("")},getSortNum:function(e){return e?(e+=1)>=1e3&&e<=9999?e:e<1e3?e+1e3:e%1e4+1e3:1e3},getRandNum:function(e){return e&&"string"==typeof e?e.length<5?this.getNum(5):e.substring(e.length-5):this.getNum(5)},getNum:function(e){for(var t=[],n=0;n<e;n++){var r=Math.floor(16*Math.random());t[n]=r.toString(16)}return t.join("")},getCurDomain:function(){return location&&location.hostname||""},parseFetchHeaders:function(e){if(!e)return{};var t={};try{if("function"==typeof e.keys)for(var n=e.keys(),r=n.next();!r.done;){var o=r.value;t[o]=e.get(o),r=n.next()}else t=e}catch(e){t={}}return t},parseXhrHeaders:function(e){if(!e&&"string"!=typeof e)return{};var t={};try{t=e.split("\r\n").reduce((function(e,t){var n=t.split(": ");return e[n[0]]=n[1],e}),{})}catch(e){t={}}return t},getQuerys:function(e){if(!e)return"";var t={},n=[],r="",o="";try{var i=[];if(e.indexOf("?")>=0&&(i=e.substring(e.indexOf("?")+1,e.length).split("&")),i.length>0)for(var a in i)r=(n=i[a].split("="))[0],o=n[1],t[r]=o}catch(e){t={}}return t},getFetchSnapshot:function(e,t,n){var r,o;try{var i=(e&&"string"!=typeof e[0]?e[0].url:e[0])||"",a=(e&&"string"!=typeof e[0]?e[0]:e[1])||{},s="POST"===a.method.toUpperCase()?a.body:this.getQuerys(i);r={originApi:i,method:a.method||"unknown",params:s,response:t||"",reqHeaders:this.parseFetchHeaders(a.headers||null),resHeaders:this.parseFetchHeaders(n)},o="function"==typeof encodeURIComponent&&JSON&&encodeURIComponent(JSON.stringify(r))||"{}"}catch(e){o="{}"}return o},getXhrSnapshot:function(e,t,n){if(!e||!t||!n)return{};var r,o;try{r={originApi:e,method:t,params:this.getQuerys(e),response:n.responseText||n.responseXml||"",reqHeaders:{},resHeaders:this.parseXhrHeaders("function"==typeof n.getAllResponseHeaders&&n.getAllResponseHeaders()||"")},o="function"==typeof encodeURIComponent&&JSON&&encodeURIComponent(JSON.stringify(r))||"{}"}catch(e){o="{}"}return o},isRobot:function(){var e=["nuhk","googlebot/","googlebot-image","yammybot","openbot","slurp","msnbot","ask jeeves/teoma","ia_archiver","baiduspider","bingbot/"];if(!navigator||"string"!=typeof navigator.userAgent)return!1;try{for(var t=navigator.userAgent.toLowerCase(),n=0;n<e.length;n++){var r=e[n];if(t.lastIndexOf(r)>=0)return!0}}catch(e){l.warn("[arms] useragent parse error")}return!1},isFunction:function(e){return"function"==typeof e},isPlainObject:function(e){return"[object Object]"===Object.prototype.toString.call(e)},isString:function(e){return"[object String]"===Object.prototype.toString.call(e)},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},joinRegExp:function(e){for(var t,n=[],r=0,o=e.length;r<o;r++)t=e[r],this.isString(t)?n.push(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):t&&t.source&&n.push(t.source);return new RegExp(n.join("|"),"i")},reWriteMethod:function(e,t,n){if(null!==e){var r=e[t];e[t]=n(r)}}},p=l,h=n((function(e){var t=function e(t){return this.ver="1.8.11",this._conf=p.ext({},e.dftCon),this.sampleCache={},this.requestQueue=[],this.hash=p.seq(),this.resetPageview(),this.setConfig(t),this.rip=p.getRandIP(),this.record=999,this["EagleEye-TraceID"]=this.getTraceId()["EagleEye-TraceID"],this._common={},this};t.dftCon={sample:1,pvSample:1,tag:"",imgUrl:"https://arms-retcode.aliyuncs.com/r.png?",region:null,ignore:{ignoreUrls:[],ignoreApis:[],ignoreErrors:[]},release:void 0,environment:"production"},t.prototype={constructor:t,onReady:function(e){return e()},getPage:function(){var e=this._conf.page;return p.safetyCall(e,[],e+"")},setPage:function(){},setConfig:function(e){e&&"object"==typeof e&&(p.verifyConfig(e),e=this.setImgUrl(e),this._conf=p.ext({},this._conf,e))},setImgUrl:function(e){var t=e.region,n=e.imgUrl;if(t){var r=p.regionMap[t];return e.imgUrl=r||p.defaultImgUrl,e}return n&&(e.imgUrl=n),e},checkImgUrl:function(e){if(this.getConfig("debug"))return!0;var t=p.regionMap,n=!1;for(var r in t)if(t[r]===e){n=!0;break}return!n&&p.warn("[retcode] invalid url: "+e),n},sendRequest:function(){},sendBeacon:function(e){!function(e,t){"object"==typeof e&&(e=p.serialize(e));var n=t+e;window&&window.navigator&&"function"==typeof window.navigator.sendBeacon?window.navigator.sendBeacon(n,"&post_res="):p.warn("[arms] navigator.sendBeacon not surported")}(e,this.getConfig("imgUrl"))},postData:function(){},commonInfo:function(){return{}},setCommonInfo:function(e){e&&"object"==typeof e&&(this._common=p.ext({},this._common,e))},resetPageview:function(){this.pageview=p.uu(),this.sBegin=Date.now()},getUsername:function(){if(this.username)return this.username;var e=this._conf,t=e&&e.setUsername;if("function"==typeof t)try{var n=t();"string"==typeof n&&(n=n.substr(0,20),this.username=n)}catch(e){p.warn("[arms] setUsername fail",e)}return this.username},getTraceId:function(){var e=this.rip,t=Date.now(),n=p.getSortNum(this.record),r=e+t+n+p.getRandNum(this._conf.pid);return this["EagleEye-TraceID"]=r,this.record=n,{"EagleEye-TraceID":r}},getPageviewId:function(){return{"EagleEye-SessionID":this.pageview}},getConfig:function(e){return e?this._conf[e]:p.ext({},this._conf)},sampling:function(e){return 1===e||("boolean"==typeof this.sampleCache[e]||(this.sampleCache[e]=p.pick(e)),this.sampleCache[e])},clear:function(){var e;clearTimeout(this.requestTimmer),this.requestTimmer=null;for(var t=this._conf&&"function"==typeof this._conf.sendRequest;e=this.requestQueue.pop();)"res"===e.t?this.postData(e,"res"):"error"===e.t?this.postData(e,"err"):"api"===e.t?this.postData(e,"apiSnapshot"):"behavior"===e.t?this.postData(e,"behavior"):"health"===e.t&&!t&&window&&window.navigator&&"function"==typeof window.navigator.sendBeacon?this.sendBeacon(e):this.sendRequest(e);return this},_lg:function(e,t,n){var r=this._conf,o=this.getPage(),i=r.ignore||{},a=i.ignoreErrors,s=i.ignoreUrls,c=i.ignoreApis;return this._isRobot||p.ignoreByRule(o,s)||p.ignoreByRule(p.decode(o),s)||"error"===e&&(p.ignoreByRule(t.msg,a)||p.ignoreByRule(p.decode(t.msg),a))||"api"===e&&(p.ignoreByRule(t.api,c)||p.ignoreByRule(p.decode(t.api),c))?this:this.checkImgUrl(r.imgUrl)&&t&&!r.disabled&&r.pid?n&&!this.sampling(n)?this:function(e,t){var n;if("error"!==t.t||!(n=e.requestQueue[0])||"error"!==n.t||t.msg!==n.msg){if("behavior"===t.t){var r=e.requestQueue&&e.requestQueue.length;if(r>0&&"behavior"===e.requestQueue[r-1].t){var o=t.behavior||[];e.requestQueue[r-1].behavior.concat(o)}else e.requestQueue.push(t)}else e.requestQueue.unshift(t);return e.onReady((function(){e.requestTimmer=p.delay((function(){e.clear()}),e.requestQueue[0]&&"error"===e.requestQueue[0].t?3e3:-1)})),!0}n.times++}(this,t=p.ext({t:e,times:1,page:o,tag:r.tag||"",release:r.release||"",environment:r.environment,begin:Date.now()},t,this.commonInfo(),this._common,{pid:r.pid,_v:this.ver,pv_id:this.pageview,username:this.getUsername(),sampling:n||1,z:p.seq(),c1:r.c1,c2:r.c2,c3:r.c3})):this},custom:function(e,t){if(!e||"object"!=typeof e)return this;var n=!1,r={begin:Date.now()};return p.each(e,(function(e,t){return!(n=t&&t.length<=20)&&p.warn("[retcode] invalid key: "+t),r["x-"+t]=e,n})),n?this._lg("custom",r,t||1):this}},e.exports=t})),g=n((function(e){var t=["api","success","time","code","msg","trace","traceId","begin","pv_id","sid","seq","domain"],n=function(e,t){var n=e.split("::");return n.length>1?p.ext({group:n[0],key:n[1]},t):p.ext({group:"default_group",key:n[0]},t)},r=function(e){var t;h.call(this,e);try{t="object"==typeof performance?performance.timing.fetchStart:Date.now()}catch(e){t=Date.now()}return this._startTime=t,this};r.prototype=p.createObject(h.prototype),p.ext(h.dftCon,{startTime:null}),p.ext(r.prototype,{constructor:r,_super:h,sum:function(e,t,r){try{return this._lg("sum",n(e,{val:t||1,begin:Date.now()}),r)}catch(e){p.warn("[retcode] can not get parseStatData: "+e)}},avg:function(e,t,r){try{return this._lg("avg",n(e,{val:t||0,begin:Date.now()}),r)}catch(e){p.warn("[retcode] can not get parseStatData: "+e)}},percent:function(e,t,r,o){try{return this._lg("percent",n(e,{subkey:t,val:r||0,begin:Date.now()}),o)}catch(e){p.warn("[retcode] can not get parseStatData: "+e)}},msg:function(e,t){if(e&&!(e.length>180))return this.custom({msg:e},t)},error:function(e,t){if(!e)return p.warn("[retcode] invalid param e: "+e),this;1===arguments.length?("string"==typeof e&&(e={message:e},t={}),"object"==typeof e&&(t=e=e.error||e)):("string"==typeof e&&(e={message:e}),"object"!=typeof t&&(t={}));var n=e.name||"CustomError",r=e.message||"",o=e.stack||"";t=t||{};var i={begin:Date.now(),cate:n,msg:r&&r.substring(0,1e3),stack:o&&o.substring(0,1e3),file:p.removeUrlSearch(t.filename||""),line:t.lineno||"",col:t.colno||"",err:{msg_raw:p.encode(r),stack_raw:p.encode(o)}},a=(this.getConfig("ignore")||{}).ignoreErrors;return p.ignoreByRule(i.msg,a)||p.ignoreByRule(p.decode(i.msg),a)?this:(this.beforeSend&&this.beforeSend("error",i),this._lg("error",i,1))},behavior:function(e){if(e){var t="object"==typeof e&&e.behavior?e:{behavior:e};return this.beforeSend&&this.beforeSend("behavior",t),this._lg("behavior",t,1)}},api:function(e,n,r,o,i,a,s,c,u,f){if(!e)return p.warn("[retcode] api is null"),this;if(e="string"==typeof e?{api:e,success:n,time:r,code:o,msg:i,begin:a,traceId:s,pv_id:c,domain:f}:p.sub(e,t),!p.checkAPI(e.api,!0))return this;if(e.code=e.code||"",e.msg=e.msg||"",e.success=e.success?1:0,e.time=+e.time,e.begin=e.begin,e.traceId=e.traceId||"",e.pv_id=e.pv_id||"",e.domain=e.domain||"",e.success?e.apiSnapshot&&delete e.apiSnapshot:e.apiSnapshot=u,!e.api||isNaN(e.time))return p.warn("[retcode] invalid time or api"),this;var l=(this.getConfig("ignore")||{}).ignoreApis;if(p.ignoreByRule(e.api,l)||p.ignoreByRule(p.decode(e.api),l))return this;this.beforeSend&&this.beforeSend("api",e);var h={type:"api",data:{message:e.msg,url:e.api,status:e.code},timestamp:e.begin};try{this.getConfig("behavior")&&this.addBehavior&&this.addBehavior(h)}catch(e){}return this._lg("api",e,e.success&&this.getConfig("sample"))},speed:function(e,t,n){var r=this,o=this.getConfig("startTime")||this._startTime;return/^s(\d|1[0])$/.test(e)?(t="number"!=typeof t?Date.now()-o:t>=o?t-o:t,r.speedCache=r.speedCache||{},r.speedCache[e]=t,r.speedCache.begin=o,clearTimeout(r.speedTimmer),r.speedTimmer=setTimeout((function(){n||(r.speedCache.page=r.getPage(!0)),r._lg("speed",r.speedCache),r.speedCache=null}),5e3),r):(p.warn("[retcode] invalid point: "+e),r)},performance:function(e){if(e&&"object"==typeof e){var t={},n=this.getConfig("autoSendPerf");if(n&&e.autoSend&&!this.hasSendPerf)return this.hasSendPerf=!0,this._lg("perf",e,this.getConfig("sample"));for(var r in e)(/^t([1-9]|1[0])$/.test(r)||"ctti"===r||"cfpt"===r)&&(t[r]=e[r]);if(n&&!0!==e.autoSend)this.perfData=p.ext(this.perfData||{},t);else if(!1===n&&!this.hasSendPerf){if(!this.perfData||"object"!=typeof this.perfData)return;return t=p.ext(this.perfData,t),this.hasSendPerf=!0,this._lg("perf",t,this.getConfig("sample"))}}},resource:function(e,t){if(!e||!p.isPlainObject(e))return p.warn("[arms] invalid param data: "+e),this;var n=Object.keys(e),r=["begin","dom","load","res","dl"],o=!1;for(var i in r)if(n.indexOf(r[i])<0){o=!0;break}if(o)return p.warn("[arms] lack param data: "+e),this;var a={begin:e.begin||Date.now(),dom:e.dom||"",load:e.load||"",res:p.isArray(e.res)?JSON.stringify(e.res):JSON.stringify([]),dl:e.dl||""};return this._lg("res",a,t)}}),r._super=h,r._root=h,h.Reporter=r,e.exports=r})),d=n((function(e){var t="object"==typeof window?window:{},n=t.__oFetch_||t.fetch;n="function"==typeof n?n:void 0,e.exports=function(e,r){var o=-1;"object"==typeof e&&(o=e.z,e=p.serialize(e));var i=r+e;if(n)return n(i,{method:"HEAD",mode:"no-cors"}).catch(p.noop);if(t.document&&t.document.createElement){var a="__request_hold_"+o,s=t[a]=new Image;s.onload=s.onerror=function(){t[a]=void 0},s.src=i,s=null}}})),v=n((function(e){var t="object"==typeof window?window:{},n=t.__oXMLHttpRequest_||t.XMLHttpRequest;n="function"==typeof n?n:void 0,e.exports=function(e,t){try{var r=new n;r.open("POST",t,!0),r.setRequestHeader("Content-Type","text/plain"),r.send(JSON.stringify(e))}catch(e){p.warn("[retcode] Failed to log, exception is :\n"+e)}}})),m=function(e,t){var n=[],r=null,o=t&&t.location&&t.location.href,i=0,a=void 0,s=null,c=function(e,t,n){if(null!==e){var r=e[t];e[t]=n(r)}},u=function(e){var t,n,r,o,i,a=[];if(!e||!e.tagName)return"";if(a.push(e.tagName.toLowerCase()),e.id&&"[object String]"===Object.prototype.toString.call(e.id)&&a.push("#".concat(e.id)),(t=e.className)&&"[object String]"===Object.prototype.toString.call(t))for(n=t.split(/\s+/),i=0;i<n.length;i++)a.push(".".concat(n[i]));var s=["type","name","title","alt"];for(i=0;i<s.length;i++)r=s[i],(o=e.getAttribute(r))&&"[object String]"===Object.prototype.toString.call(o)&&a.push("[".concat(r,'="').concat(o,'"]'));return a.join("")},f=function(e,t){return function(n){if(n&&n!==s){var o;s=n;try{o=n.target}catch(e){o="<unknown>"}if(0!==o.length){var c={type:"ui.".concat(e),data:{message:function(e){if(!e||1!==e.nodeType)return"";for(var t=e||null,n=[],r=0,o=0,i=" > ".length,a="";t&&r++<5&&!("html"===(a=u(t))||r>1&&o+n.length*i+a.length>=80);)n.push(a),o+=a.length,t=t.parentNode;return n.reverse().join(" > ")}(o)},timestamp:Date.now()};"click"===e?(i&&clearTimeout(i),t?i=setTimeout((function(){r&&r.addBehavior(c)}),0):r&&r.addBehavior(c)):"keypress"===e&&(a||r&&r.addBehavior(c),clearTimeout(a),a=setTimeout((function(){a=void 0}),100))}}}};p.ext(e.prototype,{addBehavior:function(e){if(this.getConfig("behavior")&&e&&"object"==typeof e){var r={},o=e.data||{};if(e.type)r=o;else{if("string"!=typeof o.name||"string"!=typeof o.message)return;r.name=o.name.substr(0,20),r.message=o.message.substr(0,200)}r.message&&(r.message=p.encode(r.message));var i={type:e.type||"custom",data:r||{},timestamp:e.timestamp||Date.now(),page:e.page||t&&t.location&&t.location.pathname};return n.push(i),n=n.slice(-100)}},getBehavior:function(){return n||[]},setBehavior:function(e){return e&&(n=e),n},reportBehavior:function(e){var t=this;t.getConfig("behavior")&&(t.sendBhTimer&&(clearTimeout(t.sendBhTimer),t.sendBhTimer=void 0),t.sendBhTimer=setTimeout((function(){n&&n.length>0&&(t.behavior(n),n=[],t.sendBhTimer=void 0,e&&"function"==typeof e&&e())}),0))},initBehavior:function(){if(!this.hasInitBehavior&&!r){try{!function(){if(document&&document.referrer&&document.location){var e=document.referrer,t=document.location.href;if(""!==e){var n={type:"navigation",data:{from:e,to:t}};o=t,r&&r.addBehavior(n)}}}(),t&&t.document&&t.document.addEventListener&&(t.document.addEventListener("click",f("click"),!1),t.document.addEventListener("keypress",f("keypress"),!1)),function(){if(function(){var e=t&&t.chrome,n=e&&e.app&&e.app.runtime,r="history"in t&&!!t.history.pushState&&!!t.history.replaceState;return!n&&r}()){var e=function(e,t){var n={type:"navigation",data:{from:e,to:t}};r&&r.addBehavior(n),o=t},n=t.onpopstate;t.onpopstate=function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];var s=t.location.href;if(e(o,s),n)return n.apply(this,i)};var i=function(t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=r.length>2?r[2]:void 0;return a&&e(o,String(a)),t.apply(this,r)}};c(t.history,"pushState",i),c(t.history,"replaceState",i)}}(),this.getConfig("enableConsole")&&function(){if(t&&t.console)for(var e=["debug","info","warn","log","error","assert"],n=0;n<e.length;n++){var o=e[n];t.console[o]&&"function"==typeof t.console[o]&&c(t.console,o,(function(e){var n=o;return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s={type:"console",data:{level:n,message:i}};if(r&&r.addBehavior(s),"error"===n)for(var c=0;c<i.length;c++){var u=i[c];u&&u.message&&u.stack&&r&&r.errorHandler(new ErrorEvent("error",{error:u,message:u.message}))}e&&Function.prototype.apply.call(e,t.console,i)}}))}}()}catch(e){p.warn("[arms] error in initBehavior",e)}r=this,this.hasInitBehavior=!0}return this}})},y=["","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","requestStart","responseStart","responseEnd","","domInteractive","","domContentLoadedEventEnd","","loadEventStart","","msFirstPaint","secureConnectionStart"],b=y,w=function(){var e=p.win||{},t=e.performance;if(!t||"object"!=typeof t||"function"!=typeof t.getEntriesByType)return null;var n={},r=t.timing||{},o=t.getEntriesByType("resource")||[];if(n.begin=r[b[1]]||Date.now(),"function"==typeof e.PerformanceNavigationTiming){var i=t.getEntriesByType("navigation")[0];i&&(r=i)}return p.each({dom:[10,8],load:[14,1]},(function(e,t){var o=r[b[e[1]]],i=r[b[e[0]]];if(o>0&&i>0){var a=Math.round(i-o);a>=0&&a<6e5&&(n[t]=a)}})),n.res=JSON.stringify(o),n},_=y,S=function(){var e=p.win||{},t=e.performance;if(!t||"object"!=typeof t)return null;var n={},r=t.timing||{},o=Date.now(),i=1;if("function"==typeof e.PerformanceNavigationTiming){var a=t.getEntriesByType("navigation")[0];a&&(r=a,i=2)}p.each({dns:[3,2],tcp:[5,4],ssl:[5,17],ttfb:[7,6],trans:[8,7],dom:[10,8],res:[14,12],firstbyte:[7,2],fpt:[8,1],tti:[10,1],ready:[12,1],load:[14,1]},(function(e,t){var o=r[_[e[1]]],a=r[_[e[0]]];if(2===i||o>0&&a>0){var s=Math.round(a-o);s>=0&&s<6e5&&(n[t]=s)}}));var s=e.navigator.connection,c=t.navigation||{};n.ct=s?s.effectiveType||s.type:"";var u=s&&(s.downlink||s.downlinkMax||s.bandwidth)||null;if((u=u>999?999:u)&&(n.bandwidth=u),n.navtype=1===c.type?"Reload":"Other",1===i&&r[_[16]]>0&&r[_[1]]>0){var f=r[_[16]]-r[_[1]];f>=0&&f<36e5&&(n.fpt=f)}return 1===i&&r[_[1]]>0?n.begin=r[_[1]]:2===i&&n.load>0?n.begin=o-n.load:n.begin=o,n},E=function(e,t,n){function r(e,t,n){var i=0,a=e.tagName;if("SCRIPT"!==a&&"STYLE"!==a&&"META"!==a&&"HEAD"!==a){var s=e.children?e.children.length:0;if(s>0)for(var c=e.children,u=s-1;u>=0;u--)i+=r(c[u],t+1,i>0);if(i<=0&&!n&&!(e.getBoundingClientRect&&e.getBoundingClientRect().top<o))return 0;i+=1+.5*t}return i}var o=t.innerHeight||0,i=[],a=null,s=0;p.ext(e.prototype,{initFmpObserver:function(e){var o=this;if(!o._conf||!o._conf.useFmp)return null;if(!t.MutationObserver)return p.warn("[retcode] first meaningful paint can not be retrieved"),o.sendPerformance(),null;p.on(t,"beforeunload",(function(){o.endObserving(0,!0)}));var c=t.MutationObserver;return(a=new c((function(){!function(e){var t=Date.now()-e,o=n.querySelector("body");if(o){var a=0;a+=r(o,1,!1),i.push({score:a,t:t})}else i.push({score:0,t:t})}(o._startTime)}))).observe(document,{childList:!0,subtree:!0}),s=1,o.onReady((function(){o.endObserving(e)})),a},endObserving:function(e,t){var n=this;if(a&&s)if(t||!function(e,t){var n=Date.now()-e;return!(n>t||n-(i&&i.length&&i[i.length-1].t||0)>1e3)}(n._startTime,e)){a.disconnect(),s=0,i=function e(t){for(var n=1;n<t.length;n++)if(t[n].score<t[n-1].score)return t.splice(n,1),e(t);return t}(i);for(var r=null,o=1;o<i.length;o++)if(i[o].t>=i[o-1].t){var c=i[o].score-i[o-1].score;(!r||r.rate<=c)&&(r={t:i[o].t,rate:c})}r&&r.t>0&&r.t<36e5?n.sendPerformance({fmp:r.t}):n.sendPerformance()}else p.delay((function(){n.endObserving(e)}),500)}})},C=n((function(e){var t,n,r,o,i,a,s,c,u,f,l,h,y,b,_,C=p.win,I=C.document,T=/^(error|api|speed|sum|avg|percent|custom|msg|setPage|setConfig|behavior|performance)$/,x=function(e){var t=this;return g.call(t,e),t._initialPage=e.page&&p.safetyCall(e.page,[],e.page+"")||null,t._isRobot=p.isRobot(),t._health={errcount:0,apisucc:0,apifail:0},t.beforeSend=function(e,n){"error"===e?t._health.errcount++:"api"===e&&t._health[n.success?"apisucc":"apifail"]++},!1!==e.enableInstanceAutoSend&&(t.initHandler(),t.initHook(),t.initFmpObserver(1e4),t._conf&&t._conf.behavior&&"function"==typeof t.initBehavior&&t.initBehavior()),Object.defineProperty&&C.addEventListener&&Object.defineProperty(t,"pipe",{set:t.sendPipe}),t};x.prototype=p.createObject(g.prototype),p.ext(g._root.dftCon,{uid:null,setUsername:null,ignoreUrlPath:null,ignoreApiPath:null,urlHelper:[{rule:/\/([a-z\-_]+)?\d{2,20}/g,target:"/$1**"},/\/$/],apiHelper:{rule:/(\w+)\/\d{2,}/g,target:"$1"},ignoreUrlCase:!0,imgUrl:"https://arms-retcode.aliyuncs.com/r.png?",disableHook:!1,autoSendPv:!0,autoSendPerf:!0,enableSPA:!1,enableLinkTrace:!1,sendResource:!0,behavior:!0,enableConsole:!1,parseHash:function(e){return(e?p.cutUrlSearch(e.replace(/^#\/?/,"")):"")||"[index]"},parseResponse:function(e){if(!e||"object"!=typeof e)return{};var t=e.code,n=e.msg||e.message||e.subMsg||e.errorMsg||e.ret||e.errorResponse||"";return"object"==typeof n&&(t=t||n.code,n=n.msg||n.message||n.info||n.ret||JSON.stringify(n)),{msg:n,code:t,success:!0}}}),p.ext(x.prototype,{constructor:x,_super:g,onReady:function(e){var t=this;if(t.hasReady)return e();"complete"===I.readyState?(t.hasReady=!0,e()):p.on(C,"load",(function(){t.hasReady=!0,e()}),!0)},getPage:function(e){var t=this._conf,n=t.page,r=location,o=r.host+r.pathname;return n&&!e?p.safetyCall(n,[],n+""):this._initialPage||p.filterByRule(t.ignoreUrlCase?o.toLowerCase():o,t.ignoreUrlPath?t.ignoreUrlPath:t.urlHelper)},setPage:function(e,t){var n=this,r=n.prevPage;if(!1!==t){if(!e||e===r)return n;n.prevPage=e,clearTimeout(n.sendPVTimmer),n.handleUnload(1),n.resetPageview(),n.sendPVTimmer=setTimeout((function(){n.sendPV()}),10)}else n.prevPage=e;return n._conf.page=e,n},setConfig:function(e,t){if(e&&"object"==typeof e){p.verifyConfig(e),e=this.setImgUrl(e);var n=this._conf;if(this._conf=p.ext({},n,e),!t){var r="disableHook";r in e&&n[r]!==e[r]&&(e[r]?this.removeHook():this.addHook()),(r="enableSPA")in e&&n[r]!==e[r]&&this.bindHashChange(e[r])}}},sendRequest:function(e){d(e,this.getConfig("imgUrl"))},postData:function(e,t){var n={};n[t]=e[t],delete e[t];var r="";"object"==typeof e&&(r=p.serialize(e)),v(n,this.getConfig("imgUrl")+r+"&post_res=")},sendPipe:function(e){var t=this;if(!e||!e.length)return t;try{if("Array"===p.T(e[0]))return p.each(e,(function(e){return t.sendPipe(e)}));if("Array"!==p.T(e))return t;var n=e.shift();if(!T.test(n))return t;t[n].apply(t,e)}catch(e){return p.warn("[retcode] error in sendPipe",e),t}},sendHealth:function(){var e=p.ext({},this._health);e.healthy=e.errcount>0?0:1,e.begin=Date.now();var t=e.begin-this.sBegin;e.stay=t,this._lg("health",e,1),this._health={errcount:0,apisucc:0,apifail:0}},createInstance:function(e){e=p.ext({pid:this._conf.pid},e);var t=this.__proto__.constructor(e);return e.page&&t.sendPV(),t}}),m(x,C),t=x,n=C,o=p,i=w,a=S,s=null,c=(r=I).documentElement,u=n.innerWidth||c.clientWidth||r.body.clientWidth,f=n.innerHeight||c.clientHeight||r.body.clientHeight,l=n.navigator.connection,h={sr:screen.width+"x"+screen.height,vp:u+"x"+f,ct:l?l.effectiveType||l.type:""},y={},b=function(e,t,n,i,a){if(void 0===t){var s,c;if(!y[e]){s=new RegExp(e+"=([^;]+)");try{c=s.exec(r.cookie)}catch(e){return o.warn("[retcode] can not get cookie:",e),null}c&&(y[e]=c[1])}return y[e]}var u=e+"="+t;i&&(u+="; domain="+i),u+="; path="+(a||"/"),n&&(u+="; max-age="+n);try{return r.cookie=u,!!r.cookie}catch(e){return o.warn("[retcode] can not set cookie: ",e),!1}},_=function(e){var t=e._conf.uid||b("_nk_")||b("_bl_uid");return t||(t=o.uu(),b("_bl_uid",t,15552e3))?t:null},o.ext(t.prototype,{activeErrHandler:function(e){return s&&!e||(s=this),this},errorHandler:function(e){if(!e)return this;var t=e.type;if("error"===t){var n=e.target||e.srcElement;!n||!n.tagName||e.message||e.filename||e.lineno||e.colno?this.error(e.error||{message:e.message},e):this.resourceErrorHandler(e)}else"unhandledrejection"===t&&o.T(e.reason,"Error")&&o.checkAutoError(e.reason)&&this.error(e.reason);try{this.getConfig("behavior")&&this.reportBehavior&&this.reportBehavior()}catch(e){}return this},resourceErrorHandler:function(e){var t=this,n=e.target||e.srcElement;try{var r=t.getSrc(n),i=n.tagName?n.tagName.toLowerCase():"",a=t.getXPath(n,5);return t._lg("resourceError",{src:r&&r.substring(0,1e3),node_name:i,xpath:a}),t}catch(e){return o.warn("[ARMS] resourceErrorHandler error :",e),t}},getSrc:function(e){var t=e.src||e.href;try{if(!t){var n="object"===(e.tagName?e.tagName.toLowerCase():""),r=e.getAttribute("classid")&&"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"===e.getAttribute("classid").toLowerCase()||"application/x-shockwave-flash"===e.getAttribute("type");n&&r&&(t=e.getAttribute("data")||e.getAttribute("codebase")),t||(t=e.outerHTML||e.innerHTML)}}catch(e){t=""}return t},getXPath:function(e,t){var n=e.id?"#"+e.id:"",r=e.className?"."+e.className.split(" ").join("."):"",o=(e.tagName?e.tagName.toLowerCase():"")+n+r;return e.parentNode&&e.parentNode.tagName&&t-1!=0?this.getXPath(e.parentNode,t-1)+" > "+o:o},sendPerformance:function(e){var t=this;t.onReady((function(){var n=a();n&&(n.page=t.getPage(!0),e&&(n=o.ext(n,e)),t.perfData&&(n=o.ext(n,t.perfData)),t.getConfig("autoSendPerf")?(n.autoSend=!0,t.performance(n)):t.perfData=n)}))},sendResources:function(e){var t=this;t.onReady((function(){var n=i();n&&(n.load&&n.load<=2e3||n.load&&n.load<=8e3&&Math.random()>.05||(n.page=t.getPage(!0),n.dl=location.href,e&&(n=o.ext(n,e)),t._lg("res",n,t.getConfig("sample"))))}))},sendPV:function(){var e=this;e.onReady((function(){var t=function(e){var t=_(e),o=n.devicePixelRatio||1;return{uid:t,dt:r.title,dl:location.href,dr:r.referrer,dpr:o.toFixed(2),de:(r.characterSet||r.defaultCharset||"").toLowerCase(),ul:c.lang,begin:Date.now()}}(e);t&&t.uid&&e._lg("pv",t,e.getConfig("pvSample"))}))},commonInfo:function(){return h.uid=_(this),h.sid=function(e){return e.session?e.session:sessionStorage&&"function"==typeof sessionStorage.getItem?"string"==typeof(t=sessionStorage.getItem("_bl_sid"))?(e.session=t,t):(t=o.uu(),e.session=t,"function"==typeof sessionStorage.setItem&&sessionStorage.setItem("_bl_sid",t),t):(e.session=t=o.uu(),t);var t}(this),h},handleUnload:function(e){var t=Date.now();if(t-this._lastUnload<200)return this;this._lastUnload=t,this.sendHealth(e),this.speedCache&&(this._lg("speed",this.speedCache),this.speedCache=null,clearTimeout(this.speedTimmer)),this.clear()},bindHashChange:function(e){var t=this;if(!e^t.hashChangeHandler)return t;e?(t.hackHistoryState(),t.hashChangeHandler=function(e){var n=t._conf.parseHash(location.hash);n&&t.setPage(n,!1!==e)},t.stateChangeHandler=function(e){var n=t._conf.parseHash(e.detail);n&&t.setPage(n)},o.on(n,"hashchange",t.hashChangeHandler),o.on(n,"historystatechange",t.stateChangeHandler),t.hashChangeHandler(!1)):(o.off(n,"hashchange",t.hashChangeHandler),o.off(n,"historystatechange",t.stateChangeHandler),t.hashChangeHandler=null,t.stateChangeHandler=null)},initHandler:function(){var e=this;if(e.hasInitHandler)return e;var t=e._conf;return o.on(n,"beforeunload",(function(){e.handleUnload(0)})),e.bindHashChange(t.enableSPA),e.activeErrHandler(!1),e.hasInitHandler=!0,e}}),o.on(n,"error",(function(e){s&&s.errorHandler(e)}),!1,!0).on(n,"unhandledrejection",(function(e){s&&s.errorHandler(e)})),E(x,C,I),function(e,t){var n=p,r=null,o=n.getCurDomain(),i=function(e,t,r,i,a,s,c,u,f,l){var p=n.J(a)||null,h=n.safetyCall(t,[p,i],null);if(!h)return!1;var g=h.code||s,d=!("success"in h)||h.success;e.api(r,d,c,g,h.msg,u,f,l,{},o)},a="fetch",s="__oFetch_",c="__oXMLHttpRequest_",u="XMLHttpRequest";n.ext(e.prototype,{removeHook:function(e,n){return r&&(n||this===r)?(t[s]&&(t[a]=t[s],delete t[s]),t[c]&&(t[u]=t[c],delete t[c]),r=null,this):this},addHook:function(e){return!e&&r||(r||(function(){if("function"==typeof t[a]){var e=t[a];t[s]=e,t[a]=function(a,s){var c=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),u=r;if(!u||!u.api)return e.apply(t,c);if(s&&("HEAD"===s.method||"no-cors"===s.mode))return e.apply(t,c);var f=Date.now(),l=u._conf,p=(a&&"string"!=typeof a?a.url:a)||"",h=p;if(p=n.cutUrlSearch(p),!n.checkAPI(p,!0))return e.apply(t,c);p=n.filterByRule(p,l.ignoreApiPath?l.ignoreApiPath:l.apiHelper);var g=l.enableLinkTrace,d="",v="",m=u.getConfig("pid");if(g){var y="";try{y=location.origin?location.origin:location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")}catch(e){y=""}if(n.checkSameOrigin(h,y)){if(a&&"string"!=typeof a)try{if(c[0].headers&&"function"==typeof c[0].headers.get&&"function"==typeof c[0].headers.append){var b=c[0].headers.get("EagleEye-TraceID"),w=c[0].headers.get("EagleEye-SessionID"),_=c[0].headers.get("EagleEye-pAppName");b?d=b:(d=u.getTraceId()["EagleEye-TraceID"],c[0].headers.append("EagleEye-TraceID",d)),w?v=w:(v=u.getPageviewId()["EagleEye-SessionID"],c[0].headers.append("EagleEye-SessionID",v)),_||c[0].headers.append("EagleEye-pAppName",m)}}catch(e){n.warn("[retcode] fetch failed to set header, exception is :\n"+e)}s&&(s.headers=s.headers?s.headers:{},s.headers["EagleEye-TraceID"]?d=s.headers["EagleEye-TraceID"]:(d=u.getTraceId()["EagleEye-TraceID"],s.headers["EagleEye-TraceID"]=d),s.headers["EagleEye-SessionID"]?v=s.headers["EagleEye-SessionID"]:(v=u.getPageviewId()["EagleEye-SessionID"],s.headers["EagleEye-SessionID"]=v),s.headers["EagleEye-pAppName"]||(s.headers["EagleEye-pAppName"]=m))}}return e.apply(t,c).then((function(e){if(!u||!u.api)return e;try{if(!e||"function"!=typeof e.clone)return e;var t=e.clone(),r=t.headers;if(r&&"function"==typeof r.get){var a=r.get("content-type");if(a&&!/(text)|(json)/.test(a))return e}var s=Date.now()-f;return t.text().then((function(e){var a=n.getFetchSnapshot(c,e,r);t.ok?i(u,l.parseResponse,p,h,e,t.status||200,s,f,d,v):u.api(p,!1,s,t.status||404,t.statusText,f,d,v,a,o)})),e}catch(t){return n.warn("[ARMS] fetch response error :",t),e}})).catch((function(e){if(!u||!u.api)throw e;var t=Date.now()-f;throw u.api(p,!1,t,e.name||"Error",e.message,f,d,v,{},o),e}))},t[a].toString=n.createFakeToString(a)}}(),function(){if("function"==typeof t[u]){var e,a=t[u];t[c]=a,t[u]=function(t){var s=new a(t),c=r;if(!c||!c.api||!s.addEventListener)return s;var u,f,l,p=s.send,h=s.open,g=s.setRequestHeader,d=c._conf,v=c.getConfig("enableLinkTrace"),m="",y="",b="";return s.open=function(t,r){e=t;var o=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);if(h.apply(s,o),l=r||"",f=(f=n.cutUrlSearch(l))?n.filterByRule(f,d.ignoreApiPath?d.ignoreApiPath:d.apiHelper):"",v){var i="";try{i=location.origin?location.origin:location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")}catch(e){i=""}n.checkSameOrigin(l,i)&&g&&"function"==typeof g&&(m=c.getTraceId()["EagleEye-TraceID"],g.apply(s,["EagleEye-TraceID",m]),y=c.getPageviewId()["EagleEye-SessionID"],g.apply(s,["EagleEye-SessionID",y]),b=c.getConfig("pid"),g.apply(s,["EagleEye-pAppName",b]))}},s.send=function(){u=Date.now();var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);p.apply(s,e)},n.on(s,"readystatechange",(function(){if(f&&4===s.readyState){var t=Date.now()-u,r=n.getXhrSnapshot(l,e,s);if(s.status>=200&&s.status<=299){var a=s.status||200;if("function"==typeof s.getResponseHeader){var p=s.getResponseHeader("Content-Type");if(p&&!/(text)|(json)/.test(p))return}s.responseType&&"text"!==s.responseType?c.api(f,!0,t,a,"",u,m,y,{},o):i(c,d.parseResponse,f,l,s.responseText,a,t,u,m,y)}else c.api(f,!1,t,s.status||"FAILED",s.statusText,u,m,y,r,o)}})),s},t[u].toString=n.createFakeToString(u)}}()),r=this),this},initHook:function(){return this.hasInitHook||(this.getConfig("disableHook")||this.addHook(),this.hasInitHook=!0),this}})}(x,C),function(e,t){var n=p,r=t.history||{},o=t.document,i=function(e,n){var r;t.CustomEvent?r=new CustomEvent(e,{detail:n}):((r=o.createEvent("HTMLEvents")).initEvent(e,!1,!0),r.detail=n),t.dispatchEvent(r)},a=function(e){var t=r[e];"function"==typeof t&&(r[e]=function(o,a,s){var c=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),u=location.href,f=t.apply(r,c);if(!s||"string"!=typeof s)return f;if(s===u)return f;try{var l=u.split("#"),p=s.split("#"),h=n.cutUrlSearch(l[0]),g=n.cutUrlSearch(p[0]),d=l[1]&&l[1].replace(/^\/?(.*)/,"$1"),v=p[1]&&p[1].replace(/^\/?(.*)/,"$1");h!==g?i("historystatechange",g):d!==v&&i("historystatechange",v)}catch(t){n.warn("[retcode] error in "+e+": "+t)}return f},r[e].toString=n.createFakeToString(e))};n.ext(e.prototype,{hackHistoryState:function(){return this.hasHackedHistoryState||(a("pushState"),a("replaceState"),this.hasHackedHistoryState=!0),this}})}(x,C),x._super=g,x._root=g._root,g.Browser=x,e.exports=x})),I=n((function(e){function t(e,t){var a=n[o]=new r(e);a.sendPipe(t);var s=a._conf;return!1!==s.autoSendPv&&a.sendPV(),s&&s.useFmp||a.sendPerformance(),s&&s.sendResource&&a.sendResources(),n[i]=!0,a}var n=window,r=n.BrowserLogger=C,o=p.key,i="__hasInitBlSdk";r.singleton=function(e,r){return n[i]?n[o]:t(e,r)},r.createExtraInstance=function(e){e&&"object"==typeof e&&!0!==e.enableInstanceAutoSend&&(e.enableInstanceAutoSend=!1);var t=new r(e),n=t._conf;return n.enableInstanceAutoSend&&(!1!==n.autoSendPv&&t.sendPV(),n&&n.useFmp||t.sendPerformance(),n&&n.sendResource&&t.sendResources()),t},"object"==typeof window&&!!window.navigator&&n[o]&&(r.bl=function(){if(n[i])return n[o];var e={},r=[];return o in n&&(e=n[o].config||{},r=n[o].pipe||[]),t(e,r)}()),e.exports=r})),T=function(e){function t(t){var n;return void 0===t&&(t={}),(n=e.call(this)||this)._instance=void 0,n._ignoreFunction=void 0,t.weIgnore&&n.setupIgnore(t.weIgnore),n._instance=I.createExtraInstance(t,[]),n}a(t,e);var n=t.prototype;return n.getArms=function(){return this._instance},n.setConfig=function(e){e.weIgnore&&this.setupIgnore(e.weIgnore),this._instance.setConfig(e)},n.getConfig=function(){return this._instance.getConfig()},n.setupIgnore=function(e){this._ignoreFunction=e},n.ignore=function(e,t){return!!this._ignoreFunction&&this._ignoreFunction(e,t)},n.setBaseInfo=function(e){this._instance.setCommonInfo(e)},n.sum=function(e){this._instance.sum(e,1)},n.avg=function(e,t){void 0===t&&(t=0),this._instance.avg(e,t)},n.log=function(e,t,n){if(n)if(e!==s.ERROR&&e!==s.FATAL){var o=function(e,t){if(void 0===t&&(t=!1),!e)return{};var n={type:"log"};if(e instanceof Error){var o=e;n.msg=String(o.message),n.stack=String(o.stack),n.type=String(o.name||"sys")}else if("object"!=typeof e)n.msg=String(e);else if(n=r({},e),t)for(var i in n)n[i]=String(n[i]);return n}(n),i=r({"log-category":t,"log-level":s[e]},o);this._instance.custom(i)}else{var a=function(e){if(!e)return null;var t;if("object"!=typeof e)return t=new Error(String(e));if(e instanceof Error){var n=e;(t=new Error).message=n.message,t.stack=n.stack,t.name=n.name}else{t=new Error("");try{t.message=JSON.stringify(e)}catch(e){}}return t}(n);a&&(t&&(a.name=t),this._instance.error(a))}},n.api=function(e){this._instance.api(e)},t}(c);e.default=T,Object.defineProperty(e,"__esModule",{value:!0})}));
