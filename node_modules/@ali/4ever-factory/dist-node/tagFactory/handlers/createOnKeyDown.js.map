{"version":3,"sources":["../../../../src/tagFactory/handlers/createOnKeyDown.ts"],"names":["isArrowRightHotKey","isArrowLeftHotKey","createKeyDown","customizedKeyDown","onKeyDown","event","controller","next","selection","value","isCollapsed","tagElement","hotkeys","isDeleteBackward","isDeleteForward","preventDefault","command","Commands","moveAnchorToStartOfNode","moveFocusToEndOfNode"],"mappings":";;;;;;;;;AACA;;AACA;;AACA;;AAEA,MAAMA,kBAAkB,GAAG,2BAAY,OAAZ,CAA3B;AACA,MAAMC,iBAAiB,GAAG,2BAAY,MAAZ,CAA1B;;AAIe,SAASC,aAAT,CAAuBC,iBAAvB,EAAwD;AACrE,SAAO,SAASC,SAAT,CACLC,KADK,EAELC,UAFK,EAGLC,IAHK,EAIL;AACA,UAAM;AAAEC,MAAAA;AAAF,QAAgBF,UAAU,CAACG,KAAjC;;AACA,QAAID,SAAS,IAAIA,SAAS,CAACE,WAA3B,EAAwC;AACtC,UAAIC,UAAU,GAAIC,qBAAQC,gBAAR,CAAyBR,KAAzB,KAAmCO,qBAAQE,eAAR,CAAwBT,KAAxB,CAApC,GAAsE,gCAAkBC,UAAlB,EAA8BM,qBAAQC,gBAAR,CAAyBR,KAAzB,IAAkC,UAAlC,GAA+C,SAA7E,CAAtE,GAAgK,IAAjL;AACA,UAAI,CAACM,UAAL,EAAiBA,UAAU,GAAGV,iBAAiB,CAACI,KAAD,CAAjB,GAA2B,gCAAkBC,UAAlB,EAA8BL,iBAAiB,CAACI,KAAD,CAAjB,GAA2B,UAA3B,GAAwC,SAAtE,CAA3B,GAA8G,IAA3H;AACjB,UAAI,CAACM,UAAL,EAAiBA,UAAU,GAAGX,kBAAkB,CAACK,KAAD,CAAlB,GAA4B,gCAAkBC,UAAlB,EAA8BN,kBAAkB,CAACK,KAAD,CAAlB,GAA4B,SAA5B,GAAwC,UAAtE,CAA5B,GAAgH,IAA7H;;AAEjB,UAAIM,UAAJ,EAAgB;AACdN,QAAAA,KAAK,CAACU,cAAN;AACA,eAAOT,UAAU,CAACU,OAAX,CAAmBC,sBAASC,uBAA5B,EAAqDP,UAArD,EAAiEK,OAAjE,CAAyEC,sBAASE,oBAAlF,EAAwGR,UAAxG,CAAP;AACD;AACF;;AACD,WAAOR,iBAAiB,GAAGA,iBAAiB,CAACE,KAAD,EAAQC,UAAR,EAAoBC,IAApB,CAApB,GAAgDA,IAAI,EAA5E;AACD,GAjBD;AAkBD","sourcesContent":["import * as React from 'react';\nimport { isKeyHotkey } from 'is-hotkey';\nimport { Controller, hotkeys, Commands } from '@ali/4ever-cangjie';\nimport getTagAtFocusEdge from '../queries/getTagAtFocusEdge';\n\nconst isArrowRightHotKey = isKeyHotkey('right');\nconst isArrowLeftHotKey = isKeyHotkey('left');\n\ntype KeyDownType = (event: React.KeyboardEvent, controller: Controller, next: () => void) => void;\n\nexport default function createKeyDown(customizedKeyDown?: KeyDownType) {\n  return function onKeyDown(\n    event: React.KeyboardEvent,\n    controller: Controller,\n    next: () => void,\n  ) {\n    const { selection } = controller.value;\n    if (selection && selection.isCollapsed) {\n      let tagElement = (hotkeys.isDeleteBackward(event) || hotkeys.isDeleteForward(event)) ? getTagAtFocusEdge(controller, hotkeys.isDeleteBackward(event) ? 'Backward' : 'Forward') : null;\n      if (!tagElement) tagElement = isArrowLeftHotKey(event) ? getTagAtFocusEdge(controller, isArrowLeftHotKey(event) ? 'Backward' : 'Forward') : null;\n      if (!tagElement) tagElement = isArrowRightHotKey(event) ? getTagAtFocusEdge(controller, isArrowRightHotKey(event) ? 'Forward' : 'Backward') : null;\n\n      if (tagElement) {\n        event.preventDefault();\n        return controller.command(Commands.moveAnchorToStartOfNode, tagElement).command(Commands.moveFocusToEndOfNode, tagElement);\n      }\n    }\n    return customizedKeyDown ? customizedKeyDown(event, controller, next) : next();\n  };\n}"],"file":"createOnKeyDown.js"}