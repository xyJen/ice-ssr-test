{"version":3,"sources":["../../../../src/tagFactory/queries/getTagAtFocusEdge.ts"],"names":["getTagAtFocusEdge","controller","dire","selection","focusText","document","value","start","getStart","isAtStartOfNode","preNode","getPreviousSibling","key","Inline","isInline","type","isAtEndOfNode","nextNode","getNextSibling"],"mappings":";;;;;;;AAAA;;AACA;AACA;AACA;AACA;AACA;AACe,SAASA,iBAAT,CAA2BC,UAA3B,EAAmDC,IAAnD,EAAiG;AAC9G,QAAM;AAAEC,IAAAA,SAAF;AAAaC,IAAAA,SAAb;AAAwBC,IAAAA;AAAxB,MAAqCJ,UAAU,CAACK,KAAtD;AACA,MAAI,CAACH,SAAD,IAAc,CAACC,SAAnB,EAA8B,OAAO,IAAP;AAC9B,QAAMG,KAAK,GAAGJ,SAAS,CAACK,QAAV,CAAmBH,QAAnB,CAAd;;AACA,MAAIH,IAAI,KAAK,UAAT,IAAuBK,KAAK,CAACE,eAAN,CAAsBL,SAAtB,CAA3B,EAA6D;AAC3D,UAAMM,OAAO,GAAGL,QAAQ,CAACM,kBAAT,CAA4BP,SAAS,CAACQ,GAAtC,CAAhB;AACA,QAAIF,OAAO,IAAIG,oBAAOC,QAAP,CAAgBJ,OAAhB,CAAX,IAAuCA,OAAO,CAACK,IAAR,KAAiB,KAA5D,EAAmE,OAAOL,OAAP;AACpE,GAHD,MAGO,IAAIR,IAAI,KAAK,SAAT,IAAsBK,KAAK,CAACS,aAAN,CAAoBZ,SAApB,CAA1B,EAA0D;AAC/D,UAAMa,QAAQ,GAAGZ,QAAQ,CAACa,cAAT,CAAwBd,SAAS,CAACQ,GAAlC,CAAjB;AACA,QAAIK,QAAQ,IAAIJ,oBAAOC,QAAP,CAAgBG,QAAhB,CAAZ,IAAyCA,QAAQ,CAACF,IAAT,KAAkB,KAA/D,EAAsE,OAAOE,QAAP;AACvE;;AACD,SAAO,IAAP;AACD","sourcesContent":["import { Controller, Element, Inline } from '@ali/4ever-cangjie';\n/**\n * 获取focus边缘的tag节点\n * @param controller\n * @param dire 方向\n */\nexport default function getTagAtFocusEdge(controller: Controller, dire: 'Backward' | 'Forward'): Element | null {\n  const { selection, focusText, document } = controller.value;\n  if (!selection || !focusText) return null;\n  const start = selection.getStart(document);\n  if (dire === 'Backward' && start.isAtStartOfNode(focusText)) {\n    const preNode = document.getPreviousSibling(focusText.key);\n    if (preNode && Inline.isInline(preNode) && preNode.type === 'tag') return preNode;\n  } else if (dire === 'Forward' && start.isAtEndOfNode(focusText)) {\n    const nextNode = document.getNextSibling(focusText.key);\n    if (nextNode && Inline.isInline(nextNode) && nextNode.type === 'tag') return nextNode;\n  }\n  return null;\n}"],"file":"getTagAtFocusEdge.js"}