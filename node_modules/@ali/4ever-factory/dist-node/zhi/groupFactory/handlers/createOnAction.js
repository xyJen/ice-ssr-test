"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _everPluginComment = require("@ali/4ever-plugin-comment");

var _everPluginHeadingGroup = require("@ali/4ever-plugin-heading-group");

var _fold = require("../commands/fold");

function createOnAction(customizedAction) {
  const handleCommentShow = (0, _everPluginHeadingGroup.createCommentShow)({
    onAutoUnfold: (controller, node) => controller.command(_fold.injectFold, node, false),
    inject: true
  });
  return function onAction(action, controller, next) {
    const {
      type,
      payload
    } = action;

    if (type === _everPluginHeadingGroup.TOGGLE_FOLD) {
      const {
        node,
        fold
      } = payload;
      return controller.command(_fold.injectFold, node, fold);
    }

    if (type === _everPluginComment.ACTION_COMMENT_SHOW && payload) {
      handleCommentShow(controller, payload);
    }

    return customizedAction ? customizedAction(action, controller, next) : next();
  };
}

var _default = createOnAction;
exports.default = _default;
//# sourceMappingURL=createOnAction.js.map