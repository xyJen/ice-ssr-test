{"version":3,"sources":["../../../../src/embedFactory/handlers/onDrop.ts"],"names":["onUpload","enableFilePreview","event","controller","next","preventDefault","data","transferUtils","getEventTransfer","files","uploadFiles","filter","file","type","indexOf","length","value","query"],"mappings":";;;;;;;;;AAAA;;AAEA;;AADA;;eAGe,CAACA,QAAD,EAAWC,iBAAX,KAAiC,CAACC,KAAD,EAAQC,UAAR,EAAgCC,IAAhC,KAAyC;AACvFF,EAAAA,KAAK,CAACG,cAAN;;AACA,QAAMC,IAAI,GAAGC,2BAAcC,gBAAd,CAA+BN,KAA/B,EAAsCC,UAAtC,CAAb;;AACA,QAAM;AAAEM,IAAAA;AAAF,MAAYH,IAAlB;;AACA,MAAI,CAACG,KAAL,EAAY;AACV,WAAOL,IAAI,EAAX;AACD,GANsF,CAQvF;;;AACA,QAAMM,WAAW,GAAGD,KAAK,CAACE,MAAN,CAAaC,IAAI,IAAIA,IAAI,CAACC,IAAL,CAAUC,OAAV,CAAkB,OAAlB,MAA+B,CAAC,CAArD,CAApB;AACA,MAAIJ,WAAW,CAACK,MAAZ,KAAuB,CAA3B,EAA8B,OAAOX,IAAI,EAAX,CAVyD,CAYvF;;AACA,QAAM;AAAEY,IAAAA;AAAF,MAAYb,UAAlB;;AAEA,MAAIA,UAAU,CAACc,KAAX,CAAiB,uBAAjB,CAAJ,EAA+C;AAC7C,WAAOb,IAAI,EAAX;AACD;;AAED,MAAKE,IAAD,CAAyBO,IAAzB,KAAkC,OAAlC,IAA6Cb,QAAjD,EAA2D;AACzD,WAAO,2BAAaG,UAAb,EAAyBH,QAAzB,EAAmCU,WAAnC,EAAgDT,iBAAhD,CAAP;AACD;;AAED,SAAOG,IAAI,EAAX;AACD,C","sourcesContent":["import { Controller, transferUtils } from '@ali/4ever-cangjie';\n;\nimport onInsertFile from './onInsertFile';\n\nexport default (onUpload, enableFilePreview) => (event, controller: Controller, next) => {\n  event.preventDefault();\n  const data = transferUtils.getEventTransfer(event, controller);\n  const { files } = data;\n  if (!files) {\n    return next();\n  }\n\n  // 都是图片的话走图片自己逻辑\n  const uploadFiles = files.filter(file => file.type.indexOf('image') === -1);\n  if (uploadFiles.length === 0) return next();\n\n  // 表格内不允许拖拽文件\n  const { value } = controller;\n\n  if (controller.query('isSelectionInTaskList')) {\n    return next();\n  }\n\n  if ((data as {type: string}).type === 'files' && onUpload) {\n    return onInsertFile(controller, onUpload, uploadFiles, enableFilePreview);\n  }\n\n  return next();\n};\n"],"file":"onDrop.js"}