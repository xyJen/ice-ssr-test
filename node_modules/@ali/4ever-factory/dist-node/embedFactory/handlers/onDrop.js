"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _everCangjie = require("@ali/4ever-cangjie");

var _onInsertFile = _interopRequireDefault(require("./onInsertFile"));

;

var _default = (onUpload, enableFilePreview) => (event, controller, next) => {
  event.preventDefault();

  const data = _everCangjie.transferUtils.getEventTransfer(event, controller);

  const {
    files
  } = data;

  if (!files) {
    return next();
  } // 都是图片的话走图片自己逻辑


  const uploadFiles = files.filter(file => file.type.indexOf('image') === -1);
  if (uploadFiles.length === 0) return next(); // 表格内不允许拖拽文件

  const {
    value
  } = controller;

  if (controller.query('isSelectionInTaskList')) {
    return next();
  }

  if (data.type === 'files' && onUpload) {
    return (0, _onInsertFile.default)(controller, onUpload, uploadFiles, enableFilePreview);
  }

  return next();
};

exports.default = _default;
//# sourceMappingURL=onDrop.js.map