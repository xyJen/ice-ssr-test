{"version":3,"sources":["../../../../src/cardFactory/commands/setCardInjection.ts"],"names":["setCardInjection","controller","node","injectionData","logger","error","JSON","stringify","injections","value","injection","Injection","create","key","data","excludeInjections","filter","inj","setInjections","concat"],"mappings":";;;;;;;;;AAAA;;AACA;;AAEe,SAASA,gBAAT,CACbC,UADa,EAEbC,IAFa,EAGbC,aAHa,EAID;AACZ,MAAI,CAACD,IAAL,EAAW;AACT;AACAE,wBAAOC,KAAP,CAAc,8BAA6BC,IAAI,CAACC,SAAL,CAAeJ,aAAf,CAA8B,EAAzE;;AACA,WAAOF,UAAP;AACD;;AACD,QAAM;AAAEO,IAAAA;AAAF,MAAiBP,UAAU,CAACQ,KAAlC;;AACA,QAAMC,SAAS,GAAGC,uBAAUC,MAAV,CAAiB;AACjCC,IAAAA,GAAG,EAAEX,IAAI,CAACW,GADuB;AAEjCC,IAAAA,IAAI,EAAEX;AAF2B,GAAjB,CAAlB;;AAIA,QAAMY,iBAAiB,GAAGP,UAAU,CAACQ,MAAX,CAAmBC,GAAD,IAASA,GAAG,CAACJ,GAAJ,KAAYX,IAAI,CAACW,GAA5C,CAA1B;AACA,SAAOZ,UAAU,CAACiB,aAAX,CAAyBH,iBAAiB,CAACI,MAAlB,CAAyBT,SAAzB,CAAzB,CAAP;AACD","sourcesContent":["import { Controller, Element, Injection } from '@ali/4ever-cangjie';\nimport logger from '@ali/4ever-logger';\n\nexport default function setCardInjection(\n  controller: Controller,\n  node: Element,\n  injectionData: Record<string, any>,\n): Controller {\n  if (!node) {\n    // FIX: 怀疑 hetu 业务方设置 injection 时未判断 node 是否存在\n    logger.error(`Invalid node! injection is ${JSON.stringify(injectionData)}`);\n    return controller;\n  }\n  const { injections } = controller.value;\n  const injection = Injection.create({\n    key: node.key,\n    data: injectionData,\n  });\n  const excludeInjections = injections.filter((inj) => inj.key !== node.key);\n  return controller.setInjections(excludeInjections.concat(injection));\n}\n"],"file":"setCardInjection.js"}