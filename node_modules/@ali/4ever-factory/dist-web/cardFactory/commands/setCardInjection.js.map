{"version":3,"sources":["../../../../src/cardFactory/commands/setCardInjection.ts"],"names":["Injection","logger","setCardInjection","controller","node","injectionData","error","JSON","stringify","injections","value","injection","create","key","data","excludeInjections","filter","inj","setInjections","concat"],"mappings":"AAAA,SAA8BA,SAA9B,QAA+C,oBAA/C;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AAEA,eAAe,SAASC,gBAAT,CACbC,UADa,EAEbC,IAFa,EAGbC,aAHa,EAID;AACZ,MAAI,CAACD,IAAL,EAAW;AACT;AACAH,IAAAA,MAAM,CAACK,KAAP,iCAA2CC,IAAI,CAACC,SAAL,CAAeH,aAAf,CAA3C;AACA,WAAOF,UAAP;AACD;;AALW,MAMJM,UANI,GAMWN,UAAU,CAACO,KANtB,CAMJD,UANI;AAOZ,MAAME,SAAS,GAAGX,SAAS,CAACY,MAAV,CAAiB;AACjCC,IAAAA,GAAG,EAAET,IAAI,CAACS,GADuB;AAEjCC,IAAAA,IAAI,EAAET;AAF2B,GAAjB,CAAlB;AAIA,MAAMU,iBAAiB,GAAGN,UAAU,CAACO,MAAX,CAAkB,UAACC,GAAD;AAAA,WAASA,GAAG,CAACJ,GAAJ,KAAYT,IAAI,CAACS,GAA1B;AAAA,GAAlB,CAA1B;AACA,SAAOV,UAAU,CAACe,aAAX,CAAyBH,iBAAiB,CAACI,MAAlB,CAAyBR,SAAzB,CAAzB,CAAP;AACD","sourcesContent":["import { Controller, Element, Injection } from '@ali/4ever-cangjie';\nimport logger from '@ali/4ever-logger';\n\nexport default function setCardInjection(\n  controller: Controller,\n  node: Element,\n  injectionData: Record<string, any>,\n): Controller {\n  if (!node) {\n    // FIX: 怀疑 hetu 业务方设置 injection 时未判断 node 是否存在\n    logger.error(`Invalid node! injection is ${JSON.stringify(injectionData)}`);\n    return controller;\n  }\n  const { injections } = controller.value;\n  const injection = Injection.create({\n    key: node.key,\n    data: injectionData,\n  });\n  const excludeInjections = injections.filter((inj) => inj.key !== node.key);\n  return controller.setInjections(excludeInjections.concat(injection));\n}\n"],"file":"setCardInjection.js"}