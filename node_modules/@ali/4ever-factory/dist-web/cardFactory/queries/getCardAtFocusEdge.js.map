{"version":3,"sources":["../../../../src/cardFactory/queries/getCardAtFocusEdge.ts"],"names":["Block","getCardAtFocusEdge","controller","dire","value","selection","focusBlock","document","focus","anchor","isEdgePoint","key","type","start","getStart","isAtStartOfNode","preNode","getPreviousSibling","isBlock","isAtEndOfNode","nextNode","getNextSibling"],"mappings":"AAAA,SAA8BA,KAA9B,QAA2C,oBAA3C;AACA;AACA;AACA;AACA;AACA;;AACA,eAAe,SAASC,kBAAT,CAA4BC,UAA5B,EAAoDC,IAApD,EAAkG;AAAA,0BACnED,UAAU,CAACE,KADwD;AAAA,MACvGC,SADuG,qBACvGA,SADuG;AAAA,MAC5FC,UAD4F,qBAC5FA,UAD4F;AAAA,MAChFC,QADgF,qBAChFA,QADgF;AAE/G,MAAI,CAACF,SAAD,IAAc,CAACC,UAAnB,EAA+B,OAAO,IAAP;AAFgF,MAGvGE,KAHuG,GAGrFH,SAHqF,CAGvGG,KAHuG;AAAA,MAGhGC,MAHgG,GAGrFJ,SAHqF,CAGhGI,MAHgG;AAI/G,MAAID,KAAK,CAACE,WAAN,MAAuBD,MAAM,CAACC,WAAP,EAAvB,IAA+CF,KAAK,CAACG,GAAN,KAAcF,MAAM,CAACE,GAApE,IAA2EL,UAAU,CAACM,IAAX,KAAoB,MAAnG,EAA2G,OAAON,UAAP;AAC3G,MAAMO,KAAK,GAAGR,SAAS,CAACS,QAAV,CAAmBP,QAAnB,CAAd;;AACA,MAAIJ,IAAI,KAAK,UAAT,IAAuBU,KAAK,CAACE,eAAN,CAAsBT,UAAtB,CAA3B,EAA8D;AAC5D,QAAMU,OAAO,GAAGT,QAAQ,CAACU,kBAAT,CAA4BX,UAAU,CAACK,GAAvC,CAAhB;AACA,QAAIK,OAAO,IAAIhB,KAAK,CAACkB,OAAN,CAAcF,OAAd,CAAX,IAAqCA,OAAO,CAACJ,IAAR,KAAiB,MAA1D,EAAkE,OAAOI,OAAP;AACnE,GAHD,MAGO,IAAIb,IAAI,KAAK,SAAT,IAAsBU,KAAK,CAACM,aAAN,CAAoBb,UAApB,CAA1B,EAA2D;AAChE,QAAMc,QAAQ,GAAGb,QAAQ,CAACc,cAAT,CAAwBf,UAAU,CAACK,GAAnC,CAAjB;AACA,QAAIS,QAAQ,IAAIpB,KAAK,CAACkB,OAAN,CAAcE,QAAd,CAAZ,IAAuCA,QAAQ,CAACR,IAAT,KAAkB,MAA7D,EAAqE,OAAOQ,QAAP;AACtE;;AACD,SAAO,IAAP;AACD","sourcesContent":["import { Controller, Element, Block } from '@ali/4ever-cangjie';\n/**\n * 获取focus边缘的card节点\n * @param controller\n * @param dire 方向\n */\nexport default function getCardAtFocusEdge(controller: Controller, dire: 'Backward' | 'Forward'): Element | null {\n  const { selection, focusBlock, document } = controller.value;\n  if (!selection || !focusBlock) return null;\n  const { focus, anchor } = selection;\n  if (focus.isEdgePoint() && anchor.isEdgePoint() && focus.key === anchor.key && focusBlock.type === 'card') return focusBlock;\n  const start = selection.getStart(document);\n  if (dire === 'Backward' && start.isAtStartOfNode(focusBlock)) {\n    const preNode = document.getPreviousSibling(focusBlock.key);\n    if (preNode && Block.isBlock(preNode) && preNode.type === 'card') return preNode;\n  } else if (dire === 'Forward' && start.isAtEndOfNode(focusBlock)) {\n    const nextNode = document.getNextSibling(focusBlock.key);\n    if (nextNode && Block.isBlock(nextNode) && nextNode.type === 'card') return nextNode;\n  }\n  return null;\n}"],"file":"getCardAtFocusEdge.js"}