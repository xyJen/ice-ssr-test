{"version":3,"sources":["../../../../src/embedFactory/components/EmbedInlineToolbar.tsx"],"names":["React","Button","DeleteBetaNormal","EmbedCardBetaNormal","Preview1BetaNormal","InlineToolbar","removeFile","getFileTypeForRead","CanPreviewFileTypes","embedInlineLayout","toolButtons","name","EmbedInlineToolbar","props","locale","controller","node","onSwitchViewType","isMoreButtonShown","triggerNode","isBlurred","value","isExpanded","rangeSelection","data","shouldShowModeButtons","includes","handleSwitchView","e","type","preventDefault","stopPropagation","handlePreviewMode","handleCardMode","handleDel","useCallback","event","run","EmbedCardButton","cardView","EmbedPreviewButton","previewView","DelEmbedButton","customToolButtons","undefined"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Button, DeleteBetaNormal, EmbedCardBetaNormal, Preview1BetaNormal } from '@ali/we-design';\nimport {\n  Controller,\n} from '@ali/4ever-cangjie';\nimport {\n  InlineToolbar,\n} from '@ali/4ever-component';\nimport { removeFile } from '../actions';\nimport { EmbedNode, getFileTypeForRead, CanPreviewFileTypes } from '@ali/4ever-plugin-embed';\n\ninterface InlineToolbarProps {\n  controller: Controller;\n  node: EmbedNode;\n  locale: Record<string, any>;\n  onSwitchViewType?: Function;\n  isMoreButtonShown?: boolean;\n  triggerNode?: HTMLDivElement | null;\n}\n\nconst embedInlineLayout = [{\n  toolButtons: [{\n    name: 'embed.cardMode',\n  }, {\n    name: 'embed.previewMode',\n  }, {\n    name: 'embed.del',\n  }],\n}];\n\nconst EmbedInlineToolbar: React.FC<InlineToolbarProps> = (props) => {\n  const {\n    locale,\n    controller,\n    node,\n    onSwitchViewType,\n    isMoreButtonShown,\n    triggerNode,\n  } = props;\n\n  const { isBlurred } = controller.value;\n  const { isExpanded } = controller.value.rangeSelection;\n  const { data } = node;\n  const { name } = data;\n  const shouldShowModeButtons = (\n    CanPreviewFileTypes.includes(getFileTypeForRead(name)) &&\n    isMoreButtonShown);\n\n  const handleSwitchView = (e: MouseEvent, type: 'card' | 'preview') => {\n    e.preventDefault();\n    e.stopPropagation();\n    onSwitchViewType && onSwitchViewType(type);\n  };\n\n  const handlePreviewMode = (e) => {\n    handleSwitchView(e, 'preview');\n  };\n\n  const handleCardMode = (e) => {\n    handleSwitchView(e, 'card');\n  };\n\n  const handleDel = React.useCallback((event: React.MouseEvent | React.TouchEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    controller.run('onAction', removeFile(node));\n  }, [controller, node]);\n\n  const EmbedCardButton = () => {\n    return (\n      <Button\n        bordered={false}\n        onClick={handleCardMode}\n        title={locale.cardView}\n        icon={<EmbedCardBetaNormal />}\n        testid=\"embed-toolbar-card\"\n      />\n    );\n  };\n\n  const EmbedPreviewButton = () => {\n    return (\n      <Button\n        bordered={false}\n        onClick={handlePreviewMode}\n        title={locale.previewView}\n        icon={<Preview1BetaNormal />}\n        testid=\"embed-toolbar-previewView\"\n      />\n    );\n  };\n\n  const DelEmbedButton = () => {\n    return <Button bordered={false} onClick={handleDel} title={locale.delete} icon={<DeleteBetaNormal />} testid=\"embed-toolbar-delete\" />;\n  };\n\n  const customToolButtons = {\n    'embed.cardMode': shouldShowModeButtons ? EmbedCardButton : null,\n    'embed.previewMode': shouldShowModeButtons ? EmbedPreviewButton : null,\n    'embed.del': DelEmbedButton,\n  };\n\n  if (isExpanded || isBlurred) {\n    return null;\n  }\n\n  return (\n    <InlineToolbar\n      visible\n      inlineLayout={embedInlineLayout}\n      customToolButtons={customToolButtons}\n      triggerNode={triggerNode || undefined}\n    />\n  );\n};\n\nexport default EmbedInlineToolbar;\n"],"file":"EmbedInlineToolbar.js"}