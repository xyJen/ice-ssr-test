{"version":3,"sources":["../../../../src/embedFactory/handlers/onDrop.ts"],"names":["transferUtils","onInsertFile","onUpload","enableFilePreview","event","controller","next","preventDefault","data","getEventTransfer","files","uploadFiles","filter","file","type","indexOf","length","value","query"],"mappings":"AAAA,SAAqBA,aAArB,QAA0C,oBAA1C;AACA;AACA,OAAOC,YAAP;AAEA,gBAAe,UAACC,QAAD,EAAWC,iBAAX;AAAA,SAAiC,UAACC,KAAD,EAAQC,UAAR,EAAgCC,IAAhC,EAAyC;AACvFF,IAAAA,KAAK,CAACG,cAAN;AACA,QAAMC,IAAI,GAAGR,aAAa,CAACS,gBAAd,CAA+BL,KAA/B,EAAsCC,UAAtC,CAAb;AAFuF,QAG/EK,KAH+E,GAGrEF,IAHqE,CAG/EE,KAH+E;;AAIvF,QAAI,CAACA,KAAL,EAAY;AACV,aAAOJ,IAAI,EAAX;AACD,KANsF,CAQvF;;;AACA,QAAMK,WAAW,GAAGD,KAAK,CAACE,MAAN,CAAa,UAAAC,IAAI;AAAA,aAAIA,IAAI,CAACC,IAAL,CAAUC,OAAV,CAAkB,OAAlB,MAA+B,CAAC,CAApC;AAAA,KAAjB,CAApB;AACA,QAAIJ,WAAW,CAACK,MAAZ,KAAuB,CAA3B,EAA8B,OAAOV,IAAI,EAAX,CAVyD,CAYvF;;AAZuF,QAa/EW,KAb+E,GAarEZ,UAbqE,CAa/EY,KAb+E;;AAevF,QAAIZ,UAAU,CAACa,KAAX,CAAiB,uBAAjB,CAAJ,EAA+C;AAC7C,aAAOZ,IAAI,EAAX;AACD;;AAED,QAAKE,IAAD,CAAyBM,IAAzB,KAAkC,OAAlC,IAA6CZ,QAAjD,EAA2D;AACzD,aAAOD,YAAY,CAACI,UAAD,EAAaH,QAAb,EAAuBS,WAAvB,EAAoCR,iBAApC,CAAnB;AACD;;AAED,WAAOG,IAAI,EAAX;AACD,GAxBc;AAAA,CAAf","sourcesContent":["import { Controller, transferUtils } from '@ali/4ever-cangjie';\n;\nimport onInsertFile from './onInsertFile';\n\nexport default (onUpload, enableFilePreview) => (event, controller: Controller, next) => {\n  event.preventDefault();\n  const data = transferUtils.getEventTransfer(event, controller);\n  const { files } = data;\n  if (!files) {\n    return next();\n  }\n\n  // 都是图片的话走图片自己逻辑\n  const uploadFiles = files.filter(file => file.type.indexOf('image') === -1);\n  if (uploadFiles.length === 0) return next();\n\n  // 表格内不允许拖拽文件\n  const { value } = controller;\n\n  if (controller.query('isSelectionInTaskList')) {\n    return next();\n  }\n\n  if ((data as {type: string}).type === 'files' && onUpload) {\n    return onInsertFile(controller, onUpload, uploadFiles, enableFilePreview);\n  }\n\n  return next();\n};\n"],"file":"onDrop.js"}