{"version":3,"sources":["../../../src/utils/convert.ts"],"names":["jsonMLAttrsToMarks","markToJsonMLAttrs","attrsToMarks","attrs","bold","caps","color","fonts","highlight","shd","italic","smallCaps","strike","dstrike","sz","szUnit","underline","vertAlign","inlineCode","spacing","kern","em","rest","marks","Object","keys","forEach","key","data","markData","isObj","Array","isArray","value","push","type","markToAttr","mark","m","marksToAttrs","reduce","assign"],"mappings":"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","sourcesContent":["import type { Mark, MarkProperties, MoAttributes as Attributes, TextMark } from \"@ali/4ever-cangjie\";\nimport type { CapData } from \"../mo/models/caps\";\n\nimport { jsonMLAttrsToMarks } from './jsonMLAttrsToMarks';\nimport { markToJsonMLAttrs } from './markToJsonMLAttrs';\n\ndeclare module '@ali/4ever-cangjie' {\n  interface TextMark {\n    bold?: boolean; // 加粗\n    italic?: boolean; // 倾斜\n    underline?: {\n      value?: string;\n      color?: string;\n    }; // 下划线\n    strike?: boolean; // 删除线\n    dstrike?: boolean; // 双删除线\n    em?: string; // 着重号\n    color?: string; // 字体颜色\n    highlight?: string; // 高亮\n    shd?: {\n      val?: string;\n      color?: string;\n      fill?: string;\n    };\n    caps?: CapData;\n    smallCaps?: boolean;\n    vertAlign?: 'superscript' | 'subscript' | 'baseline';\n    sz?: number; // 字号设置\n    szUnit?: string; // 字号单位\n    fonts?: {\n      // 字体设置\n      ascii?: string;\n      hAnsi?: string;\n      cs?: string;\n      eastAsia?: string;\n      hint?: string;\n    };\n    br?: {\n      // 换行设置\n      type: 'page' | 'textWrapping' | 'column';\n    };\n    lastRenderedPageBreak?: boolean;\n    inlineCode?: boolean; // 行内代码\n    spacing?: number; // 字符间距\n    kern?: number; // 字偶间距\n  }\n}\n\nexport function attrsToMarks(attrs: TextMark): Array<MarkProperties | Mark> {\n  const {\n    bold,\n    caps,\n    color,\n    fonts,\n    highlight,\n    shd,\n    italic,\n    smallCaps,\n    strike,\n    dstrike,\n    sz,\n    szUnit,\n    underline,\n    vertAlign,\n    inlineCode,\n    spacing,\n    kern,\n    em,\n    ...rest\n  } = attrs;\n\n  const { marks = [] } = jsonMLAttrsToMarks(attrs) || {};\n\n  delete rest['data-type'];\n\n  Object.keys(rest).forEach((key) => {\n    const data = rest[key];\n    let markData: Record<string, any>;\n    const isObj = typeof data === 'object' && !!data && !Array.isArray(data);\n    if (!isObj) {\n      // not a object\n      markData = { value: data };\n    } else {\n      markData = data;\n    }\n    marks.push({ type: key, data: markData });\n  });\n\n  return marks;\n}\n\nexport function markToAttr(mark: Mark): TextMark {\n  const m = markToJsonMLAttrs(mark);\n\n  if (m) {\n    return m;\n  }\n\n  return { [mark.type]: mark.data };\n}\n\nexport function marksToAttrs(marks: Mark[]): Attributes {\n  return marks.reduce((attrs: Attributes, mark: Mark) => Object.assign(attrs, markToAttr(mark)), {} as Attributes);\n}\n"],"file":"convert.js"}