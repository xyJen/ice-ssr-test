{"version":3,"sources":["../../../src/utils/jsonMLAttrsToStyle.ts"],"names":["SzUtil","ShdUtil","inlineCodeTheme","INLINE_CODE","jsonMLAttrsToStyle","attrs","style","bold","italic","strike","dstrike","underline","color","highlight","vertAlign","sz","szUnit","fonts","inlineCode","shd","spacing","fontWeight","fontStyle","textDecoration","isInvalid","value","backgroundColor","transformShd","verticalAlign","fontSize","toPt","letterSpacing","ascii","hAnsi","cs","eastAsia","fontFamily","padding","margin","border","borderRadius","wordBreak"],"mappings":"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","sourcesContent":["import type { LeafRule } from \"@ali/4ever-cangjie\";\nimport {\n  SzUtil,\n  ShdUtil,\n  inlineCodeTheme as INLINE_CODE,\n} from '@ali/4ever-utils';\n\nexport const jsonMLAttrsToStyle: NonNullable<LeafRule['jsonMLAttrsToStyle']> = (attrs, style) => {\n  const {\n    bold,\n    italic,\n    strike,\n    dstrike,\n    underline,\n    color,\n    highlight,\n    vertAlign,\n    sz,\n    szUnit = 'px',\n    fonts,\n    inlineCode,\n    shd,\n    spacing,\n  } = attrs;\n\n  if (bold) {\n    style.fontWeight = 'bold';\n  }\n  if (italic) {\n    style.fontStyle = 'italic';\n  }\n  if (strike || dstrike) {\n    style.textDecoration = 'line-through';\n  }\n  if (underline) {\n    // 使用最基础的 textDecoration 属性，否则 word/wps 等无法识别\n    let isInvalid = true;\n    if (\n      typeof underline === 'string' ||\n      (underline?.value && underline.value !== 'none')\n    ) {\n      isInvalid = false;\n    }\n    if (!isInvalid) {\n      style.textDecoration = style.textDecoration\n        ? `${style.textDecoration} underline`\n        : 'underline';\n    }\n  }\n  if (color) {\n    style.color = color;\n  }\n  if (highlight) {\n    style.backgroundColor = highlight;\n  } else if (shd) {\n    style.backgroundColor =\n      style.backgroundColor || ShdUtil.transformShd(shd);\n  }\n  if (vertAlign) {\n    if (vertAlign === 'superscript') {\n      style.verticalAlign = 'super';\n    } else if (vertAlign === 'subscript') {\n      style.verticalAlign = 'sub';\n    }\n  }\n  // TODO: 这里无法区分正文or标题，无法给正文设置默认字号\n  if (sz) {\n    style.fontSize = `${SzUtil.toPt(sz + szUnit)}pt`;\n  }\n  if (spacing) {\n    style.letterSpacing = `${spacing}pt`;\n  }\n  if (fonts) {\n    const { ascii, hAnsi, cs, eastAsia } = fonts;\n    style.fontFamily = `${ascii}, ${hAnsi}, ${cs}, ${eastAsia}`;\n  }\n  if (inlineCode) {\n    style.padding = INLINE_CODE.padding;\n    style.margin = INLINE_CODE.margin;\n    style.border = INLINE_CODE.border;\n    style.borderRadius = INLINE_CODE['border-radius'];\n    style.fontFamily = INLINE_CODE['font-family'];\n    style.wordBreak = INLINE_CODE['word-break'] as any;\n    style.backgroundColor = INLINE_CODE['background-color'];\n  }\n  return style;\n}\n"],"file":"jsonMLAttrsToStyle.js"}