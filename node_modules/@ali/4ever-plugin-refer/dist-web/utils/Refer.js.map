{"version":3,"sources":["../../../src/utils/Refer.tsx"],"names":["React","environment","ReferTextWrapper","ReferText","convertMarks","getFileName4Show","FileIconMap","getFileTypeForRead","Refer","props","attributes","onDingpanPreview","node","data","name","fileType","corpId","spaceId","fileId","fileSize","text","nodes","leaf","leaves","marks","isClicked","onPreview","useCallback","fileName","mode","handleTouchStart","e","preventDefault","stopPropagation","handleTouchMove","handleTouchEnd","innerType","FileIcon","IS_MOBILE","memo"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Text, environment } from '@ali/4ever-cangjie';\nimport { ReferTextWrapper, ReferText } from './styled';\nimport convertMarks from './convertMarks';\nimport getFileName4Show from './getFileName4Show';\nimport { FileIconMap, getFileTypeForRead } from '@ali/4ever-plugin-embed';\n\nconst Refer = (props) => {\n  const { attributes, onDingpanPreview, node } = props;\n  const { data } = node;\n  const { name, fileType, corpId, spaceId, fileId, fileSize } = data;\n  const text = node.nodes[0] as Text;\n  const leaf = text.leaves[0];\n  const marks = leaf ? leaf.marks : [];\n\n  let isClicked = false;\n\n  const onPreview = React.useCallback(() => {\n    if (onDingpanPreview) {\n      onDingpanPreview({\n        corpId,\n        spaceId,\n        fileId,\n        fileSize,\n        fileType,\n        fileName: name,\n        mode: 'normal',\n      });\n    }\n  }, []);\n\n  const handleTouchStart = React.useCallback((e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    isClicked = true;\n  }, []);\n\n  const handleTouchMove = React.useCallback((e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    isClicked = false;\n  }, []);\n\n  const handleTouchEnd = React.useCallback((e) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (isClicked) {\n      onPreview();\n    }\n  }, []);\n\n  const innerType = getFileTypeForRead(name);\n  const FileIcon = FileIconMap[innerType];\n\n  return (\n    <span {...attributes}>\n      <ReferTextWrapper\n        data-testid=\"refer\"\n        onClick={onPreview}\n        style={convertMarks(marks)}\n        onTouchStart={handleTouchStart}\n        onTouchMove={handleTouchMove}\n        onTouchEnd={handleTouchEnd}\n      >\n        {FileIcon && <FileIcon />}\n        <ReferText isMobile={environment.IS_MOBILE}>\n          {getFileName4Show(innerType, data.name)}\n        </ReferText>\n      </ReferTextWrapper>\n    </span>\n  );\n};\n\nexport default React.memo(Refer);\n"],"file":"Refer.js"}