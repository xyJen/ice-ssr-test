{"version":3,"sources":["../../../../src/bi/queries/isInlineCode.ts"],"names":["isInlineCode","controller","selection","document","value","anchor","focus","isCollapsed","inline","getClosestInline","key","type","InlineCode","TYPE","isInNode","anchorInline","focusInline"],"mappings":";;;;;;;;;AACA;;AACA;;AAEA;AACA;AACA;AACA;AACA;AACO,SAASA,YAAT,CAAsBC,UAAtB,EAA8C;AACnD,QAAM;AAAEC,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAA0BF,UAAU,CAACG,KAA3C;AACA,QAAM;AAAEC,IAAAA,MAAF;AAAUC,IAAAA;AAAV,MAAoBJ,SAA1B,CAFmD,CAGnD;;AACA,MAAI,gCAAgBD,UAAhB,CAAJ,EAAiC;AAC/B,WAAO,IAAP;AACD,GANkD,CAOnD;AACA;;;AACA,MAAIC,SAAS,CAACK,WAAd,EAA2B;AACzB,UAAMC,MAAM,GAAGL,QAAQ,CAACM,gBAAT,CAA0BJ,MAAM,CAACK,GAAjC,CAAf;;AACA,QAAIF,MAAM,EAAEG,IAAR,KAAiBC,gBAAWC,IAA5B,IAAoCR,MAAM,CAACS,QAAP,CAAgBN,MAAhB,CAAxC,EAAiE;AAC/D,aAAO,IAAP;AACD;AACF,GAdkD,CAgBnD;;;AACA,QAAM;AAAEO,IAAAA,YAAF;AAAgBC,IAAAA;AAAhB,MAAgCf,UAAU,CAACG,KAAjD;;AACA,MAAIW,YAAY,IAAIC,WAApB,EAAiC;AAC/B,WAAOD,YAAY,CAACL,GAAb,KAAqBM,WAAW,CAACN,GAAjC,IAAwCK,YAAY,CAACJ,IAAb,KAAsBC,gBAAWC,IAAhF;AACD;;AACD,SAAO,KAAP;AACD","sourcesContent":["import type { Controller } from '@ali/4ever-cangjie';\nimport InlineCode from '../../mo/models';\nimport { isInlineCode as isOldInlineCode } from '../../oldInlineCode/queries/isInlineCode';\n\n/**\n * 判断选区是否在 InlineCode 内\n * @param controller\n * @returns\n */\nexport function isInlineCode(controller: Controller) {\n  const { selection, document } = controller.value;\n  const { anchor, focus } = selection;\n  // 兼容旧版，根据 common mark 来判断\n  if (isOldInlineCode(controller)) {\n    return true;\n  }\n  // 新版 inline code\n  // collapsed 情况\n  if (selection.isCollapsed) {\n    const inline = document.getClosestInline(anchor.key);\n    if (inline?.type === InlineCode.TYPE && anchor.isInNode(inline)) {\n      return true;\n    }\n  }\n\n  // 选区 expanded 时，若都在同一 inlineCode 内，则返回 true\n  const { anchorInline, focusInline } = controller.value;\n  if (anchorInline && focusInline) {\n    return anchorInline.key === focusInline.key && anchorInline.type === InlineCode.TYPE;\n  }\n  return false;\n}\n"],"file":"isInlineCode.js"}