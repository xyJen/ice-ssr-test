{"version":3,"sources":["../../../../src/bi/utils/getTextOffsetOutsideInlineCode.ts"],"names":["getTextOffsetOutsideInlineCode","value","side","selection","document","isExpanded","curTextNode","maybeInlineNode","getNextSibling","key","getPreviousSibling","InlineCode","isInlineCode","anchor","offset"],"mappings":";;;;;;;;;AACA;;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASA,8BAAT,CACbC,KADa,EAEbC,IAFa,EAGE;AACf,QAAM;AAAEC,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAA0BH,KAAhC;AACA,MAAI,CAACE,SAAD,IAAcA,SAAS,CAACE,UAA5B,EAAwC,OAAO,IAAP,CAFzB,CAGf;;AACA,QAAMC,WAAW,GAAG,6BAAeL,KAAf,CAApB;AACA,MAAI,CAACK,WAAL,EAAkB,OAAO,IAAP,CALH,CAMf;;AACA,QAAMC,eAAe,GACnBL,IAAI,KAAK,MAAT,GACIE,QAAQ,CAACI,cAAT,CAAwBF,WAAW,CAACG,GAApC,CADJ,GAEIL,QAAQ,CAACM,kBAAT,CAA4BJ,WAAW,CAACG,GAAxC,CAHN;;AAIA,MAAIE,gBAAWC,YAAX,CAAwBL,eAAxB,CAAJ,EAA8C;AAC5C,UAAMM,MAAM,GAAGV,SAAS,CAACU,MAAzB;AACA,WAAOA,MAAM,CAACC,MAAd;AACD;;AACD,SAAO,IAAP;AACD","sourcesContent":["import { Value, TextPoint } from '@ali/4ever-cangjie';\nimport getCurTextNode from './getCurTextNode';\nimport InlineCode from '../../mo/models';\n\n/**\n * 首先判断Text节点的左侧/右侧是否有Inline Code\n * 如果有，则计算光标处于Inline Code左右侧Text节点的偏移量\n * @param value\n * @param side\n * @return\n */\nexport default function getTextOffsetOutsideInlineCode(\n  value: Value,\n  side: 'left' | 'right',\n): number | null {\n  const { selection, document } = value;\n  if (!selection || selection.isExpanded) return null;\n  //若当前选中点为 text 起始，则试探前后一个节点是否为 inline\n  const curTextNode = getCurTextNode(value);\n  if (!curTextNode) return null;\n  // 试探后一个节点是否为Inline Code Node\n  const maybeInlineNode =\n    side === 'left'\n      ? document.getNextSibling(curTextNode.key)\n      : document.getPreviousSibling(curTextNode.key);\n  if (InlineCode.isInlineCode(maybeInlineNode)) {\n    const anchor = selection.anchor as TextPoint;\n    return anchor.offset;\n  }\n  return null;\n}\n"],"file":"getTextOffsetOutsideInlineCode.js"}