{"version":3,"sources":["../../../../src/bi/queries/isInlineCode.ts"],"names":["InlineCode","isInlineCode","isOldInlineCode","controller","value","selection","document","anchor","focus","isCollapsed","inline","getClosestInline","key","type","TYPE","isInNode","anchorInline","focusInline"],"mappings":"AACA,OAAOA,UAAP;AACA,SAASC,YAAY,IAAIC,eAAzB;AAEA;AACA;AACA;AACA;AACA;;AACA,OAAO,SAASD,YAAT,CAAsBE,UAAtB,EAA8C;AAAA,0BACnBA,UAAU,CAACC,KADQ;AAAA,MAC3CC,SAD2C,qBAC3CA,SAD2C;AAAA,MAChCC,QADgC,qBAChCA,QADgC;AAAA,MAE3CC,MAF2C,GAEzBF,SAFyB,CAE3CE,MAF2C;AAAA,MAEnCC,KAFmC,GAEzBH,SAFyB,CAEnCG,KAFmC,EAGnD;;AACA,MAAIN,eAAe,CAACC,UAAD,CAAnB,EAAiC;AAC/B,WAAO,IAAP;AACD,GANkD,CAOnD;AACA;;;AACA,MAAIE,SAAS,CAACI,WAAd,EAA2B;AACzB,QAAMC,MAAM,GAAGJ,QAAQ,CAACK,gBAAT,CAA0BJ,MAAM,CAACK,GAAjC,CAAf;;AACA,QAAI,CAAAF,MAAM,QAAN,YAAAA,MAAM,CAAEG,IAAR,MAAiBb,UAAU,CAACc,IAA5B,IAAoCP,MAAM,CAACQ,QAAP,CAAgBL,MAAhB,CAAxC,EAAiE;AAC/D,aAAO,IAAP;AACD;AACF,GAdkD,CAgBnD;;;AAhBmD,2BAiBbP,UAAU,CAACC,KAjBE;AAAA,MAiB3CY,YAjB2C,sBAiB3CA,YAjB2C;AAAA,MAiB7BC,WAjB6B,sBAiB7BA,WAjB6B;;AAkBnD,MAAID,YAAY,IAAIC,WAApB,EAAiC;AAC/B,WAAOD,YAAY,CAACJ,GAAb,KAAqBK,WAAW,CAACL,GAAjC,IAAwCI,YAAY,CAACH,IAAb,KAAsBb,UAAU,CAACc,IAAhF;AACD;;AACD,SAAO,KAAP;AACD","sourcesContent":["import type { Controller } from '@ali/4ever-cangjie';\nimport InlineCode from '../../mo/models';\nimport { isInlineCode as isOldInlineCode } from '../../oldInlineCode/queries/isInlineCode';\n\n/**\n * 判断选区是否在 InlineCode 内\n * @param controller\n * @returns\n */\nexport function isInlineCode(controller: Controller) {\n  const { selection, document } = controller.value;\n  const { anchor, focus } = selection;\n  // 兼容旧版，根据 common mark 来判断\n  if (isOldInlineCode(controller)) {\n    return true;\n  }\n  // 新版 inline code\n  // collapsed 情况\n  if (selection.isCollapsed) {\n    const inline = document.getClosestInline(anchor.key);\n    if (inline?.type === InlineCode.TYPE && anchor.isInNode(inline)) {\n      return true;\n    }\n  }\n\n  // 选区 expanded 时，若都在同一 inlineCode 内，则返回 true\n  const { anchorInline, focusInline } = controller.value;\n  if (anchorInline && focusInline) {\n    return anchorInline.key === focusInline.key && anchorInline.type === InlineCode.TYPE;\n  }\n  return false;\n}\n"],"file":"isInlineCode.js"}