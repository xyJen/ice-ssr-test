import { Commands } from '@ali/4ever-cangjie';
import InlineCode from "../../mo/models";
import toggleInlineCodeMark from "../../oldInlineCode/commands/toggleInlineCodeMark";
import containsInlineCode from "../utils/hasInlineOrInlineCodeMark";
export default function toggleInlineCode(controller) {
  var value = controller.value;
  var selection = value.selection,
      document = value.document;
  var isCollapsed = selection.isCollapsed;
  if (!selection) return controller; // 选区覆盖的位置为存量旧版 inline code，则取消其 mark

  if (controller.query('isOldInlineCode')) {
    return controller.command(toggleInlineCodeMark);
  }

  var isNewInlineCode = controller.query('isInlineCode'); // 选区在新版 inlineCode 中

  if (isNewInlineCode) {
    return controller.command(Commands.unwrapInline, {
      type: InlineCode.TYPE
    });
  } // expanded 选区 + 不包含任何 inlneCode 元素


  if (!isCollapsed && !isNewInlineCode && !containsInlineCode(controller)) {
    return controller.command(Commands.wrapInline, {
      type: InlineCode.TYPE
    }).command(Commands.moveToEndOfInline);
  }

  return controller;
}
//# sourceMappingURL=toggleInlineCode.js.map