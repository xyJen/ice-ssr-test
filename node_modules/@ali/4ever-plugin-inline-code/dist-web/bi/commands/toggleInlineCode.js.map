{"version":3,"sources":["../../../../src/bi/commands/toggleInlineCode.ts"],"names":["Commands","InlineCode","toggleInlineCodeMark","containsInlineCode","toggleInlineCode","controller","value","selection","document","isCollapsed","query","command","isNewInlineCode","unwrapInline","type","TYPE","wrapInline","moveToEndOfInline"],"mappings":"AAAA,SAAqBA,QAArB,QAAqC,oBAArC;AACA,OAAOC,UAAP;AACA,OAAOC,oBAAP;AACA,OAAOC,kBAAP;AAEA,eAAe,SAASC,gBAAT,CAA0BC,UAA1B,EAA8D;AAAA,MACnEC,KADmE,GACzDD,UADyD,CACnEC,KADmE;AAAA,MAEnEC,SAFmE,GAE3CD,KAF2C,CAEnEC,SAFmE;AAAA,MAExDC,QAFwD,GAE3CF,KAF2C,CAExDE,QAFwD;AAAA,MAGnEC,WAHmE,GAGnDF,SAHmD,CAGnEE,WAHmE;AAI3E,MAAI,CAACF,SAAL,EAAgB,OAAOF,UAAP,CAJ2D,CAM3E;;AACA,MAAIA,UAAU,CAACK,KAAX,CAAiB,iBAAjB,CAAJ,EAAyC;AACvC,WAAOL,UAAU,CAACM,OAAX,CAAmBT,oBAAnB,CAAP;AACD;;AAED,MAAMU,eAAe,GAAGP,UAAU,CAACK,KAAX,CAAiB,cAAjB,CAAxB,CAX2E,CAY3E;;AACA,MAAIE,eAAJ,EAAqB;AACnB,WAAOP,UAAU,CAACM,OAAX,CAAmBX,QAAQ,CAACa,YAA5B,EAA0C;AAAEC,MAAAA,IAAI,EAAEb,UAAU,CAACc;AAAnB,KAA1C,CAAP;AACD,GAf0E,CAiB3E;;;AACA,MAAI,CAACN,WAAD,IAAgB,CAACG,eAAjB,IAAoC,CAACT,kBAAkB,CAACE,UAAD,CAA3D,EAAyE;AACvE,WAAOA,UAAU,CACdM,OADI,CACIX,QAAQ,CAACgB,UADb,EACyB;AAAEF,MAAAA,IAAI,EAAEb,UAAU,CAACc;AAAnB,KADzB,EAEJJ,OAFI,CAEIX,QAAQ,CAACiB,iBAFb,CAAP;AAGD;;AAED,SAAOZ,UAAP;AACD","sourcesContent":["import { Controller, Commands } from '@ali/4ever-cangjie';\nimport InlineCode from '../../mo/models';\nimport toggleInlineCodeMark from '../../oldInlineCode/commands/toggleInlineCodeMark';\nimport containsInlineCode from '../utils/hasInlineOrInlineCodeMark';\n\nexport default function toggleInlineCode(controller: Controller): Controller {\n  const { value } = controller;\n  const { selection, document } = value;\n  const { isCollapsed } = selection;\n  if (!selection) return controller;\n\n  // 选区覆盖的位置为存量旧版 inline code，则取消其 mark\n  if (controller.query('isOldInlineCode')) {\n    return controller.command(toggleInlineCodeMark);\n  }\n\n  const isNewInlineCode = controller.query('isInlineCode');\n  // 选区在新版 inlineCode 中\n  if (isNewInlineCode) {\n    return controller.command(Commands.unwrapInline, { type: InlineCode.TYPE });\n  }\n\n  // expanded 选区 + 不包含任何 inlneCode 元素\n  if (!isCollapsed && !isNewInlineCode && !containsInlineCode(controller)) {\n    return controller\n      .command(Commands.wrapInline, { type: InlineCode.TYPE })\n      .command(Commands.moveToEndOfInline);\n  }\n\n  return controller;\n}\n"],"file":"toggleInlineCode.js"}