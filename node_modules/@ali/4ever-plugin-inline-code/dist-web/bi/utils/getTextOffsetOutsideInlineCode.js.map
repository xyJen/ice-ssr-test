{"version":3,"sources":["../../../../src/bi/utils/getTextOffsetOutsideInlineCode.ts"],"names":["getCurTextNode","InlineCode","getTextOffsetOutsideInlineCode","value","side","selection","document","isExpanded","curTextNode","maybeInlineNode","getNextSibling","key","getPreviousSibling","isInlineCode","anchor","offset"],"mappings":"AACA,OAAOA,cAAP;AACA,OAAOC,UAAP;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,eAAe,SAASC,8BAAT,CACbC,KADa,EAEbC,IAFa,EAGE;AAAA,MACPC,SADO,GACiBF,KADjB,CACPE,SADO;AAAA,MACIC,QADJ,GACiBH,KADjB,CACIG,QADJ;AAEf,MAAI,CAACD,SAAD,IAAcA,SAAS,CAACE,UAA5B,EAAwC,OAAO,IAAP,CAFzB,CAGf;;AACA,MAAMC,WAAW,GAAGR,cAAc,CAACG,KAAD,CAAlC;AACA,MAAI,CAACK,WAAL,EAAkB,OAAO,IAAP,CALH,CAMf;;AACA,MAAMC,eAAe,GACnBL,IAAI,KAAK,MAAT,GACIE,QAAQ,CAACI,cAAT,CAAwBF,WAAW,CAACG,GAApC,CADJ,GAEIL,QAAQ,CAACM,kBAAT,CAA4BJ,WAAW,CAACG,GAAxC,CAHN;;AAIA,MAAIV,UAAU,CAACY,YAAX,CAAwBJ,eAAxB,CAAJ,EAA8C;AAC5C,QAAMK,MAAM,GAAGT,SAAS,CAACS,MAAzB;AACA,WAAOA,MAAM,CAACC,MAAd;AACD;;AACD,SAAO,IAAP;AACD","sourcesContent":["import { Value, TextPoint } from '@ali/4ever-cangjie';\nimport getCurTextNode from './getCurTextNode';\nimport InlineCode from '../../mo/models';\n\n/**\n * 首先判断Text节点的左侧/右侧是否有Inline Code\n * 如果有，则计算光标处于Inline Code左右侧Text节点的偏移量\n * @param value\n * @param side\n * @return\n */\nexport default function getTextOffsetOutsideInlineCode(\n  value: Value,\n  side: 'left' | 'right',\n): number | null {\n  const { selection, document } = value;\n  if (!selection || selection.isExpanded) return null;\n  //若当前选中点为 text 起始，则试探前后一个节点是否为 inline\n  const curTextNode = getCurTextNode(value);\n  if (!curTextNode) return null;\n  // 试探后一个节点是否为Inline Code Node\n  const maybeInlineNode =\n    side === 'left'\n      ? document.getNextSibling(curTextNode.key)\n      : document.getPreviousSibling(curTextNode.key);\n  if (InlineCode.isInlineCode(maybeInlineNode)) {\n    const anchor = selection.anchor as TextPoint;\n    return anchor.offset;\n  }\n  return null;\n}\n"],"file":"getTextOffsetOutsideInlineCode.js"}