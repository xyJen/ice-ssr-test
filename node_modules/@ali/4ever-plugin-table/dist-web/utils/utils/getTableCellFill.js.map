{"version":3,"sources":["../../../../src/utils/utils/getTableCellFill.ts"],"names":["Table","getPositionOfCell","getTabelCellFill","cell","table","docStyle","undefined","cellFill","data","fill","shd","styleId","tblLook","tableStyle","position","key","rowIndex","colIndex","tblStylePr","Array","isArray","i","length","stylePr","isRowHeader","type","firstRow","tcPr","isColumnHeader","firstColumn"],"mappings":"AACA,OAAOA,KAAP;AAEA,OAAOC,iBAAP;AAiBA,eAAe,SAASC,gBAAT,CACbC,IADa,EAEbC,KAFa,EAGbC,QAHa,EAIb;AAAA;;AACA,MAAI,CAACD,KAAL,EAAY,OAAOE,SAAP;AAEZ,MAAMC,QAAQ,GAAG,eAAAJ,IAAI,CAACK,IAAL,gCAAWC,IAAX,qBAAmBN,IAAI,CAACK,IAAxB,wCAAmB,YAAWE,GAA9B,qBAAmB,gBAAgBD,IAAnC,CAAjB;AACA,MAAIF,QAAJ,EAAc,OAAOA,QAAP;AAJd,oBAM6BH,KAAK,CAACI,IANnC;AAAA,MAMQG,OANR,eAMQA,OANR;AAAA,MAMiBC,OANjB,eAMiBA,OANjB;AAQA,MAAI,CAACP,QAAD,IAAa,CAACM,OAAlB,EAA2B,OAAOL,SAAP;AAE3B,MAAMO,UAAU,GAAGR,QAAQ,CAACM,OAAD,CAA3B;AAEA,MAAI,CAACE,UAAL,EAAiB,OAAOP,SAAP;AAEjB,MAAMQ,QAAQ,GAAGb,iBAAiB,CAACE,IAAI,CAACY,GAAN,EAAWX,KAAX,CAAlC;AAEA,MAAI,CAACU,QAAL,EAAe,OAAOR,SAAP;AAhBf,MAkBQU,QAlBR,GAkB+BF,QAlB/B,CAkBQE,QAlBR;AAAA,MAkBkBC,QAlBlB,GAkB+BH,QAlB/B,CAkBkBG,QAlBlB;AAmBA,MAAID,QAAQ,KAAK,CAAb,IAAkBC,QAAQ,KAAK,CAAnC,EAAsC,OAAOX,SAAP;AAEtC,MAAMY,UAAU,GAAGL,UAAH,wCAAGA,UAAU,CAAEL,IAAf,qBAAG,iBAAkBU,UAArC;AAEA,MAAI,CAACC,KAAK,CAACC,OAAN,CAAcF,UAAd,CAAL,EAAgC,OAAOZ,SAAP;AAEhC,MAAIG,IAAJ;;AAEA,OAAK,IAAIY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,UAAU,CAACI,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AAC1C,QAAME,OAAO,GAAGL,UAAU,CAACG,CAAD,CAA1B;;AACA,QACEL,QAAQ,KAAK,CAAb,IACGhB,KAAK,CAACwB,WAAN,CAAkBpB,KAAlB,CADH,IAEGmB,OAAO,CAACE,IAAR,KAAiB,UAFpB,KAGI,CAAAb,OAAO,QAAP,YAAAA,OAAO,CAAEc,QAAT,MAAsBpB,SAAtB,IAAmC,CAAC,EAACM,OAAD,YAACA,OAAO,CAAEc,QAAV,CAHxC,CADF,EAKE;AAAA;;AACAjB,MAAAA,IAAI,oBAAGc,OAAO,CAACI,IAAX,0CAAG,cAAcjB,GAAjB,qBAAG,kBAAmBD,IAA1B;AACA;AACD;;AACD,QACEQ,QAAQ,KAAK,CAAb,IACGjB,KAAK,CAAC4B,cAAN,CAAqBxB,KAArB,CADH,IAEGmB,OAAO,CAACE,IAAR,KAAiB,UAFpB,KAGI,CAAAb,OAAO,QAAP,YAAAA,OAAO,CAAEiB,WAAT,MAAyBvB,SAAzB,IAAsC,CAAC,EAACM,OAAD,YAACA,OAAO,CAAEiB,WAAV,CAH3C,CADF,EAKE;AAAA;;AACApB,MAAAA,IAAI,qBAAGc,OAAO,CAACI,IAAX,2CAAG,eAAcjB,GAAjB,qBAAG,mBAAmBD,IAA1B;AACA;AACD;AACF;;AAED,SAAOA,IAAP;AACD","sourcesContent":["import { DocStyle } from '@ali/4ever-cangjie';\nimport Table from '../../mo/models';\nimport TableCell from '../../mo/models/tableCell';\nimport getPositionOfCell from './getPositionOfCell';\n\ninterface TableStyleProperty {\n  type?: 'firstRow' | 'firstCol';\n  tcPr?: {\n    shd?: {\n      fill?: string;\n    };\n  };\n}\n\ninterface TableStyle {\n  data?: {\n    tblStylePr: TableStyleProperty[];\n  };\n}\n\nexport default function getTabelCellFill(\n  cell: TableCell,\n  table: Table | null,\n  docStyle?: DocStyle,\n) {\n  if (!table) return undefined;\n\n  const cellFill = cell.data?.fill || cell.data?.shd?.fill;\n  if (cellFill) return cellFill;\n\n  const { styleId, tblLook } = table.data;\n\n  if (!docStyle || !styleId) return undefined;\n\n  const tableStyle = docStyle[styleId] as TableStyle;\n\n  if (!tableStyle) return undefined;\n\n  const position = getPositionOfCell(cell.key, table);\n\n  if (!position) return undefined;\n\n  const { rowIndex, colIndex } = position;\n  if (rowIndex !== 0 && colIndex !== 0) return undefined;\n\n  const tblStylePr = tableStyle?.data?.tblStylePr;\n\n  if (!Array.isArray(tblStylePr)) return undefined;\n\n  let fill: string | undefined;\n\n  for (let i = 0; i < tblStylePr.length; i++) {\n    const stylePr = tblStylePr[i];\n    if (\n      rowIndex === 0\n      && Table.isRowHeader(table)\n      && stylePr.type === 'firstRow'\n      && (tblLook?.firstRow === undefined || !!tblLook?.firstRow)\n    ) {\n      fill = stylePr.tcPr?.shd?.fill;\n      break;\n    }\n    if (\n      colIndex === 0\n      && Table.isColumnHeader(table)\n      && stylePr.type === 'firstCol'\n      && (tblLook?.firstColumn === undefined || !!tblLook?.firstColumn)\n    ) {\n      fill = stylePr.tcPr?.shd?.fill;\n      break;\n    }\n  }\n\n  return fill;\n}\n"],"file":"getTableCellFill.js"}