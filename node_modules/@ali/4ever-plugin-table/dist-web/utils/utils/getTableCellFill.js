import Table from "../../mo/models";
import getPositionOfCell from "./getPositionOfCell";
export default function getTabelCellFill(cell, table, docStyle) {
  var _cell$data, _cell$data2, _cell$data2$shd, _tableStyle$data;

  if (!table) return undefined;
  var cellFill = ((_cell$data = cell.data) == null ? void 0 : _cell$data.fill) || ((_cell$data2 = cell.data) == null ? void 0 : (_cell$data2$shd = _cell$data2.shd) == null ? void 0 : _cell$data2$shd.fill);
  if (cellFill) return cellFill;
  var _table$data = table.data,
      styleId = _table$data.styleId,
      tblLook = _table$data.tblLook;
  if (!docStyle || !styleId) return undefined;
  var tableStyle = docStyle[styleId];
  if (!tableStyle) return undefined;
  var position = getPositionOfCell(cell.key, table);
  if (!position) return undefined;
  var rowIndex = position.rowIndex,
      colIndex = position.colIndex;
  if (rowIndex !== 0 && colIndex !== 0) return undefined;
  var tblStylePr = tableStyle == null ? void 0 : (_tableStyle$data = tableStyle.data) == null ? void 0 : _tableStyle$data.tblStylePr;
  if (!Array.isArray(tblStylePr)) return undefined;
  var fill;

  for (var i = 0; i < tblStylePr.length; i++) {
    var stylePr = tblStylePr[i];

    if (rowIndex === 0 && Table.isRowHeader(table) && stylePr.type === 'firstRow' && ((tblLook == null ? void 0 : tblLook.firstRow) === undefined || !!(tblLook != null && tblLook.firstRow))) {
      var _stylePr$tcPr, _stylePr$tcPr$shd;

      fill = (_stylePr$tcPr = stylePr.tcPr) == null ? void 0 : (_stylePr$tcPr$shd = _stylePr$tcPr.shd) == null ? void 0 : _stylePr$tcPr$shd.fill;
      break;
    }

    if (colIndex === 0 && Table.isColumnHeader(table) && stylePr.type === 'firstCol' && ((tblLook == null ? void 0 : tblLook.firstColumn) === undefined || !!(tblLook != null && tblLook.firstColumn))) {
      var _stylePr$tcPr2, _stylePr$tcPr2$shd;

      fill = (_stylePr$tcPr2 = stylePr.tcPr) == null ? void 0 : (_stylePr$tcPr2$shd = _stylePr$tcPr2.shd) == null ? void 0 : _stylePr$tcPr2$shd.fill;
      break;
    }
  }

  return fill;
}
//# sourceMappingURL=getTableCellFill.js.map