{"version":3,"sources":["../../../../../src/bi/components/toolbarButtons/tableFillButton.tsx"],"names":["React","ColorPicker","EColorPickerIcon","TableRole","PluginRoles","setTableCellFill","getTable","getTableSelection","setColorPanelMode","TableFillButton","props","controller","locale","rest","value","table","selection","color","startRowIndex","startColIndex","tablePath","document","getPath","key","cellPath","cell","getNodeByPath","payload","data","fill","undefined","onChange","run","getColorPanelMode","useCallback","query","mode","handleSelectValueChange","fillColor","tipText","backgroundsheet","tableFillColor"],"mappings":";;AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;qBAC4B,a;AAC5B,SAASC,WAAT,EAAsBC,gBAAtB,QAA+D,iBAA/D;AACA,SAASC,SAAS,IAAIC,WAAtB;AAEA,SAASC,gBAAT;AACA,OAAOC,QAAP;AACA,OAAOC,iBAAP;AACA,SAASC,iBAAT,QAAkC,wBAAlC;AAEA,eAAe,SAASC,eAAT,CAAyBC,KAAzB,EAAgC;AAAA;;AAAA,MACrCC,UADqC,GACLD,KADK,CACrCC,UADqC;AAAA,MACzBC,MADyB,GACLF,KADK,CACzBE,MADyB;AAAA,MACdC,IADc,iCACLH,KADK;;AAAA,aAE3BC,UAF2B;AAAA,MAErCG,KAFqC,QAErCA,KAFqC;AAG7C,MAAMC,KAAK,GAAGT,QAAQ,CAACQ,KAAD,CAAtB;AACA,MAAME,SAAS,GAAGT,iBAAiB,CAACI,UAAD,CAAnC;AAEA,MAAIM,KAAJ;;AACA,MAAID,SAAJ,EAAe;AAAA,QACLE,aADK,GAC4BF,SAD5B,CACLE,aADK;AAAA,QACUC,aADV,GAC4BH,SAD5B,CACUG,aADV;AAGb,QAAMC,SAAS,GAAGN,KAAK,CAACO,QAAN,CAAeC,OAAf,CAAuBP,KAAK,CAACQ,GAA7B,CAAlB;AACA,QAAMC,QAAQ,aAAOJ,SAAP,GAAkBF,aAAlB,EAAiCC,aAAjC,EAAd;AACA,QAAMM,IAAI,GAAGX,KAAK,CAACO,QAAN,CAAeK,aAAf,CAA6BF,QAA7B,CAAb;;AACA,QAAIC,IAAJ,EAAU;AACR,UAAME,OAAO,GAAGF,IAAI,CAACG,IAArB;AACAX,MAAAA,KAAK,GAAGU,OAAO,IAAIA,OAAO,CAACE,IAA3B;AACD;AACF,GAjB4C,CAkB7C;;;AACAZ,EAAAA,KAAK,GAAGA,KAAK,KAAKa,SAAV,GAAsB,SAAtB,GAAkCb,KAA1C;;AAEA,MAAMc,QAAQ,GAAG,SAAXA,QAAW,CAACF,IAAD,EAAkB;AACjClB,IAAAA,UAAU,CAACqB,GAAX,CAAe,UAAf,EAA2B3B,gBAAgB,CAACU,KAAD,EAAQC,SAAR,EAAmBa,IAAnB,CAA3C;AACD,GAFD;;AAIA,MAAMI,iBAAiB,GACrBjC,KAAK,CAACkC,WAAN,CAAkB;AAAA;;AAAA,gCAAMvB,UAAU,CAACwB,KAAX,CAAiB,mBAAjB,CAAN,qBAAM,kBAAuCC,IAA7C;AAAA,GAAlB,EAAqE,CAACzB,UAAD,CAArE,CADF;AAGA,MAAM0B,uBAAuB,GAAGrC,KAAK,CAACkC,WAAN,CAAkB,UAACE,IAAD,EAA2B;AAC3EzB,IAAAA,UAAU,CAACqB,GAAX,CAAe,UAAf,EAA2BxB,iBAAiB,CAAC;AAAE4B,MAAAA,IAAI,EAAJA;AAAF,KAAD,CAA5C;AACD,GAF+B,EAE7B,CAACzB,UAAD,CAF6B,CAAhC;AAIA,sBACE,eAAC,WAAD,eACME,IADN;AAEE,IAAA,OAAO,uBAAED,MAAM,CAAC0B,SAAT,qBAAE,kBAAkBC,OAF7B;AAGE,IAAA,MAAM,EAAC,uBAHT;AAIE,IAAA,KAAK,EAAEtB,KAJT;AAKE,IAAA,cAAc,EAAC,EALjB;AAME,IAAA,UAAU,EAAC,EANb;AAOE,IAAA,aAAa,EAAEc,QAPjB;AAQE,IAAA,OAAO,EAAE7B,gBAAgB,CAACsC,eAR5B;AASE,IAAA,IAAI,EAAEpC,WAAW,CAACqC,cATpB;AAUE,IAAA,gBAAgB,MAVlB;AAWE,IAAA,iBAAiB,EAAER,iBAXrB;AAYE,IAAA,mBAAmB,EAAEI;AAZvB,KADF;AAgBD","sourcesContent":["import * as React from 'react';\nimport { Controller, Block } from '@ali/4ever-cangjie';\nimport { ColorPicker, EColorPickerIcon, EColorPanelMode } from '@ali/we-toolbar';\nimport { TableRole as PluginRoles } from '../../../utils/role';\n\nimport { setTableCellFill } from '../../actions';\nimport getTable from '../../utils/getTable';\nimport getTableSelection from '../../utils/getTableSelection';\nimport { setColorPanelMode } from '@ali/4ever-plugin-pref';\n\nexport default function TableFillButton(props) {\n  const { controller, locale, ...rest } = props;\n  const { value } = controller as Controller;\n  const table = getTable(value)!;\n  const selection = getTableSelection(controller);\n\n  let color;\n  if (selection) {\n    const { startRowIndex, startColIndex } = selection;\n\n    const tablePath = value.document.getPath(table.key)!;\n    const cellPath = [...tablePath, startRowIndex, startColIndex];\n    const cell = value.document.getNodeByPath(cellPath) as Block;\n    if (cell) {\n      const payload = cell.data;\n      color = payload && payload.fill;\n    }\n  }\n  // DEFAULT COLOR\n  color = color === undefined ? '#FDBE3D' : color;\n\n  const onChange = (fill: string) => {\n    controller.run('onAction', setTableCellFill(table, selection, fill));\n  };\n\n  const getColorPanelMode =\n    React.useCallback(() => controller.query('getColorPanelMode')?.mode, [controller]);\n\n  const handleSelectValueChange = React.useCallback((mode: EColorPanelMode) => {\n    controller.run('onAction', setColorPanelMode({ mode }));\n  }, [controller]);\n\n  return (\n    <ColorPicker\n      {...rest}\n      tooltip={locale.fillColor?.tipText}\n      testid=\"bi-toolbar-table-fill\"\n      color={color}\n      automaticColor=\"\"\n      clearColor=\"\"\n      onColorPicker={onChange}\n      btnType={EColorPickerIcon.backgroundsheet}\n      role={PluginRoles.tableFillColor}\n      showToggleSelect\n      getColorPanelMode={getColorPanelMode}\n      onSelectValueChange={handleSelectValueChange}\n    />\n  );\n}\n"],"file":"tableFillButton.js"}