{"version":3,"sources":["../../../../../src/bi/components/cornerToolbar/index.tsx"],"names":["React","styled","Commands","Table","AdaptNormal","SelectedNormalNormal","Switch","TOOLBAR_ITEM_SIZE","resizeTableWidthFitContainer","setTableAutofitWidthEnable","setTableAutofitWidthDisable","selectTable","removeTableRowHeader","setTableRowHeader","removeTableColHeader","setTableColHeader","TYPE_MENU_ITEM","TYPE_SUB_MENU","MenuTitleWithNewBadge","DragDropdown","TableHeaderIcon","constants","hooks","MENU_ITEM_WHITE_LIST","useRowIsSticky","useScrollableContainerRect","REALTABLE_PADDING","STICKY_ROW_TOP_HEIGHT","STICKY_TOOLBAR_INDEX_MAP","ICON_SIZE","GAP_X","GAP_Y","LEFT_OFFSET","CornerToolbar","div","props","Math","round","scale","top","TableCornerToolbar","controller","visible","locale","table","isSelectWholeTable","onSelect","onMouseEnter","onMouseLeave","draggableConfig","enableAutofitWidth","enableHeader","setTableHeaderStyle","isSticky","scrollRect","timer","useRef","handleStopPropagation","useCallback","event","stopPropagation","isAutofit","isAutofitWidth","handleAutoFit","run","handleMouseOver","e","current","clearTimeout","handleMouseLeave","setTimeout","useEffect","handleToggleRowHeader","_","preventDefault","selection","value","isRowHeader","command","select","handleToggleColHeader","isColumnHeader","customizeMenus","useMemo","menus","push","type","testid","title","widthFitContainer","icon","menuKey","hoverable","autoClose","extra","onClick","tableHeader","rowHeader","columnHeader","style","display","ret","position","zIndex","cornerToolbar","left","Number","isFinite","transform","handleMenuItemClick","setMenuVisible","canMenuVisible","includes"],"mappings":"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","sourcesContent":["/* eslint-disable react/no-unused-prop-types */\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BiPluginConfig, Commands, Controller } from '@ali/4ever-cangjie';\nimport Table from '../../../mo/models';\nimport { AdaptNormal, SelectedNormalNormal } from '@ali/we-icon';\nimport { Switch } from '@ali/we-design';\nimport { TOOLBAR_ITEM_SIZE } from '../../constants';\nimport {\n  resizeTableWidthFitContainer,\n  setTableAutofitWidthEnable,\n  setTableAutofitWidthDisable,\n  selectTable,\n  removeTableRowHeader,\n  setTableRowHeader,\n  removeTableColHeader,\n  setTableColHeader,\n} from '../../actions';\nimport { TYPE_MENU_ITEM, TYPE_SUB_MENU } from '@ali/4ever-component';\nimport { MenuTitleWithNewBadge } from '@ali/4ever-component';\nimport { DragDropdown } from '@ali/4ever-plugin-draggable'\nimport TableHeaderIcon from './tableHeaderIcon';\nimport constants from '../../../utils/constants';\nimport * as hooks from '../../../utils/hooks';\n\n// menu 菜单点击后不需要关闭的menuKey选项白名单\nconst MENU_ITEM_WHITE_LIST = ['table-autofit'];\n\nconst { useRowIsSticky, useScrollableContainerRect } = hooks;\nconst {\n  REALTABLE_PADDING,\n  STICKY_ROW_TOP_HEIGHT,\n  STICKY_TOOLBAR_INDEX_MAP,\n} = constants;\n\nconst ICON_SIZE = 16;\nconst GAP_X = 8;\nconst GAP_Y = 8;\n\nconst LEFT_OFFSET = -(ICON_SIZE + GAP_X);\n\nconst CornerToolbar = styled.div<{ scale: number }>`\n  box-sizing: border-box;\n  position: absolute;\n  cursor: default;\n  color: transparent;\n  width: ${(props) => Math.round(ICON_SIZE / props.scale)}px;\n  height: ${(props) => Math.round(ICON_SIZE / props.scale)}px;\n  top: -${(props) => (GAP_Y + ICON_SIZE - TOOLBAR_ITEM_SIZE - REALTABLE_PADDING.top) / props.scale}px;\n  left: ${(props) => Math.round(LEFT_OFFSET / props.scale)}px;\n  line-height: 0;\n  font-size: ${ICON_SIZE}px;\n  z-index: 1;\n  transform-origin: left top;\n\n  * {\n    box-sizing: border-box;\n  }\n`;\n\ninterface TableCornerToolbarProps {\n  controller: Controller;\n  visible: boolean;\n  table: Table;\n  scale: number;\n  locale: any;\n  isSelectWholeTable: boolean;\n  onSelect: () => void;\n  onToolbarEvent: (command: string) => void;\n  realTableWrapperRef?: React.RefObject<HTMLDivElement | null>;\n  zoomContainer?: HTMLElement;\n  getLastActiveTableKey?: () => string | null;\n  setIsHighlightSelection?: (isHighlight: boolean) => void;\n  hideWidthFitButton?: boolean;\n  draggableConfig?: BiPluginConfig['draggable'];\n  onMouseEnter: () => void;\n  onMouseLeave: () => void;\n  enableAutofitWidth?: () => boolean;\n  enableHeader?: () => boolean;\n  setTableHeaderStyle?: () => void;\n}\n\nconst TableCornerToolbar = (props: TableCornerToolbarProps) => {\n  const {\n    controller,\n    visible,\n    locale,\n    table,\n    scale,\n    isSelectWholeTable,\n    onSelect,\n    onMouseEnter,\n    onMouseLeave,\n    draggableConfig,\n    enableAutofitWidth,\n    enableHeader,\n    setTableHeaderStyle,\n  } = props;\n\n  const [isSticky] = useRowIsSticky();\n  const [scrollRect] = useScrollableContainerRect();\n\n  const timer = React.useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  const handleStopPropagation = React.useCallback(\n    (event: React.MouseEvent | React.TouchEvent) => {\n      event.stopPropagation();\n    },\n    [],\n  );\n  const isAutofit = Table.isAutofitWidth(table);\n\n  const handleAutoFit = React.useCallback(() => {\n    // 无论是否命中灰度，只要是自适应\n    if (isAutofit) {\n      controller.run('onAction', setTableAutofitWidthDisable(table));\n    } else if (enableAutofitWidth && enableAutofitWidth()) {\n      controller.run('onAction', setTableAutofitWidthEnable(table));\n    } else {\n      controller.run('onAction', resizeTableWidthFitContainer(table));\n    }\n    controller.run('onAction', selectTable(table));\n  }, [isAutofit, enableAutofitWidth, controller, table]);\n\n  const handleMouseOver = React.useCallback(\n    (e: React.MouseEvent) => {\n      handleStopPropagation(e);\n      if (timer && timer.current) {\n        clearTimeout(timer.current);\n        timer.current = null;\n      }\n      onMouseEnter();\n    },\n    [onMouseEnter, handleStopPropagation],\n  );\n\n  const handleMouseLeave = React.useCallback(\n    (e: React.MouseEvent) => {\n      handleStopPropagation(e);\n      timer.current = setTimeout(() => {\n        onMouseLeave();\n      }, 200);\n    },\n    [onMouseLeave, handleStopPropagation],\n  );\n\n  React.useEffect(() => {\n    if (timer && timer.current) {\n      clearTimeout(timer.current);\n    }\n  }, []);\n\n  const handleToggleRowHeader = React.useCallback((_, e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const { selection } = controller.value;\n    if (Table.isRowHeader(table)) {\n      controller.run('onAction', removeTableRowHeader(table));\n    } else {\n      // NOTE: 需要先执行 setTableHeaderStyle\n      setTableHeaderStyle?.();\n      controller.run('onAction', setTableRowHeader(table));\n    }\n    controller.command(Commands.select, selection);\n  }, [controller, table, setTableHeaderStyle]);\n\n  const handleToggleColHeader = React.useCallback(() => {\n    const { selection } = controller.value;\n    if (Table.isColumnHeader(table)) {\n      controller.run('onAction', removeTableColHeader(table));\n    } else {\n      // NOTE: 需要先执行 setTableHeaderStyle\n      setTableHeaderStyle?.();\n      controller.run('onAction', setTableColHeader(table));\n    }\n    controller.command(Commands.select, selection);\n  }, [controller, table, setTableHeaderStyle]);\n\n  const customizeMenus = React.useMemo(() => {\n    const menus: Array<Record<string, any>> = [];\n    if ((enableAutofitWidth && enableAutofitWidth()) || isAutofit) {\n      menus.push({\n        type: TYPE_MENU_ITEM,\n        testid: 'table-autofit-menu-item',\n        title: locale?.widthFitContainer,\n        icon: <AdaptNormal />,\n        menuKey: 'table-autofit',\n        hoverable: false,\n        autoClose: false,\n        extra: (\n          <Switch\n            testid=\"table-autofit-switch\"\n            checked={isAutofit}\n            size=\"small\"\n            onChange={handleAutoFit}\n          />\n        ),\n      });\n    } else {\n      menus.push({\n        type: TYPE_MENU_ITEM,\n        title: locale?.widthFitContainer,\n        icon: <AdaptNormal />,\n        onClick: handleAutoFit,\n      });\n    }\n    if (enableHeader && enableHeader()) {\n      menus.push({\n        type: TYPE_SUB_MENU,\n        testid: 'table-header-sub-menu',\n        title: <MenuTitleWithNewBadge title={locale?.tableHeader} />,\n        icon: <TableHeaderIcon />,\n        menus: [\n          {\n            type: TYPE_MENU_ITEM,\n            testid: 'table-header-row-menu-item',\n            title: locale?.rowHeader,\n            extra: Table.isRowHeader(table) ? (\n              <SelectedNormalNormal pathColors={['#171A1D']} />\n            ) : null,\n            onClick: handleToggleRowHeader,\n            menuKey: 'table-header-row',\n          },\n          {\n            type: TYPE_MENU_ITEM,\n            testid: 'table-header-column-menu-item',\n            title: locale?.columnHeader,\n            extra: Table.isColumnHeader(table) ? (\n              <SelectedNormalNormal pathColors={['#171A1D']} />\n            ) : null,\n            onClick: handleToggleColHeader,\n            menuKey: 'table-header-col',\n          },\n        ],\n      });\n    }\n\n    return menus;\n  }, [\n    enableAutofitWidth,\n    enableHeader,\n    handleAutoFit,\n    handleToggleColHeader,\n    handleToggleRowHeader,\n    isAutofit,\n    locale?.columnHeader,\n    locale?.rowHeader,\n    locale?.tableHeader,\n    locale?.widthFitContainer,\n    table,\n  ]);\n\n  const style: React.CSSProperties = React.useMemo(() => {\n    if (!visible) {\n      return { display: 'none' };\n    }\n\n    const ret: React.CSSProperties = {\n      display: 'block',\n    };\n\n    if (isSticky) {\n      ret.position = 'fixed';\n      ret.top = STICKY_ROW_TOP_HEIGHT + scrollRect.top - GAP_Y - ICON_SIZE;\n      ret.zIndex = STICKY_TOOLBAR_INDEX_MAP.cornerToolbar;\n      ret.left = Number.isFinite(scrollRect.left)\n        ? scrollRect.left\n        : 'unset';\n      ret.transform = `translateX(${LEFT_OFFSET}px)`;\n    }\n\n    return ret;\n  }, [isSticky, scrollRect, visible]);\n\n  const handleMenuItemClick = React.useCallback(\n    (menuKey: string, setMenuVisible: (state: boolean) => void) => {\n      const canMenuVisible = MENU_ITEM_WHITE_LIST.includes(menuKey);\n      if (!canMenuVisible) {\n        setMenuVisible(false);\n      }\n      onMouseLeave();\n    },\n    [onMouseLeave],\n  );\n\n  return (\n    <CornerToolbar\n      style={style}\n      role=\"toolbar\"\n      data-testid=\"table-corner-toobar-button\"\n      data-sticky={isSticky}\n      scale={scale}\n      onMouseLeave={handleMouseLeave}\n      onMouseOver={handleMouseOver}\n      onContextMenu={handleStopPropagation}\n      onMouseDown={handleStopPropagation}\n      onTouchStart={handleStopPropagation}\n      onMouseUp={handleStopPropagation} // \b防止触发 Cangjie 选区事件\n    >\n      <div>\n        <DragDropdown\n          controller={controller}\n          currentBlock={table}\n          draggableConfig={draggableConfig}\n          scale={scale}\n          // @ts-ignore\n          customizeMenus={customizeMenus}\n          handleClickMenuItem={handleMenuItemClick}\n          active={isSelectWholeTable}\n          onClickIcon={onSelect}\n        />\n      </div>\n    </CornerToolbar>\n  );\n};\n\nexport default TableCornerToolbar;\n"],"file":"index.js"}