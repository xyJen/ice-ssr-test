import { getClosestContainerBlock, getInnerFullWidth } from '@ali/4ever-utils';
import { MIN_COL_WIDTH } from "../constants";
import { DEFAULT_PCT_WIDTH } from "../../utils/constants";

function createColsWidth(colSize, containerWidth) {
  var colsWidth = [];
  var colWidth = Math.max(MIN_COL_WIDTH, Math.floor(containerWidth / colSize));

  for (var i = 0; i < colSize; i += 1) {
    colsWidth.push(colWidth);
  }

  return colsWidth;
}

function createAutofitColsWidth(colSize) {
  var colWidth = Number((DEFAULT_PCT_WIDTH / colSize).toFixed(1));
  var colsWidth = Array(colSize).fill(colWidth);
  colsWidth[colSize - 1] = DEFAULT_PCT_WIDTH - colWidth * (colSize - 1);
  return colsWidth;
}

export default function createTableData(controller, _ref) {
  var colSize = _ref.colSize,
      containerWidth = _ref.containerWidth,
      defaultAutofit = _ref.defaultAutofit;
  var tableData = {};

  if (defaultAutofit) {
    tableData.colsWidth = createAutofitColsWidth(colSize);
    tableData.tblW = {
      w: DEFAULT_PCT_WIDTH,
      type: 'pct'
    };
  } else {
    var width = containerWidth;

    if (!containerWidth) {
      var containerBlock = getClosestContainerBlock(controller.value);
      var document = controller.value.document;
      width = getInnerFullWidth(containerBlock, document) || 0;
    }

    tableData.colsWidth = createColsWidth(colSize, width - 2);
  }

  return tableData;
}
//# sourceMappingURL=createTableData.js.map