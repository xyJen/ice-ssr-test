{"version":3,"sources":["../../../../src/bi/utils/isSelectionInTableCell.ts"],"names":["Table","isTableCell","isSelectionInTableCell","value","configs","document","selection","sort","start","end","isEdgePoint","startCell","getClosest","key","endCell","excludeColumns","parentTable","isTable","data","sr"],"mappings":"AACA,OAAOA,KAAP;AACA,SAASC,WAAT;AAOA,eAAe,SAASC,sBAAT,CACbC,KADa,EAEbC,OAFa,EAGb;AAAA,MACQC,QADR,GACgCF,KADhC,CACQE,QADR;AAAA,MACkBC,SADlB,GACgCH,KADhC,CACkBG,SADlB;;AAEA,MAAI,CAACA,SAAL,EAAgB;AACd,WAAO,KAAP;AACD;;AAJD,wBAKuBA,SAAS,CAACC,IAAV,CAAeF,QAAf,CALvB;AAAA,MAKQG,KALR,mBAKQA,KALR;AAAA,MAKeC,GALf,mBAKeA,GALf;;AAMA,MAAID,KAAK,CAACE,WAAN,MAAuBD,GAAG,CAACC,WAAJ,EAA3B,EAA8C;AAC5C,WAAO,KAAP;AACD;;AACD,MAAMC,SAAS,GAAGN,QAAQ,CAACO,UAAT,CAAoBJ,KAAK,CAACK,GAA1B,EAA+BZ,WAA/B,CAAlB;;AACA,MAAI,CAACU,SAAL,EAAgB;AACd,WAAO,KAAP;AACD;;AACD,MAAMG,OAAO,GAAGT,QAAQ,CAACO,UAAT,CAAoBH,GAAG,CAACI,GAAxB,EAA6BZ,WAA7B,CAAhB;;AACA,MAAI,CAACa,OAAL,EAAc;AACZ,WAAO,KAAP;AACD;;AACD,MAAIV,OAAJ,YAAIA,OAAO,CAAEW,cAAb,EAA6B;AAC3B,QAAMC,WAAW,GAAGX,QAAQ,CAACO,UAAT,CAAoBJ,KAAK,CAACK,GAA1B,EAA+Bb,KAAK,CAACiB,OAArC,CAApB;;AAGA,QAAID,WAAW,IAAIA,WAAW,CAACE,IAAZ,CAAiBC,EAApC,EAAwC;AACtC,aAAO,KAAP;AACD;AACF;;AACD,SAAOR,SAAS,KAAKG,OAArB;AACD","sourcesContent":["import { Value } from '@ali/4ever-cangjie';\nimport Table from '../../mo/models';\nimport { isTableCell } from '../types';\n\nexport type Configs = {\n  // 排除特殊的表格 - 分栏\n  excludeColumns: boolean;\n};\n\nexport default function isSelectionInTableCell(\n  value: Value,\n  configs?: Configs,\n) {\n  const { document, selection } = value;\n  if (!selection) {\n    return false;\n  }\n  const { start, end } = selection.sort(document);\n  if (start.isEdgePoint() || end.isEdgePoint()) {\n    return false;\n  }\n  const startCell = document.getClosest(start.key, isTableCell);\n  if (!startCell) {\n    return false;\n  }\n  const endCell = document.getClosest(end.key, isTableCell);\n  if (!endCell) {\n    return false;\n  }\n  if (configs?.excludeColumns) {\n    const parentTable = document.getClosest(start.key, Table.isTable) as\n      | Table\n      | undefined;\n    if (parentTable && parentTable.data.sr) {\n      return false;\n    }\n  }\n  return startCell === endCell;\n}\n"],"file":"isSelectionInTableCell.js"}