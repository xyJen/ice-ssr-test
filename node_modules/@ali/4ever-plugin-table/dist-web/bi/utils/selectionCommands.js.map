{"version":3,"sources":["../../../../src/bi/utils/selectionCommands.ts"],"names":["Commands","getRealNodeInTable","setSelectionByTable","moveToStartOfPreviousSibling","controller","table","prevBlock","value","document","getPreviousSibling","key","selection","s","moveToStartOfNode","command","select","moveToStartOfNextSibling","nextBlock","getNextSibling","moveToEndOfNode","moveToBeforeOfTable","moveToAfterOfTable","moveToStartOfCell","rowIndex","colIndex","maxRowIndex","nodes","length","rowI","Math","min","max","maxColIndex","colI","cell"],"mappings":"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","sourcesContent":["import { Commands, Controller } from '@ali/4ever-cangjie';\nimport Table from '../../mo/models';\nimport getRealNodeInTable from './getRealNodeInTable';\nimport setSelectionByTable from '../../utils/utils/setSelectionByTable';\n\nexport function moveToStartOfPreviousSibling(controller: Controller, table: Table) {\n  const prevBlock = controller.value.document.getPreviousSibling(table.key);\n  const { selection } = controller.value;\n  let s = selection.moveToStartOfNode(table, controller);\n  if (prevBlock) {\n    s = selection.moveToStartOfNode(prevBlock, controller);\n  }\n  return controller.command(\n    Commands.select,\n    setSelectionByTable(s, false),\n  );\n}\n\nexport function moveToStartOfNextSibling(controller: Controller, table: Table) {\n  const nextBlock = controller.value.document.getNextSibling(table.key);\n  const { selection } = controller.value;\n  let s = selection.moveToEndOfNode(table, controller);\n  if (nextBlock) {\n    s = selection.moveToStartOfNode(nextBlock, controller);\n  }\n  return controller.command(\n    Commands.select,\n    setSelectionByTable(s, false),\n  );\n}\n\nexport function moveToBeforeOfTable(controller: Controller, table: Table) {\n  const { selection } = controller.value;\n  const s = selection.moveToStartOfNode(table, controller);\n  return controller.command(\n    Commands.select,\n    setSelectionByTable(s, false),\n  );\n}\n\nexport function moveToAfterOfTable(controller: Controller, table: Table) {\n  const { selection } = controller.value;\n  const s = selection.moveToEndOfNode(table, controller);\n  return controller.command(\n    Commands.select,\n    setSelectionByTable(s, false),\n  );\n}\n\nexport function moveToStartOfCell(controller: Controller, table: Table, rowIndex: number, colIndex: number) {\n  const maxRowIndex = table.nodes.length - 1;\n  const rowI = Math.min(maxRowIndex, Math.max(0, rowIndex));\n  const maxColIndex = table.nodes[rowI].nodes.length - 1;\n  const colI = Math.min(maxColIndex, Math.max(0, colIndex));\n\n  const cell = getRealNodeInTable(table, rowI, colI);\n  if (!cell) return controller;\n\n  const { selection } = controller.value;\n  const s = selection.moveToStartOfNode(cell, controller);\n  return controller.command(\n    Commands.select,\n    setSelectionByTable(s, false),\n  );\n}\n"],"file":"selectionCommands.js"}