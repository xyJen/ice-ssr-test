{"version":3,"sources":["../../../../../../../src/bi/mobile/components/floatToolbar/utils/createToolbarLayout.tsx"],"names":["React","ContextMenu","Table","emptyTableSelection","selectTableSelection","deleteTableCols","deleteTableRows","insertTableCol","insertTableRowBySelections","DeleteColIcon","DeleteRowIcon","InsertColLeftIcon","InsertColRightIcon","InsertRowAboveIcon","InsertRowBelowIcon","CopyIcon","CutIcon","PasteIcon","ClearIcon","DEFAULT_TOTAL_WIDTH_FOR_AUTOFIT","KeyEnum","createToolbarLayout","params","controller","table","type","hideToolbar","tableSelection","locale","isAutofit","isAutofitWidth","containerWidth","undefined","handleClick","callback","handleCopy","run","ACTION_COPY","handleCut","ACTION_CUT","handlePaste","ACTION_PASTE","handleClear","defaultLayout","key","copy","icon","title","contextMenuCopy","onClick","cut","contextMenuCut","paste","contextMenuPaste","clear","mobileFloatToolbar","endColIndex","colsWidth","data","targetColIndex","rightColWidth","leftColWidth","startColIndex","getNewTable","value","document","getNode","handleInsertRowAbove","newTblSelection","startRowIndex","endRowIndex","handleInsertRowBelow","handleDeleteRow","handleInsertColLeft","handleInsertColRight","handleDeleteCol","appendLayout","insertRowAbove","insertRowBelow","deleteRow","toolbarDeleteRow","insertColLeft","insertColRight","deleteCol","toolbarDeleteCol"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { ContextMenu, Controller } from '@ali/4ever-cangjie';\nimport { LayoutConfig } from '../basic';\nimport { ITableSelection, TableConfig } from '../../../../types';\nimport Table from '../../../../../mo/models';\nimport { emptyTableSelection, selectTableSelection } from '../../../../commands';\nimport {\n  deleteTableCols,\n  deleteTableRows,\n  insertTableCol,\n  insertTableRowBySelections,\n} from '../../../../actions';\nimport {\n  DeleteColIcon,\n  DeleteRowIcon,\n  InsertColLeftIcon,\n  InsertColRightIcon,\n  InsertRowAboveIcon,\n  InsertRowBelowIcon,\n  CopyIcon,\n  CutIcon,\n  PasteIcon,\n  ClearIcon,\n} from '../icons';\nimport { DEFAULT_TOTAL_WIDTH_FOR_AUTOFIT } from '../../../../../utils/constants';\n\nenum KeyEnum {\n  copy = 'copy',\n  cut = 'cut',\n  paste = 'paste',\n  clear = 'clear',\n  insertRowAbove = 'insertRowAbove',\n  insertRowBelow = 'insertRowBelow',\n  deleteRow = 'deleteRow',\n  insertColLeft = 'insertColLeft',\n  insertColRight = 'insertColRight',\n  deleteCol = 'deleteCol',\n}\n\ntype TableLayoutConfig = Omit<LayoutConfig, 'key'> & {\n  key: KeyEnum;\n};\n\ntype LayoutFactory = (params: {\n  controller: Controller;\n  table: Table;\n  type: 'row' | 'col';\n  hideToolbar: Function;\n  tableSelection: ITableSelection;\n  locale: TableConfig['locale'];\n}) => TableLayoutConfig[];\n\nexport const createToolbarLayout: LayoutFactory = (params) => {\n  const { controller, table, type, hideToolbar, tableSelection, locale } = params;\n  const isAutofit = Table.isAutofitWidth(table);\n  const containerWidth = isAutofit ? DEFAULT_TOTAL_WIDTH_FOR_AUTOFIT : undefined;\n  const handleClick = (callback: Function) => () => {\n    callback();\n    hideToolbar();\n  };\n  const handleCopy = () => {\n    controller.run('onAction', { type: ContextMenu.ACTION_COPY });\n  };\n  const handleCut = () => {\n    controller.run('onAction', { type: ContextMenu.ACTION_CUT });\n  };\n  const handlePaste = () => {\n    controller.run('onAction', { type: ContextMenu.ACTION_PASTE });\n  };\n  const handleClear = () => {\n    return emptyTableSelection(controller, table);\n  };\n  const defaultLayout = [{\n    key: KeyEnum.copy,\n    icon: <CopyIcon />,\n    title: locale?.contextMenuCopy,\n    onClick: handleClick(handleCopy),\n  }, {\n    key: KeyEnum.cut,\n    icon: <CutIcon />,\n    title: locale?.contextMenuCut,\n    onClick: handleClick(handleCut),\n  }, {\n    key: KeyEnum.paste,\n    icon: <PasteIcon />,\n    title: locale?.contextMenuPaste,\n    onClick: handleClick(handlePaste),\n  }, {\n    key: KeyEnum.clear,\n    icon: <ClearIcon />,\n    title: locale?.mobileFloatToolbar?.clear,\n    onClick: handleClick(handleClear),\n  }];\n\n  const { endColIndex } = tableSelection;\n  const colsWidth = table.data.colsWidth!;\n  const targetColIndex = endColIndex + 1;\n  const rightColWidth = colsWidth[endColIndex];\n  const leftColWidth = colsWidth[tableSelection.startColIndex];\n  const getNewTable = () => {\n    return controller.value.document.getNode(table.key) as Table;\n  };\n  const handleInsertRowAbove = () => {\n    controller.run('onAction', insertTableRowBySelections(table, 'insert-row-above'));\n    const newTblSelection: ITableSelection = {\n      ...tableSelection,\n      startRowIndex: tableSelection.startRowIndex + 1,\n      endRowIndex: tableSelection.endRowIndex + 1,\n      type: 'row',\n    };\n    selectTableSelection(controller, getNewTable(), newTblSelection, false);\n  };\n  const handleInsertRowBelow = () => {\n    controller.run('onAction', insertTableRowBySelections(table, 'insert-row-below'));\n    const newTblSelection: ITableSelection = {\n      ...tableSelection,\n      type: 'row',\n    };\n    selectTableSelection(controller, getNewTable(), newTblSelection, false);\n  };\n  const handleDeleteRow = () => {\n    controller.run('onAction', deleteTableRows(table));\n  };\n  const handleInsertColLeft = () => {\n    controller.run('onAction', insertTableCol(\n      table,\n      tableSelection.startColIndex,\n      tableSelection.startColIndex,\n      leftColWidth,\n      containerWidth,\n    ));\n    const newTblSelection: ITableSelection = {\n      ...tableSelection,\n      startColIndex: tableSelection.startColIndex + 1,\n      endColIndex: tableSelection.endColIndex + 1,\n      type: 'col',\n    };\n    selectTableSelection(controller, getNewTable(), newTblSelection, false);\n  };\n  const handleInsertColRight = () => {\n    controller.run('onAction', insertTableCol(\n      table,\n      targetColIndex,\n      endColIndex,\n      rightColWidth,\n      containerWidth,\n    ));\n    const newTblSelection: ITableSelection = {\n      ...tableSelection,\n      type: 'col',\n    };\n    selectTableSelection(controller, getNewTable(), newTblSelection, false);\n  };\n  const handleDeleteCol = () => {\n    controller.run('onAction', deleteTableCols(table));\n  };\n  const appendLayout: TableLayoutConfig[] = type === 'row' ?\n    [{\n      key: KeyEnum.insertRowAbove,\n      icon: <InsertRowAboveIcon />,\n      title: locale?.mobileFloatToolbar?.insertRowAbove,\n      onClick: handleClick(handleInsertRowAbove),\n    }, {\n      key: KeyEnum.insertRowBelow,\n      icon: <InsertRowBelowIcon />,\n      title: locale?.mobileFloatToolbar?.insertRowBelow,\n      onClick: handleClick(handleInsertRowBelow),\n    }, {\n      key: KeyEnum.deleteRow,\n      icon: <DeleteRowIcon />,\n      title: locale?.toolbarDeleteRow,\n      onClick: handleClick(handleDeleteRow),\n    }] :\n    [{\n      key: KeyEnum.insertColLeft,\n      icon: <InsertColLeftIcon />,\n      title: locale?.mobileFloatToolbar?.insertColLeft,\n      onClick: handleClick(handleInsertColLeft),\n    }, {\n      key: KeyEnum.insertColRight,\n      icon: <InsertColRightIcon />,\n      title: locale?.mobileFloatToolbar?.insertColRight,\n      onClick: handleClick(handleInsertColRight),\n    }, {\n      key: KeyEnum.deleteCol,\n      icon: <DeleteColIcon />,\n      title: locale?.toolbarDeleteCol,\n      onClick: handleClick(handleDeleteCol),\n    }];\n  return [...appendLayout, ...defaultLayout];\n};\n"],"file":"createToolbarLayout.js"}