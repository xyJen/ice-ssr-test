import _extends from "@babel/runtime/helpers/extends";
import { Commands } from '@ali/4ever-cangjie';
import { MIN_ROW_HEIGHT } from "../constants";
import resizeTable from "../utils/resizeTable"; // rowsHeight 为 UI 上测得的高度
// 这里有个毛病——如果有行的高度是被内容撑高的，resize 结果很可能不符合用户预期
// 有合并单元格时这个问题基本无解。zoho 与 word 桌面版都有这个问题，google 不能 resize。

export default function resizeTableHeight(controller, table, rowsHeight, delta) {
  if (delta === 0) {
    return controller;
  }

  var originalRowsHeight = rowsHeight.reduce(function (acc, curr) {
    return acc + curr;
  }, 0);
  var expectTotalRowsHeight = originalRowsHeight + delta;
  var limitHeights = Array(rowsHeight.length).fill(MIN_ROW_HEIGHT);
  var outputRowsHeight = resizeTable(rowsHeight, expectTotalRowsHeight, limitHeights);
  table.nodes.forEach(function (row, i) {
    controller.command(Commands.setNodeByKey, row.key, {
      data: _extends({}, row.data || {}, {
        h: outputRowsHeight[i]
      })
    });
  });
  return controller;
}
//# sourceMappingURL=resizeTableHeight.js.map