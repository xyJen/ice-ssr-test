{"version":3,"sources":["../../../../src/bi/queries/isHideDragButton.ts"],"names":["Table","tableSelection","isHideDragButton","controller","data","node","tbSelection","key","startColIndex","endColIndex","startRowIndex","endRowIndex","table","value","document","getNode","isTable","contains","colsLength","colsWidth","length","r","row","nodes","undefined"],"mappings":"AACA,OAAOA,KAAP;AACA,OAAOC,cAAP;AAEA,eAAe,SAASC,gBAAT,CAA0BC,UAA1B,EAAkDC,IAAlD,EAAwE;AAAA,MAC7EC,IAD6E,GACpED,IADoE,CAC7EC,IAD6E;AAErF,MAAMC,WAAW,GAAGL,cAAc,CAACE,UAAD,CAAlC,CAFqF,CAGrF;;AACA,MAAIG,WAAJ,EAAiB;AAAA,QACPC,GADO,GACyDD,WADzD,CACPC,GADO;AAAA,QACFC,aADE,GACyDF,WADzD,CACFE,aADE;AAAA,QACaC,WADb,GACyDH,WADzD,CACaG,WADb;AAAA,QAC0BC,aAD1B,GACyDJ,WADzD,CAC0BI,aAD1B;AAAA,QACyCC,WADzC,GACyDL,WADzD,CACyCK,WADzC;AAEf,QAAMC,KAAK,GAAGT,UAAU,CAACU,KAAX,CAAiBC,QAAjB,CAA0BC,OAA1B,CAAkCR,GAAlC,CAAd;;AACA,QAAIP,KAAK,CAACgB,OAAN,CAAcJ,KAAd,KAAwBA,KAAK,CAACK,QAAN,CAAeZ,IAAf,CAA5B,EAAkD;AAAA;;AAChD,UAAMa,UAAU,4BAAGN,KAAK,CAACR,IAAN,CAAWe,SAAd,qBAAG,sBAAsBC,MAAzC;;AACA,UAAIF,UAAU,IAAIV,aAAa,KAAK,CAAhC,IAAqCC,WAAW,KAAKS,UAAU,GAAG,CAAtE,EAAyE;AACvE,aAAK,IAAIG,CAAC,GAAGX,aAAb,EAA4BW,CAAC,IAAIV,WAAjC,EAA8CU,CAAC,EAA/C,EAAmD;AAAA;;AACjD,cAAMC,GAAG,GAAGV,KAAK,CAACW,KAAN,CAAYF,CAAZ,CAAZ;;AACA,cAAI,CAACC,GAAL,EAAU;AACR;AACD;;AACD,6BAAIA,GAAG,CAACC,KAAJ,CAAU,CAAV,CAAJ,aAAI,YAAcN,QAAd,CAAuBZ,IAAvB,CAAJ,EAAkC;AAChC,mBAAO,IAAP;AACD;AACF;AACF;AACF;AACF;;AACD,SAAOmB,SAAP;AACD","sourcesContent":["import { Controller, Node } from '@ali/4ever-cangjie';\nimport Table from '../../mo/models';\nimport tableSelection from './tableSelection';\n\nexport default function isHideDragButton(controller: Controller, data: { node: Node }) {\n  const { node } = data;\n  const tbSelection = tableSelection(controller);\n  // 选中表格整行时，被选中行的第一个单元格不展示拖拽按钮\n  if (tbSelection) {\n    const { key, startColIndex, endColIndex, startRowIndex, endRowIndex } = tbSelection;\n    const table = controller.value.document.getNode(key) as Table;\n    if (Table.isTable(table) && table.contains(node)) {\n      const colsLength = table.data.colsWidth?.length;\n      if (colsLength && startColIndex === 0 && endColIndex === colsLength - 1) {\n        for (let r = startRowIndex; r <= endRowIndex; r++) {\n          const row = table.nodes[r];\n          if (!row) {\n            continue;\n          }\n          if (row.nodes[0]?.contains(node)) {\n            return true;\n          }\n        }\n      }\n    }\n  }\n  return undefined;\n}\n"],"file":"isHideDragButton.js"}