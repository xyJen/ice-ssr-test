import getRealNodeInTable from "../utils/getRealNodeInTable";
import getPositionOfCell from "../utils/getPositionOfCell";
// 判断选择的单元格是否完整
// NOTE：有合并单元格情况下，如果选区只覆盖了合并单元格的一部分，则认为不完整
export default function isAllSelectedCellsComplete(controller, _ref) {
  var table = _ref.node,
      tableSelection = _ref.tableSelection;

  if (!tableSelection || !table) {
    return false;
  }

  var _startRowIndex = tableSelection.startRowIndex,
      _endRowIndex = tableSelection.endRowIndex,
      _startColIndex = tableSelection.startColIndex,
      _endColIndex = tableSelection.endColIndex;

  if (!table.data.colsWidth) {
    return false;
  }

  var MAX_ROWS_INDEX = table.nodes.length - 1;
  var MAX_COLS_INDEX = table.data.colsWidth.length - 1;
  var startRowIndex = _startRowIndex;
  var startColIndex = _startColIndex;
  var endRowIndex = Math.min(_endRowIndex, MAX_ROWS_INDEX);
  var endColIndex = Math.min(_endColIndex, MAX_COLS_INDEX); // 上边框

  for (var i = startColIndex; i <= endColIndex; i++) {
    var cell = getRealNodeInTable(table, startRowIndex, i);

    if (!cell) {
      return false;
    }

    var position = getPositionOfCell(cell.key, table);

    if (!position) {
      return false;
    }

    if (position.rowIndex !== startRowIndex) {
      return false;
    }
  } // 左边框


  for (var _i = startRowIndex; _i <= endRowIndex; _i++) {
    var _cell = getRealNodeInTable(table, _i, startColIndex);

    if (!_cell) {
      return false;
    }

    var _position = getPositionOfCell(_cell.key, table);

    if (!_position) {
      return false;
    }

    if (_position.colIndex !== startColIndex) {
      return false;
    }
  } // 下边框


  for (var _i2 = startColIndex; _i2 <= endColIndex; _i2++) {
    var _cell2$data;

    var _cell2 = getRealNodeInTable(table, endRowIndex, _i2);

    if (!_cell2) {
      return false;
    }

    var _position2 = getPositionOfCell(_cell2.key, table);

    if (!_position2) {
      return false;
    }

    if (endRowIndex !== _position2.rowIndex + (((_cell2$data = _cell2.data) == null ? void 0 : _cell2$data.rowSpan) || 1) - 1) {
      return false;
    }
  } // 右边框


  for (var _i3 = startRowIndex; _i3 <= endRowIndex; _i3++) {
    var _cell3$data;

    var _cell3 = getRealNodeInTable(table, _i3, endColIndex);

    if (!_cell3) {
      return false;
    }

    var _position3 = getPositionOfCell(_cell3.key, table);

    if (!_position3) {
      return false;
    }

    if (endColIndex !== _position3.colIndex + (((_cell3$data = _cell3.data) == null ? void 0 : _cell3$data.colSpan) || 1) - 1) {
      return false;
    }
  }

  return true;
}
//# sourceMappingURL=isAllSelectedCellsComplete.js.map