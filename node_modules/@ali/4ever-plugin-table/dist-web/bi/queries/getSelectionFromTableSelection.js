export default function getSelectionFromTableSelection(controller, _ref) {
  var _rows$startRowIndex, _rows$endRowIndex;

  var tableSelection = _ref.tableSelection;
  var startRowIndex = tableSelection.startRowIndex,
      startColIndex = tableSelection.startColIndex,
      endRowIndex = tableSelection.endRowIndex,
      endColIndex = tableSelection.endColIndex,
      key = tableSelection.key;
  var _controller$value = controller.value,
      document = _controller$value.document,
      selection = _controller$value.selection;
  var table = document.getNode(key);

  if (!(table != null && table.nodes)) {
    return null;
  }

  var rows = table.nodes;
  var startCell = (_rows$startRowIndex = rows[startRowIndex]) == null ? void 0 : _rows$startRowIndex.nodes[startColIndex];
  var endCell = (_rows$endRowIndex = rows[endRowIndex]) == null ? void 0 : _rows$endRowIndex.nodes[endColIndex];

  if (!endCell || !startCell) {
    return null;
  } // 将 focus 设为 endCell，避免选中列时 focus 在视口外导致文档滚动


  return selection.moveAnchorToStartOfNode(endCell, controller).moveFocusToEndOfNode(startCell, controller);
}
//# sourceMappingURL=getSelectionFromTableSelection.js.map