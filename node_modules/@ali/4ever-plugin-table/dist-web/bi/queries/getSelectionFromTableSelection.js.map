{"version":3,"sources":["../../../../src/bi/queries/getSelectionFromTableSelection.ts"],"names":["getSelectionFromTableSelection","controller","tableSelection","startRowIndex","startColIndex","endRowIndex","endColIndex","key","value","document","selection","table","getNode","nodes","rows","startCell","endCell","moveAnchorToStartOfNode","moveFocusToEndOfNode"],"mappings":"AAIA,eAAe,SAASA,8BAAT,CACbC,UADa,QAGb;AAAA;;AAAA,MADEC,cACF,QADEA,cACF;AAAA,MAEEC,aAFF,GAOID,cAPJ,CAEEC,aAFF;AAAA,MAGEC,aAHF,GAOIF,cAPJ,CAGEE,aAHF;AAAA,MAIEC,WAJF,GAOIH,cAPJ,CAIEG,WAJF;AAAA,MAKEC,WALF,GAOIJ,cAPJ,CAKEI,WALF;AAAA,MAMEC,GANF,GAOIL,cAPJ,CAMEK,GANF;AAAA,0BAQgCN,UAAU,CAACO,KAR3C;AAAA,MAQQC,QARR,qBAQQA,QARR;AAAA,MAQkBC,SARlB,qBAQkBA,SARlB;AASA,MAAMC,KAAK,GAAGF,QAAQ,CAACG,OAAT,CAAiBL,GAAjB,CAAd;;AACA,MAAI,EAACI,KAAD,YAACA,KAAK,CAAEE,KAAR,CAAJ,EAAmB;AACjB,WAAO,IAAP;AACD;;AACD,MAAMC,IAAI,GAAGH,KAAK,CAACE,KAAnB;AACA,MAAME,SAAS,0BAAGD,IAAI,CAACX,aAAD,CAAP,qBAAG,oBAAqBU,KAArB,CAA2BT,aAA3B,CAAlB;AACA,MAAMY,OAAO,wBAAGF,IAAI,CAACT,WAAD,CAAP,qBAAG,kBAAmBQ,KAAnB,CAAyBP,WAAzB,CAAhB;;AACA,MAAI,CAACU,OAAD,IAAY,CAACD,SAAjB,EAA4B;AAC1B,WAAO,IAAP;AACD,GAlBD,CAmBA;;;AACA,SAAOL,SAAS,CACbO,uBADI,CACoBD,OADpB,EAC6Bf,UAD7B,EAEJiB,oBAFI,CAEiBH,SAFjB,EAE4Bd,UAF5B,CAAP;AAGD","sourcesContent":["import { Controller } from '@ali/4ever-cangjie';\nimport Table from '../../mo/models';\nimport { ITableSelection } from '../types';\n\nexport default function getSelectionFromTableSelection(\n  controller: Controller,\n  { tableSelection }: { tableSelection: ITableSelection },\n) {\n  const {\n    startRowIndex,\n    startColIndex,\n    endRowIndex,\n    endColIndex,\n    key,\n  } = tableSelection;\n  const { document, selection } = controller.value;\n  const table = document.getNode(key) as Table;\n  if (!table?.nodes) {\n    return null;\n  }\n  const rows = table.nodes;\n  const startCell = rows[startRowIndex]?.nodes[startColIndex];\n  const endCell = rows[endRowIndex]?.nodes[endColIndex];\n  if (!endCell || !startCell) {\n    return null;\n  }\n  // 将 focus 设为 endCell，避免选中列时 focus 在视口外导致文档滚动\n  return selection\n    .moveAnchorToStartOfNode(endCell, controller)\n    .moveFocusToEndOfNode(startCell, controller);\n}\n"],"file":"getSelectionFromTableSelection.js"}