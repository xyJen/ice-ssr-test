{"version":3,"sources":["../../../../src/common/queries/calcMinTableColWidth.ts"],"names":["calcMinTableColWidth","controller","payload","node","colIndex","key","width","Table","isTable","nodes","forEach","row","Array","isArray","cell","forEachDescendant","n","colWidth","query","Math","max"],"mappings":";;;;;;;;;AACA;;AAYe,SAASA,oBAAT,CACbC,UADa,EAEbC,OAFa,EAGJ;AACT,QAAM;AAAEC,IAAAA,IAAF;AAAQC,IAAAA;AAAR,MAAqBF,OAA3B;AACA,MAAIG,GAAJ;AACA,MAAIC,KAAJ;AAEAC,kBAAMC,OAAN,CAAcL,IAAd,KAAuBA,IAAI,EAAEM,KAAN,CAAYC,OAAZ,CAAqBC,GAAD,IAAS;AAClD,QAAI,CAACC,KAAK,CAACC,OAAN,CAAcF,GAAG,CAACF,KAAlB,CAAL,EAA+B;AAC7B;AACD;;AACD,UAAMK,IAAI,GAAGH,GAAG,CAACF,KAAJ,CAAUL,QAAV,CAAb;;AACA,QAAI,CAACU,IAAL,EAAW;AACT;AACD;;AACD,QAAI,CAACA,IAAI,CAACC,iBAAV,EAA6B;AAC3B;AACD;;AACDD,IAAAA,IAAI,CAACC,iBAAL,CAAwBC,CAAD,IAAO;AAC5B,YAAMC,QAAQ,GAAGhB,UAAU,CAACiB,KAAX,CAAiB,qBAAjB,EAAwC;AAAEf,QAAAA,IAAI,EAAEa;AAAR,OAAxC,CAAjB;;AACA,UAAI,OAAOC,QAAP,KAAoB,QAAxB,EAAkC;AAChCX,QAAAA,KAAK,GAAGa,IAAI,CAACC,GAAL,CAASH,QAAT,EAAmBX,KAAK,IAAI,CAA5B,CAAR;AACAD,QAAAA,GAAG,GAAGW,CAAC,CAACX,GAAR;AACD;AACF,KAND;AAOD,GAlBsB,CAAvB;AAmBA,SAAO;AACLA,IAAAA,GADK;AAELC,IAAAA;AAFK,GAAP;AAID","sourcesContent":["import { Controller, Node } from '@ali/4ever-cangjie';\nimport Table from '../../mo/models';\n\ninterface IPayload {\n  node: Node;\n  colIndex: number;\n}\n\ninterface IResult {\n  key?: string;\n  width?: number;\n}\n\nexport default function calcMinTableColWidth(\n  controller: Controller,\n  payload: IPayload,\n): IResult {\n  const { node, colIndex } = payload;\n  let key: string | undefined;\n  let width: number | undefined;\n\n  Table.isTable(node) && node?.nodes.forEach((row) => {\n    if (!Array.isArray(row.nodes)) {\n      return;\n    }\n    const cell = row.nodes[colIndex];\n    if (!cell) {\n      return;\n    }\n    if (!cell.forEachDescendant) {\n      return;\n    }\n    cell.forEachDescendant((n) => {\n      const colWidth = controller.query('getMinTableColWidth', { node: n });\n      if (typeof colWidth === 'number') {\n        width = Math.max(colWidth, width || 0);\n        key = n.key;\n      }\n    });\n  });\n  return {\n    key,\n    width,\n  };\n}\n"],"file":"calcMinTableColWidth.js"}