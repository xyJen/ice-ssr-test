"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = calcResizeColsWidth;

var _constants = require("../constants");

var _resizeTable = _interopRequireDefault(require("../utils/resizeTable"));

function calcResizeColsWidth(controller, table, delta, maxWidth) {
  const colsWidth = [...(table.data.colsWidth || [])];
  const originalTotalWidth = colsWidth.reduce((acc, curr) => acc + curr, 0);
  const expectTotalWidth = Math.min(originalTotalWidth + delta, maxWidth || Infinity);
  const limitColWidths = colsWidth.map((_, i) => {
    if (delta >= 0) {
      return _constants.MIN_COL_WIDTH;
    }

    const {
      width: limitWidth
    } = controller.query('calcMinTableColWidth', {
      node: table,
      colIndex: i
    }) || {};
    return typeof limitWidth === 'number' ? limitWidth : _constants.MIN_COL_WIDTH;
  });
  const resultColsWidth = (0, _resizeTable.default)(colsWidth, expectTotalWidth, limitColWidths);
  return resultColsWidth;
}
//# sourceMappingURL=calcResizeColsWidth.js.map