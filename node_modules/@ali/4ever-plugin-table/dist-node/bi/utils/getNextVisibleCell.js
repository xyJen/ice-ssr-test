"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getNextNonHiddenCell;

var _ = require(".");

var _types = require("../types");

function getNextNonHiddenCell(document, cell, direction) {
  const row = document.getClosest(cell.key, _types.isTableRow);
  const nextRow = direction === 'up' ? document.getPreviousSibling(row.key) : document.getNextSibling(row.key);

  if (!nextRow) {
    return;
  }

  const colIndex = row.nodes.indexOf(cell); // nextRow.nodes.last() 是为了处理不规则表格的情况

  const nextCell = nextRow.nodes[colIndex] || nextRow.nodes[nextRow.nodes.length - 1];

  if (!nextCell) {
    return;
  }

  if (nextCell.data.hidden) {
    const table = document.getClosest(nextCell.key, _types.isTable);
    const {
      rowIndex,
      colIndex: ci
    } = (0, _.getPositionOfCell)(nextCell.key, table);
    const realCell = (0, _.getRealNodeInTable)(table, rowIndex, ci);

    if (realCell === cell) {
      return getNextNonHiddenCell(document, nextCell, direction);
    }

    return realCell;
  }

  return nextCell;
}
//# sourceMappingURL=getNextVisibleCell.js.map