"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = isSelectionInTableCell;

var _models = _interopRequireDefault(require("../../mo/models"));

var _types = require("../types");

function isSelectionInTableCell(value, configs) {
  const {
    document,
    selection
  } = value;

  if (!selection) {
    return false;
  }

  const {
    start,
    end
  } = selection.sort(document);

  if (start.isEdgePoint() || end.isEdgePoint()) {
    return false;
  }

  const startCell = document.getClosest(start.key, _types.isTableCell);

  if (!startCell) {
    return false;
  }

  const endCell = document.getClosest(end.key, _types.isTableCell);

  if (!endCell) {
    return false;
  }

  if (configs?.excludeColumns) {
    const parentTable = document.getClosest(start.key, _models.default.isTable);

    if (parentTable && parentTable.data.sr) {
      return false;
    }
  }

  return startCell === endCell;
}
//# sourceMappingURL=isSelectionInTableCell.js.map