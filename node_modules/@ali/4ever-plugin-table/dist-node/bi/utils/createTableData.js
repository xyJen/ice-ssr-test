"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = createTableData;

var _everUtils = require("@ali/4ever-utils");

var _constants = require("../constants");

var _constants2 = require("../../utils/constants");

function createColsWidth(colSize, containerWidth) {
  const colsWidth = [];
  const colWidth = Math.max(_constants.MIN_COL_WIDTH, Math.floor(containerWidth / colSize));

  for (let i = 0; i < colSize; i += 1) {
    colsWidth.push(colWidth);
  }

  return colsWidth;
}

function createAutofitColsWidth(colSize) {
  const colWidth = Number((_constants2.DEFAULT_PCT_WIDTH / colSize).toFixed(1));
  const colsWidth = Array(colSize).fill(colWidth);
  colsWidth[colSize - 1] = _constants2.DEFAULT_PCT_WIDTH - colWidth * (colSize - 1);
  return colsWidth;
}

function createTableData(controller, {
  colSize,
  containerWidth,
  defaultAutofit
}) {
  const tableData = {};

  if (defaultAutofit) {
    tableData.colsWidth = createAutofitColsWidth(colSize);
    tableData.tblW = {
      w: _constants2.DEFAULT_PCT_WIDTH,
      type: 'pct'
    };
  } else {
    let width = containerWidth;

    if (!containerWidth) {
      const containerBlock = (0, _everUtils.getClosestContainerBlock)(controller.value);
      const {
        document
      } = controller.value;
      width = (0, _everUtils.getInnerFullWidth)(containerBlock, document) || 0;
    }

    tableData.colsWidth = createColsWidth(colSize, width - 2);
  }

  return tableData;
}
//# sourceMappingURL=createTableData.js.map