{"version":3,"sources":["../../../../src/bi/utils/isSelectionInTableCell.ts"],"names":["isSelectionInTableCell","value","configs","document","selection","start","end","sort","isEdgePoint","startCell","getClosest","key","isTableCell","endCell","excludeColumns","parentTable","Table","isTable","data","sr"],"mappings":";;;;;;;;;AACA;;AACA;;AAOe,SAASA,sBAAT,CACbC,KADa,EAEbC,OAFa,EAGb;AACA,QAAM;AAAEC,IAAAA,QAAF;AAAYC,IAAAA;AAAZ,MAA0BH,KAAhC;;AACA,MAAI,CAACG,SAAL,EAAgB;AACd,WAAO,KAAP;AACD;;AACD,QAAM;AAAEC,IAAAA,KAAF;AAASC,IAAAA;AAAT,MAAiBF,SAAS,CAACG,IAAV,CAAeJ,QAAf,CAAvB;;AACA,MAAIE,KAAK,CAACG,WAAN,MAAuBF,GAAG,CAACE,WAAJ,EAA3B,EAA8C;AAC5C,WAAO,KAAP;AACD;;AACD,QAAMC,SAAS,GAAGN,QAAQ,CAACO,UAAT,CAAoBL,KAAK,CAACM,GAA1B,EAA+BC,kBAA/B,CAAlB;;AACA,MAAI,CAACH,SAAL,EAAgB;AACd,WAAO,KAAP;AACD;;AACD,QAAMI,OAAO,GAAGV,QAAQ,CAACO,UAAT,CAAoBJ,GAAG,CAACK,GAAxB,EAA6BC,kBAA7B,CAAhB;;AACA,MAAI,CAACC,OAAL,EAAc;AACZ,WAAO,KAAP;AACD;;AACD,MAAIX,OAAO,EAAEY,cAAb,EAA6B;AAC3B,UAAMC,WAAW,GAAGZ,QAAQ,CAACO,UAAT,CAAoBL,KAAK,CAACM,GAA1B,EAA+BK,gBAAMC,OAArC,CAApB;;AAGA,QAAIF,WAAW,IAAIA,WAAW,CAACG,IAAZ,CAAiBC,EAApC,EAAwC;AACtC,aAAO,KAAP;AACD;AACF;;AACD,SAAOV,SAAS,KAAKI,OAArB;AACD","sourcesContent":["import { Value } from '@ali/4ever-cangjie';\nimport Table from '../../mo/models';\nimport { isTableCell } from '../types';\n\nexport type Configs = {\n  // 排除特殊的表格 - 分栏\n  excludeColumns: boolean;\n};\n\nexport default function isSelectionInTableCell(\n  value: Value,\n  configs?: Configs,\n) {\n  const { document, selection } = value;\n  if (!selection) {\n    return false;\n  }\n  const { start, end } = selection.sort(document);\n  if (start.isEdgePoint() || end.isEdgePoint()) {\n    return false;\n  }\n  const startCell = document.getClosest(start.key, isTableCell);\n  if (!startCell) {\n    return false;\n  }\n  const endCell = document.getClosest(end.key, isTableCell);\n  if (!endCell) {\n    return false;\n  }\n  if (configs?.excludeColumns) {\n    const parentTable = document.getClosest(start.key, Table.isTable) as\n      | Table\n      | undefined;\n    if (parentTable && parentTable.data.sr) {\n      return false;\n    }\n  }\n  return startCell === endCell;\n}\n"],"file":"isSelectionInTableCell.js"}