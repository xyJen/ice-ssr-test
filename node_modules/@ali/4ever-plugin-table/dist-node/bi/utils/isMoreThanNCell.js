"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = isMoreThanNCell;

function isMoreThanNCell(n, status, tableProps) {
  const {
    visible,
    table,
    selection
  } = tableProps;

  if (!visible || !selection || !table) {
    return false;
  }

  const hidden = status === 'hidden';
  let count = 0;

  for (let r = selection.startRowIndex; r <= selection.endRowIndex; r += 1) {
    const row = table.nodes[r]; // 多人编辑时，A 拖动完选区后，再点击右键时，B 可能已经把表格选区的部分行列删除了

    if (!row?.nodes) {
      break;
    }

    for (let c = selection.startColIndex; c <= selection.endColIndex; c += 1) {
      const cell = row.nodes[c];

      if (!cell) {
        break;
      }

      if ((cell.data?.hidden || false) === hidden) {
        count += 1;
      }

      if (count >= n) {
        return true;
      }
    }
  }

  return false;
}
//# sourceMappingURL=isMoreThanNCell.js.map