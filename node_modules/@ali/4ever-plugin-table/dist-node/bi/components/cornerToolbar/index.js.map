{"version":3,"sources":["../../../../../src/bi/components/cornerToolbar/index.tsx"],"names":["MENU_ITEM_WHITE_LIST","useRowIsSticky","useScrollableContainerRect","hooks","REALTABLE_PADDING","STICKY_ROW_TOP_HEIGHT","STICKY_TOOLBAR_INDEX_MAP","constants","ICON_SIZE","GAP_X","GAP_Y","LEFT_OFFSET","CornerToolbar","styled","div","props","Math","round","scale","TOOLBAR_ITEM_SIZE","top","TableCornerToolbar","controller","visible","locale","table","isSelectWholeTable","onSelect","onMouseEnter","onMouseLeave","draggableConfig","enableAutofitWidth","enableHeader","setTableHeaderStyle","isSticky","scrollRect","timer","React","useRef","handleStopPropagation","useCallback","event","stopPropagation","isAutofit","Table","isAutofitWidth","handleAutoFit","run","handleMouseOver","e","current","clearTimeout","handleMouseLeave","setTimeout","useEffect","handleToggleRowHeader","_","preventDefault","selection","value","isRowHeader","command","Commands","select","handleToggleColHeader","isColumnHeader","customizeMenus","useMemo","menus","push","type","TYPE_MENU_ITEM","testid","title","widthFitContainer","icon","menuKey","hoverable","autoClose","extra","onClick","TYPE_SUB_MENU","tableHeader","rowHeader","columnHeader","style","display","ret","position","zIndex","cornerToolbar","left","Number","isFinite","transform","handleMenuItemClick","setMenuVisible","canMenuVisible","includes"],"mappings":"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","sourcesContent":["/* eslint-disable react/no-unused-prop-types */\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport { BiPluginConfig, Commands, Controller } from '@ali/4ever-cangjie';\nimport Table from '../../../mo/models';\nimport { AdaptNormal, SelectedNormalNormal } from '@ali/we-icon';\nimport { Switch } from '@ali/we-design';\nimport { TOOLBAR_ITEM_SIZE } from '../../constants';\nimport {\n  resizeTableWidthFitContainer,\n  setTableAutofitWidthEnable,\n  setTableAutofitWidthDisable,\n  selectTable,\n  removeTableRowHeader,\n  setTableRowHeader,\n  removeTableColHeader,\n  setTableColHeader,\n} from '../../actions';\nimport { TYPE_MENU_ITEM, TYPE_SUB_MENU } from '@ali/4ever-component';\nimport { MenuTitleWithNewBadge } from '@ali/4ever-component';\nimport { DragDropdown } from '@ali/4ever-plugin-draggable'\nimport TableHeaderIcon from './tableHeaderIcon';\nimport constants from '../../../utils/constants';\nimport * as hooks from '../../../utils/hooks';\n\n// menu 菜单点击后不需要关闭的menuKey选项白名单\nconst MENU_ITEM_WHITE_LIST = ['table-autofit'];\n\nconst { useRowIsSticky, useScrollableContainerRect } = hooks;\nconst {\n  REALTABLE_PADDING,\n  STICKY_ROW_TOP_HEIGHT,\n  STICKY_TOOLBAR_INDEX_MAP,\n} = constants;\n\nconst ICON_SIZE = 16;\nconst GAP_X = 8;\nconst GAP_Y = 8;\n\nconst LEFT_OFFSET = -(ICON_SIZE + GAP_X);\n\nconst CornerToolbar = styled.div<{ scale: number }>`\n  box-sizing: border-box;\n  position: absolute;\n  cursor: default;\n  color: transparent;\n  width: ${(props) => Math.round(ICON_SIZE / props.scale)}px;\n  height: ${(props) => Math.round(ICON_SIZE / props.scale)}px;\n  top: -${(props) => (GAP_Y + ICON_SIZE - TOOLBAR_ITEM_SIZE - REALTABLE_PADDING.top) / props.scale}px;\n  left: ${(props) => Math.round(LEFT_OFFSET / props.scale)}px;\n  line-height: 0;\n  font-size: ${ICON_SIZE}px;\n  z-index: 1;\n  transform-origin: left top;\n\n  * {\n    box-sizing: border-box;\n  }\n`;\n\ninterface TableCornerToolbarProps {\n  controller: Controller;\n  visible: boolean;\n  table: Table;\n  scale: number;\n  locale: any;\n  isSelectWholeTable: boolean;\n  onSelect: () => void;\n  onToolbarEvent: (command: string) => void;\n  realTableWrapperRef?: React.RefObject<HTMLDivElement | null>;\n  zoomContainer?: HTMLElement;\n  getLastActiveTableKey?: () => string | null;\n  setIsHighlightSelection?: (isHighlight: boolean) => void;\n  hideWidthFitButton?: boolean;\n  draggableConfig?: BiPluginConfig['draggable'];\n  onMouseEnter: () => void;\n  onMouseLeave: () => void;\n  enableAutofitWidth?: () => boolean;\n  enableHeader?: () => boolean;\n  setTableHeaderStyle?: () => void;\n}\n\nconst TableCornerToolbar = (props: TableCornerToolbarProps) => {\n  const {\n    controller,\n    visible,\n    locale,\n    table,\n    scale,\n    isSelectWholeTable,\n    onSelect,\n    onMouseEnter,\n    onMouseLeave,\n    draggableConfig,\n    enableAutofitWidth,\n    enableHeader,\n    setTableHeaderStyle,\n  } = props;\n\n  const [isSticky] = useRowIsSticky();\n  const [scrollRect] = useScrollableContainerRect();\n\n  const timer = React.useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  const handleStopPropagation = React.useCallback(\n    (event: React.MouseEvent | React.TouchEvent) => {\n      event.stopPropagation();\n    },\n    [],\n  );\n  const isAutofit = Table.isAutofitWidth(table);\n\n  const handleAutoFit = React.useCallback(() => {\n    // 无论是否命中灰度，只要是自适应\n    if (isAutofit) {\n      controller.run('onAction', setTableAutofitWidthDisable(table));\n    } else if (enableAutofitWidth && enableAutofitWidth()) {\n      controller.run('onAction', setTableAutofitWidthEnable(table));\n    } else {\n      controller.run('onAction', resizeTableWidthFitContainer(table));\n    }\n    controller.run('onAction', selectTable(table));\n  }, [isAutofit, enableAutofitWidth, controller, table]);\n\n  const handleMouseOver = React.useCallback(\n    (e: React.MouseEvent) => {\n      handleStopPropagation(e);\n      if (timer && timer.current) {\n        clearTimeout(timer.current);\n        timer.current = null;\n      }\n      onMouseEnter();\n    },\n    [onMouseEnter, handleStopPropagation],\n  );\n\n  const handleMouseLeave = React.useCallback(\n    (e: React.MouseEvent) => {\n      handleStopPropagation(e);\n      timer.current = setTimeout(() => {\n        onMouseLeave();\n      }, 200);\n    },\n    [onMouseLeave, handleStopPropagation],\n  );\n\n  React.useEffect(() => {\n    if (timer && timer.current) {\n      clearTimeout(timer.current);\n    }\n  }, []);\n\n  const handleToggleRowHeader = React.useCallback((_, e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const { selection } = controller.value;\n    if (Table.isRowHeader(table)) {\n      controller.run('onAction', removeTableRowHeader(table));\n    } else {\n      // NOTE: 需要先执行 setTableHeaderStyle\n      setTableHeaderStyle?.();\n      controller.run('onAction', setTableRowHeader(table));\n    }\n    controller.command(Commands.select, selection);\n  }, [controller, table, setTableHeaderStyle]);\n\n  const handleToggleColHeader = React.useCallback(() => {\n    const { selection } = controller.value;\n    if (Table.isColumnHeader(table)) {\n      controller.run('onAction', removeTableColHeader(table));\n    } else {\n      // NOTE: 需要先执行 setTableHeaderStyle\n      setTableHeaderStyle?.();\n      controller.run('onAction', setTableColHeader(table));\n    }\n    controller.command(Commands.select, selection);\n  }, [controller, table, setTableHeaderStyle]);\n\n  const customizeMenus = React.useMemo(() => {\n    const menus: Array<Record<string, any>> = [];\n    if ((enableAutofitWidth && enableAutofitWidth()) || isAutofit) {\n      menus.push({\n        type: TYPE_MENU_ITEM,\n        testid: 'table-autofit-menu-item',\n        title: locale?.widthFitContainer,\n        icon: <AdaptNormal />,\n        menuKey: 'table-autofit',\n        hoverable: false,\n        autoClose: false,\n        extra: (\n          <Switch\n            testid=\"table-autofit-switch\"\n            checked={isAutofit}\n            size=\"small\"\n            onChange={handleAutoFit}\n          />\n        ),\n      });\n    } else {\n      menus.push({\n        type: TYPE_MENU_ITEM,\n        title: locale?.widthFitContainer,\n        icon: <AdaptNormal />,\n        onClick: handleAutoFit,\n      });\n    }\n    if (enableHeader && enableHeader()) {\n      menus.push({\n        type: TYPE_SUB_MENU,\n        testid: 'table-header-sub-menu',\n        title: <MenuTitleWithNewBadge title={locale?.tableHeader} />,\n        icon: <TableHeaderIcon />,\n        menus: [\n          {\n            type: TYPE_MENU_ITEM,\n            testid: 'table-header-row-menu-item',\n            title: locale?.rowHeader,\n            extra: Table.isRowHeader(table) ? (\n              <SelectedNormalNormal pathColors={['#171A1D']} />\n            ) : null,\n            onClick: handleToggleRowHeader,\n            menuKey: 'table-header-row',\n          },\n          {\n            type: TYPE_MENU_ITEM,\n            testid: 'table-header-column-menu-item',\n            title: locale?.columnHeader,\n            extra: Table.isColumnHeader(table) ? (\n              <SelectedNormalNormal pathColors={['#171A1D']} />\n            ) : null,\n            onClick: handleToggleColHeader,\n            menuKey: 'table-header-col',\n          },\n        ],\n      });\n    }\n\n    return menus;\n  }, [\n    enableAutofitWidth,\n    enableHeader,\n    handleAutoFit,\n    handleToggleColHeader,\n    handleToggleRowHeader,\n    isAutofit,\n    locale?.columnHeader,\n    locale?.rowHeader,\n    locale?.tableHeader,\n    locale?.widthFitContainer,\n    table,\n  ]);\n\n  const style: React.CSSProperties = React.useMemo(() => {\n    if (!visible) {\n      return { display: 'none' };\n    }\n\n    const ret: React.CSSProperties = {\n      display: 'block',\n    };\n\n    if (isSticky) {\n      ret.position = 'fixed';\n      ret.top = STICKY_ROW_TOP_HEIGHT + scrollRect.top - GAP_Y - ICON_SIZE;\n      ret.zIndex = STICKY_TOOLBAR_INDEX_MAP.cornerToolbar;\n      ret.left = Number.isFinite(scrollRect.left)\n        ? scrollRect.left\n        : 'unset';\n      ret.transform = `translateX(${LEFT_OFFSET}px)`;\n    }\n\n    return ret;\n  }, [isSticky, scrollRect, visible]);\n\n  const handleMenuItemClick = React.useCallback(\n    (menuKey: string, setMenuVisible: (state: boolean) => void) => {\n      const canMenuVisible = MENU_ITEM_WHITE_LIST.includes(menuKey);\n      if (!canMenuVisible) {\n        setMenuVisible(false);\n      }\n      onMouseLeave();\n    },\n    [onMouseLeave],\n  );\n\n  return (\n    <CornerToolbar\n      style={style}\n      role=\"toolbar\"\n      data-testid=\"table-corner-toobar-button\"\n      data-sticky={isSticky}\n      scale={scale}\n      onMouseLeave={handleMouseLeave}\n      onMouseOver={handleMouseOver}\n      onContextMenu={handleStopPropagation}\n      onMouseDown={handleStopPropagation}\n      onTouchStart={handleStopPropagation}\n      onMouseUp={handleStopPropagation} // \b防止触发 Cangjie 选区事件\n    >\n      <div>\n        <DragDropdown\n          controller={controller}\n          currentBlock={table}\n          draggableConfig={draggableConfig}\n          scale={scale}\n          // @ts-ignore\n          customizeMenus={customizeMenus}\n          handleClickMenuItem={handleMenuItemClick}\n          active={isSelectWholeTable}\n          onClickIcon={onSelect}\n        />\n      </div>\n    </CornerToolbar>\n  );\n};\n\nexport default TableCornerToolbar;\n"],"file":"index.js"}