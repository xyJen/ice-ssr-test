"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ContextContainer = void 0;

var _fastDeepEqual = _interopRequireDefault(require("fast-deep-equal"));

var _react = _interopRequireDefault(require("react"));

var _hooks = require("../../utils/hooks");

const _createElement = /*#__PURE__*/_react.default.createElement;

const ContextContainer = props => {
  const {
    isSelected
  } = props;

  const [rowsClientHeight, setRowsClientHeight] = _react.default.useState({});

  const rowsClientHeightRef = _react.default.useRef({});

  const updateRowClientHeight = _react.default.useCallback((rowKey, height) => {
    if (height === null) {
      delete rowsClientHeightRef.current[rowKey];
    } else {
      rowsClientHeightRef.current[rowKey] = height;
    }

    if (isSelected) {
      setRowsClientHeight({ ...rowsClientHeightRef.current
      });
    }
  }, [isSelected]);

  _react.default.useEffect(() => {
    if (isSelected && !(0, _fastDeepEqual.default)(rowsClientHeight, rowsClientHeightRef.current)) {
      setRowsClientHeight({ ...rowsClientHeightRef.current
      });
    }
  }, [isSelected, rowsClientHeight]);

  const rowsClientHeightValue = _react.default.useMemo(() => {
    return [rowsClientHeight, updateRowClientHeight];
  }, [rowsClientHeight, updateRowClientHeight]);

  const [pixelColsWidth, setPixelColsWidth] = _react.default.useState([]);

  const pixelColsWidthValue = _react.default.useMemo(() => {
    return [pixelColsWidth, setPixelColsWidth];
  }, [pixelColsWidth]);

  return /*#__PURE__*/_createElement(_hooks.RowsClientHeightContext.Provider, {
    value: rowsClientHeightValue
  }, /*#__PURE__*/_createElement(_hooks.PixelColsWidthContext.Provider, {
    value: pixelColsWidthValue
  }, props.children));
};

exports.ContextContainer = ContextContainer;
//# sourceMappingURL=contextContainer.js.map