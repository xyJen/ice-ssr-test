"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getSelectionFromTableSelection;

function getSelectionFromTableSelection(controller, {
  tableSelection
}) {
  const {
    startRowIndex,
    startColIndex,
    endRowIndex,
    endColIndex,
    key
  } = tableSelection;
  const {
    document,
    selection
  } = controller.value;
  const table = document.getNode(key);

  if (!table?.nodes) {
    return null;
  }

  const rows = table.nodes;
  const startCell = rows[startRowIndex]?.nodes[startColIndex];
  const endCell = rows[endRowIndex]?.nodes[endColIndex];

  if (!endCell || !startCell) {
    return null;
  } // 将 focus 设为 endCell，避免选中列时 focus 在视口外导致文档滚动


  return selection.moveAnchorToStartOfNode(endCell, controller).moveFocusToEndOfNode(startCell, controller);
}
//# sourceMappingURL=getSelectionFromTableSelection.js.map