{"version":3,"sources":["../../../../src/bi/queries/getSelectionFromTableSelection.ts"],"names":["getSelectionFromTableSelection","controller","tableSelection","startRowIndex","startColIndex","endRowIndex","endColIndex","key","document","selection","value","table","getNode","nodes","rows","startCell","endCell","moveAnchorToStartOfNode","moveFocusToEndOfNode"],"mappings":";;;;;;;AAIe,SAASA,8BAAT,CACbC,UADa,EAEb;AAAEC,EAAAA;AAAF,CAFa,EAGb;AACA,QAAM;AACJC,IAAAA,aADI;AAEJC,IAAAA,aAFI;AAGJC,IAAAA,WAHI;AAIJC,IAAAA,WAJI;AAKJC,IAAAA;AALI,MAMFL,cANJ;AAOA,QAAM;AAAEM,IAAAA,QAAF;AAAYC,IAAAA;AAAZ,MAA0BR,UAAU,CAACS,KAA3C;AACA,QAAMC,KAAK,GAAGH,QAAQ,CAACI,OAAT,CAAiBL,GAAjB,CAAd;;AACA,MAAI,CAACI,KAAK,EAAEE,KAAZ,EAAmB;AACjB,WAAO,IAAP;AACD;;AACD,QAAMC,IAAI,GAAGH,KAAK,CAACE,KAAnB;AACA,QAAME,SAAS,GAAGD,IAAI,CAACX,aAAD,CAAJ,EAAqBU,KAArB,CAA2BT,aAA3B,CAAlB;AACA,QAAMY,OAAO,GAAGF,IAAI,CAACT,WAAD,CAAJ,EAAmBQ,KAAnB,CAAyBP,WAAzB,CAAhB;;AACA,MAAI,CAACU,OAAD,IAAY,CAACD,SAAjB,EAA4B;AAC1B,WAAO,IAAP;AACD,GAlBD,CAmBA;;;AACA,SAAON,SAAS,CACbQ,uBADI,CACoBD,OADpB,EAC6Bf,UAD7B,EAEJiB,oBAFI,CAEiBH,SAFjB,EAE4Bd,UAF5B,CAAP;AAGD","sourcesContent":["import { Controller } from '@ali/4ever-cangjie';\nimport Table from '../../mo/models';\nimport { ITableSelection } from '../types';\n\nexport default function getSelectionFromTableSelection(\n  controller: Controller,\n  { tableSelection }: { tableSelection: ITableSelection },\n) {\n  const {\n    startRowIndex,\n    startColIndex,\n    endRowIndex,\n    endColIndex,\n    key,\n  } = tableSelection;\n  const { document, selection } = controller.value;\n  const table = document.getNode(key) as Table;\n  if (!table?.nodes) {\n    return null;\n  }\n  const rows = table.nodes;\n  const startCell = rows[startRowIndex]?.nodes[startColIndex];\n  const endCell = rows[endRowIndex]?.nodes[endColIndex];\n  if (!endCell || !startCell) {\n    return null;\n  }\n  // 将 focus 设为 endCell，避免选中列时 focus 在视口外导致文档滚动\n  return selection\n    .moveAnchorToStartOfNode(endCell, controller)\n    .moveFocusToEndOfNode(startCell, controller);\n}\n"],"file":"getSelectionFromTableSelection.js"}