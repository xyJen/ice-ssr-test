"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.isKeyInCell = isKeyInCell;
exports.default = canInsertTable;

var _utils = require("../utils");

function isKeyInCell(document, key) {
  const ancestors = document.getAncestors(key);
  return !!ancestors.find(ancestor => ancestor.type === 'table-cell');
}

function canInsertTable(controller) {
  if (!controller) return false;
  const {
    value
  } = controller;
  const tableSelection = controller.query('hasTableSelection');

  if (tableSelection) {
    // 单元格被选中
    return false;
  }

  const {
    selection
  } = value;
  const {
    isCollapsedAtEdge
  } = selection;

  try {
    return !isCollapsedAtEdge && !(0, _utils.isSelectionInTableCell)(value, {
      excludeColumns: true
    }) && !controller.query('isSelectionInLink') && !controller.query('isSelectionInMention');
  } catch (e) {
    return true;
  }
}
//# sourceMappingURL=canInsertTable.js.map