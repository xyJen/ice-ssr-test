{"version":3,"sources":["../../../../../../../src/bi/mobile/components/floatToolbar/utils/createToolbarLayout.tsx"],"names":["KeyEnum","createToolbarLayout","params","controller","table","type","hideToolbar","tableSelection","locale","isAutofit","Table","isAutofitWidth","containerWidth","DEFAULT_TOTAL_WIDTH_FOR_AUTOFIT","undefined","handleClick","callback","handleCopy","run","ContextMenu","ACTION_COPY","handleCut","ACTION_CUT","handlePaste","ACTION_PASTE","handleClear","defaultLayout","key","copy","icon","title","contextMenuCopy","onClick","cut","contextMenuCut","paste","contextMenuPaste","clear","mobileFloatToolbar","endColIndex","colsWidth","data","targetColIndex","rightColWidth","leftColWidth","startColIndex","getNewTable","value","document","getNode","handleInsertRowAbove","newTblSelection","startRowIndex","endRowIndex","handleInsertRowBelow","handleDeleteRow","handleInsertColLeft","handleInsertColRight","handleDeleteCol","appendLayout","insertRowAbove","insertRowBelow","deleteRow","toolbarDeleteRow","insertColLeft","insertColRight","deleteCol","toolbarDeleteCol"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { ContextMenu, Controller } from '@ali/4ever-cangjie';\nimport { LayoutConfig } from '../basic';\nimport { ITableSelection, TableConfig } from '../../../../types';\nimport Table from '../../../../../mo/models';\nimport { emptyTableSelection, selectTableSelection } from '../../../../commands';\nimport {\n  deleteTableCols,\n  deleteTableRows,\n  insertTableCol,\n  insertTableRowBySelections,\n} from '../../../../actions';\nimport {\n  DeleteColIcon,\n  DeleteRowIcon,\n  InsertColLeftIcon,\n  InsertColRightIcon,\n  InsertRowAboveIcon,\n  InsertRowBelowIcon,\n  CopyIcon,\n  CutIcon,\n  PasteIcon,\n  ClearIcon,\n} from '../icons';\nimport { DEFAULT_TOTAL_WIDTH_FOR_AUTOFIT } from '../../../../../utils/constants';\n\nenum KeyEnum {\n  copy = 'copy',\n  cut = 'cut',\n  paste = 'paste',\n  clear = 'clear',\n  insertRowAbove = 'insertRowAbove',\n  insertRowBelow = 'insertRowBelow',\n  deleteRow = 'deleteRow',\n  insertColLeft = 'insertColLeft',\n  insertColRight = 'insertColRight',\n  deleteCol = 'deleteCol',\n}\n\ntype TableLayoutConfig = Omit<LayoutConfig, 'key'> & {\n  key: KeyEnum;\n};\n\ntype LayoutFactory = (params: {\n  controller: Controller;\n  table: Table;\n  type: 'row' | 'col';\n  hideToolbar: Function;\n  tableSelection: ITableSelection;\n  locale: TableConfig['locale'];\n}) => TableLayoutConfig[];\n\nexport const createToolbarLayout: LayoutFactory = (params) => {\n  const { controller, table, type, hideToolbar, tableSelection, locale } = params;\n  const isAutofit = Table.isAutofitWidth(table);\n  const containerWidth = isAutofit ? DEFAULT_TOTAL_WIDTH_FOR_AUTOFIT : undefined;\n  const handleClick = (callback: Function) => () => {\n    callback();\n    hideToolbar();\n  };\n  const handleCopy = () => {\n    controller.run('onAction', { type: ContextMenu.ACTION_COPY });\n  };\n  const handleCut = () => {\n    controller.run('onAction', { type: ContextMenu.ACTION_CUT });\n  };\n  const handlePaste = () => {\n    controller.run('onAction', { type: ContextMenu.ACTION_PASTE });\n  };\n  const handleClear = () => {\n    return emptyTableSelection(controller, table);\n  };\n  const defaultLayout = [{\n    key: KeyEnum.copy,\n    icon: <CopyIcon />,\n    title: locale?.contextMenuCopy,\n    onClick: handleClick(handleCopy),\n  }, {\n    key: KeyEnum.cut,\n    icon: <CutIcon />,\n    title: locale?.contextMenuCut,\n    onClick: handleClick(handleCut),\n  }, {\n    key: KeyEnum.paste,\n    icon: <PasteIcon />,\n    title: locale?.contextMenuPaste,\n    onClick: handleClick(handlePaste),\n  }, {\n    key: KeyEnum.clear,\n    icon: <ClearIcon />,\n    title: locale?.mobileFloatToolbar?.clear,\n    onClick: handleClick(handleClear),\n  }];\n\n  const { endColIndex } = tableSelection;\n  const colsWidth = table.data.colsWidth!;\n  const targetColIndex = endColIndex + 1;\n  const rightColWidth = colsWidth[endColIndex];\n  const leftColWidth = colsWidth[tableSelection.startColIndex];\n  const getNewTable = () => {\n    return controller.value.document.getNode(table.key) as Table;\n  };\n  const handleInsertRowAbove = () => {\n    controller.run('onAction', insertTableRowBySelections(table, 'insert-row-above'));\n    const newTblSelection: ITableSelection = {\n      ...tableSelection,\n      startRowIndex: tableSelection.startRowIndex + 1,\n      endRowIndex: tableSelection.endRowIndex + 1,\n      type: 'row',\n    };\n    selectTableSelection(controller, getNewTable(), newTblSelection, false);\n  };\n  const handleInsertRowBelow = () => {\n    controller.run('onAction', insertTableRowBySelections(table, 'insert-row-below'));\n    const newTblSelection: ITableSelection = {\n      ...tableSelection,\n      type: 'row',\n    };\n    selectTableSelection(controller, getNewTable(), newTblSelection, false);\n  };\n  const handleDeleteRow = () => {\n    controller.run('onAction', deleteTableRows(table));\n  };\n  const handleInsertColLeft = () => {\n    controller.run('onAction', insertTableCol(\n      table,\n      tableSelection.startColIndex,\n      tableSelection.startColIndex,\n      leftColWidth,\n      containerWidth,\n    ));\n    const newTblSelection: ITableSelection = {\n      ...tableSelection,\n      startColIndex: tableSelection.startColIndex + 1,\n      endColIndex: tableSelection.endColIndex + 1,\n      type: 'col',\n    };\n    selectTableSelection(controller, getNewTable(), newTblSelection, false);\n  };\n  const handleInsertColRight = () => {\n    controller.run('onAction', insertTableCol(\n      table,\n      targetColIndex,\n      endColIndex,\n      rightColWidth,\n      containerWidth,\n    ));\n    const newTblSelection: ITableSelection = {\n      ...tableSelection,\n      type: 'col',\n    };\n    selectTableSelection(controller, getNewTable(), newTblSelection, false);\n  };\n  const handleDeleteCol = () => {\n    controller.run('onAction', deleteTableCols(table));\n  };\n  const appendLayout: TableLayoutConfig[] = type === 'row' ?\n    [{\n      key: KeyEnum.insertRowAbove,\n      icon: <InsertRowAboveIcon />,\n      title: locale?.mobileFloatToolbar?.insertRowAbove,\n      onClick: handleClick(handleInsertRowAbove),\n    }, {\n      key: KeyEnum.insertRowBelow,\n      icon: <InsertRowBelowIcon />,\n      title: locale?.mobileFloatToolbar?.insertRowBelow,\n      onClick: handleClick(handleInsertRowBelow),\n    }, {\n      key: KeyEnum.deleteRow,\n      icon: <DeleteRowIcon />,\n      title: locale?.toolbarDeleteRow,\n      onClick: handleClick(handleDeleteRow),\n    }] :\n    [{\n      key: KeyEnum.insertColLeft,\n      icon: <InsertColLeftIcon />,\n      title: locale?.mobileFloatToolbar?.insertColLeft,\n      onClick: handleClick(handleInsertColLeft),\n    }, {\n      key: KeyEnum.insertColRight,\n      icon: <InsertColRightIcon />,\n      title: locale?.mobileFloatToolbar?.insertColRight,\n      onClick: handleClick(handleInsertColRight),\n    }, {\n      key: KeyEnum.deleteCol,\n      icon: <DeleteColIcon />,\n      title: locale?.toolbarDeleteCol,\n      onClick: handleClick(handleDeleteCol),\n    }];\n  return [...appendLayout, ...defaultLayout];\n};\n"],"file":"createToolbarLayout.js"}