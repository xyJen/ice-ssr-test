"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getPositionOfCell;
const POSITION_CACHE = new WeakMap();

const hasCache = (key, table) => {
  if (POSITION_CACHE.has(table)) {
    const tableCache = POSITION_CACHE.get(table);

    if (tableCache && tableCache[key] !== undefined) {
      return true;
    }
  }

  return false;
};

const setCache = (key, table, position) => {
  if (!POSITION_CACHE.has(table)) {
    POSITION_CACHE.set(table, {});
  }

  const tableCache = POSITION_CACHE.get(table);
  tableCache[key] = position;
  POSITION_CACHE.set(table, tableCache);
};

function getPositionOfCell(cellKey, table) {
  if (!table?.nodes) return null;

  if (hasCache(cellKey, table)) {
    return POSITION_CACHE.get(table)[cellKey];
  }

  const path = table.getPath(cellKey);

  if (!path || path.length !== 2) {
    setCache(cellKey, table, null);
    return null;
  }

  const position = {
    colIndex: path[1],
    rowIndex: path[0]
  };
  setCache(cellKey, table, position);
  return position;
}
//# sourceMappingURL=getPositionOfCell.js.map