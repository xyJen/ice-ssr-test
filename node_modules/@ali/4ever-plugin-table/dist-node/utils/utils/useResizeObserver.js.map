{"version":3,"sources":["../../../../src/utils/utils/useResizeObserver.ts"],"names":["useResizeObserver","target","callback","observerRef","React","useRef","useEffect","HTMLElement","undefined","current","ResizeObserver","fastdom","measure","rect","getBoundingClientRect","observe","box","unobserve","disconnect"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AACA;;AAEA,MAAMA,iBAAiB,GAAG,CACxBC,MADwB,EAExBC,QAFwB,KAGrB;AACH,QAAMC,WAAW,GAAGC,KAAK,CAACC,MAAN,EAApB;AAEAD,EAAAA,KAAK,CAACE,SAAN,CAAgB,MAAM;AACpB,QAAI,EAAEL,MAAM,YAAYM,WAApB,CAAJ,EAAsC,OAAOC,SAAP;AAEtCL,IAAAA,WAAW,CAACM,OAAZ,GAAsB,IAAIC,+BAAJ,CAAmB,MAAM;AAC7CC,uBAAQC,OAAR,CAAgB,MAAM;AACpB,cAAMC,IAAI,GAAGZ,MAAM,CAACa,qBAAP,EAAb;AACAZ,QAAAA,QAAQ,CAACW,IAAD,CAAR;AACD,OAHD;AAID,KALqB,CAAtB,CAHoB,CAUpB;;AACAV,IAAAA,WAAW,CAACM,OAAZ,CAAoBM,OAApB,CAA4Bd,MAA5B,EAAoC;AAAEe,MAAAA,GAAG,EAAE;AAAP,KAApC;AAEA,WAAO,MAAM;AACXb,MAAAA,WAAW,CAACM,OAAZ,EAAqBQ,SAArB,CAA+BhB,MAA/B;AACD,KAFD;AAGD,GAhBD,EAgBG,CAACA,MAAD,EAASC,QAAT,CAhBH;AAkBAE,EAAAA,KAAK,CAACE,SAAN,CAAgB,MAAM;AACpB,WAAO,MAAM;AACX,UAAIH,WAAW,CAACM,OAAhB,EAAyB;AACvBN,QAAAA,WAAW,CAACM,OAAZ,CAAoBS,UAApB;AACD;AACF,KAJD;AAKD,GAND,EAMG,EANH;AAOD,CA/BD;;eAiCelB,iB","sourcesContent":["import fastdom from 'fastdom';\nimport * as React from 'react';\nimport ResizeObserver from 'resize-observer-polyfill';\n\nconst useResizeObserver = (\n  target: HTMLElement | Window | null,\n  callback: ((rect: DOMRect) => void),\n) => {\n  const observerRef = React.useRef<ResizeObserver>();\n\n  React.useEffect(() => {\n    if (!(target instanceof HTMLElement)) return undefined;\n\n    observerRef.current = new ResizeObserver(() => {\n      fastdom.measure(() => {\n        const rect = target.getBoundingClientRect();\n        callback(rect);\n      });\n    });\n\n    // @ts-ignore resize-observer-polyfill API 不支持 options，浏览器可用\n    observerRef.current.observe(target, { box: 'border-box' });\n\n    return () => {\n      observerRef.current?.unobserve(target);\n    };\n  }, [target, callback]);\n\n  React.useEffect(() => {\n    return () => {\n      if (observerRef.current) {\n        observerRef.current.disconnect();\n      }\n    };\n  }, []);\n};\n\nexport default useResizeObserver;\n"],"file":"useResizeObserver.js"}