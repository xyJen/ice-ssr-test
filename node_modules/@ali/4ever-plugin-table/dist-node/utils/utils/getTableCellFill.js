"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getTabelCellFill;

var _models = _interopRequireDefault(require("../../mo/models"));

var _getPositionOfCell = _interopRequireDefault(require("./getPositionOfCell"));

function getTabelCellFill(cell, table, docStyle) {
  if (!table) return undefined;
  const cellFill = cell.data?.fill || cell.data?.shd?.fill;
  if (cellFill) return cellFill;
  const {
    styleId,
    tblLook
  } = table.data;
  if (!docStyle || !styleId) return undefined;
  const tableStyle = docStyle[styleId];
  if (!tableStyle) return undefined;
  const position = (0, _getPositionOfCell.default)(cell.key, table);
  if (!position) return undefined;
  const {
    rowIndex,
    colIndex
  } = position;
  if (rowIndex !== 0 && colIndex !== 0) return undefined;
  const tblStylePr = tableStyle?.data?.tblStylePr;
  if (!Array.isArray(tblStylePr)) return undefined;
  let fill;

  for (let i = 0; i < tblStylePr.length; i++) {
    const stylePr = tblStylePr[i];

    if (rowIndex === 0 && _models.default.isRowHeader(table) && stylePr.type === 'firstRow' && (tblLook?.firstRow === undefined || !!tblLook?.firstRow)) {
      fill = stylePr.tcPr?.shd?.fill;
      break;
    }

    if (colIndex === 0 && _models.default.isColumnHeader(table) && stylePr.type === 'firstCol' && (tblLook?.firstColumn === undefined || !!tblLook?.firstColumn)) {
      fill = stylePr.tcPr?.shd?.fill;
      break;
    }
  }

  return fill;
}
//# sourceMappingURL=getTableCellFill.js.map