{"version":3,"sources":["../../../../src/utils/components/title.tsx"],"names":["React","styled","classnames","domUtils","useZoom","FoldBox","div","props","foldBoxLeft","TitleBox","ArrowIconBox","span","size","rotate","arrow","Title","style","className","fold","onChange","dataName","disabled","children","role","foldBtnRef","useRef","titleRef","zoom","useState","hovered","setHovered","handleMouseEnterTitle","useCallback","handleMouseLeaveTitle","visible","handleClickFold","e","preventDefault","stopPropagation","useLayoutEffect","title","current","foldBtn","line","querySelector","splitRows","row","rowHeight","height","foldBtnTop","Math","round","offsetHeight","getComputedStyle","top","foldClassName"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport styled from 'styled-components';\nimport classnames from 'classnames';\nimport { domUtils, useZoom } from '@ali/4ever-cangjie';\n\nconst FoldBox = styled.div<{foldBoxLeft?: number}>`\n  opacity: 0;\n  position: absolute;\n  width: 20px;\n  height: 20px;\n  left: ${(props) => props.foldBoxLeft || 0 - 20}px;\n  margin: auto;\n  cursor: default;\n  z-index: 2;\n  border-radius: 4px;\n\n  &.disabled {\n    display: none;\n  }\n\n  &.visible {\n    opacity: 1;\n  }\n\n  &:hover {\n    background: rgba(25,31,37,0.08);\n  }\n`;\n\nconst TitleBox = styled.div`\n  position: relative;\n`;\n\nconst ArrowIconBox = styled.span<{ size: number; rotate: number }>`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: ${(props) => props.size}px;\n  height: ${(props) => props.size}px;\n\n  & svg {\n    transform: rotateZ(${(props) => props.rotate}deg);\n    transition: transform 0.2s ease-in-out;\n  }\n`;\n\nconst arrow = (\n  <svg width=\"10\" height=\"7\" viewBox=\"0 0 10 7\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M4.60369 5.98479C4.80384 6.24499 5.19616 6.24499 5.39631 5.98479L9.38088 0.804856C9.63381 0.476046 9.39941 0 8.98457 0L1.01543 0C0.600595 0 0.366189 0.476046 0.619119 0.804855L4.60369 5.98479Z\" fill=\"#171A1D\" fillOpacity=\"0.4\" />\n  </svg>\n);\n\nexport interface TitleProps {\n  style?: React.CSSProperties;\n  className?: string;\n  onChange?: (fold: boolean) => void;\n  fold: boolean;\n  dataName: string;\n  disabled?: boolean;\n  foldBoxLeft?: number;\n  role?: string;\n}\n\n/**\n * 分组标题组件\n * @param props\n * @returns\n */\nconst Title: React.FC<TitleProps> = (props) => {\n  const {\n    style,\n    className,\n    fold,\n    onChange,\n    dataName,\n    disabled,\n    children,\n    foldBoxLeft,\n    role,\n  } = props;\n\n  const foldBtnRef = React.useRef<HTMLDivElement>(null);\n  const titleRef = React.useRef<HTMLDivElement>(null);\n  const zoom = useZoom();\n\n  const [hovered, setHovered] = React.useState(false);\n  const handleMouseEnterTitle = React.useCallback(() => setHovered(true), []);\n  const handleMouseLeaveTitle = React.useCallback(() => setHovered(false), []);\n\n  const visible = hovered || fold;\n\n  /**\n   * 点击标题折叠\n   */\n  const handleClickFold = React.useCallback((e: React.MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (typeof onChange === 'function') {\n      onChange(!fold);\n    }\n  }, [fold, onChange]);\n\n  React.useLayoutEffect(() => {\n    if (!visible) {\n      return;\n    }\n    const title = titleRef.current;\n    const foldBtn = foldBtnRef.current;\n    if (!title || !foldBtn) {\n      return;\n    }\n    const line = title.querySelector('[data-name=\"heading-group-title-content\"]') || title;\n    const [row] = domUtils.splitRows(line, true);\n    const rowHeight = row.height;\n    const foldBtnTop = `${Math.round((rowHeight / zoom - foldBtn.offsetHeight) / 2)}px`;\n    if (getComputedStyle(foldBtn).top !== foldBtnTop) {\n      // 与第一行保持居中对齐\n      foldBtn.style.top = foldBtnTop;\n    }\n  });\n\n  const rotate = fold ? -90 : 0;\n  const foldClassName = classnames({\n    disabled,\n    visible,\n  });\n\n  return (\n    <TitleBox\n      ref={titleRef}\n      style={style}\n      className={className}\n      data-name={dataName}\n      onMouseEnter={handleMouseEnterTitle}\n      onMouseLeave={handleMouseLeaveTitle}\n    >\n      <FoldBox\n        ref={foldBtnRef}\n        foldBoxLeft={foldBoxLeft}\n        data-name=\"group-fold-btn\"\n        className={foldClassName}\n        onClick={handleClickFold}\n        data-role={role}\n      >\n        <ArrowIconBox size={20} rotate={rotate}>{arrow}</ArrowIconBox>\n      </FoldBox>\n      {children}\n    </TitleBox>\n  );\n};\n\nexport default Title;\n"],"file":"title.js"}