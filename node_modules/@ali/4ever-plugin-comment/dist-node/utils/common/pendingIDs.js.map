{"version":3,"sources":["../../../../src/utils/common/pendingIDs.ts"],"names":["pending","enqueue","obj","targetIndex","findIndex","p","prio","length","splice","dequeue","cancelQueue","isScheduled","shift","callback"],"mappings":";;;;;;;;;;AAAA;;AAMA,MAAMA,OAAgB,GAAG,EAAzB;;AAEO,SAASC,OAAT,CAAiBC,GAAjB,EAA6B;AAClC,MAAIC,WAAW,GAAGH,OAAO,CAACI,SAAR,CAAmBC,CAAD,IAAOA,CAAC,CAACC,IAAF,GAASJ,GAAG,CAACI,IAAtC,CAAlB;;AACA,MAAIH,WAAW,GAAG,CAAlB,EAAqB;AACnBA,IAAAA,WAAW,GAAGH,OAAO,CAACO,MAAtB;AACD;;AACDP,EAAAA,OAAO,CAACQ,MAAR,CAAeL,WAAf,EAA4B,CAA5B,EAA+BD,GAA/B;AACAO,EAAAA,OAAO;AACR;;AAEM,SAASC,WAAT,CAAqBR,GAArB,EAAiC;AACtC,QAAMC,WAAW,GAAGH,OAAO,CAACI,SAAR,CAAmBC,CAAD,IAAOA,CAAC,KAAKH,GAA/B,CAApB;;AACA,MAAIC,WAAW,IAAI,CAAnB,EAAsB;AACpBH,IAAAA,OAAO,CAACQ,MAAR,CAAeL,WAAf,EAA4B,CAA5B;AACD;AACF;;AAED,IAAIQ,WAAW,GAAG,KAAlB;;AACA,SAASF,OAAT,GAAmB;AACjB,MAAIE,WAAJ,EAAiB;AACf;AACD;;AACDA,EAAAA,WAAW,GAAG,IAAd;AACA,4BAAY,MAAM;AAChBA,IAAAA,WAAW,GAAG,KAAd;AACA,UAAMN,CAAC,GAAGL,OAAO,CAACY,KAAR,EAAV;;AACA,QAAIP,CAAJ,EAAO;AACLA,MAAAA,CAAC,CAACQ,QAAF;AACAJ,MAAAA,OAAO;AACR;AACF,GAPD;AAQD","sourcesContent":["import requestIdle from '../utils/requestIdle';\ninterface Queue {\n  prio: number;\n  callback: Function;\n}\n\nconst pending: Queue[] = [];\n\nexport function enqueue(obj: Queue) {\n  let targetIndex = pending.findIndex((p) => p.prio > obj.prio);\n  if (targetIndex < 0) {\n    targetIndex = pending.length;\n  }\n  pending.splice(targetIndex, 0, obj);\n  dequeue();\n}\n\nexport function cancelQueue(obj: Queue) {\n  const targetIndex = pending.findIndex((p) => p === obj);\n  if (targetIndex >= 0) {\n    pending.splice(targetIndex, 1);\n  }\n}\n\nlet isScheduled = false;\nfunction dequeue() {\n  if (isScheduled) {\n    return;\n  }\n  isScheduled = true;\n  requestIdle(() => {\n    isScheduled = false;\n    const p = pending.shift();\n    if (p) {\n      p.callback();\n      dequeue();\n    }\n  });\n}\n"],"file":"pendingIDs.js"}