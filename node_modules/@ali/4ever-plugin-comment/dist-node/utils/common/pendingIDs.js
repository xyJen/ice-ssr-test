"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.enqueue = enqueue;
exports.cancelQueue = cancelQueue;

var _requestIdle = _interopRequireDefault(require("../utils/requestIdle"));

const pending = [];

function enqueue(obj) {
  let targetIndex = pending.findIndex(p => p.prio > obj.prio);

  if (targetIndex < 0) {
    targetIndex = pending.length;
  }

  pending.splice(targetIndex, 0, obj);
  dequeue();
}

function cancelQueue(obj) {
  const targetIndex = pending.findIndex(p => p === obj);

  if (targetIndex >= 0) {
    pending.splice(targetIndex, 1);
  }
}

let isScheduled = false;

function dequeue() {
  if (isScheduled) {
    return;
  }

  isScheduled = true;
  (0, _requestIdle.default)(() => {
    isScheduled = false;
    const p = pending.shift();

    if (p) {
      p.callback();
      dequeue();
    }
  });
}
//# sourceMappingURL=pendingIDs.js.map