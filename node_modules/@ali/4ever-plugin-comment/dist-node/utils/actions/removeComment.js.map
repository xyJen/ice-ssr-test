{"version":3,"sources":["../../../../src/utils/actions/removeComment.ts"],"names":["removeComment","contentId","controller","decorations","value","currentDec","find","dec","ViewMark","isViewMark","mark","data","undefined","DataMark","create","start","anchor","end","focus","range","Selection","isCollapsed","command","Commands","removeMarkByKey","key","removeMarkAtRange"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AAEe,SAASA,aAAT,CACbC,SADa,EAEbC,UAFa,EAGb;AACA,QAAM;AAAEC,IAAAA;AAAF,MAAkBD,UAAU,CAACE,KAAnC;AACA,QAAMC,UAAU,GAAGF,WAAW,CAACG,IAAZ,CAChBC,GAAD,IACEC,gBAASC,UAAT,CAAoBF,GAAG,CAACG,IAAxB,KAAiCH,GAAG,CAACG,IAAJ,CAASC,IAAT,CAAcV,SAAd,KAA4BA,SAF9C,CAAnB;;AAIA,MAAII,UAAJ,EAAgB;AACd,8BAAYH,UAAZ,EAAwBU,SAAxB;;AACA,UAAMF,IAAI,GAAGG,gBAASC,MAAT,CAAgB;AAAEb,MAAAA;AAAF,KAAhB,CAAb;;AACA,UAAM;AAAEc,MAAAA,KAAK,EAAEC,MAAT;AAAiBC,MAAAA,GAAG,EAAEC;AAAtB,QAAgCb,UAAtC;;AACA,UAAMc,KAAK,GAAGC,uBAAUN,MAAV,CAAiB;AAAEE,MAAAA,MAAF;AAAUE,MAAAA;AAAV,KAAjB,CAAd;;AACA,QAAIC,KAAK,CAACE,WAAV,EAAuB;AACrBnB,MAAAA,UAAU,CAACoB,OAAX,CAAmBC,sBAASC,eAA5B,EAA6CR,MAAM,CAACS,GAApD,EAAyD,CAAzD,EAA4D,CAA5D,EAA+Df,IAA/D;AACD,KAFD,MAEO;AACLR,MAAAA,UAAU,CAACoB,OAAX,CAAmBC,sBAASG,iBAA5B,EAA+CP,KAA/C,EAAsDT,IAAtD;AACD;AACF;AACF","sourcesContent":["import { Commands, Selection, Controller } from '@ali/4ever-cangjie';\nimport { ViewMark, DataMark } from '../models/marks';\nimport showComment from './showComment';\n\nexport default function removeComment(\n  contentId: string,\n  controller: Controller,\n) {\n  const { decorations } = controller.value;\n  const currentDec = decorations.find(\n    (dec) =>\n      ViewMark.isViewMark(dec.mark) && dec.mark.data.contentId === contentId,\n  );\n  if (currentDec) {\n    showComment(controller, undefined);\n    const mark = DataMark.create({ contentId });\n    const { start: anchor, end: focus } = currentDec;\n    const range = Selection.create({ anchor, focus });\n    if (range.isCollapsed) {\n      controller.command(Commands.removeMarkByKey, anchor.key, 0, 0, mark);\n    } else {\n      controller.command(Commands.removeMarkAtRange, range, mark);\n    }\n  }\n}\n"],"file":"removeComment.js"}