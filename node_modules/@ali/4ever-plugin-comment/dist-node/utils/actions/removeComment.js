"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = removeComment;

var _everCangjie = require("@ali/4ever-cangjie");

var _marks = require("../models/marks");

var _showComment = _interopRequireDefault(require("./showComment"));

function removeComment(contentId, controller) {
  const {
    decorations
  } = controller.value;
  const currentDec = decorations.find(dec => _marks.ViewMark.isViewMark(dec.mark) && dec.mark.data.contentId === contentId);

  if (currentDec) {
    (0, _showComment.default)(controller, undefined);

    const mark = _marks.DataMark.create({
      contentId
    });

    const {
      start: anchor,
      end: focus
    } = currentDec;

    const range = _everCangjie.Selection.create({
      anchor,
      focus
    });

    if (range.isCollapsed) {
      controller.command(_everCangjie.Commands.removeMarkByKey, anchor.key, 0, 0, mark);
    } else {
      controller.command(_everCangjie.Commands.removeMarkAtRange, range, mark);
    }
  }
}
//# sourceMappingURL=removeComment.js.map