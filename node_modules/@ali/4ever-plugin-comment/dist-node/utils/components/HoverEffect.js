"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = HoverEffect;

var _react = _interopRequireDefault(require("react"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _everCangjie = require("@ali/4ever-cangjie");

var _constants = require("../constants");

const _createElement = /*#__PURE__*/_react.default.createElement;

const HoverEffectWrapper = /*#__PURE__*/_styledComponents.default.div(["z-index:1;width:0;height:0;float:left;position:relative;"]);

const HoverEffectNode = /*#__PURE__*/_styledComponents.default.div(["position:absolute;left:0;top:0;border-radius:4px;transition:background 0.25s;"]);

function HoverEffect({
  blockKey
}) {
  const ref = _react.default.useRef(null);

  const zoom = (0, _everCangjie.useZoom)();

  _react.default.useEffect(() => {
    const target = ref.current?.parentElement?.nextElementSibling;
    const node = ref.current;

    if (!target || !node) {
      return undefined;
    }

    const {
      top,
      width,
      height
    } = target.getBoundingClientRect();
    const {
      top: selfTop
    } = ref.current.parentElement.getBoundingClientRect();
    node.style.width = `${width / zoom}px`;
    node.style.height = `${height / zoom}px`;
    node.style.top = `${(top - selfTop) / zoom}px`;
    const timer = requestAnimationFrame(() => {
      node.style.backgroundColor = _constants.COLOR;
    });
    return () => {
      cancelAnimationFrame(timer);
    };
  }, [zoom]);

  return /*#__PURE__*/_createElement(HoverEffectWrapper, {
    "data-drag-handler-key": blockKey
  }, /*#__PURE__*/_createElement(HoverEffectNode, {
    ref: ref
  }));
}
//# sourceMappingURL=HoverEffect.js.map