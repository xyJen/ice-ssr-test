"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = canComment;

var _everCangjie = require("@ali/4ever-cangjie");

/**
 * 当前 block 是否包含文字或者其它 inline 内容
 */
function canComment(controller, range) {
  const {
    document
  } = controller.value;
  const newRange = (range || controller.value.selection).convertToTextPoints(document);

  const selection = _everCangjie.Selection.create(newRange);

  if (selection.isExpanded) {
    return true;
  }

  try {
    const {
      anchor
    } = selection;
    const block = document.getClosestBlock(anchor.key);

    if (!block) {
      return true;
    }

    const isVoid = controller.query('isVoid', block);
    const onlyChild = !isVoid && block.nodes.length === 1 && block.nodes[0];

    if (onlyChild && onlyChild.isText() && !onlyChild.text) {
      return false;
    }
  } catch (error) {// ignore
  }

  return true;
}
//# sourceMappingURL=canComment.js.map