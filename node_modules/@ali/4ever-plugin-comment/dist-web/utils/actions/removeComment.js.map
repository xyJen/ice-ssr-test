{"version":3,"sources":["../../../../src/utils/actions/removeComment.ts"],"names":["Commands","Selection","ViewMark","DataMark","showComment","removeComment","contentId","controller","decorations","value","currentDec","find","dec","isViewMark","mark","data","undefined","create","anchor","start","focus","end","range","isCollapsed","command","removeMarkByKey","key","removeMarkAtRange"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,SAAnB,QAAgD,oBAAhD;AACA,SAASC,QAAT,EAAmBC,QAAnB;AACA,OAAOC,WAAP;AAEA,eAAe,SAASC,aAAT,CACbC,SADa,EAEbC,UAFa,EAGb;AAAA,MACQC,WADR,GACwBD,UAAU,CAACE,KADnC,CACQD,WADR;AAEA,MAAME,UAAU,GAAGF,WAAW,CAACG,IAAZ,CACjB,UAACC,GAAD;AAAA,WACEV,QAAQ,CAACW,UAAT,CAAoBD,GAAG,CAACE,IAAxB,KAAiCF,GAAG,CAACE,IAAJ,CAASC,IAAT,CAAcT,SAAd,KAA4BA,SAD/D;AAAA,GADiB,CAAnB;;AAIA,MAAII,UAAJ,EAAgB;AACdN,IAAAA,WAAW,CAACG,UAAD,EAAaS,SAAb,CAAX;AACA,QAAMF,IAAI,GAAGX,QAAQ,CAACc,MAAT,CAAgB;AAAEX,MAAAA,SAAS,EAATA;AAAF,KAAhB,CAAb;AAFc,QAGCY,MAHD,GAGwBR,UAHxB,CAGNS,KAHM;AAAA,QAGcC,KAHd,GAGwBV,UAHxB,CAGSW,GAHT;AAId,QAAMC,KAAK,GAAGrB,SAAS,CAACgB,MAAV,CAAiB;AAAEC,MAAAA,MAAM,EAANA,MAAF;AAAUE,MAAAA,KAAK,EAALA;AAAV,KAAjB,CAAd;;AACA,QAAIE,KAAK,CAACC,WAAV,EAAuB;AACrBhB,MAAAA,UAAU,CAACiB,OAAX,CAAmBxB,QAAQ,CAACyB,eAA5B,EAA6CP,MAAM,CAACQ,GAApD,EAAyD,CAAzD,EAA4D,CAA5D,EAA+DZ,IAA/D;AACD,KAFD,MAEO;AACLP,MAAAA,UAAU,CAACiB,OAAX,CAAmBxB,QAAQ,CAAC2B,iBAA5B,EAA+CL,KAA/C,EAAsDR,IAAtD;AACD;AACF;AACF","sourcesContent":["import { Commands, Selection, Controller } from '@ali/4ever-cangjie';\nimport { ViewMark, DataMark } from '../models/marks';\nimport showComment from './showComment';\n\nexport default function removeComment(\n  contentId: string,\n  controller: Controller,\n) {\n  const { decorations } = controller.value;\n  const currentDec = decorations.find(\n    (dec) =>\n      ViewMark.isViewMark(dec.mark) && dec.mark.data.contentId === contentId,\n  );\n  if (currentDec) {\n    showComment(controller, undefined);\n    const mark = DataMark.create({ contentId });\n    const { start: anchor, end: focus } = currentDec;\n    const range = Selection.create({ anchor, focus });\n    if (range.isCollapsed) {\n      controller.command(Commands.removeMarkByKey, anchor.key, 0, 0, mark);\n    } else {\n      controller.command(Commands.removeMarkAtRange, range, mark);\n    }\n  }\n}\n"],"file":"removeComment.js"}