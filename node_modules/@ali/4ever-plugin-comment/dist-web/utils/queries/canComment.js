import { Selection } from '@ali/4ever-cangjie';
/**
 * 当前 block 是否包含文字或者其它 inline 内容
 */

export default function canComment(controller, range) {
  var document = controller.value.document;
  var newRange = (range || controller.value.selection).convertToTextPoints(document);
  var selection = Selection.create(newRange);

  if (selection.isExpanded) {
    return true;
  }

  try {
    var anchor = selection.anchor;
    var block = document.getClosestBlock(anchor.key);

    if (!block) {
      return true;
    }

    var isVoid = controller.query('isVoid', block);
    var onlyChild = !isVoid && block.nodes.length === 1 && block.nodes[0];

    if (onlyChild && onlyChild.isText() && !onlyChild.text) {
      return false;
    }
  } catch (error) {// ignore
  }

  return true;
}
//# sourceMappingURL=canComment.js.map