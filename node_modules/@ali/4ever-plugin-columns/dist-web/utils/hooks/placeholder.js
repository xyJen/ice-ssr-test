import { Block } from '@ali/4ever-cangjie';
import { Table, TableCell } from '@ali/4ever-plugin-table';
import { isEmptyParagraph } from '@ali/4ever-utils';
export default function placeholder(configs) {
  var locale = (configs == null ? void 0 : configs.locale) || {};
  var _locale$insertText = locale.insertText1,
      insertText1 = _locale$insertText === void 0 ? 'New Column' : _locale$insertText,
      _locale$insertText2 = locale.insertText2,
      insertText2 = _locale$insertText2 === void 0 ? '' : _locale$insertText2;
  return [{
    text: function text(controller, node) {
      var document = controller.value.document;
      var block = document.getClosestBlock(node.key);
      var path = block && document.getPath(block.key);
      var index = path && path[path.length - 2];

      if (typeof index !== 'number') {
        return '';
      }

      return insertText1 + " " + (index + 1) + " " + insertText2;
    },
    when: function when(controller, block) {
      if (!Block.isBlock(block)) {
        return false;
      }

      var document = controller.value.document;
      var maybeCell = document.getParent(block.key);

      if (!TableCell.isTableCell(maybeCell) || maybeCell.nodes.length !== 1) {
        return false;
      }

      var row = document.getParent(maybeCell.key);
      var table = document.getParent((row == null ? void 0 : row.key) || '');

      if (!Table.isTable(table) || !table.data.sr) {
        return false;
      }

      return isEmptyParagraph(block);
    }
  }];
}
//# sourceMappingURL=placeholder.js.map