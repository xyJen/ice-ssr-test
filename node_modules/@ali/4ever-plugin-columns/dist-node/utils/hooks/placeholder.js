"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = placeholder;

var _everCangjie = require("@ali/4ever-cangjie");

var _everPluginTable = require("@ali/4ever-plugin-table");

var _everUtils = require("@ali/4ever-utils");

function placeholder(configs) {
  const locale = configs?.locale || {};
  const {
    insertText1 = 'New Column',
    insertText2 = ''
  } = locale;
  return [{
    text: (controller, node) => {
      const {
        document
      } = controller.value;
      const block = document.getClosestBlock(node.key);
      const path = block && document.getPath(block.key);
      const index = path && path[path.length - 2];

      if (typeof index !== 'number') {
        return '';
      }

      return `${insertText1} ${index + 1} ${insertText2}`;
    },
    when: (controller, block) => {
      if (!_everCangjie.Block.isBlock(block)) {
        return false;
      }

      const {
        document
      } = controller.value;
      const maybeCell = document.getParent(block.key);

      if (!_everPluginTable.TableCell.isTableCell(maybeCell) || maybeCell.nodes.length !== 1) {
        return false;
      }

      const row = document.getParent(maybeCell.key);
      const table = document.getParent(row?.key || '');

      if (!_everPluginTable.Table.isTable(table) || !table.data.sr) {
        return false;
      }

      return (0, _everUtils.isEmptyParagraph)(block);
    }
  }];
}
//# sourceMappingURL=placeholder.js.map