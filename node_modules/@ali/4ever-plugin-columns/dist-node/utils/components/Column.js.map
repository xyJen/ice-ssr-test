{"version":3,"sources":["../../../../src/utils/components/Column.tsx"],"names":["IS_MOBILE","IS_IPAD","environment","IS_PC_OR_IPAD","Wrapper","styled","div","theme","commonBgHoverColor","p","isHover","hoverCSS","borderBoxHoverCSS","props","isLastOne","Content","css","blockMarginStyleInContainer","PercentTab","PercentText","isAligned","SelectedColumnLayer","isSelectWholeTable","vAlignToFlex","vAlign","isHidePadding","colors","every","c","Column","cell","controller","ColorButton","children","configs","forceUpdate","React","useReducer","document","value","table","getClosest","key","isColumnsTable","query","node","cellItem","ref","useRef","useEffect","nodes","length","n","Block","isBlock","run","showInnerToolbar","setShowInnerToolbar","useState","updateInnerToolbar","useCallback","event","target","HTMLElement","panel","closest","showIt","current","trailing","handleHideInnerToolbar","cancel","enableBorderHighlight","useMemo","hoverHandlers","onMouseLeave","handleMouseMove","persist","window","addEventListener","removeEventListener","onSelectingHots","hots","hot","find","hotNodeKey","maybeCell","index","percent","percentAligned","isDragging","count","handleDragging","handleDraggingChange","widthStr","COLUMN_SPACE","fill","border","data","pLeft","HORIZ_PADDING","pRight","background","style","width","contentStyle","justifyContent","paddingLeft","paddingRight","percentText","Math","round","disableInnerButton","ExtraAboveComponent","getExtraAboveComponent","extraAboveComponentStyle","Fragment","readOnly","uuid","isFocused"],"mappings":";;;;;;;;;;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AAdA;uBAC4B,a;AAe5B,MAAM;AAAEA,EAAAA,SAAF;AAAaC,EAAAA;AAAb,IAAyBC,wBAA/B;AACA,MAAMC,aAAa,GAAG,CAACH,SAAD,IAAcC,OAApC;;AAEA,MAAMG,OAAO,gBAAGC,0BAAOC,GAAV,iPAUWC,gBAAMC,kBAVjB,EAYRC,CAAD,IAAQA,CAAC,CAACC,OAAF,GAAYC,wBAASC,iBAArB,GAAyC,EAZxC,EAaRC,KAAD,IACCV,aAAa,GACV,EADU,GAET;AACT;AACA;AACA,yBAAyBU,KAAK,CAACC,SAAN,GAAkB,GAAlB,GAAwB,KAAM;AACvD;AACA,KArBa,CAAb;;AAwBA,MAAMC,OAAO,gBAAGV,0BAAOC,GAAV,ubAYTU,qBAZS,YAYHC,sCAZG,EAAb;;AA8BA,MAAMC,UAAU,gBAAGb,0BAAOC,GAAV,mJAAhB;;AAYA,MAAMa,WAAW,gBAAGd,0BAAOC,GAAV,2IACN,CAAC;AAAEc,EAAAA;AAAF,CAAD,KACNA,SAAS,GAAG,yBAAH,GAA+B,SAF5B,EAMK,CAAC;AAAEA,EAAAA;AAAF,CAAD,KACjBA,SAAS,GAAG,0BAAH,GAAgC,yBAP7B,CAAjB;;AAYA,MAAMC,mBAAmB,gBAAGhB,0BAAOC,GAAV,mIAOZ,CAAC;AAAEgB,EAAAA;AAAF,CAAD,KAA6BA,kBAAkB,GAAG,OAAH,GAAa,MAPhD,CAAzB;;AAiBA,MAAMC,YAAY,GAAIC,MAAD,IAAqB;AACxC,MAAIA,MAAM,KAAK,KAAf,EAAsB;AACpB,WAAO,YAAP;AACD;;AACD,MAAIA,MAAM,KAAK,QAAf,EAAyB;AACvB,WAAO,UAAP;AACD;;AACD,SAAO,QAAP;AACD,CARD;;AAUA,SAASC,aAAT,CAAuBC,MAAvB,EAA0D;AACxD,SAAOA,MAAM,CAACC,KAAP,CAAcC,CAAD,IAAO,CAACA,CAAD,IAAMA,CAAC,KAAK,aAAhC,CAAP;AACD;;AAEc,SAASC,MAAT,CAAgB;AAC7BC,EAAAA,IAD6B;AAE7BC,EAAAA,UAF6B;AAG7BC,EAAAA,WAH6B;AAI7BC,EAAAA,QAJ6B;AAK7BC,EAAAA;AAL6B,CAAhB,EAMqB;AAClC,QAAM,GAAGC,WAAH,IAAkBC,KAAK,CAACC,UAAN,CAAkBT,CAAD,IAAO,CAACA,CAAzB,EAA4B,KAA5B,CAAxB;AAEA,QAAM;AAAEU,IAAAA;AAAF,MAAeP,UAAU,CAACQ,KAAhC;AACA,QAAMC,KAAK,GAAGF,QAAQ,CAACG,UAAT,CAAoBX,IAAI,CAACY,GAAzB,EAA8BC,yBAA9B,CAAd;AACA,QAAMrB,kBAAkB,GAAGS,UAAU,CAACa,KAAX,CAAiB,oBAAjB,EAAuC;AAAEC,IAAAA,IAAI,EAAEL;AAAR,GAAvC,CAA3B;AACA,QAAMM,QAAQ,GAAG,qCAAehB,IAAI,CAACY,GAApB,CAAjB;AACA,QAAMK,GAAG,GAAGX,KAAK,CAACY,MAAN,CAA6B,IAA7B,CAAZ;AAEAZ,EAAAA,KAAK,CAACa,SAAN,CAAgB,MAAM;AACpB,UAAMC,KAAK,GAAGpB,IAAI,CAACoB,KAAL,IAAc,EAA5B;;AACA,QAAI,CAACA,KAAK,CAACC,MAAP,IAAiBD,KAAK,CAACvB,KAAN,CAAayB,CAAD,IAAO,CAACC,mBAAMC,OAAN,CAAcF,CAAd,CAApB,CAArB,EAA4D;AAC1DrB,MAAAA,UAAU,CAACwB,GAAX,CAAe,UAAf,EAA2B,2BAAa;AAAEb,QAAAA,GAAG,EAAEZ,IAAI,CAACY;AAAZ,OAAb,CAA3B;AACD;AACF,GALD,EAKG,CAACZ,IAAD,EAAOC,UAAP,CALH;AAOA,QAAM,CAACyB,gBAAD,EAAmBC,mBAAnB,IAA0CrB,KAAK,CAACsB,QAAN,CAAe,KAAf,CAAhD;AAEA,QAAMC,kBAAkB,GAAGvB,KAAK,CAACwB,WAAN,CACzB,sBAAUC,KAAD,IAA6B;AACpC,UAAM;AAAEC,MAAAA;AAAF,QAAaD,KAAnB;;AACA,QAAI,EAAEC,MAAM,YAAYC,WAApB,CAAJ,EAAsC;AACpC;AACD;;AACD,UAAMC,KAAK,GAAGF,MAAM,CAACG,OAAP,CAAe,2BAAf,CAAd;AACA,UAAMC,MAAM,GAAG,CAACF,KAAD,IAAUA,KAAK,KAAKjB,GAAG,CAACoB,OAAvC;;AACA,QAAIX,gBAAgB,KAAKU,MAAzB,EAAiC;AAC/BT,MAAAA,mBAAmB,CAACS,MAAD,CAAnB;AACD;AACF,GAVD,EAUG,GAVH,EAUQ;AAAEE,IAAAA,QAAQ,EAAE;AAAZ,GAVR,CADyB,EAYzB,CAACZ,gBAAD,CAZyB,CAA3B;AAeA,QAAMa,sBAAsB,GAAGjC,KAAK,CAACwB,WAAN,CAAkB,MAAM;AACrDD,IAAAA,kBAAkB,CAACW,MAAnB;AACAb,IAAAA,mBAAmB,CAAC,KAAD,CAAnB;AACD,GAH8B,EAG5B,CAACE,kBAAD,CAH4B,CAA/B;AAKA,QAAMY,qBAAqB,GAAGnC,KAAK,CAACoC,OAAN,CAAc,MAAMzC,UAAU,CAACa,KAAX,CAAiB,uBAAjB,CAApB,EAA+D,EAA/D,CAA9B;AACA,QAAM,CAAClC,OAAD,EAAU+D,aAAV,IAA2B,6BAASF,qBAAT,EAAgC;AAC/DG,IAAAA,YAAY,EAAEL;AADiD,GAAhC,CAAjC;AAIA,QAAMM,eAAe,GAAGvC,KAAK,CAACwB,WAAN,CAAmBC,KAAD,IAA6B;AACrE,QAAI,CAAC1D,aAAL,EAAoB;AAClB;AACD;;AACD0D,IAAAA,KAAK,CAACe,OAAN,GAJqE,CAKrE;;AACAjB,IAAAA,kBAAkB,CAACE,KAAD,CAAlB;AACD,GAPuB,EAOrB,CAACF,kBAAD,CAPqB,CAAxB,CA3CkC,CAoDlC;;AACAvB,EAAAA,KAAK,CAACa,SAAN,CAAgB,MAAM;AACpB4B,IAAAA,MAAM,CAACvC,QAAP,CAAgBwC,gBAAhB,CAAiC,SAAjC,EAA4CT,sBAA5C;AACA,WAAO,MAAM;AACXQ,MAAAA,MAAM,CAACvC,QAAP,CAAgByC,mBAAhB,CAAoC,SAApC,EAA+CV,sBAA/C;AACD,KAFD;AAGD,GALD,EAKG,CAACtC,UAAD,EAAasC,sBAAb,CALH,EArDkC,CA4DlC;;AACA,QAAMW,eAAe,GAAG5C,KAAK,CAACwB,WAAN,CAAmBqB,IAAD,IAAiB;AACzD,UAAM3D,kBAAkB,GAAGS,UAAU,CAACa,KAAX,CAAiB,oBAAjB,EAAuC;AAAEC,MAAAA,IAAI,EAAEL;AAAR,KAAvC,CAA3B;;AACA,QAAI,CAAClB,kBAAL,EAAyB;AACvB;AACD;;AACD,UAAM4D,GAAG,GAAGD,IAAI,CAACE,IAAL,CAAWD,GAAD,IAAS;AAC7B,YAAME,UAAU,GAAGF,GAAG,CAACrC,IAAJ,CAASH,GAA5B;;AACA,UAAI,8BAAcJ,QAAd,EAAwB8C,UAAxB,KAAuCA,UAAU,KAAKtD,IAAI,CAACY,GAA/D,EAAoE;AAClE,eAAOwC,GAAP;AACD,OAFD,MAEO;AACL,cAAMG,SAAS,GAAG/C,QAAQ,CAACG,UAAT,CAAoB2C,UAApB,EAAgC,CAAC;AAAE1C,UAAAA;AAAF,SAAD,KAAa,8BAAcJ,QAAd,EAAwBI,GAAxB,CAA7C,CAAlB;;AACA,YAAI2C,SAAS,IAAIA,SAAS,CAAC3C,GAAV,KAAkBZ,IAAI,CAACY,GAAxC,EAA6C;AAC3C,iBAAOwC,GAAP;AACD;AACF;;AACD,aAAO,KAAP;AACD,KAXW,CAAZ;;AAYA,QAAIA,GAAJ,EAAS;AACP/C,MAAAA,WAAW;AACZ;AACF,GApBuB,EAoBrB,CAACJ,UAAD,EAAaD,IAAb,EAAmBU,KAAnB,EAA0BF,QAA1B,CApBqB,CAAxB;AAqBA,qCAAiBP,UAAjB,EAA6BiD,eAA7B;;AAEA,MAAI,CAAClC,QAAL,EAAe;AACb,wBAAO,eAAC,KAAD,CAAO,QAAP,QAAiBb,QAAjB,CAAP;AACD;;AAED,QAAM;AACJqD,IAAAA,KADI;AAEJC,IAAAA,OAFI;AAGJC,IAAAA,cAHI;AAIJC,IAAAA,UAJI;AAKJC,IAAAA,KALI;AAMJC,IAAAA,cANI;AAOJC,IAAAA;AAPI,MAQF9C,QARJ;AAUA,QAAM+C,QAAQ,GAAI,gBAChBC,2BAAgBJ,KAAK,GAAG,CAAxB,CACD,SAAQH,OAAQ,GAFjB;AAIA,QAAM;AAAEQ,IAAAA,IAAF;AAAQvE,IAAAA,MAAR;AAAgBwE,IAAAA;AAAhB,MAA2BlE,IAAI,CAACmE,IAAtC;AACA,QAAMC,KAAK,GAAGzE,aAAa,CAAC,CAACsE,IAAD,EAAOC,MAAP,CAAD,CAAb,GAAgC,CAAhC,GAAoCG,wBAAlD;AACA,QAAMC,MAAM,GAAG3E,aAAa,CAAC,CAACsE,IAAD,EAAOC,MAAP,CAAD,CAAb,GAAgC,CAAhC,GAAoCG,wBAAnD;AACA,QAAME,UAAU,GAAGN,IAAI,IAAI,aAA3B;AACA,QAAMO,KAA0B,GAAG;AACjCC,IAAAA,KAAK,EAAEV,QAD0B;AAEjCQ,IAAAA,UAFiC;AAGjCL,IAAAA,MAAM,EAAG,aAAYA,MAAM,IAAIK,UAAW;AAHT,GAAnC;AAMA,QAAMG,YAAiC,GAAG;AACxCC,IAAAA,cAAc,EAAElF,YAAY,CAACC,MAAD,CADY;AAExCkF,IAAAA,WAAW,EAAG,GAAER,KAAM,IAFkB;AAGxCS,IAAAA,YAAY,EAAG,GAAEP,MAAO;AAHgB,GAA1C;AAKA,QAAMQ,WAAW,GAAI,GAAEC,IAAI,CAACC,KAAL,CAAWvB,OAAO,GAAG,GAArB,CAA0B,GAAjD;AACA,QAAMwB,kBAAkB,GAAGhF,UAAU,CAACa,KAAX,CAAiB,iBAAjB,EAAoC,SAApC,CAA3B;AAEA,MAAIoE,mBAAmB,GAAG9E,OAAO,EAAE+E,sBAAT,GAAkCnF,IAAlC,EAAwCC,UAAxC,CAA1B;AACA,MAAImF,wBAAJ;;AACA,MAAIF,mBAAJ,EAAyB;AACvBE,IAAAA,wBAAwB,GAAG;AACzBX,MAAAA,KAAK,EAAEV;AADkB,KAA3B;AAGAS,IAAAA,KAAK,CAACC,KAAN,GAAc,MAAd;AACD;;AAEDS,EAAAA,mBAAmB,GAAGA,mBAAmB,IAAI5E,KAAK,CAAC+E,QAAnD;AAGA,sBACE,eAAC,KAAD,CAAO,QAAP,QACG7B,KAAK,KAAK,CAAV,iBACC,eAAC,gBAAD;AACE,IAAA,OAAO,EAAExD,IAAI,CAACY,GADhB;AAEE,IAAA,SAAS,EAAE+C,UAFb;AAGE,IAAA,QAAQ,EAAE1D,UAAU,CAACqF,QAHvB;AAIE,IAAA,SAAS,EAAEjH,aAAa,IAAI,CAAC4B,UAAU,CAACqF,QAJ1C;AAKE,IAAA,UAAU,EAAEzB,cALd;AAME,IAAA,gBAAgB,EAAEC,oBANpB;AAOE,IAAA,KAAK,EAAEN;AAPT,IAFJ,eAYE,eAAC,mBAAD;AACE,IAAA,UAAU,EAAEvD,UADd;AAEE,IAAA,IAAI,EAAED,IAFR;AAGE,IAAA,KAAK,EAAEoF,wBAHT;AAIE,IAAA,SAAS,EAAE5B,KAAK,KAAKI,KAAK,GAAG;AAJ/B,kBAME,eAAC,OAAD;AACE,IAAA,KAAK,EAAEY,KADT;AAEE,IAAA,GAAG,EAAEvD,GAFP;AAGE,uBAHF;AAIE,IAAA,SAAS,EAAEuC,KAAK,KAAKI,KAAK,GAAG,CAJ/B;AAKE,gCALF;AAME;AANF,KAOMjB,aAPN;AAQE,IAAA,WAAW,EAAEE,eARf;AASE,uBAAiB7C,IAAI,CAACmE,IAAL,EAAWoB,IAT9B;AAUE,wBAAkBvF,IAAI,CAACY,GAVzB;AAWE,sBAAe,WAXjB;AAYE,IAAA,OAAO,EAAEhC,OAAO,IAAIqB,UAAU,CAACQ,KAAX,CAAiB+E;AAZvC,mBAcE,eAAC,mBAAD;AAAqB,IAAA,kBAAkB,EAAEhG;AAAzC,IAdF,eAeE,eAAC,OAAD;AAAS,IAAA,KAAK,EAAEkF;AAAhB,KACGvE,QADH,CAfF,EAkBGwD,UAAU,iBACT,eAAC,UAAD,qBACE,eAAC,WAAD;AAAa,IAAA,SAAS,EAAED;AAAxB,KAAyCoB,WAAzC,CADF,CAnBJ,EAuBG,CAACG,kBAAD,IAAuB,CAAChF,UAAU,CAACqF,QAAnC,IAA+C,CAAC,CAACpF,WAAjD,iBACC,eAAC,WAAD;AACE,IAAA,UAAU,EAAED,UADd;AAEE,IAAA,OAAO,EAAEsE,UAFX;AAGE,IAAA,IAAI,EAAEvE,IAHR;AAIE,IAAA,gBAAgB,EAAE0B;AAJpB,IAxBJ,CANF,CAZF,CADF;AAsDD","sourcesContent":["/* eslint-disable @typescript-eslint/no-shadow */\nimport * as React from 'react';\nimport { throttle } from 'lodash-es';\nimport styled, { css } from 'styled-components';\nimport { theme } from '@ali/we-design';\nimport { environment, Controller, Block, Hot, useSelectingHots } from '@ali/4ever-cangjie';\nimport { Table, TableCell } from '@ali/4ever-plugin-table';\nimport { hoverCSS, useHover } from '@ali/4ever-component';\nimport { useCellConfigs } from '../utils/ColumnsProvider';\nimport { COLUMN_SPACE, HORIZ_PADDING } from '../constants';\nimport { blockMarginStyleInContainer } from '@ali/4ever-utils';\nimport DragBar from './DragBar';\nimport { ColumnsConfigs } from '../types';\nimport { deleteColumn } from '../actions';\nimport { isColumnsCell, isColumnsTable } from '../utils/isColumns';\n\nconst { IS_MOBILE, IS_IPAD } = environment;\nconst IS_PC_OR_IPAD = !IS_MOBILE || IS_IPAD;\n\nconst Wrapper = styled.div<{ isHover: boolean; isLastOne: boolean }>`\n  flex-grow: 0;\n  flex-shrink: 0;\n  box-sizing: border-box;\n  position: relative;\n  display: block;\n  border-radius: 8px;\n  transition: background 300ms, border 300ms, padding 300ms;\n  margin-bottom: 0;\n  &.draggable-highlight {\n    background-color: ${theme.commonBgHoverColor} !important;\n  }\n  ${(p) => (p.isHover ? hoverCSS.borderBoxHoverCSS : '')}\n  ${(props) =>\n    (IS_PC_OR_IPAD\n      ? ''\n      : `\n      @media (max-width: 500px) {\n        width: initial !important;\n        margin-bottom: ${props.isLastOne ? '0' : '8px'};\n      }\n    `)}\n`;\n\nconst Content = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: stretch;\n  height: 100%;\n  padding-top: 7px;\n  padding-bottom: 7px;\n  & > [data-cangjie-leaf-block] {\n    max-width: 100%;\n  }\n\n  ${css`${blockMarginStyleInContainer}`}\n\n  /* placeholder 溢出问题 */\n  span[data-cangjie-placeholder]:not(td span[data-cangjie-placeholder]) {\n    position: absolute !important;\n    display: inline-block;\n    width: calc(100% - 14px);\n    height: calc(100% - 14px);\n\n    & > span {\n      width: 100% !important;\n      overflow: hidden;\n      text-overflow: ellipsis !important;\n    }\n  }\n\n`;\n\nconst PercentTab = styled.div`\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 137, 255, 0.08);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst PercentText = styled.div<{ isAligned: boolean }>`\n  color: ${({ isAligned }) =>\n    (isAligned ? 'rgba(0, 137, 255, 0.48)' : '#A9AEB3')};\n  font-size: 14px;\n  font-weight: bold;\n  transition: background-color 250ms;\n  background-color: ${({ isAligned }) =>\n    (isAligned ? 'rgba(231, 244, 255, 0.8)' : 'rgb(245, 246, 247, 0.8)')};\n  padding: 0 10px;\n  border-radius: 4px;\n`;\n\nconst SelectedColumnLayer = styled.div<{isSelectWholeTable: boolean}>`\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 106, 254, 0.12);\n  pointer-events: none;\n  border-radius: 8px;\n  display: ${({ isSelectWholeTable }) => (isSelectWholeTable ? 'block' : 'none')};\n`;\n\ninterface IProps {\n  cell: TableCell;\n  configs?: ColumnsConfigs;\n  controller: Controller;\n  ColorButton?: React.ComponentType<any>;\n}\n\nconst vAlignToFlex = (vAlign?: string) => {\n  if (vAlign === 'top') {\n    return 'flex-start';\n  }\n  if (vAlign === 'bottom') {\n    return 'flex-end';\n  }\n  return 'center';\n};\n\nfunction isHidePadding(colors: Array<string | undefined>) {\n  return colors.every((c) => !c || c === 'transparent');\n}\n\nexport default function Column({\n  cell,\n  controller,\n  ColorButton,\n  children,\n  configs,\n}: React.PropsWithChildren<IProps>) {\n  const [, forceUpdate] = React.useReducer((c) => !c, false);\n\n  const { document } = controller.value;\n  const table = document.getClosest(cell.key, isColumnsTable) as Table;\n  const isSelectWholeTable = controller.query('isSelectWholeTable', { node: table });\n  const cellItem = useCellConfigs(cell.key);\n  const ref = React.useRef<HTMLDivElement>(null);\n\n  React.useEffect(() => {\n    const nodes = cell.nodes || [];\n    if (!nodes.length || nodes.every((n) => !Block.isBlock(n))) {\n      controller.run('onAction', deleteColumn({ key: cell.key }));\n    }\n  }, [cell, controller]);\n\n  const [showInnerToolbar, setShowInnerToolbar] = React.useState(false);\n\n  const updateInnerToolbar = React.useCallback(\n    throttle((event: React.MouseEvent) => {\n      const { target } = event;\n      if (!(target instanceof HTMLElement)) {\n        return;\n      }\n      const panel = target.closest('[data-color-select-panel]');\n      const showIt = !panel || panel === ref.current;\n      if (showInnerToolbar !== showIt) {\n        setShowInnerToolbar(showIt);\n      }\n    }, 100, { trailing: true }),\n    [showInnerToolbar],\n  );\n\n  const handleHideInnerToolbar = React.useCallback(() => {\n    updateInnerToolbar.cancel();\n    setShowInnerToolbar(false);\n  }, [updateInnerToolbar]);\n\n  const enableBorderHighlight = React.useMemo(() => controller.query('enableBorderHighlight'), []);\n  const [isHover, hoverHandlers] = useHover(enableBorderHighlight, {\n    onMouseLeave: handleHideInnerToolbar,\n  });\n\n  const handleMouseMove = React.useCallback((event: React.MouseEvent) => {\n    if (!IS_PC_OR_IPAD) {\n      return;\n    }\n    event.persist();\n    // TODO\n    updateInnerToolbar(event);\n  }, [updateInnerToolbar]);\n\n  // TODO: 暴露全局的 keydown，不要每个组件自己注册一遍\n  React.useEffect(() => {\n    window.document.addEventListener('keydown', handleHideInnerToolbar);\n    return () => {\n      window.document.removeEventListener('keydown', handleHideInnerToolbar);\n    };\n  }, [controller, handleHideInnerToolbar]);\n\n  // fix: 选中整栏, 其他栏没有重渲\n  const onSelectingHots = React.useCallback((hots: Hot[]) => {\n    const isSelectWholeTable = controller.query('isSelectWholeTable', { node: table });\n    if (!isSelectWholeTable) {\n      return;\n    }\n    const hot = hots.find((hot) => {\n      const hotNodeKey = hot.node.key;\n      if (isColumnsCell(document, hotNodeKey) && hotNodeKey === cell.key) {\n        return hot;\n      } else {\n        const maybeCell = document.getClosest(hotNodeKey, ({ key }) => isColumnsCell(document, key));\n        if (maybeCell && maybeCell.key === cell.key) {\n          return hot;\n        }\n      }\n      return false;\n    });\n    if (hot) {\n      forceUpdate();\n    }\n  }, [controller, cell, table, document]);\n  useSelectingHots(controller, onSelectingHots);\n\n  if (!cellItem) {\n    return <React.Fragment>{children}</React.Fragment>;\n  }\n\n  const {\n    index,\n    percent,\n    percentAligned,\n    isDragging,\n    count,\n    handleDragging,\n    handleDraggingChange,\n  } = cellItem;\n\n  const widthStr = `calc((100% - ${\n    COLUMN_SPACE * (count - 1)\n  }px) * ${percent})`;\n\n  const { fill, vAlign, border } = cell.data;\n  const pLeft = isHidePadding([fill, border]) ? 0 : HORIZ_PADDING;\n  const pRight = isHidePadding([fill, border]) ? 0 : HORIZ_PADDING;\n  const background = fill || 'transparent';\n  const style: React.CSSProperties = {\n    width: widthStr,\n    background,\n    border: `1px solid ${border || background}`,\n  };\n\n  const contentStyle: React.CSSProperties = {\n    justifyContent: vAlignToFlex(vAlign),\n    paddingLeft: `${pLeft}px`,\n    paddingRight: `${pRight}px`,\n  };\n  const percentText = `${Math.round(percent * 100)}%`;\n  const disableInnerButton = controller.query('hasHoverToolbar', 'columns');\n\n  let ExtraAboveComponent = configs?.getExtraAboveComponent?.(cell, controller);\n  let extraAboveComponentStyle;\n  if (ExtraAboveComponent) {\n    extraAboveComponentStyle = {\n      width: widthStr,\n    };\n    style.width = '100%';\n  }\n\n  ExtraAboveComponent = ExtraAboveComponent || React.Fragment;\n\n\n  return (\n    <React.Fragment>\n      {index !== 0 && (\n        <DragBar\n          cellKey={cell.key}\n          isAligned={isDragging}\n          readOnly={controller.readOnly}\n          isEnabled={IS_PC_OR_IPAD && !controller.readOnly}\n          onDragging={handleDragging}\n          onDraggingChange={handleDraggingChange}\n          index={index}\n        />\n      )}\n      <ExtraAboveComponent\n        controller={controller}\n        node={cell}\n        style={extraAboveComponentStyle}\n        isLastOne={index === count - 1}\n      >\n        <Wrapper\n          style={style}\n          ref={ref}\n          data-column\n          isLastOne={index === count - 1}\n          data-container-block\n          data-color-select-panel\n          {...hoverHandlers}\n          onMouseMove={handleMouseMove}\n          data-block-uuid={cell.data?.uuid}\n          data-cangjie-key={cell.key}\n          data-hover-box=\"borderBox\"\n          isHover={isHover && controller.value.isFocused}\n        >\n          <SelectedColumnLayer isSelectWholeTable={isSelectWholeTable!} />\n          <Content style={contentStyle}>\n            {children}\n          </Content>\n          {isDragging && (\n            <PercentTab>\n              <PercentText isAligned={percentAligned}>{percentText}</PercentText>\n            </PercentTab>\n          )}\n          {!disableInnerButton && !controller.readOnly && !!ColorButton && (\n            <ColorButton\n              controller={controller}\n              bgcolor={background}\n              node={cell}\n              showInnerToolbar={showInnerToolbar}\n            />\n          )}\n        </Wrapper>\n      </ExtraAboveComponent>\n    </React.Fragment>\n  );\n}\n"],"file":"Column.js"}