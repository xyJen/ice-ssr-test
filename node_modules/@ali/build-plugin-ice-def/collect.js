const { collectDetail } = require('@alifd/fusion-collector');

const collect = ({ command, rootDir, pkg = {} }) => {
  if (!process.env.DISABLE_COLLECT) {
    try {
      let kit = 'build-scripts';

      ['devDependencies', 'dependencies'].forEach((pkgKey) => {
        if (pkg[pkgKey] && pkg[pkgKey]['ice.js']) {
          kit = 'icejs';
        }
      });

      const options = {
        rootDir,
        kit,
        cmdType: command,
      };
      collectDetail(options);
    } catch (err) {}
  }
};

module.exports = collect;
