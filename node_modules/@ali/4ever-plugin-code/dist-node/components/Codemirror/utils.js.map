{"version":3,"sources":["../../../../src/components/Codemirror/utils.ts"],"names":["code","CODE_THEME","theme","countNewLine","str","count","i","length","CODE_LINEHEIGHT","unitsConverter","toPX","globalStyle","getCodeContent","node","onlyText","nodes","onlyLeaf","leaves","text","getCodeHeight","height","data","Math","min","MAX_HEIGHT"],"mappings":";;;;;;;;AACA;;AACA;;AAEA,MAAM;AAAEA,EAAAA,IAAI,EAAEC;AAAR,IAAuBC,gBAA7B;;AAEA,SAASC,YAAT,CAAsBC,GAAtB,EAAmC;AACjC,MAAIC,KAAK,GAAG,CAAZ;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,GAAG,CAACG,MAAxB,EAAgCD,CAAC,IAAI,CAArC,EAAwC;AACtC,QAAIF,GAAG,CAACE,CAAD,CAAH,KAAW,IAAf,EAAqB;AACnBD,MAAAA,KAAK,IAAI,CAAT;AACD;AACF;;AACD,SAAOA,KAAP;AACD,C,CAED;;;AACA,MAAMG,eAAe,GAAGC,0BAAeC,IAAf,CAAoBR,iBAAMS,WAAN,CAAkB,WAAlB,CAApB,IAAsDV,UAAU,CAAC,aAAD,CAAxF,C,CAEA;;AACO,SAASW,cAAT,CAAwBC,IAAxB,EAAqC;AAC1C,QAAM,CAACC,QAAD,IAAaD,IAAI,CAACE,KAAxB;AACA,QAAM,CAACC,QAAD,IAAcF,QAAD,CAAmBG,MAAtC;AACA,SAAOD,QAAQ,CAACE,IAAhB;AACD;;AAED,SAASC,aAAT,CAAuBN,IAAvB,EAAoC;AAClC,MAAI;AAAEO,IAAAA;AAAF,MAAaP,IAAI,CAACQ,IAAtB;;AACA,MAAI,CAACD,MAAL,EAAa;AACXA,IAAAA,MAAM,GAAG,CAACjB,YAAY,CAACS,cAAc,CAACC,IAAD,CAAf,CAAZ,GAAqC,CAAtC,IAA2CL,eAA3C,IAA8D,MAAM,CAApE,CAAT;AACD;;AACD,SAAOc,IAAI,CAACC,GAAL,CAASH,MAAT,EAAiBI,qBAAjB,CAAP;AACD;;AAEDL,aAAa,CAACX,eAAd,GAAgCA,eAAhC;eAEeW,a","sourcesContent":["import { Block, Text } from '@ali/4ever-cangjie';\nimport { theme, unitsConverter } from '@ali/4ever-utils';\nimport { MAX_HEIGHT } from '../../utils/constants/dimension';\n\nconst { code: CODE_THEME } = theme;\n\nfunction countNewLine(str: string) {\n  let count = 0;\n  for (let i = 0; i < str.length; i += 1) {\n    if (str[i] === '\\n') {\n      count += 1;\n    }\n  }\n  return count;\n}\n\n// 代码块行高\nconst CODE_LINEHEIGHT = unitsConverter.toPX(theme.globalStyle['font-size']) * CODE_THEME['line-height']\n\n// 获取 code 内容\nexport function getCodeContent(node: Block) {\n  const [onlyText] = node.nodes;\n  const [onlyLeaf] = (onlyText as Text).leaves;\n  return onlyLeaf.text;\n}\n\nfunction getCodeHeight(node: Block) {\n  let { height } = node.data;\n  if (!height) {\n    height = (countNewLine(getCodeContent(node)) + 1) * CODE_LINEHEIGHT + (10 || 0);\n  }\n  return Math.min(height, MAX_HEIGHT);\n}\n\ngetCodeHeight.CODE_LINEHEIGHT = CODE_LINEHEIGHT;\n\nexport default getCodeHeight;\n"],"file":"utils.js"}