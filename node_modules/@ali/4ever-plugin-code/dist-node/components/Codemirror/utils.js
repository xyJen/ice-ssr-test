"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getCodeContent = getCodeContent;
exports.default = void 0;

var _everUtils = require("@ali/4ever-utils");

var _dimension = require("../../utils/constants/dimension");

const {
  code: CODE_THEME
} = _everUtils.theme;

function countNewLine(str) {
  let count = 0;

  for (let i = 0; i < str.length; i += 1) {
    if (str[i] === '\n') {
      count += 1;
    }
  }

  return count;
} // 代码块行高


const CODE_LINEHEIGHT = _everUtils.unitsConverter.toPX(_everUtils.theme.globalStyle['font-size']) * CODE_THEME['line-height']; // 获取 code 内容

function getCodeContent(node) {
  const [onlyText] = node.nodes;
  const [onlyLeaf] = onlyText.leaves;
  return onlyLeaf.text;
}

function getCodeHeight(node) {
  let {
    height
  } = node.data;

  if (!height) {
    height = (countNewLine(getCodeContent(node)) + 1) * CODE_LINEHEIGHT + (10 || 0);
  }

  return Math.min(height, _dimension.MAX_HEIGHT);
}

getCodeHeight.CODE_LINEHEIGHT = CODE_LINEHEIGHT;
var _default = getCodeHeight;
exports.default = _default;
//# sourceMappingURL=utils.js.map