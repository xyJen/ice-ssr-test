"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _index = _interopRequireDefault(require("../../mo/models/index"));

const getCodeDataSetting = (code, targetSyntax) => {
  const {
    syntax,
    theme
  } = code.data;

  if (targetSyntax && targetSyntax === syntax) {
    return {
      syntax,
      theme
    };
  } else if (!targetSyntax) {
    return {
      syntax,
      theme
    };
  }

  return null;
};

const findClosestCodeSetting = (document, anchorNode, targetSyntax) => {
  function findClosest(dire) {
    const findCodeFun = key => dire === 'prev' ? document.getPreviousBlock(key) : document.getNextBlock(key);

    let maybeCode = findCodeFun(anchorNode.key);

    while (maybeCode) {
      if (_index.default.isCode(maybeCode)) {
        const result = getCodeDataSetting(maybeCode, targetSyntax);
        if (result) return result;
      }

      maybeCode = findCodeFun(maybeCode.key);
    }

    return null;
  }

  return findClosest('prev') || findClosest('next');
};

var _default = findClosestCodeSetting;
exports.default = _default;
//# sourceMappingURL=findClosestCodeSetting.js.map