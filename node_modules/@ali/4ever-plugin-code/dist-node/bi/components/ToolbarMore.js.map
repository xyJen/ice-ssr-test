{"version":3,"sources":["../../../../src/bi/components/ToolbarMore.tsx"],"names":["ToolbarMore","props","controller","getContainer","nodeKey","locale","onClick","React","useCallback","type","copyOrCutNode","run","key","document","body","options","title","copy","icon","cut","delete","node","value","getNode","rst","query","Promise","catch","e","console","error"],"mappings":";;;;;;;;;AACA;;AACA;;AACA;;AAKA;;uBAP4B,a;AAS5B;;wBA8BkB,eAAC,yBAAD,O;;yBAIA,eAAC,wBAAD,O;;yBAIA,eAAC,2BAAD,O;;AA3BH,SAASA,WAAT,CAAqBC,KAArB,EAA8C;AAC3D,QAAM;AAAEC,IAAAA,UAAF;AAAcC,IAAAA,YAAd;AAA4BC,IAAAA,OAA5B;AAAqCC,IAAAA;AAArC,MAAgDJ,KAAtD;AACA,QAAMK,OAAO,GAAGC,KAAK,CAACC,WAAN,CAAmBC,IAAD,IAAkB;AAClD,QAAIA,IAAI,KAAK,MAAT,IAAmBA,IAAI,KAAK,KAAhC,EAAuC;AACrCC,MAAAA,aAAa,CAACR,UAAD,EAAaO,IAAb,EAAmBL,OAAnB,CAAb;AACD,KAFD,MAEO,IAAIK,IAAI,KAAK,QAAb,EAAuB;AAC5BP,MAAAA,UAAU,CAACS,GAAX,CAAe,UAAf,EAA2B,yBAAW;AACpCC,QAAAA,GAAG,EAAER;AAD+B,OAAX,CAA3B;AAGD;AACF,GARe,EAQb,EARa,CAAhB;AAUA,sBACE,eAAC,wBAAD;AACE,IAAA,YAAY,EAAE,MAAMD,YAAY,QAAQU,QAAQ,CAACC,IADnD;AAEE,IAAA,cAAc,EAAE;AACdC,MAAAA,OAAO,EAAE,CACP,CAAC;AACCC,QAAAA,KAAK,EAAEX,MAAM,CAACY,IADf;AAECC,QAAAA,IAAI,MAFL;AAGCZ,QAAAA,OAAO,EAAE,MAAMA,OAAO,CAAC,MAAD;AAHvB,OAAD,EAIG;AACDU,QAAAA,KAAK,EAAEX,MAAM,CAACc,GAAP,IAAc,KADpB;AAEDD,QAAAA,IAAI,OAFH;AAGDZ,QAAAA,OAAO,EAAE,MAAMA,OAAO,CAAC,KAAD;AAHrB,OAJH,EAQG;AACDU,QAAAA,KAAK,EAAEX,MAAM,CAACe,MADb;AAEDF,QAAAA,IAAI,OAFH;AAGDZ,QAAAA,OAAO,EAAE,MAAMA,OAAO,CAAC,QAAD;AAHrB,OARH,CADO;AADK,KAFlB;AAmBE,IAAA,KAAK,EAAE;AAnBT,IADF;AAuBD;;AAED,SAASI,aAAT,CAAuBR,UAAvB,EAA+CO,IAA/C,EAAqEL,OAArE,EAAsF;AACpF,QAAMiB,IAAI,GAAGnB,UAAU,CAACoB,KAAX,CAAiBT,QAAjB,CAA0BU,OAA1B,CAAkCnB,OAAlC,CAAb;;AACA,MAAIiB,IAAI,KAAK,IAAb,EAAmB;AACjB,UAAMG,GAAG,GAAGtB,UAAU,CAACuB,KAAX,CAAiB,WAAjB,EAA8BJ,IAA9B,CAAZ;;AACA,QAAIG,GAAG,YAAYE,OAAnB,EAA4B;AAC1BF,MAAAA,GAAG,CAACG,KAAJ,CAAWC,CAAD,IAAOC,OAAO,CAACC,KAAR,CAAc,YAAd,EAA4BF,CAA5B,CAAjB;AACD;;AACD,QAAInB,IAAI,KAAK,KAAb,EAAoB;AAClBP,MAAAA,UAAU,CAACS,GAAX,CAAe,UAAf,EAA2B,yBAAW;AACpCC,QAAAA,GAAG,EAAER;AAD+B,OAAX,CAA3B;AAGD;AACF;AACF","sourcesContent":["import { Commands, Controller } from '@ali/4ever-cangjie';\nimport { InlineToolbar } from '@ali/we-toolbar';\nimport * as React from 'react';\nimport {\n  ToolbarCutNormal,\n  ToolbarCopyNormal,\n  ToolbarDeleteNormal,\n} from '@ali/we-icon';\nimport { removeCode } from '../actions';\nimport { CodeLocale } from '../types';\n;\n\nexport type MoreClickEvent = (type: 'copy' | 'cut' | 'delete') => void;\n\ninterface ToolbarMoreProps {\n  controller: Controller;\n  locale: CodeLocale;\n  getContainer: Function;\n  nodeKey: string;\n}\n\nexport default function ToolbarMore(props: ToolbarMoreProps) {\n  const { controller, getContainer, nodeKey, locale } = props;\n  const onClick = React.useCallback((type: string) => {\n    if (type === 'copy' || type === 'cut') {\n      copyOrCutNode(controller, type, nodeKey);\n    } else if (type === 'delete') {\n      controller.run('onAction', removeCode({\n        key: nodeKey\n      } as any));\n    }\n  }, []);\n\n  return (\n    <InlineToolbar\n      getContainer={() => getContainer?.() || document.body}\n      moreMenuConfig={{\n        options: [\n          [{\n            title: locale.copy,\n            icon: <ToolbarCopyNormal />,\n            onClick: () => onClick('copy'),\n          }, {\n            title: locale.cut || 'Cut',\n            icon: <ToolbarCutNormal />,\n            onClick: () => onClick('cut'),\n          }, {\n            title: locale.delete,\n            icon: <ToolbarDeleteNormal />,\n            onClick: () => onClick('delete'),\n          }],\n        ],\n      }}\n      width={300}\n    />\n  );\n}\n\nfunction copyOrCutNode(controller: Controller, type: 'copy' | 'cut', nodeKey: string) {\n  const node = controller.value.document.getNode(nodeKey);\n  if (node !== null) {\n    const rst = controller.query('copyNodes', node);\n    if (rst instanceof Promise) {\n      rst.catch((e) => console.error('copy error', e));\n    }\n    if (type === 'cut') {\n      controller.run('onAction', removeCode({\n        key: nodeKey\n      } as any));\n    }\n  }\n}\n"],"file":"ToolbarMore.js"}