import { theme, unitsConverter } from '@ali/4ever-utils';
import { MAX_HEIGHT } from "../../utils/constants/dimension";
var CODE_THEME = theme.code;

function countNewLine(str) {
  var count = 0;

  for (var i = 0; i < str.length; i += 1) {
    if (str[i] === '\n') {
      count += 1;
    }
  }

  return count;
} // 代码块行高


var CODE_LINEHEIGHT = unitsConverter.toPX(theme.globalStyle['font-size']) * CODE_THEME['line-height']; // 获取 code 内容

export function getCodeContent(node) {
  var _node$nodes = node.nodes,
      onlyText = _node$nodes[0];
  var _leaves = onlyText.leaves,
      onlyLeaf = _leaves[0];
  return onlyLeaf.text;
}

function getCodeHeight(node) {
  var height = node.data.height;

  if (!height) {
    height = (countNewLine(getCodeContent(node)) + 1) * CODE_LINEHEIGHT + (10 || 0);
  }

  return Math.min(height, MAX_HEIGHT);
}

getCodeHeight.CODE_LINEHEIGHT = CODE_LINEHEIGHT;
export default getCodeHeight;
//# sourceMappingURL=utils.js.map