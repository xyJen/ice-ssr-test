{"version":3,"sources":["../../../../../src/mo/serializer/htmlToJsonML/parseFromYuQue.ts"],"names":["createTextWithString","CODEBLOCK","DATA_LAKE_CARD","DATA_LANGUAGE","PLAIN_TEXT","THEME_DEFAULT","parseFromYuQue","index","name","onOpenTag","state","attr","push","syntax","theme","onCloseTag","pop","codeBlockDom","htmlDom","querySelectorAll","append","textContent"],"mappings":"AACA,SAAyEA,oBAAzE,QAAqG,oBAArG;AACA,SACEC,SADF,EAEEC,cAFF,EAGEC,aAHF,EAIEC,UAJF,EAKEC,aALF;;AAQA,SAASC,cAAT,GAA4C;AAC1C,MAAIC,KAAK,GAAG,CAAZ;AACA,SAAO;AACLC,IAAAA,IAAI,EAAE,MADD;AAGLC,IAAAA,SAHK,qBAGKC,KAHL,EAGmBF,IAHnB,EAGiCG,IAHjC,EAG4D;AAC/D,UAAIA,IAAI,CAACT,cAAD,CAAJ,KAAyBD,SAA7B,EAAwC,OAAO,KAAP;AAExCS,MAAAA,KAAK,CAACE,IAAN,CAAW,CACT,MADS,EAET;AACEC,QAAAA,MAAM,EAAEF,IAAI,CAACR,aAAD,CAAJ,IAAuBC,UADjC;AAEEU,QAAAA,KAAK,EAAET;AAFT,OAFS,CAAX;AAOA,aAAO,IAAP;AACD,KAdI;AAgBLU,IAAAA,UAhBK,sBAgBML,KAhBN,EAgBoBF,IAhBpB,EAgBkCG,IAhBlC,EAgB6D;AAChE,UAAIA,IAAI,CAACT,cAAD,CAAJ,KAAyBD,SAA7B,EAAwC,OAAO,KAAP;AACxCS,MAAAA,KAAK,CAACM,GAAN;AAEA,UAAMC,YAAY,GAAGP,KAAK,CAACQ,OAAN,CAAcC,gBAAd,OACfjB,cADe,SACGD,SADH,QAEnBM,KAFmB,CAArB;AAIAG,MAAAA,KAAK,CAACU,MAAN,CAAa,CACX,MADW,EAEX;AACEP,QAAAA,MAAM,EAAEF,IAAI,CAACR,aAAD,CAAJ,IAAuBC,UADjC;AAEEU,QAAAA,KAAK,EAAET;AAFT,OAFW,EAMXL,oBAAoB,CAAC,CAAAiB,YAAY,QAAZ,YAAAA,YAAY,CAAEI,WAAd,KAA6B,EAA9B,CANT,CAAb;AAQAd,MAAAA,KAAK;AACL,aAAO,IAAP;AACD;AAlCI,GAAP;AAoCD;;AAED,eAAeD,cAAf","sourcesContent":["\nimport { MoState as State, MoAttributes as Attributes, HTMLToJsonMLRule, createTextWithString } from '@ali/4ever-cangjie';\nimport {\n  CODEBLOCK,\n  DATA_LAKE_CARD,\n  DATA_LANGUAGE,\n  PLAIN_TEXT,\n  THEME_DEFAULT,\n} from './constants';\n\nfunction parseFromYuQue(): HTMLToJsonMLRule {\n  let index = 0;\n  return {\n    name: 'code',\n\n    onOpenTag(state: State, name: string, attr: Attributes): boolean {\n      if (attr[DATA_LAKE_CARD] !== CODEBLOCK) return false;\n\n      state.push([\n        'code',\n        {\n          syntax: attr[DATA_LANGUAGE] || PLAIN_TEXT,\n          theme: THEME_DEFAULT,\n        },\n      ] as any);\n      return true;\n    },\n\n    onCloseTag(state: State, name: string, attr: Attributes): boolean {\n      if (attr[DATA_LAKE_CARD] !== CODEBLOCK) return false;\n      state.pop();\n\n      const codeBlockDom = state.htmlDom.querySelectorAll(\n        `[${DATA_LAKE_CARD}=${CODEBLOCK}]`,\n      )[index];\n\n      state.append([\n        'code',\n        {\n          syntax: attr[DATA_LANGUAGE] || PLAIN_TEXT,\n          theme: THEME_DEFAULT,\n        },\n        createTextWithString(codeBlockDom?.textContent || ''),\n      ]);\n      index++;\n      return true;\n    },\n  };\n}\n\nexport default parseFromYuQue;\n"],"file":"parseFromYuQue.js"}