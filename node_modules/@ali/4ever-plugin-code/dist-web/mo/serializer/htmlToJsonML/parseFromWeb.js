import { createTextWithString } from '@ali/4ever-cangjie';
import { PLAIN_TEXT, THEME_DEFAULT } from "./constants";
import { getTextContent, getSyntax } from "./utils"; // 识别如下两种结构作为代码块
// <pre><code>xxxxx</code></pre>
// <pre>xxxx</pre>

function parseFromWeb() {
  var index = 0;
  return {
    name: 'code',
    onOpenTag: function onOpenTag(state, name) {
      if (name !== 'pre') return false;
      state.push(['code', {
        syntax: PLAIN_TEXT,
        theme: THEME_DEFAULT
      }]);
      return true;
    },
    onCloseTag: function onCloseTag(state, name) {
      if (name !== 'pre') return false;
      state.pop();
      var codeBlockDom = state.htmlDom.getElementsByTagName('pre')[index];
      state.append(['code', {
        syntax: getSyntax(codeBlockDom),
        theme: THEME_DEFAULT
      }, createTextWithString(getTextContent(codeBlockDom) || '')]);
      index++;
      return true;
    }
  };
}

export default parseFromWeb;
//# sourceMappingURL=parseFromWeb.js.map