{"version":3,"sources":["../../../../../../src/utils/components/common/embedCard/mobileEmbedCard.tsx"],"names":["MobileEmbedCard","props","name","onPreview","src","type","size","isClickedRef","fileType","getIcon","IconUrlMap","renderDesc","handleTouchStart","e","CanPreviewFileTypes","includes","preventDefault","stopPropagation","current","handleTouchMove","handleTouchEnd","width","height"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AAMA;;uBAP4B,a;;wBA0FhB,eAAC,2BAAD,O;;AAjEZ,SAASA,eAAT,CAAyBC,KAAzB,EAAuC;AACrC,QAAM;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,SAAR;AAAmBC,IAAAA,GAAnB;AAAwBC,IAAAA,IAAxB;AAA8BC,IAAAA;AAA9B,MAAuCL,KAA7C;AACA,QAAMM,YAAY,GAAG,mBAAO,KAAP,CAArB;AAEA,QAAMC,QAAQ,GAAG,wCAAmBN,IAAnB,CAAjB;;AAEA,QAAMO,OAAO,GAAG,MAAM;AACpB,WAAOC,2BAAWL,IAAX,KAAoBK,2BAAW,KAAX,CAA3B;AACD,GAFD;;AAIA,QAAMC,UAAU,GAAG,MAAM;AACvB,wBAAO,eAAC,mBAAD,QAAc,gCAAWL,IAAX,CAAd,CAAP;AACD,GAFD;;AAIA,QAAMM,gBAAgB,GAAIC,CAAD,IAAO;AAC9B,QAAIC,oCAAoBC,QAApB,CAA6BP,QAA7B,CAAJ,EAA4C;AAC1CK,MAAAA,CAAC,CAACG,cAAF;AACAH,MAAAA,CAAC,CAACI,eAAF;AACAV,MAAAA,YAAY,CAACW,OAAb,GAAuB,IAAvB;AACD;AACF,GAND;;AAQA,QAAMC,eAAe,GAAIN,CAAD,IAAO;AAC7B,QAAIC,oCAAoBC,QAApB,CAA6BP,QAA7B,CAAJ,EAA4C;AAC1CK,MAAAA,CAAC,CAACG,cAAF;AACAH,MAAAA,CAAC,CAACI,eAAF;AACAV,MAAAA,YAAY,CAACW,OAAb,GAAuB,KAAvB;AACD;AACF,GAND;;AAQA,QAAME,cAAc,GAAIP,CAAD,IAAO;AAC5B;AACA,QAAIC,oCAAoBC,QAApB,CAA6BP,QAA7B,CAAJ,EAA4C;AAC1CK,MAAAA,CAAC,CAACG,cAAF;AACAH,MAAAA,CAAC,CAACI,eAAF;;AAEA,UAAId,SAAS,IAAII,YAAY,CAACW,OAA9B,EAAuC;AACrCf,QAAAA,SAAS,CAACC,GAAD,CAAT;AACAG,QAAAA,YAAY,CAACW,OAAb,GAAuB,KAAvB;AACD;AACF;AACF,GAXD;;AAaA,sBACE,eAAC,8BAAD,qBACE,eAAC,cAAD,CAAO,QAAP,qBACE,eAAC,uBAAD,qBACE;AACE,IAAA,GAAG,EAAET,OAAO,EADd;AAEE,IAAA,GAAG,EAAC,MAFN;AAGE,IAAA,KAAK,EAAE;AAAEY,MAAAA,KAAK,EAAE,EAAT;AAAaC,MAAAA,MAAM,EAAE;AAArB;AAHT,IADF,CADF,eAQE,eAAC,0BAAD,qBACE,eAAC,qCAAD,qBACE,eAAC,qBAAD,QAAgBpB,IAAhB,CADF,EAEGS,UAAU,EAFb,CADF,CARF,EAcIG,oCAAoBC,QAApB,CAA6BP,QAA7B,KAA0CL,SAA3C,gBACC,eAAC,0BAAD;AACE,IAAA,YAAY,EAAES,gBADhB;AAEE,IAAA,WAAW,EAAEO,eAFf;AAGE,IAAA,UAAU,EAAEC;AAHd,UADD,GAQG,IAtBN,CADF,CADF;AA4BD;;eAEcpB,e","sourcesContent":["import React, { useRef } from 'react';\nimport { PreviewBetaNormal } from '@ali/we-design';\nimport {\n  CanPreviewFileTypes,\n  getFileTypeForRead,\n  IconUrlMap,\n  formatSize,\n} from '../../../fileTypeHelper';\nimport {\n  MobileEmbedCardWrapper,\n  CardIconWrapper,\n  CardContentWrapper,\n  MobileCardContentInnerWrapper,\n  ContentHeader,\n  ContentDesc,\n  PreviewIconWrapper,\n} from './styled';\n\ninterface Props {\n  name: string;\n  onPreview?: (src: string) => void;\n  src: string;\n  type: string;\n  size: number;\n}\n\nfunction MobileEmbedCard(props: Props) {\n  const { name, onPreview, src, type, size } = props;\n  const isClickedRef = useRef(false);\n\n  const fileType = getFileTypeForRead(name);\n\n  const getIcon = () => {\n    return IconUrlMap[type] || IconUrlMap['app'];\n  };\n\n  const renderDesc = () => {\n    return <ContentDesc>{formatSize(size)}</ContentDesc>;\n  };\n\n  const handleTouchStart = (e) => {\n    if (CanPreviewFileTypes.includes(fileType)) {\n      e.preventDefault();\n      e.stopPropagation();\n      isClickedRef.current = true;\n    }\n  };\n\n  const handleTouchMove = (e) => {\n    if (CanPreviewFileTypes.includes(fileType)) {\n      e.preventDefault();\n      e.stopPropagation();\n      isClickedRef.current = false;\n    }\n  };\n\n  const handleTouchEnd = (e) => {\n    // TODO 此处限制了业务层的拓展，之后应当移除\n    if (CanPreviewFileTypes.includes(fileType)) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      if (onPreview && isClickedRef.current) {\n        onPreview(src);\n        isClickedRef.current = false;\n      }\n    }\n  };\n\n  return (\n    <MobileEmbedCardWrapper>\n      <React.Fragment>\n        <CardIconWrapper>\n          <img\n            src={getIcon()}\n            alt=\"icon\"\n            style={{ width: 26, height: 28 }}\n          />\n        </CardIconWrapper>\n        <CardContentWrapper>\n          <MobileCardContentInnerWrapper>\n            <ContentHeader>{name}</ContentHeader>\n            {renderDesc()}\n          </MobileCardContentInnerWrapper>\n        </CardContentWrapper>\n        {(CanPreviewFileTypes.includes(fileType) && onPreview) ? (\n          <PreviewIconWrapper\n            onTouchStart={handleTouchStart}\n            onTouchMove={handleTouchMove}\n            onTouchEnd={handleTouchEnd}\n          >\n            <PreviewBetaNormal />\n          </PreviewIconWrapper>\n        ) : null}\n      </React.Fragment>\n    </MobileEmbedCardWrapper>\n  );\n}\n\nexport default MobileEmbedCard;\n"],"file":"mobileEmbedCard.js"}