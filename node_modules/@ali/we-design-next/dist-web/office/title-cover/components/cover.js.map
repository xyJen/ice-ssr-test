{"version":3,"file":"cover.js","names":["noop","React","useState","useEffect","PositionedImage","loadImage","Cover","forwardRef","props","ref","src","thumbSrc","position","onMouseDown","renderError","renderSrc","setRenderSrc","isLoadError","setIsLoadError","then","shouldShowError"],"sources":["../../../../../src/office/title-cover/components/cover.tsx"],"sourcesContent":["import { noop } from 'lodash-es';\nimport React, { useState, useEffect } from 'react';\nimport { PositionedImage } from './positionedImage';\nimport loadImage from '../utils';\n\ninterface Props {\n  src: string;\n  thumbSrc?: string;\n  position: number;\n  onMouseDown?: (e: React.MouseEvent) => void;\n  renderError?: () => React.ReactNode;\n}\n\nexport const Cover = React.forwardRef<HTMLImageElement, Props>((props: Props, ref) => {\n  const { src, thumbSrc, position, onMouseDown = noop, renderError } = props;\n  const [renderSrc, setRenderSrc] = useState(thumbSrc);\n  const [isLoadError, setIsLoadError] = useState(false);\n\n  useEffect(() => {\n    if (renderSrc === src) {\n      return;\n    }\n\n    loadImage(src)\n      .then(() => {\n        setRenderSrc(src);\n        setIsLoadError(false);\n      })\n      .catch(() => {\n        setIsLoadError(true);\n      });\n  }, [src, renderSrc]);\n\n  useEffect(() => {\n    setRenderSrc(thumbSrc || src);\n  }, [src, thumbSrc]);\n\n  const shouldShowError = isLoadError && renderError;\n\n  return shouldShowError ? (\n    <>{renderError()}</>\n  ) : (\n    <PositionedImage\n      ref={ref}\n      src={renderSrc}\n      onMouseDown={onMouseDown}\n      position={position}\n    />\n  );\n});\n"],"mappings":"AAAA,SAASA,IAAI,QAAQ,WAAW;AAChC,OAAOC,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAAC,qBAAvB;AAC5B,SAASC,eAAe;AACxB,OAAOC,SAAS;AAUhB,OAAO,IAAMC,KAAK,gBAAGL,KAAK,CAACM,UAAU,CAA0B,UAACC,KAAY,EAAEC,GAAG,EAAK;EACpF,IAAQC,GAAG,GAA0DF,KAAK,CAAlEE,GAAG;IAAEC,QAAQ,GAAgDH,KAAK,CAA7DG,QAAQ;IAAEC,QAAQ,GAAsCJ,KAAK,CAAnDI,QAAQ;IAAA,qBAAsCJ,KAAK,CAAzCK,WAAW;IAAXA,WAAW,mCAAGb,IAAI;IAAEc,WAAW,GAAKN,KAAK,CAArBM,WAAW;EAChE,gBAAkCZ,QAAQ,CAACS,QAAQ,CAAC;IAA7CI,SAAS;IAAEC,YAAY;EAC9B,iBAAsCd,QAAQ,CAAC,KAAK,CAAC;IAA9Ce,WAAW;IAAEC,cAAc;EAElCf,SAAS,CAAC,YAAM;IACd,IAAIY,SAAS,KAAKL,GAAG,EAAE;MACrB;IACF;IAEAL,SAAS,CAACK,GAAG,CAAC,CACXS,IAAI,CAAC,YAAM;MACVH,YAAY,CAACN,GAAG,CAAC;MACjBQ,cAAc,CAAC,KAAK,CAAC;IACvB,CAAC,CAAC,SACI,CAAC,YAAM;MACXA,cAAc,CAAC,IAAI,CAAC;IACtB,CAAC,CAAC;EACN,CAAC,EAAE,CAACR,GAAG,EAAEK,SAAS,CAAC,CAAC;EAEpBZ,SAAS,CAAC,YAAM;IACda,YAAY,CAACL,QAAQ,IAAID,GAAG,CAAC;EAC/B,CAAC,EAAE,CAACA,GAAG,EAAEC,QAAQ,CAAC,CAAC;EAEnB,IAAMS,eAAe,GAAGH,WAAW,IAAIH,WAAW;EAElD,OAAOM,eAAe,gBACpB,qCAAGN,WAAW,EAAE,CAAI,gBAEpB,eAAC,eAAe;IACd,GAAG,EAAEL,GAAI;IACT,GAAG,EAAEM,SAAU;IACf,WAAW,EAAEF,WAAY;IACzB,QAAQ,EAAED;EAAS,EAEtB;AACH,CAAC,CAAC"}