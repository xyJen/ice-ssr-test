{"version":3,"file":"Menu.js","names":["React","useEffect","useMemo","useReducer","useRef","memo","forwardRef","cloneElement","isValidElement","IconArrowRight","List","flattenNested","isNormalized","isEnabled","MenuItemDescription","MenuItemTitleDescription","Popover","useDefaultProp","mergeRestProps","useFocusTarget","mergeRef","renderReactNode","KEY_CODES","noop","hasSubMenu","it","subMenu","hasAsyncSubMenu","hasSyncSubMenu","Array","isArray","Menu","props","ref","_path","path","onPathChange","onSelect","items","renderItem","keyboard","rest","flattenItems","setPath","state","action","key","smiState","smiDispatch","wrapRef","focusTargetId","focusTarget","focusOwner","onActiveChange","k","op","find","from","undefined","length","onKeydownLeaf","e","kbKey","toLowerCase","isArrowRight","keyCode","RIGHT","isEnter","ENTER","curItem","subMenuItems","subFlattenItems","filter","rightKey","stopPropagation","onKeydownSecondaryLeaf","isArrowLeft","onKeydown","Boolean","subMenuRef","renderListItem","sourceNode","item","itemHasSubMenu","targetItemChildren","description","title","disabled","children","toCloned","suffix","targetItemWithChildren","targetNode","isExpaned","subItems","v","current","document","body","slice","p","onMouseLeave","t","x","clientX","y","clientY","subMenuRect","getBoundingClientRect","right","left","bottom","top","then","displayName","MenuItem","Item"],"sources":["../../../../src/display/menu/Menu.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useReducer, useRef, memo, forwardRef, cloneElement, isValidElement } from 'react';\nimport { IconArrowRight, IconLoading } from '../../basic/icon';\nimport { List } from '../../basic/list';\nimport { IListItemNormalized, IListItemCustomized, flattenNested, INestedItems, isNormalized, isEnabled } from '../../basic/list/nested';\nimport { MenuItemDescription, MenuItemTitleDescription } from './styled';\nimport { Popover } from '../popover';\nimport { useDefaultProp, IRestProps, mergeRestProps, useFocusTarget, mergeRef, renderReactNode, IRenderReactNode, KEY_CODES } from '../../common';\nimport { noop } from 'lodash-es';\n\nexport type IMenuItemNormalized = IListItemNormalized & {\n  description?: string;\n  subMenu?: INestedItems<IMenuItem> | (() => Promise<INestedItems<IMenuItem>>);\n};\n\nexport type IMenuItemCustomized = IListItemCustomized;\n\nexport type IMenuItem = IMenuItemNormalized | IMenuItemCustomized;\n\nconst hasSubMenu = (it: IMenuItem): it is (IMenuItemNormalized & { subMenu: Required<IMenuItemNormalized>['subMenu'] }) => {\n  return 'subMenu' in it && !!it.subMenu;\n};\n\nconst hasAsyncSubMenu = (it: IMenuItem): it is (IMenuItemNormalized & { subMenu: () => Promise<INestedItems<IMenuItem>> }) => {\n  return hasSubMenu(it) && typeof it.subMenu === 'function';\n};\n\nconst hasSyncSubMenu = (it: IMenuItem): it is (IMenuItemNormalized & { subMenu: INestedItems<IMenuItem> }) => {\n  return hasSubMenu(it) && Array.isArray(it.subMenu);\n};\n\nexport type IMenuProps = {\n  /**\n   * 菜单项配置\n   */\n  items?: INestedItems<IMenuItem>;\n  /**\n   * 当前激活的路径，每一项为 item 的 key；最后一项可能为 undefined，表示下级菜单被展开，但未激活其中的任意项\n   */\n  path?: Array<string | undefined>;\n  /**\n   * 当前激活路径变化\n   */\n  onPathChange?: (path: Array<string | undefined>) => void;\n  /**\n   * 某个菜单项被选中\n   */\n  onSelect?: (path: Array<string>) => void;\n  /**\n   * 是否响应键盘事件\n   */\n  keyboard?: boolean;\n  /**\n   * 自定义菜单项渲染\n   */\n  renderItem?: IRenderReactNode<{ key: string }>;\n} & IRestProps & Omit<React.DOMAttributes<HTMLDivElement>, 'onSelect'>;\n\nexport const Menu = memo(\n  forwardRef<HTMLDivElement, IMenuProps>(\n    (props, ref) => {\n\n      const {\n        path: _path,\n        onPathChange,\n        onSelect = noop as Required<IMenuProps>['onSelect'],\n        items = [],\n        renderItem,\n        keyboard = true,\n        ...rest\n      } = props;\n\n      const flattenItems = useMemo(() => flattenNested(items), [items]);\n\n      const [path, setPath] = useDefaultProp<Array<string | undefined>>([], _path, onPathChange);\n\n      // 存储异步菜单项数据\n      const [smiState, smiDispatch] = useReducer(\n        (\n          state: Record<string, INestedItems<IMenuItem> | undefined>,\n          action: [string, INestedItems<IMenuItem>]\n        ) => {\n          const [key, items] = action;\n          return {\n            ...state,\n            [key]: items\n          };\n        },\n        {}\n      );\n\n      const wrapRef = useRef<HTMLDivElement>(null);\n      const [focusTargetId, focusTarget, focusOwner] = useFocusTarget(wrapRef);\n\n      // 根据列表中的当前激活项变化，设置 path\n      // 注意：当通过鼠标悬浮到具有子菜单的菜单项时，自动展开子菜单\n      const onActiveChange: React.ComponentProps<typeof List>['onActiveChange'] = (k, op) => {\n        const it = flattenItems.find(it => it.key === k);\n        if (it) {\n          if (hasSubMenu(it)) {\n            if (op.from === 'mouse') {\n              setPath([it.key, undefined]);\n            } else {\n              setPath([it.key]);\n            }\n          } else {\n            setPath([it.key]);\n          }\n        } else {\n          if (path.length === 1) {\n            setPath([undefined]);\n          }\n        }\n      };\n\n      // 键盘方向键控制子菜单的打开关闭\n      // 如果当前菜单叶子级：\n      //    按下 Right 键：如果当前项有子菜单，则打开\n      //    按下 Enter 键：如果当前项有子菜单，则打开\n      // 如果当前菜单次叶子级（即从叶子级开始向上追溯的第二级）：\n      //    按下 Left 键：收起当前子菜单\n      const onKeydownLeaf = (e: React.KeyboardEvent) => {\n        const kbKey = e.key.toLowerCase();\n        const isArrowRight = kbKey === 'arrowright' || e.keyCode === KEY_CODES.RIGHT;\n        const isEnter = kbKey === 'enter' || e.keyCode === KEY_CODES.ENTER;\n\n        const curItem = flattenItems.find(it => it.key === path[0])!;\n        if (isArrowRight || isEnter) {\n\n          if (hasSubMenu(curItem)) {\n\n            const subMenuItems = curItem.subMenu === undefined ? undefined :\n              typeof curItem.subMenu === 'function' ? smiState[curItem.key] :\n                curItem.subMenu;\n\n            if (subMenuItems) {\n\n              const subFlattenItems = flattenNested(subMenuItems).filter(isNormalized).filter(isEnabled);\n\n              if (subFlattenItems.length > 0) {\n                const rightKey = subFlattenItems[0].key;\n                focusTarget(\n                  () => {\n                    setPath([path[0], rightKey]);\n                  }\n                );\n                e.stopPropagation();\n                return;\n              }\n            } else {\n              focusTarget(\n                () => {\n                  setPath([path[0], undefined]);\n                }\n              );\n              e.stopPropagation();\n              return;\n            }\n          }\n        }\n      };\n      const onKeydownSecondaryLeaf = (e: React.KeyboardEvent) => {\n        const isArrowLeft = e.key.toLowerCase() === 'arrowleft' || e.keyCode === 37;\n        if (isArrowLeft) {\n          focusOwner(\n            () => {\n              setPath([path[0]]);\n            }\n          );\n          e.stopPropagation();\n        }\n      };\n      const onKeydown = keyboard ? (\n        path.filter(Boolean).length === 1 /** isLeaf */ ?\n          onKeydownLeaf :\n          path.filter(Boolean).length === 2 /** isSecondaryLeaf */ ?\n            onKeydownSecondaryLeaf :\n            undefined\n      ) : undefined;\n\n      const subMenuRef = useRef<HTMLDivElement>(null);\n\n      // 自定义列表项渲染\n      const renderListItem: React.ComponentProps<typeof List>['renderItem'] =\n        ({ key }) =>\n          /* 以下 arrow function 不是一个 React 组件 */\n          /* eslint-disable react/display-name */\n          (sourceNode) => {\n\n            const item = flattenItems.find(it => it.key === key);\n\n            if (item && isNormalized(item)) {\n\n              const itemHasSubMenu = hasSubMenu(item);\n\n              const targetItemChildren = item.description ? <>\n                <MenuItemTitleDescription>{item.title}</MenuItemTitleDescription>\n                <MenuItemDescription disabled={!!item.disabled}>{item.description}</MenuItemDescription>\n              </> : sourceNode.props.children;\n\n              const toCloned = {\n                children: targetItemChildren,\n                suffix: itemHasSubMenu ? <IconArrowRight size={16} /> : item.suffix,\n              };\n              if (toCloned.suffix === undefined) {\n                delete toCloned.suffix;\n              }\n\n              const targetItemWithChildren: React.ReactNode = cloneElement(sourceNode, toCloned);\n\n              const targetNode = renderReactNode(renderItem, targetItemWithChildren, { key });\n\n              if (itemHasSubMenu) {\n\n                const isExpaned = path[0] === item.key && path.length > 1;\n\n                if (isExpaned) {\n\n                  const subItems = hasSyncSubMenu(item) ? item.subMenu : smiState[item.key];\n\n                  // 对于正在加载的子菜单，subItems 为 undefined\n\n                  if (subItems) {\n\n                    return <Popover\n                      animation={true}\n                      visible={true}\n                      onVisibleChange={v => {\n                        if (v === false) {\n                          setPath([path[0]]);\n                        }\n                      }}\n                      placement='rightTop'\n                      placementOffset={[-2, -5]}\n                      getContainer={() => wrapRef.current || document.body}\n                      content={\n                        <Menu\n                          ref={subMenuRef}\n                          path={path.slice(1)}\n                          onPathChange={p => {\n                            setPath([item.key, ...p]);\n                          }}\n                          items={subItems}\n                          onSelect={(path) => onSelect([item.key, ...path])}\n                          renderItem={renderItem}\n                          {...rest}\n                          id={focusTargetId}\n                        />\n                      }\n                    >\n                      {\n                        isValidElement(targetNode) ? cloneElement(\n                          targetNode as React.ReactElement,\n                          {\n                            onMouseLeave: (e: React.MouseEvent) => {\n                              const t = 10;\n                              const { clientX: x, clientY: y } = e;\n                              const subMenu = subMenuRef.current;\n                              if (subMenu) {\n                                const subMenuRect = subMenu.getBoundingClientRect();\n                                if (\n                                  x < subMenuRect.right + t &&\n                                  x > subMenuRect.left - t &&\n                                  y < subMenuRect.bottom + t &&\n                                  y > subMenuRect.top - t\n                                ) {\n                                  return;\n                                }\n                              }\n                              setPath([undefined]);\n                            }\n                          }\n                        ) : targetNode\n                      }\n                    </Popover>\n                  } else {\n                    return targetNode;\n                  }\n                } else {\n                  return targetNode;\n                }\n              } else {\n                return targetNode;\n              }\n            } else {\n              return null;\n            }\n          };\n          /* eslint-enable react/display-name */\n\n      // 根据菜单 path 变化，尝试发起异步子菜单数据获取\n      const key = path[0];\n      useEffect(() => {\n        if (typeof key === 'string') {\n          const item = flattenItems.find(it => it.key === key);\n          if (item && hasAsyncSubMenu(item) && smiState[key] === undefined) {\n            item.subMenu().then(e => {\n              smiDispatch([key, e]);\n            });\n          }\n        }\n      }, [flattenItems, key, smiState]);\n\n      return <List\n        items={items}\n        active={path[0] || null}\n        onActiveChange={onActiveChange}\n        onSelect={k => onSelect([k])}\n        onKeyDown={onKeydown}\n        renderItem={renderListItem}\n        keyboard={keyboard}\n        {...mergeRestProps(rest, 'wdn-menu')}\n        ref={mergeRef(ref, wrapRef)}\n      />;\n    }\n  )\n);\n\nMenu.displayName = 'Menu';\n\nexport const MenuItem = List.Item;\n"],"mappings":";;;;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,OAAO,EAAEC,UAAU,EAAEC,MAAM,EAAEC,IAAI,EAAEC,UAAU,EAAEC,YAAY,EAAEC,cAAc,QAAQ,OAAO;AAAC,qBAC1F;AAA5B,SAASC,cAAc;AACvB,SAASC,IAAI;AACb,SAAmDC,aAAa,EAAgBC,YAAY,EAAEC,SAAS;AACvG,SAASC,mBAAmB,EAAEC,wBAAwB;AACtD,SAASC,OAAO;AAChB,SAASC,cAAc,EAAcC,cAAc,EAAEC,cAAc,EAAEC,QAAQ,EAAEC,eAAe,EAAoBC,SAAS;AAC3H,SAASC,IAAI,QAAQ,WAAW;AAWhC,IAAMC,UAAU,GAAG,SAAbA,UAAU,CAAIC,EAAa,EAA0F;EACzH,OAAO,SAAS,IAAIA,EAAE,IAAI,CAAC,CAACA,EAAE,CAACC,OAAO;AACxC,CAAC;AAED,IAAMC,eAAe,GAAG,SAAlBA,eAAe,CAAIF,EAAa,EAAwF;EAC5H,OAAOD,UAAU,CAACC,EAAE,CAAC,IAAI,OAAOA,EAAE,CAACC,OAAO,KAAK,UAAU;AAC3D,CAAC;AAED,IAAME,cAAc,GAAG,SAAjBA,cAAc,CAAIH,EAAa,EAAyE;EAC5G,OAAOD,UAAU,CAACC,EAAE,CAAC,IAAII,KAAK,CAACC,OAAO,CAACL,EAAE,CAACC,OAAO,CAAC;AACpD,CAAC;AA6BD,OAAO,IAAMK,IAAI,gBAAG1B,IAAI,eACtBC,UAAU,CACR,UAAC0B,KAAK,EAAEC,GAAG,EAAK;EAEd,IACQC,KAAK,GAOTF,KAAK,CAPPG,IAAI;IACJC,YAAY,GAMVJ,KAAK,CANPI,YAAY;IAAA,kBAMVJ,KAAK,CALPK,QAAQ;IAARA,SAAQ,gCAAGd,IAAI;IAAA,eAKbS,KAAK,CAJPM,KAAK;IAALA,KAAK,6BAAG,EAAE;IACVC,UAAU,GAGRP,KAAK,CAHPO,UAAU;IAAA,kBAGRP,KAAK,CAFPQ,QAAQ;IAARA,QAAQ,gCAAG,IAAI;IACZC,IAAI,iCACLT,KAAK;EAET,IAAMU,YAAY,GAAGxC,OAAO,CAAC;IAAA,OAAMS,aAAa,CAAC2B,KAAK,CAAC;EAAA,GAAE,CAACA,KAAK,CAAC,CAAC;EAEjE,sBAAwBrB,cAAc,CAA4B,EAAE,EAAEiB,KAAK,EAAEE,YAAY,CAAC;IAAnFD,IAAI;IAAEQ,OAAO;;EAEpB;EACA,kBAAgCxC,UAAU,CACxC,UACEyC,KAA0D,EAC1DC,MAAyC,EACtC;MAAA;MACH,IAAOC,GAAG,GAAWD,MAAM;QAAfP,KAAK,GAAIO,MAAM;MAC3B,oBACKD,KAAK,6BACPE,GAAG,IAAGR,KAAK;IAEhB,CAAC,EACD,CAAC,CAAC,CACH;IAZMS,QAAQ;IAAEC,WAAW;EAc5B,IAAMC,OAAO,GAAG7C,MAAM,CAAiB,IAAI,CAAC;EAC5C,sBAAiDe,cAAc,CAAC8B,OAAO,CAAC;IAAjEC,aAAa;IAAEC,WAAW;IAAEC,UAAU;;EAE7C;EACA;EACA,IAAMC,cAAmE,GAAG,SAAtEA,cAAmE,CAAIC,CAAC,EAAEC,EAAE,EAAK;IACrF,IAAM9B,EAAE,GAAGiB,YAAY,CAACc,IAAI,CAAC,UAAA/B,EAAE;MAAA,OAAIA,EAAE,CAACqB,GAAG,KAAKQ,CAAC;IAAA,EAAC;IAChD,IAAI7B,EAAE,EAAE;MACN,IAAID,UAAU,CAACC,EAAE,CAAC,EAAE;QAClB,IAAI8B,EAAE,CAACE,IAAI,KAAK,OAAO,EAAE;UACvBd,OAAO,CAAC,CAAClB,EAAE,CAACqB,GAAG,EAAEY,SAAS,CAAC,CAAC;QAC9B,CAAC,MAAM;UACLf,OAAO,CAAC,CAAClB,EAAE,CAACqB,GAAG,CAAC,CAAC;QACnB;MACF,CAAC,MAAM;QACLH,OAAO,CAAC,CAAClB,EAAE,CAACqB,GAAG,CAAC,CAAC;MACnB;IACF,CAAC,MAAM;MACL,IAAIX,IAAI,CAACwB,MAAM,KAAK,CAAC,EAAE;QACrBhB,OAAO,CAAC,CAACe,SAAS,CAAC,CAAC;MACtB;IACF;EACF,CAAC;;EAED;EACA;EACA;EACA;EACA;EACA;EACA,IAAME,aAAa,GAAG,SAAhBA,aAAa,CAAIC,CAAsB,EAAK;IAChD,IAAMC,KAAK,GAAGD,CAAC,CAACf,GAAG,CAACiB,WAAW,EAAE;IACjC,IAAMC,YAAY,GAAGF,KAAK,KAAK,YAAY,IAAID,CAAC,CAACI,OAAO,KAAK3C,SAAS,CAAC4C,KAAK;IAC5E,IAAMC,OAAO,GAAGL,KAAK,KAAK,OAAO,IAAID,CAAC,CAACI,OAAO,KAAK3C,SAAS,CAAC8C,KAAK;IAElE,IAAMC,OAAO,GAAG3B,YAAY,CAACc,IAAI,CAAC,UAAA/B,EAAE;MAAA,OAAIA,EAAE,CAACqB,GAAG,KAAKX,IAAI,CAAC,CAAC,CAAC;IAAA,EAAE;IAC5D,IAAI6B,YAAY,IAAIG,OAAO,EAAE;MAE3B,IAAI3C,UAAU,CAAC6C,OAAO,CAAC,EAAE;QAEvB,IAAMC,YAAY,GAAGD,OAAO,CAAC3C,OAAO,KAAKgC,SAAS,GAAGA,SAAS,GAC5D,OAAOW,OAAO,CAAC3C,OAAO,KAAK,UAAU,GAAGqB,QAAQ,CAACsB,OAAO,CAACvB,GAAG,CAAC,GAC3DuB,OAAO,CAAC3C,OAAO;QAEnB,IAAI4C,YAAY,EAAE;UAEhB,IAAMC,eAAe,GAAG5D,aAAa,CAAC2D,YAAY,CAAC,CAACE,MAAM,CAAC5D,YAAY,CAAC,CAAC4D,MAAM,CAAC3D,SAAS,CAAC;UAE1F,IAAI0D,eAAe,CAACZ,MAAM,GAAG,CAAC,EAAE;YAC9B,IAAMc,QAAQ,GAAGF,eAAe,CAAC,CAAC,CAAC,CAACzB,GAAG;YACvCK,WAAW,CACT,YAAM;cACJR,OAAO,CAAC,CAACR,IAAI,CAAC,CAAC,CAAC,EAAEsC,QAAQ,CAAC,CAAC;YAC9B,CAAC,CACF;YACDZ,CAAC,CAACa,eAAe,EAAE;YACnB;UACF;QACF,CAAC,MAAM;UACLvB,WAAW,CACT,YAAM;YACJR,OAAO,CAAC,CAACR,IAAI,CAAC,CAAC,CAAC,EAAEuB,SAAS,CAAC,CAAC;UAC/B,CAAC,CACF;UACDG,CAAC,CAACa,eAAe,EAAE;UACnB;QACF;MACF;IACF;EACF,CAAC;EACD,IAAMC,sBAAsB,GAAG,SAAzBA,sBAAsB,CAAId,CAAsB,EAAK;IACzD,IAAMe,WAAW,GAAGf,CAAC,CAACf,GAAG,CAACiB,WAAW,EAAE,KAAK,WAAW,IAAIF,CAAC,CAACI,OAAO,KAAK,EAAE;IAC3E,IAAIW,WAAW,EAAE;MACfxB,UAAU,CACR,YAAM;QACJT,OAAO,CAAC,CAACR,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;MACpB,CAAC,CACF;MACD0B,CAAC,CAACa,eAAe,EAAE;IACrB;EACF,CAAC;EACD,IAAMG,SAAS,GAAGrC,QAAQ,GACxBL,IAAI,CAACqC,MAAM,CAACM,OAAO,CAAC,CAACnB,MAAM,KAAK,CAAC,CAAC,gBAChCC,aAAa,GACbzB,IAAI,CAACqC,MAAM,CAACM,OAAO,CAAC,CAACnB,MAAM,KAAK,CAAC,CAAC,yBAChCgB,sBAAsB,GACtBjB,SAAS,GACXA,SAAS;EAEb,IAAMqB,UAAU,GAAG3E,MAAM,CAAiB,IAAI,CAAC;;EAE/C;EACA,IAAM4E,cAA+D,GACnE,SADIA,cAA+D;IAAA,IAChElC,GAAG,QAAHA,GAAG;IAAA,OACJ;MACA;MACA,UAACmC,UAAU,EAAK;QAEd,IAAMC,IAAI,GAAGxC,YAAY,CAACc,IAAI,CAAC,UAAA/B,EAAE;UAAA,OAAIA,EAAE,CAACqB,GAAG,KAAKA,GAAG;QAAA,EAAC;QAEpD,IAAIoC,IAAI,IAAItE,YAAY,CAACsE,IAAI,CAAC,EAAE;UAE9B,IAAMC,cAAc,GAAG3D,UAAU,CAAC0D,IAAI,CAAC;UAEvC,IAAME,kBAAkB,GAAGF,IAAI,CAACG,WAAW,gBAAG,kDAC5C,eAAC,wBAAwB,QAAEH,IAAI,CAACI,KAAK,CAA4B,eACjE,eAAC,mBAAmB;YAAC,QAAQ,EAAE,CAAC,CAACJ,IAAI,CAACK;UAAS,GAAEL,IAAI,CAACG,WAAW,CAAuB,CACvF,GAAGJ,UAAU,CAACjD,KAAK,CAACwD,QAAQ;UAE/B,IAAMC,QAAQ,GAAG;YACfD,QAAQ,EAAEJ,kBAAkB;YAC5BM,MAAM,EAAEP,cAAc,sDAAG,eAAC,cAAc;cAAC,IAAI,EAAE;YAAG,EAAG,IAAGD,IAAI,CAACQ;UAC/D,CAAC;UACD,IAAID,QAAQ,CAACC,MAAM,KAAKhC,SAAS,EAAE;YACjC,OAAO+B,QAAQ,CAACC,MAAM;UACxB;UAEA,IAAMC,sBAAuC,gBAAGpF,YAAY,CAAC0E,UAAU,EAAEQ,QAAQ,CAAC;UAElF,IAAMG,UAAU,GAAGvE,eAAe,CAACkB,UAAU,EAAEoD,sBAAsB,EAAE;YAAE7C,GAAG,EAAHA;UAAI,CAAC,CAAC;UAE/E,IAAIqC,cAAc,EAAE;YAElB,IAAMU,SAAS,GAAG1D,IAAI,CAAC,CAAC,CAAC,KAAK+C,IAAI,CAACpC,GAAG,IAAIX,IAAI,CAACwB,MAAM,GAAG,CAAC;YAEzD,IAAIkC,SAAS,EAAE;cAEb,IAAMC,QAAQ,GAAGlE,cAAc,CAACsD,IAAI,CAAC,GAAGA,IAAI,CAACxD,OAAO,GAAGqB,QAAQ,CAACmC,IAAI,CAACpC,GAAG,CAAC;;cAEzE;;cAEA,IAAIgD,QAAQ,EAAE;gBAEZ,oBAAO,eAAC,OAAO;kBACb,SAAS,EAAE,IAAK;kBAChB,OAAO,EAAE,IAAK;kBACd,eAAe,EAAE,yBAAAC,CAAC,EAAI;oBACpB,IAAIA,CAAC,KAAK,KAAK,EAAE;sBACfpD,OAAO,CAAC,CAACR,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;oBACpB;kBACF,CAAE;kBACF,SAAS,EAAC,UAAU;kBACpB,eAAe,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAE;kBAC1B,YAAY,EAAE;oBAAA,OAAMc,OAAO,CAAC+C,OAAO,IAAIC,QAAQ,CAACC,IAAI;kBAAA,CAAC;kBACrD,OAAO,eACL,eAAC,IAAI;oBACH,GAAG,EAAEnB,UAAW;oBAChB,IAAI,EAAE5C,IAAI,CAACgE,KAAK,CAAC,CAAC,CAAE;oBACpB,YAAY,EAAE,sBAAAC,CAAC,EAAI;sBACjBzD,OAAO,EAAEuC,IAAI,CAACpC,GAAG,SAAKsD,CAAC,EAAE;oBAC3B,CAAE;oBACF,KAAK,EAAEN,QAAS;oBAChB,QAAQ,EAAE,kBAAC3D,IAAI;sBAAA,OAAKE,SAAQ,EAAE6C,IAAI,CAACpC,GAAG,SAAKX,IAAI,EAAE;oBAAA,CAAC;oBAClD,UAAU,EAAEI;kBAAW,GACnBE,IAAI;oBACR,EAAE,EAAES;kBAAc;gBAErB,GAGC,aAAA1C,cAAc,CAACoF,UAAU,CAAC,gBAAGrF,YAAY,CACvCqF,UAAU,EACV;kBACES,YAAY,EAAE,sBAACxC,CAAmB,EAAK;oBACrC,IAAMyC,CAAC,GAAG,EAAE;oBACZ,IAAiBC,CAAC,GAAiB1C,CAAC,CAA5B2C,OAAO;sBAAcC,CAAC,GAAK5C,CAAC,CAAhB6C,OAAO;oBAC3B,IAAMhF,OAAO,GAAGqD,UAAU,CAACiB,OAAO;oBAClC,IAAItE,OAAO,EAAE;sBACX,IAAMiF,WAAW,GAAGjF,OAAO,CAACkF,qBAAqB,EAAE;sBACnD,IACEL,CAAC,GAAGI,WAAW,CAACE,KAAK,GAAGP,CAAC,IACzBC,CAAC,GAAGI,WAAW,CAACG,IAAI,GAAGR,CAAC,IACxBG,CAAC,GAAGE,WAAW,CAACI,MAAM,GAAGT,CAAC,IAC1BG,CAAC,GAAGE,WAAW,CAACK,GAAG,GAAGV,CAAC,EACvB;wBACA;sBACF;oBACF;oBACA3D,OAAO,CAAC,CAACe,SAAS,CAAC,CAAC;kBACtB;gBACF,CAAC,CACF,GAAGkC,UAAU,CAER;cACZ,CAAC,MAAM;gBACL,OAAOA,UAAU;cACnB;YACF,CAAC,MAAM;cACL,OAAOA,UAAU;YACnB;UACF,CAAC,MAAM;YACL,OAAOA,UAAU;UACnB;QACF,CAAC,MAAM;UACL,OAAO,IAAI;QACb;MACF;IAAC;EAAA;EACD;;EAEJ;EACA,IAAM9C,GAAG,GAAGX,IAAI,CAAC,CAAC,CAAC;EACnBlC,SAAS,CAAC,YAAM;IACd,IAAI,OAAO6C,GAAG,KAAK,QAAQ,EAAE;MAC3B,IAAMoC,IAAI,GAAGxC,YAAY,CAACc,IAAI,CAAC,UAAA/B,EAAE;QAAA,OAAIA,EAAE,CAACqB,GAAG,KAAKA,GAAG;MAAA,EAAC;MACpD,IAAIoC,IAAI,IAAIvD,eAAe,CAACuD,IAAI,CAAC,IAAInC,QAAQ,CAACD,GAAG,CAAC,KAAKY,SAAS,EAAE;QAChEwB,IAAI,CAACxD,OAAO,EAAE,CAACuF,IAAI,CAAC,UAAApD,CAAC,EAAI;UACvBb,WAAW,CAAC,CAACF,GAAG,EAAEe,CAAC,CAAC,CAAC;QACvB,CAAC,CAAC;MACJ;IACF;EACF,CAAC,EAAE,CAACnB,YAAY,EAAEI,GAAG,EAAEC,QAAQ,CAAC,CAAC;EAEjC,oBAAO,eAAC,IAAI;IACV,KAAK,EAAET,KAAM;IACb,MAAM,EAAEH,IAAI,CAAC,CAAC,CAAC,IAAI,IAAK;IACxB,cAAc,EAAEkB,cAAe;IAC/B,QAAQ,EAAE,kBAAAC,CAAC;MAAA,OAAIjB,SAAQ,CAAC,CAACiB,CAAC,CAAC,CAAC;IAAA,CAAC;IAC7B,SAAS,EAAEuB,SAAU;IACrB,UAAU,EAAEG,cAAe;IAC3B,QAAQ,EAAExC;EAAS,GACftB,cAAc,CAACuB,IAAI,EAAE,UAAU,CAAC;IACpC,GAAG,EAAErB,QAAQ,CAACa,GAAG,EAAEgB,OAAO;EAAE,GAC5B;AACJ,CAAC,CACF,CACF;AAEDlB,IAAI,CAACmF,WAAW,GAAG,MAAM;AAEzB,OAAO,IAAMC,QAAQ,GAAGzG,IAAI,CAAC0G,IAAI"}