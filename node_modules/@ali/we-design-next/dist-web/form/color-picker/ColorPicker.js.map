{"version":3,"file":"ColorPicker.js","names":["React","isValidElement","useState","useMemo","useRef","mergeRestProps","useDefaultProp","COLORS","useTranslate","DEFAULT","ART","Text","Select","ColorSquare","Popover","ColorPickerWrapper","HeaderGroup","AutoColorWrapper","NoColorWrapper","Row","Divider","AdvanceGroup","Group","RecentGroup","SketchPickerWrap","ArrowRight","ColorPickerSketch","PRESETS","PRESET_KEY","PRESET_TITLE","title","t","startsWith","ColorPicker","memo","props","color","defaultColor","onColorChange","_currentPreset","currentPreset","_onCurrentPresetChange","onCurrentPresetChange","autoColor","recentColors","advance","hoverMode","presets","_presets","rest","value","setValue","advancePickerVisible","setAdvancePickerVisible","map","p","key","setCurrentPreset","ref","advanceGroupRef","fromSketch","intermediate","marginLeft","flexGrow","undefined","length","current","document","body","find","colors","i","j","LIGHT","LEVEL2_BASE_COLOR","marginBottom","WHITE","e","background","OTHERS","DAO_HOVER_BG_COLOR","iconAdvanceColorPicker"],"sources":["../../../../src/form/color-picker/ColorPicker.tsx"],"sourcesContent":["\nimport React, { isValidElement, ReactElement, useCallback, useState, useMemo, useRef, DOMAttributes } from 'react';\nimport { IRestProps, mergeRestProps, useDefaultProp, COLORS } from '../../common';\nimport { useTranslate } from '../../locale';\nimport { DEFAULT, ART } from './presets';\nimport { Text } from '../../basic/text';\nimport { Select } from '../select';\nimport { ColorSquare } from './ColorSquare';\nimport { Popover } from '../../display/popover';\nimport {\n  ColorPickerWrapper,\n  HeaderGroup,\n  AutoColorWrapper,\n  NoColorWrapper,\n  Row,\n  Divider,\n  AdvanceGroup,\n  Group,\n  RecentGroup,\n  SketchPickerWrap,\n  ArrowRight,\n} from './styled';\nimport { ColorPickerSketch } from './ColorPickerSketch';\n\nexport type IColorPickerProps = {\n  /**\n   * 当前选中的颜色\n   */\n  color?: string | null;\n  /**\n   * 初始颜色值\n   */\n  defaultColor?: string;\n  /**\n   * 颜色选中后的回调函数，intermediate 表示是否处在中间过渡态，即在高级的 Sketch 风格面板中按下鼠标拖拽过程产生的事件\n   */\n  onColorChange?: (color: string | null, options: { intermediate: boolean, fromSketch: boolean }) => void;\n  /**\n   * 色卡\n   */\n  presets?: Array<{ key: string, title: string, colors: Array<Array<string> | ReactElement> }>;\n  /**\n   * 当前色卡\n   */\n  currentPreset?: string;\n  /**\n   * 当前色卡\n   */\n  onCurrentPresetChange?: (v: string) => void;\n  /**\n   * 自动颜色，不传显示为「无颜色」\n   */\n  autoColor?: string;\n  /**\n   * 最近使用的颜色\n   */\n  recentColors?: string[];\n  /**\n   * 显示高级选择器\n   */\n  advance?: boolean;\n  /**\n   * 颜色块在悬浮时显示为文本或颜色块\n   */\n  hoverMode?: 'square' | 'text';\n} & IRestProps & DOMAttributes<HTMLDivElement>;\n\nconst PRESETS = [DEFAULT, ART];\nconst PRESET_KEY = 'wdn_color_picker_';\nconst PRESET_TITLE = (title: string, t: (k: any) => string): string => title.startsWith(PRESET_KEY) ? t(title) : title;\n\nexport const ColorPicker = React.memo(\n  (props: IColorPickerProps) => {\n\n    const {\n      color,\n      defaultColor,\n      onColorChange,\n      currentPreset: _currentPreset,\n      onCurrentPresetChange: _onCurrentPresetChange,\n      autoColor,\n      recentColors,\n      advance,\n      hoverMode = 'square',\n      presets: _presets = PRESETS,\n      ...rest\n    } = props;\n\n    const [value, setValue] = useDefaultProp(defaultColor, color, onColorChange);\n\n    const [advancePickerVisible, setAdvancePickerVisible] = useState<boolean>(false);\n\n    const t = useTranslate();\n\n    const presets = useMemo(() => _presets.map(p => ({ ...p, title: PRESET_TITLE(p.title, t) })), [_presets, t]);\n    const [currentPreset, setCurrentPreset] = useDefaultProp(presets[0].key, _currentPreset, _onCurrentPresetChange);\n\n    const ref = useRef<HTMLDivElement>(null);\n    const advanceGroupRef = useRef<HTMLDivElement>(null);\n\n    return (\n      <ColorPickerWrapper\n        ref={ref}\n        {...mergeRestProps(rest, 'wdn-color-picker')}\n      >\n        <HeaderGroup>\n          {\n            autoColor ?\n              <AutoColorWrapper>\n                <ColorSquare\n                  color={autoColor}\n                  active={value === autoColor}\n                  onClick={() => setValue(autoColor, { fromSketch: false, intermediate: false })}\n                  mode={hoverMode}\n                />\n                <Text style={{ marginLeft: 4, flexGrow: 1 }} onClick={() => setValue(autoColor, { fromSketch: false, intermediate: false })}>\n                  {t('wdn_color_picker_auto_color')}\n                </Text>\n              </AutoColorWrapper>\n              :\n              <NoColorWrapper>\n                <ColorSquare\n                  color={null}\n                  active={value === null}\n                  onClick={() => setValue(undefined, { fromSketch: false, intermediate: false })}\n                  mode={'square'}\n                />\n                <Text style={{ marginLeft: 4, flexGrow: 1 }} onClick={() => setValue(undefined, { fromSketch: false, intermediate: false })}>\n                  {t('wdn_color_picker_no_color')}\n                </Text>\n              </NoColorWrapper>\n          }\n          {\n            presets.length > 1 ?\n              <Select size='small' bordered={false} options={presets.map(p => ({ key: p.key, title: p.title }))}\n                value={currentPreset}\n                onChange={setCurrentPreset}\n                getContainer={() => (ref.current || document.body)}\n              /> :\n              null\n          }\n        </HeaderGroup>\n        <Group>\n          {\n            (presets.find(p => p.key === currentPreset) || presets[0]).colors.map((colors: Array<string> | ReactElement, i: number) => {\n\n              return isValidElement(colors) ?\n                colors :\n                <Row key={`${colors[0]}-${i}`}>\n                  {\n                    colors.map(\n                      (color, j) =>\n                        <ColorSquare\n                          key={`${color}-${j}`}\n                          color={color}\n                          active={color === value}\n                          onClick={() => { setValue(color, { fromSketch: false, intermediate: false }) }}\n                          mode={hoverMode}\n                        />\n                    )\n                  }\n                </Row>\n            })\n          }\n        </Group>\n        {\n          (recentColors && recentColors.length > 0) ?\n            <>\n              <Divider />\n              <RecentGroup>\n                <Text style={{ color: COLORS.LIGHT.LEVEL2_BASE_COLOR, marginBottom: 4 }}>\n                  {t('wdn_color_picker_recent_colors')}\n                </Text>\n                <Row>\n                  {\n                    recentColors.map((color, j) =>\n                      <ColorSquare\n                        key={`${color}-${j}`}\n                        color={color}\n                        active={color === value}\n                        onClick={() => { setValue(color, { fromSketch: false, intermediate: false }) }}\n                        mode={hoverMode}\n                      />\n                    )\n                  }\n                </Row>\n              </RecentGroup>\n            </> : null\n        }\n        {\n          advance ?\n            <>\n              <Divider />\n              <Popover\n                placement='rightBottom'\n                placementOffset={[12, -6]}\n                trigger='mouse-enter'\n                visible={advancePickerVisible}\n                onVisibleChange={setAdvancePickerVisible}\n                animation\n                getContainer={() => advanceGroupRef.current || document.body}\n                content={\n                  <SketchPickerWrap>\n                    <ColorPickerSketch\n                      color={value || COLORS.WHITE}\n                      onChange={e => setValue(e, { fromSketch: true, intermediate: true })}\n                      onChangeComplete={e => setValue(e, { fromSketch: true, intermediate: false })}\n                    />\n                  </SketchPickerWrap>\n                }\n              >\n                <AdvanceGroup style={{ background: advancePickerVisible ? COLORS.OTHERS.DAO_HOVER_BG_COLOR : undefined }} ref={advanceGroupRef}>\n                  {iconAdvanceColorPicker}\n                  <Text style={{ marginLeft: 8, flexGrow: 1 }}>\n                    {t('wdn_color_picker_more_colors')}\n                  </Text>\n                  <ArrowRight />\n                </AdvanceGroup>\n              </Popover>\n            </>\n            : null\n        }\n      </ColorPickerWrapper >\n    );\n  });\n\nconst iconAdvanceColorPicker = <svg width=\"20\" height=\"20\" viewBox=\"0 0 1024 1024\">\n  <path d=\"M512 512m-448 0a448 448 0 1 0 896 0 448 448 0 1 0-896 0Z\" fill=\"#FDD66F\"></path>\n  <path d=\"M512 64v448L96.106667 345.173333C162.261333 180.352 323.541333 64 512 64z\" fill=\"#FB9855\"></path>\n  <path d=\"M512 512l283.52 346.901333A446.144 446.144 0 0 1 512 960a445.952 445.952 0 0 1-259.498667-82.773333L512 512z\" fill=\"#4897DA\"></path>\n  <path d=\"M101.162667 333.077333L512 510.250667 259.52 882.133333C141.482667 801.450667 64 665.770667 64 512c0-63.616 13.248-124.117333 37.162667-178.922667z\" fill=\"#DA625A\"></path>\n  <path d=\"M922.837333 333.077333A446.506667 446.506667 0 0 1 960 512c0 153.770667-77.482667 289.450667-195.52 370.133333L512 510.250667z\" fill=\"#69B763\"></path>\n</svg>;\n"],"mappings":"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"}