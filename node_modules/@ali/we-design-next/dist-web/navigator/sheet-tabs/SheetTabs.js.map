{"version":3,"file":"SheetTabs.js","names":["React","useCallback","useState","useRef","useEffect","useMemo","useImperativeHandle","debounce","useDefaultProp","combineReactComponent","mergeRef","mergeClassName","mergeRestProps","renderReactNode","useTranslate","Tooltip","IconAdd","IconArrowLeft","IconArrowRight","Tab","TAB_ID_PREFIX","InlineTab","SheetSelect","SheetTabsWrapper","LeftIcons","TabsWrapper","RightIcons","IconWrapper","ResizeObserver","SheetTabsProvider","createContext","getDraggingTabStyle","isDragging","draggableStyle","transform","translateX","slice","indexOf","SheetTabsRaw","memo","forwardRef","props","ref","tabs","defaultTab","length","key","_tab","tab","onTabChange","onAdd","onRename","onMove","onContextMenu","switchable","movable","addable","renamable","renderTab","renderInlineTab","renderAddButton","rest","setTab","editTab","setEditTab","tabsWithoutHidden","filter","item","hidden","editHandlers","setIsDragging","contentRef","arrowVisible","canTranslatePrev","canTranslateNext","arrowState","setArrowState","t","startEdit","current","handleMouseLeaveWhenDragging","window","self","top","setTimeout","event","document","createEvent","initEvent","dispatchEvent","body","addEventListener","removeEventListener","sheetTabsContext","activeTabScrollIntoView","requestAnimationFrame","getElementById","scrollIntoView","handleArrow","scrollDom","newArrowVisible","scrollWidth","clientWidth","newCanTranslatePrev","scrollLeft","newCanTranslateNext","prevState","handleScrollToEdge","Math","ceil","debouncedResize","resizeObserver","observe","disconnect","cancel","handleTranslatePrev","preLeft","scrollTo","left","handleTranslateNext","maxLeft","convertDestinationToAfter","sourceIndex","destinationIndex","handleDragStart","handleDragEnd","e","destination","source","draggableId","index","after","handleEditTab","handleQuitEditTab","addButton","undefined","marginLeft","prevButton","nextButton","Handler","DND","dropProvided","innerRef","droppableProps","map","tabInfo","title","dragProvider","dragSnapshot","draggableProps","dragHandleProps","style","SheetTabs","init","handler"],"sources":["../../../../src/navigator/sheet-tabs/SheetTabs.tsx"],"sourcesContent":["import React, { ReactElement, useCallback, useState, useRef, useEffect, useMemo, useImperativeHandle } from \"react\";\nimport { debounce } from 'lodash-es';\nimport { useDefaultProp, combineReactComponent, mergeRef, mergeClassName, IRestProps, mergeRestProps, IRenderReactNode, renderReactNode } from \"../../common\";\nimport { useTranslate } from '../../locale';\nimport { Tooltip } from \"../../display/tooltip\";\nimport { IconAdd, IconArrowLeft, IconArrowRight } from \"../../basic/icon\";\nimport { Tab, TAB_ID_PREFIX } from \"./Tab\";\nimport { InlineTab } from \"./InlineTab\";\nimport { SheetSelect } from './SheetSelect';\nimport {\n  SheetTabsWrapper,\n  LeftIcons,\n  TabsWrapper,\n  RightIcons,\n  IconWrapper,\n} from \"./styled\";\nimport type { IMoveHandler } from \"./MoveHandler\";\nimport type { DropResult } from 'react-beautiful-dnd'\nimport ResizeObserver from 'resize-observer-polyfill';\n\nexport type TabInfo = {\n  key: string;\n  title: string;\n  hidden?: boolean;\n}\n\nexport type ISheetTabsProps = {\n  /**\n   * 标签项\n   */\n  tabs: TabInfo[];\n  /**\n   * 默认选中的标签的key\n   */\n  defaultTab?: string;\n  /**\n   * 选中的标签的key\n   */\n  tab?: string;\n  /**\n   * 标签切换时的回调\n   */\n  onTabChange?: (key: string) => void;\n  /**\n   * 标签添加时的回调\n   */\n  onAdd?: (after: string | null) => void;\n  /**\n   * 标签重命名时的回调\n   */\n  onRename?: (key: string, title: string) => void;\n  /**\n   * 标签移动时的回调\n   */\n  onMove?: (key: string, after: string | null) => void;\n  /**\n   * 标签触发右键菜单时的回调\n   */\n  onContextMenu?: (key: string, e: React.MouseEvent) => void;\n  /**\n   * 标签是否可切换\n   */\n  switchable?: boolean;\n  /**\n   * 标签是否可移动\n   */\n  movable?: boolean;\n  /**\n   * 标签是否可添加，默认显示\n   * true显示，false不显示, disabled表示显示但是点击无效\n   */\n  addable?: boolean | \"disabled\";\n  /**\n   * 标签是否可以重命名\n   */\n  renamable?: boolean;\n  /**\n   * 标签自定义渲染\n   */\n  renderTab?: IRenderReactNode<{ key: string }>;\n  /**\n   * 选项列表的标签自定义渲染\n   */\n  renderInlineTab?: IRenderReactNode<{ key: string }>;\n  /**\n   * 添加按钮自定义渲染\n   */\n  renderAddButton?: () => ReactElement;\n} & IRestProps;\n\ntype ISheetTabsHandler = {\n  startEdit: () => void;\n};\n\ninterface ISheetTabsContext {\n  editHandlers: React.MutableRefObject<Record<string, (key: string) => void>>;\n}\nexport const SheetTabsProvider = React.createContext({} as ISheetTabsContext);\n\nconst getDraggingTabStyle = (isDragging: boolean, draggableStyle: React.CSSProperties): React.CSSProperties => {\n  const { transform } = draggableStyle;\n  if (isDragging && transform) {\n    const translateX = transform.slice(\n      transform.indexOf('(') + 1,\n      transform.indexOf(','),\n    );\n    return {\n      ...draggableStyle,\n      transform: `translate(${translateX}, 0)`,\n    };\n  }\n  return draggableStyle;\n};\n\nconst SheetTabsRaw = React.memo(React.forwardRef<ISheetTabsHandler, ISheetTabsProps>((props, ref) => {\n  const {\n    tabs,\n    defaultTab = tabs.length > 0 ? tabs[0].key : '',\n    tab: _tab,\n    onTabChange,\n    onAdd,\n    onRename,\n    onMove,\n    onContextMenu,\n    switchable = true,\n    movable = true,\n    addable = true,\n    renamable = false,\n    renderTab,\n    renderInlineTab,\n    renderAddButton,\n    ...rest\n  } = props;\n\n  const [tab, setTab] = useDefaultProp<string>(defaultTab, _tab, onTabChange);\n  const [editTab, setEditTab] = useState<string | null>(null);\n  const tabsWithoutHidden = useMemo(() => tabs.filter((item) => !item.hidden), [tabs]);\n  const editHandlers = useRef<Record<string, () => void>>({});\n  const [isDragging, setIsDragging] = useState<boolean>(false);\n\n  const contentRef = useRef<HTMLDivElement>(null);\n  const [arrowState, setArrowState] = useState({\n    arrowVisible: false,\n    canTranslatePrev: false,\n    canTranslateNext: false,\n  });\n\n  const t = useTranslate();\n\n  useImperativeHandle(ref, () => ({\n    startEdit: editHandlers.current[tab],\n  }));\n\n  // iframe 条件下，鼠标拖出视口外，没有触发 mouseup，因此此处进行 hack\n  const handleMouseLeaveWhenDragging = useCallback(() => {\n    if (isDragging && window.self !== window.top) {\n      // trigger mouseup\n      setTimeout(() => {\n        const event = document.createEvent('MouseEvents');\n        event.initEvent('mouseup', true, true);\n        contentRef.current?.dispatchEvent(event);\n      }, 200);\n    }\n  }, [isDragging]);\n\n  useEffect(() => {\n    document.body.addEventListener('mouseleave', handleMouseLeaveWhenDragging);\n    return () => {\n      document.body.removeEventListener('mouseleave', handleMouseLeaveWhenDragging);\n    };\n  }, [handleMouseLeaveWhenDragging]);\n\n  const sheetTabsContext = useMemo(() => {\n    return { editHandlers };\n  }, [editHandlers]);\n\n  const activeTabScrollIntoView = useCallback(() => {\n    requestAnimationFrame(() => {\n      document.getElementById(`${TAB_ID_PREFIX}${tab}`)?.scrollIntoView();\n    });\n  }, [tab]);\n\n  const handleArrow = useCallback(debounce(() => {\n    const scrollDom = contentRef?.current;\n    if (!scrollDom) return;\n    const newArrowVisible = scrollDom.scrollWidth > scrollDom.clientWidth;\n    const newCanTranslatePrev = scrollDom.scrollLeft > 0;\n    const newCanTranslateNext =\n      scrollDom.scrollLeft < scrollDom.scrollWidth - scrollDom.clientWidth;\n    setArrowState((prevState) => {\n      if (\n        newArrowVisible !== prevState.arrowVisible ||\n        newCanTranslatePrev !== prevState.canTranslatePrev ||\n        newCanTranslateNext !== prevState.canTranslateNext\n      ) {\n        return {\n          arrowVisible: newArrowVisible,\n          canTranslatePrev: newCanTranslatePrev,\n          canTranslateNext: newCanTranslateNext,\n        };\n      }\n      return prevState;\n    });\n    activeTabScrollIntoView();\n  }, 0), [activeTabScrollIntoView]);\n\n  const handleScrollToEdge = useCallback(debounce((): void => {\n    const scrollDom = contentRef?.current;\n    if (!scrollDom) return;\n    const newCanTranslatePrev = scrollDom.scrollLeft > 0;\n    // ceil消除scrollDom.scrollLeft最大值有时是小数, 小0.5像素\n    const newCanTranslateNext = Math.ceil(scrollDom.scrollLeft) < scrollDom.scrollWidth - scrollDom.clientWidth;\n    setArrowState((prevState) => {\n      if (newCanTranslatePrev !== prevState.canTranslatePrev || newCanTranslateNext !== prevState.canTranslateNext) {\n        return {\n          arrowVisible: prevState.arrowVisible,\n          canTranslateNext: newCanTranslateNext,\n          canTranslatePrev: newCanTranslatePrev,\n        };\n      }\n      return prevState;\n    });\n  }, 100), []);\n\n  useEffect(() => {\n    handleArrow();\n  }, [tabs.length, tab, handleArrow]);\n\n  useEffect(() => {\n    const debouncedResize = debounce(() => {\n      handleArrow();\n    }, 200);\n    const resizeObserver = new ResizeObserver(debouncedResize);\n    resizeObserver.observe(contentRef.current!);\n    return () => {\n      resizeObserver.disconnect();\n      if (debouncedResize.cancel) {\n        debouncedResize.cancel();\n      }\n    };\n  }, [handleArrow]);\n\n  const handleTranslatePrev = useCallback(() => {\n    const scrollDom = contentRef?.current;\n    if (!scrollDom) return;\n    const preLeft = scrollDom.scrollLeft - scrollDom.clientWidth;\n    scrollDom.scrollTo({\n      left: preLeft < 0 ? 0 : preLeft,\n    });\n  }, []);\n\n  const handleTranslateNext = useCallback(() => {\n    const scrollDom = contentRef?.current;\n    if (!scrollDom) return;\n    const preLeft = scrollDom.scrollLeft + scrollDom.clientWidth;\n    const maxLeft = scrollDom.scrollWidth - scrollDom.clientWidth;\n    scrollDom.scrollTo({\n      left: preLeft > maxLeft ? maxLeft : preLeft,\n    });\n  }, []);\n\n  const convertDestinationToAfter = useCallback((sourceIndex: number, destinationIndex: number): string | null => {\n    if (destinationIndex === 0) return null;\n    if (sourceIndex < destinationIndex) {\n      return tabs[destinationIndex].key;\n    }\n    return tabs[destinationIndex - 1].key;\n  }, [tabs]);\n\n  const handleDragStart = useCallback(() => {\n    setIsDragging(true);\n  }, []);\n\n  const handleDragEnd = useCallback((e: DropResult): void => {\n    setIsDragging(false);\n    const { destination, source, draggableId } = e;\n    if (destination && destination.index !== source.index) {\n      const after = convertDestinationToAfter(source.index, destination.index);\n      onMove?.(draggableId, after);\n    }\n  }, [onMove]);\n\n  const handleEditTab = useCallback((key: string) => {\n    if (editTab !== key) {\n      setEditTab(key);\n    }\n  }, [editTab]);\n\n  const handleQuitEditTab = useCallback((key: string) => {\n    if (editTab === key) {\n      setEditTab(null);\n    }\n  }, [editTab]);\n\n  const addButton = (\n    <IconWrapper\n      className={mergeClassName(\n        addable === \"disabled\" ? \"disabled\" : undefined\n      )}\n      style={{ marginLeft: 8 }}\n      onClick={() => onAdd?.(tab)}\n    >\n      <IconAdd />\n    </IconWrapper>\n  );\n\n  const prevButton = (\n    <IconWrapper\n      className={mergeClassName(\n        arrowState.canTranslatePrev ? undefined : \"disabled\"\n      )}\n      onClick={arrowState.canTranslatePrev ? handleTranslatePrev : undefined}\n    >\n      <IconArrowLeft />\n    </IconWrapper>\n  );\n\n  const nextButton = (\n    <IconWrapper\n      className={mergeClassName(\n        arrowState.canTranslateNext ? undefined : \"disabled\"\n      )}\n      onClick={arrowState.canTranslateNext ? handleTranslateNext : undefined}\n    >\n      <IconArrowRight />\n    </IconWrapper>\n  );\n\n  const Handler = DND.Handler as any;\n\n  return (\n    <SheetTabsWrapper {...mergeRestProps(rest, 'wdn-sheet-tabs')}>\n      <LeftIcons>\n        <SheetSelect\n          tabs={tabs}\n          tab={tab}\n          setActiveTab={setTab}\n          disabled={!switchable}\n          renderInlineTab={renderInlineTab}\n        />\n        {addable\n          ? renderAddButton?.() || (addable === \"disabled\" ? addButton :\n            <Tooltip title={t('wdn_sheet_tabs_add')} placement=\"top\">\n              {addButton}\n            </Tooltip>\n          )\n          : null}\n      </LeftIcons>\n      <SheetTabsProvider.Provider value={sheetTabsContext}>\n        {movable && Handler ? (\n          <Handler.DragDropContext onDragStart={handleDragStart} onDragEnd={handleDragEnd}>\n            <Handler.Droppable\n              droppableId=\"wdn-sheet-tabs\"\n              direction=\"horizontal\"\n            >\n              {(dropProvided: any) => (\n                <TabsWrapper\n                  ref={mergeRef(dropProvided.innerRef, contentRef)}\n                  {...dropProvided.droppableProps}\n                  onScroll={handleScrollToEdge}\n                >\n                  {tabsWithoutHidden.map((tabInfo, index) => {\n                    const { key, title } = tabInfo;\n                    return (\n                      <Handler.Draggable\n                        key={key}\n                        draggableId={key}\n                        index={index}\n                      >\n                        {(dragProvider: any, dragSnapshot: any) =>\n                          renderReactNode(\n                            renderTab,\n                            <Tab\n                              {...dragProvider.draggableProps}\n                              {...dragProvider.dragHandleProps}\n                              ref={dragProvider.innerRef}\n                              tab={key}\n                              title={title}\n                              active={key === tab}\n                              editing={key === editTab}\n                              setActiveTab={setTab}\n                              onEditingTab={handleEditTab}\n                              onQuitEditingTab={handleQuitEditTab}\n                              switchable={switchable}\n                              renamable={renamable}\n                              onRename={onRename}\n                              onContextMenu={onContextMenu}\n                              style={getDraggingTabStyle(\n                                dragSnapshot.isDragging,\n                                dragProvider.draggableProps.style\n                              )}\n                            />,\n                            { key }\n                          )\n                        }\n                      </Handler.Draggable>\n                    );\n                  })}\n                </TabsWrapper>\n              )}\n            </Handler.Droppable>\n          </Handler.DragDropContext>\n        ) : (\n          <TabsWrapper ref={contentRef} onScroll={handleScrollToEdge}>\n            {tabsWithoutHidden.map((tabInfo) => {\n              const { key, title } = tabInfo;\n              return renderReactNode(\n                renderTab,\n                <Tab\n                  key={key}\n                  tab={key}\n                  title={title}\n                  active={key === tab}\n                  editing={key === editTab}\n                  setActiveTab={setTab}\n                  onEditingTab={handleEditTab}\n                  onQuitEditingTab={handleQuitEditTab}\n                  switchable={switchable}\n                  renamable={renamable}\n                  onRename={onRename}\n                  onContextMenu={onContextMenu}\n                />,\n                { key }\n              );\n            })}\n          </TabsWrapper>\n        )}\n      </SheetTabsProvider.Provider>\n      {arrowState.arrowVisible ? (\n        <RightIcons>\n          {arrowState.canTranslatePrev ? <Tooltip title={t('wdn_sheet_tabs_scroll_left')} placement=\"top\">\n            {prevButton}\n          </Tooltip> : prevButton}\n          {arrowState.canTranslateNext ? <Tooltip title={t('wdn_sheet_tabs_scroll_right')} placement=\"top\">\n            {nextButton}\n          </Tooltip> : nextButton}\n        </RightIcons>\n      ) : null}\n    </SheetTabsWrapper>\n  );\n}));\n\nconst DND: { Handler?: IMoveHandler } = {};\n\nexport const SheetTabs = combineReactComponent(SheetTabsRaw, {\n  init: (handler?: IMoveHandler) => (DND.Handler = handler),\n  Tab: Tab as React.FC<Partial<Pick<React.ComponentProps<typeof Tab>, 'title' | 'prefix' | 'suffix'> & Omit<IRestProps, 'id' | 'style'>>>,\n  InlineTab: InlineTab as React.FC<Partial<Pick<React.ComponentProps<typeof InlineTab>, 'title' | 'disabled' | 'tooltipTitle' | 'onClick'>> & IRestProps>,\n});\n"],"mappings":"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"}