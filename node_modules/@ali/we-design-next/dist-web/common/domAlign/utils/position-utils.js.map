{"version":3,"file":"position-utils.js","names":["utils","setTransitionProperty","getTransitionProperty","getTransformXY","setTransformXY","getTransformName","forceRelayout","elem","originalStyle","style","display","offsetHeight","getClientPosition","doc","ownerDocument","body","docElem","documentElement","box","getBoundingClientRect","x","Math","floor","left","y","top","clientLeft","clientTop","getScroll","w","ret","method","d","document","getScrollLeft","getScrollTop","getOffset","el","pos","defaultView","parentWindow","getOffsetDirection","dir","option","useCssRight","useCssBottom","oppositeOffsetDirection","setLeftTop","offset","css","position","presetH","presetV","horizontalProperty","verticalProperty","oppositeHorizontalProperty","oppositeVerticalProperty","originalTransition","originalOffset","old","key","Object","prototype","hasOwnProperty","call","preset","off","parseFloat","setTransform","originalXY","resultXY","undefined","setOffset","ignoreShake","oriOffset","oLeft","toFixed","oTop","tLeft","tTop","useCssTransform"],"sources":["../../../../../src/common/domAlign/utils/position-utils.tsx"],"sourcesContent":["import React from 'react';\nimport type { IRegion, IDir, IOption, IOffset, IFullRegion } from '../interface';\nimport { utils }from './utils';\nimport {\n  setTransitionProperty,\n  getTransitionProperty,\n  getTransformXY,\n  setTransformXY,\n  getTransformName,\n} from './property-utils';\n\n// typescript 1.5版本从document上移除了parentWindow属性;\n// https://stackoverflow.com/questions/38973426/using-documentmode-with-typescript\nexport interface OurDocument extends Document {\n  parentWindow?: Window;\n}\n\n\n// https://stackoverflow.com/a/3485654/3040605\nfunction forceRelayout(elem: HTMLElement): void {\n  const originalStyle = elem.style.display;\n  elem.style.display = 'none';\n  elem.offsetHeight; // eslint-disable-line\n  elem.style.display = originalStyle;\n}\n\n/**\n * \n * @param elem \n * @returns 元素相对于文档的left、top信息\n * 元素的getBoundingClientRect()中返回的left, top加上对应window横向和竖向滚动的距离\n * getBoundingClientRect()返回的只是元素对应 浏览器可视区域 的width,height,left,top等值\n */\nfunction getClientPosition(elem: HTMLElement): IRegion {\n  const doc = elem.ownerDocument;\n  const body = doc.body;\n  const docElem = doc && doc.documentElement;\n  // 根据 GBS 最新数据，A-Grade Browsers 都已支持 getBoundingClientRect 方法，不用再考虑传统的实现方式\n  const box = elem.getBoundingClientRect();\n\n  // 注：jQuery 还考虑减去 docElem.clientLeft/clientTop\n  // 但测试发现，这样反而会导致当 html 和 body 有边距/边框样式时，获取的值不正确\n  // 此外，ie6 会忽略 html 的 margin 值，幸运地是没有谁会去设置 html 的 margin\n\n  let x = Math.floor(box.left);\n  let y = Math.floor(box.top);\n\n  // In IE, most of the time, 2 extra pixels are added to the top and left\n  // due to the implicit 2-pixel inset border.  In IE6/7 quirks mode and\n  // IE6 standards mode, this border can be overridden by setting the\n  // document element's border to zero -- thus, we cannot rely on the\n  // offset always being 2 pixels.\n\n  // In quirks mode, the offset can be determined by querying the body's\n  // clientLeft/clientTop, but in standards mode, it is found by querying\n  // the document element's clientLeft/clientTop.  Since we already called\n  // getClientBoundingRect we have already forced a reflow, so it is not\n  // too expensive just to query them all.\n\n  // ie 下应该减去窗口的边框吧，毕竟默认 absolute 都是相对窗口定位的\n  // 窗口边框标准是设 documentElement ,quirks 时设置 body\n  // 最好禁止在 body 和 html 上边框 ，但 ie < 9 html 默认有 2px ，减去\n  // 但是非 ie 不可能设置窗口边框，body html 也不是窗口 ,ie 可以通过 html,body 设置\n  // 标准 ie 下 docElem.clientTop 就是 border-top\n  // ie7 html 即窗口边框改变不了。永远为 2\n  // 但标准 firefox/chrome/ie9 下 docElem.clientTop 是窗口边框，即使设了 border-top 也为 0\n\n  x -= docElem.clientLeft || body.clientLeft || 0; // 减去竖向滚动条宽度\n  y -= docElem.clientTop || body.clientTop || 0; // 减去横向滚动条宽度\n\n  return {\n    left: x,\n    top: y,\n  };\n}\n\nfunction getScroll(w: Window, top?: boolean): number {\n  let ret: number = w[`page${top ? 'Y' : 'X'}Offset`];\n  const method: string = `scroll${top ? 'Top' : 'Left'}`;\n  if (typeof ret !== 'number') {\n    const d = w.document;\n    // ie6,7,8 standard mode\n    ret = d.documentElement[method as keyof HTMLElement] as number;\n    if (typeof ret !== 'number') {\n      // quirks mode\n      ret = d.body[method as keyof HTMLElement] as number;\n    }\n  }\n  return ret;\n}\n\nfunction getScrollLeft(w: Window): number {\n  return getScroll(w);\n}\n\nfunction getScrollTop(w: Window): number {\n  return getScroll(w, true);\n}\n\nfunction getOffset(el: HTMLElement): IFullRegion {\n  const pos = getClientPosition(el);\n  const doc = el.ownerDocument as OurDocument;\n  const w = (doc.defaultView || doc.parentWindow) as Window;\n  pos.left += getScrollLeft(w);\n  pos.top += getScrollTop(w);\n  return pos as IFullRegion;\n}\n\n\nfunction getOffsetDirection(dir: IDir, option: IOption): IDir {\n  if (dir === 'left') {\n    return option.useCssRight ? 'right' : dir;\n  }\n  return option.useCssBottom ? 'bottom' : dir;\n}\n\nfunction oppositeOffsetDirection(dir: IDir): IDir {\n  if (dir === 'left') {\n    return 'right';\n  } else if (dir === 'right') {\n    return 'left';\n  } else if (dir === 'top') {\n    return 'bottom';\n  }\n  return 'top';\n}\n\n// 根据相对于文档的 {left, top} 值，设置 elem 相对 elem.ownerDocument 的坐标\nfunction setLeftTop(elem: HTMLElement, offset: IOffset, option: IOption) {\n  // set position first, in-case top/left are set even on static elem\n  if (utils.css(elem, 'position') === 'static') {\n    elem.style.position = 'relative';\n  }\n  let presetH = -999;\n  let presetV = -999;\n  const horizontalProperty = getOffsetDirection('left', option);\n  const verticalProperty = getOffsetDirection('top', option);\n  const oppositeHorizontalProperty = oppositeOffsetDirection(\n    horizontalProperty,\n  );\n  const oppositeVerticalProperty = oppositeOffsetDirection(verticalProperty);\n\n  if (horizontalProperty !== 'left') {\n    presetH = 999;\n  }\n\n  if (verticalProperty !== 'top') {\n    presetV = 999;\n  }\n  let originalTransition = '';\n  // 记下一开始相对文档的偏移量\n  const originalOffset = getOffset(elem);\n\n  if ('left' in offset || 'top' in offset) {\n    originalTransition = getTransitionProperty(elem) || '';\n    setTransitionProperty(elem, 'none');\n    // 保存 transition的值，即当前阶段做 left 和 top 的改变，是没有动画的\n    // 因为当前阶段是在做计算，而非真正的设置样式\n  }\n  if ('left' in offset) {\n    elem.style[oppositeHorizontalProperty] = '';\n    elem.style[horizontalProperty] = `${presetH}px`;\n  }\n  if ('top' in offset) {\n    elem.style[oppositeVerticalProperty] = '';\n    elem.style[verticalProperty] = `${presetV}px`;\n  }\n\n\n  // force relayout, 先设置为 -999 \n  forceRelayout(elem);\n  const old = getOffset(elem); // 记下变为预设之后的偏移量\n  const originalStyle: React.CSSProperties = {};\n  for (const key in offset) {\n    if (Object.prototype.hasOwnProperty.call(offset, key)) {\n      const dir = getOffsetDirection(key as keyof IOffset, option); // 根据 useRight ，当传入left,useRight为true时，返回right\n      const preset = key === 'left' ? presetH : presetV;\n      // 计算出由于 刚刚设置为预设{ 999, 999 }，导致元素实际移动的 距离\n      const off = originalOffset[key as keyof IFullRegion] - old[key as keyof IFullRegion];\n\n      // 比如元素最初实际的样式值为 { left: 20, top: 20 }\n      // 但是 可能相对`文档`的 {left: 0, top: 0}, 因为一个元素最终相对文档的left，top还会受到父元素的影响\n      // 后来样式设置为预设值 { left: -999, top: -999 }\n      // 此时再计算出相对文档的 {left,top} 值，可以知道元素实际移动的距离\n      // 通过预设值与实际移动的距离进行计算，得出最初元素的样式值\n      // 大概类似 让你走到 999米的地方，但是你说你只走了990米，说明你一开始就在9米的位置处。进行反推\n      if (dir === key) {\n        originalStyle[dir] = preset + off;\n      } else {\n        originalStyle[dir] = preset - off;\n      }\n    }\n  }\n  // 复原回原来的样式值，取消掉原来预设的值\n  utils.css(elem, originalStyle);\n\n  // force relayout\n  forceRelayout(elem);\n  if ('left' in offset || 'top' in offset) {\n    // 还原 transition的值\n    setTransitionProperty(elem, originalTransition);\n  }\n\n\n  // 现在已知 元素相对文档的 {left,top}\n  // 还知道 元素最终需要的 相对文档的 {left,top}值\n  const ret: React.CSSProperties = {};\n  for (const key in offset) {\n    if (Object.prototype.hasOwnProperty.call(offset, key)) {\n      const dir = getOffsetDirection(key as keyof IOffset, option);\n      const off = offset[key as keyof IOffset]!! - originalOffset[key as keyof IFullRegion];\n      if (key === dir) {\n        ret[dir] = parseFloat(originalStyle[dir] as string) + off;\n      } else {\n        ret[dir] = parseFloat(originalStyle[dir] as string) - off;\n      }\n    }\n  }\n  utils.css(elem, ret);\n}\n\nfunction setTransform(elem: HTMLElement, offset: IOffset) {\n  const originalOffset = getOffset(elem);\n  const originalXY = getTransformXY(elem);\n  const resultXY = { x: originalXY.x, y: originalXY.y };\n  if (offset.left !== undefined) {\n    resultXY.x = originalXY.x + offset.left - originalOffset.left;\n  }\n  if (offset.top !== undefined) {\n    resultXY.y = originalXY.y + offset.top - originalOffset.top;\n  }\n  setTransformXY(elem, resultXY);\n}\n\nfunction setOffset(elem: HTMLElement, offset: IOffset, option: IOption): void {\n  if (option.ignoreShake) {\n    const oriOffset = getOffset(elem);\n\n    const oLeft = oriOffset.left.toFixed(0);\n    const oTop = oriOffset.top.toFixed(0);\n    const tLeft = offset.left?.toFixed(0);\n    const tTop = offset.top?.toFixed(0);\n\n    // 如果目标左上和当前左上一致，则直接返回\n    if (oLeft === tLeft && oTop === tTop) {\n      return;\n    }\n  }\n\n  if (option.useCssRight || option.useCssBottom) {\n    setLeftTop(elem, offset, option);\n  } else if (\n    option.useCssTransform &&\n    getTransformName() in document.body.style\n  ) {\n    setTransform(elem, offset);\n  } else {\n    setLeftTop(elem, offset, option);\n  }\n}\n\nexport {\n  getScrollTop,\n  getScrollLeft,\n  getOffset,\n  setOffset,\n};"],"mappings":"AAEA,SAASA,KAAK;AACd,SACEC,qBAAqB,EACrBC,qBAAqB,EACrBC,cAAc,EACdC,cAAc,EACdC,gBAAgB;;AAGlB;AACA;;AAMA;AACA,SAASC,aAAa,CAACC,IAAiB,EAAQ;EAC9C,IAAMC,aAAa,GAAGD,IAAI,CAACE,KAAK,CAACC,OAAO;EACxCH,IAAI,CAACE,KAAK,CAACC,OAAO,GAAG,MAAM;EAC3BH,IAAI,CAACI,YAAY,CAAC,CAAC;EACnBJ,IAAI,CAACE,KAAK,CAACC,OAAO,GAAGF,aAAa;AACpC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASI,iBAAiB,CAACL,IAAiB,EAAW;EACrD,IAAMM,GAAG,GAAGN,IAAI,CAACO,aAAa;EAC9B,IAAMC,IAAI,GAAGF,GAAG,CAACE,IAAI;EACrB,IAAMC,OAAO,GAAGH,GAAG,IAAIA,GAAG,CAACI,eAAe;EAC1C;EACA,IAAMC,GAAG,GAAGX,IAAI,CAACY,qBAAqB,EAAE;;EAExC;EACA;EACA;;EAEA,IAAIC,CAAC,GAAGC,IAAI,CAACC,KAAK,CAACJ,GAAG,CAACK,IAAI,CAAC;EAC5B,IAAIC,CAAC,GAAGH,IAAI,CAACC,KAAK,CAACJ,GAAG,CAACO,GAAG,CAAC;;EAE3B;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEAL,CAAC,IAAIJ,OAAO,CAACU,UAAU,IAAIX,IAAI,CAACW,UAAU,IAAI,CAAC,CAAC,CAAC;EACjDF,CAAC,IAAIR,OAAO,CAACW,SAAS,IAAIZ,IAAI,CAACY,SAAS,IAAI,CAAC,CAAC,CAAC;;EAE/C,OAAO;IACLJ,IAAI,EAAEH,CAAC;IACPK,GAAG,EAAED;EACP,CAAC;AACH;AAEA,SAASI,SAAS,CAACC,CAAS,EAAEJ,GAAa,EAAU;EACnD,IAAIK,GAAW,GAAGD,CAAC,WAAQJ,GAAG,GAAG,GAAG,GAAG,GAAG,aAAS;EACnD,IAAMM,MAAc,eAAYN,GAAG,GAAG,KAAK,GAAG,MAAM,CAAE;EACtD,IAAI,OAAOK,GAAG,KAAK,QAAQ,EAAE;IAC3B,IAAME,CAAC,GAAGH,CAAC,CAACI,QAAQ;IACpB;IACAH,GAAG,GAAGE,CAAC,CAACf,eAAe,CAACc,MAAM,CAAgC;IAC9D,IAAI,OAAOD,GAAG,KAAK,QAAQ,EAAE;MAC3B;MACAA,GAAG,GAAGE,CAAC,CAACjB,IAAI,CAACgB,MAAM,CAAgC;IACrD;EACF;EACA,OAAOD,GAAG;AACZ;AAEA,SAASI,aAAa,CAACL,CAAS,EAAU;EACxC,OAAOD,SAAS,CAACC,CAAC,CAAC;AACrB;AAEA,SAASM,YAAY,CAACN,CAAS,EAAU;EACvC,OAAOD,SAAS,CAACC,CAAC,EAAE,IAAI,CAAC;AAC3B;AAEA,SAASO,SAAS,CAACC,EAAe,EAAe;EAC/C,IAAMC,GAAG,GAAG1B,iBAAiB,CAACyB,EAAE,CAAC;EACjC,IAAMxB,GAAG,GAAGwB,EAAE,CAACvB,aAA4B;EAC3C,IAAMe,CAAC,GAAIhB,GAAG,CAAC0B,WAAW,IAAI1B,GAAG,CAAC2B,YAAuB;EACzDF,GAAG,CAACf,IAAI,IAAIW,aAAa,CAACL,CAAC,CAAC;EAC5BS,GAAG,CAACb,GAAG,IAAIU,YAAY,CAACN,CAAC,CAAC;EAC1B,OAAOS,GAAG;AACZ;AAGA,SAASG,kBAAkB,CAACC,GAAS,EAAEC,MAAe,EAAQ;EAC5D,IAAID,GAAG,KAAK,MAAM,EAAE;IAClB,OAAOC,MAAM,CAACC,WAAW,GAAG,OAAO,GAAGF,GAAG;EAC3C;EACA,OAAOC,MAAM,CAACE,YAAY,GAAG,QAAQ,GAAGH,GAAG;AAC7C;AAEA,SAASI,uBAAuB,CAACJ,GAAS,EAAQ;EAChD,IAAIA,GAAG,KAAK,MAAM,EAAE;IAClB,OAAO,OAAO;EAChB,CAAC,MAAM,IAAIA,GAAG,KAAK,OAAO,EAAE;IAC1B,OAAO,MAAM;EACf,CAAC,MAAM,IAAIA,GAAG,KAAK,KAAK,EAAE;IACxB,OAAO,QAAQ;EACjB;EACA,OAAO,KAAK;AACd;;AAEA;AACA,SAASK,UAAU,CAACxC,IAAiB,EAAEyC,MAAe,EAAEL,MAAe,EAAE;EACvE;EACA,IAAI3C,KAAK,CAACiD,GAAG,CAAC1C,IAAI,EAAE,UAAU,CAAC,KAAK,QAAQ,EAAE;IAC5CA,IAAI,CAACE,KAAK,CAACyC,QAAQ,GAAG,UAAU;EAClC;EACA,IAAIC,OAAO,GAAG,CAAC,GAAG;EAClB,IAAIC,OAAO,GAAG,CAAC,GAAG;EAClB,IAAMC,kBAAkB,GAAGZ,kBAAkB,CAAC,MAAM,EAAEE,MAAM,CAAC;EAC7D,IAAMW,gBAAgB,GAAGb,kBAAkB,CAAC,KAAK,EAAEE,MAAM,CAAC;EAC1D,IAAMY,0BAA0B,GAAGT,uBAAuB,CACxDO,kBAAkB,CACnB;EACD,IAAMG,wBAAwB,GAAGV,uBAAuB,CAACQ,gBAAgB,CAAC;EAE1E,IAAID,kBAAkB,KAAK,MAAM,EAAE;IACjCF,OAAO,GAAG,GAAG;EACf;EAEA,IAAIG,gBAAgB,KAAK,KAAK,EAAE;IAC9BF,OAAO,GAAG,GAAG;EACf;EACA,IAAIK,kBAAkB,GAAG,EAAE;EAC3B;EACA,IAAMC,cAAc,GAAGtB,SAAS,CAAC7B,IAAI,CAAC;EAEtC,IAAI,MAAM,IAAIyC,MAAM,IAAI,KAAK,IAAIA,MAAM,EAAE;IACvCS,kBAAkB,GAAGvD,qBAAqB,CAACK,IAAI,CAAC,IAAI,EAAE;IACtDN,qBAAqB,CAACM,IAAI,EAAE,MAAM,CAAC;IACnC;IACA;EACF;;EACA,IAAI,MAAM,IAAIyC,MAAM,EAAE;IACpBzC,IAAI,CAACE,KAAK,CAAC8C,0BAA0B,CAAC,GAAG,EAAE;IAC3ChD,IAAI,CAACE,KAAK,CAAC4C,kBAAkB,CAAC,GAAMF,OAAO,OAAI;EACjD;EACA,IAAI,KAAK,IAAIH,MAAM,EAAE;IACnBzC,IAAI,CAACE,KAAK,CAAC+C,wBAAwB,CAAC,GAAG,EAAE;IACzCjD,IAAI,CAACE,KAAK,CAAC6C,gBAAgB,CAAC,GAAMF,OAAO,OAAI;EAC/C;;EAGA;EACA9C,aAAa,CAACC,IAAI,CAAC;EACnB,IAAMoD,GAAG,GAAGvB,SAAS,CAAC7B,IAAI,CAAC,CAAC,CAAC;EAC7B,IAAMC,aAAkC,GAAG,CAAC,CAAC;EAC7C,KAAK,IAAMoD,GAAG,IAAIZ,MAAM,EAAE;IACxB,IAAIa,MAAM,CAACC,SAAS,CAACC,cAAc,CAACC,IAAI,CAAChB,MAAM,EAAEY,GAAG,CAAC,EAAE;MACrD,IAAMlB,GAAG,GAAGD,kBAAkB,CAACmB,GAAG,EAAmBjB,MAAM,CAAC,CAAC,CAAC;MAC9D,IAAMsB,MAAM,GAAGL,GAAG,KAAK,MAAM,GAAGT,OAAO,GAAGC,OAAO;MACjD;MACA,IAAMc,GAAG,GAAGR,cAAc,CAACE,GAAG,CAAsB,GAAGD,GAAG,CAACC,GAAG,CAAsB;;MAEpF;MACA;MACA;MACA;MACA;MACA;MACA,IAAIlB,GAAG,KAAKkB,GAAG,EAAE;QACfpD,aAAa,CAACkC,GAAG,CAAC,GAAGuB,MAAM,GAAGC,GAAG;MACnC,CAAC,MAAM;QACL1D,aAAa,CAACkC,GAAG,CAAC,GAAGuB,MAAM,GAAGC,GAAG;MACnC;IACF;EACF;EACA;EACAlE,KAAK,CAACiD,GAAG,CAAC1C,IAAI,EAAEC,aAAa,CAAC;;EAE9B;EACAF,aAAa,CAACC,IAAI,CAAC;EACnB,IAAI,MAAM,IAAIyC,MAAM,IAAI,KAAK,IAAIA,MAAM,EAAE;IACvC;IACA/C,qBAAqB,CAACM,IAAI,EAAEkD,kBAAkB,CAAC;EACjD;;EAGA;EACA;EACA,IAAM3B,GAAwB,GAAG,CAAC,CAAC;EACnC,KAAK,IAAM8B,IAAG,IAAIZ,MAAM,EAAE;IACxB,IAAIa,MAAM,CAACC,SAAS,CAACC,cAAc,CAACC,IAAI,CAAChB,MAAM,EAAEY,IAAG,CAAC,EAAE;MACrD,IAAMlB,IAAG,GAAGD,kBAAkB,CAACmB,IAAG,EAAmBjB,MAAM,CAAC;MAC5D,IAAMuB,IAAG,GAAGlB,MAAM,CAACY,IAAG,CAAkB,GAAKF,cAAc,CAACE,IAAG,CAAsB;MACrF,IAAIA,IAAG,KAAKlB,IAAG,EAAE;QACfZ,GAAG,CAACY,IAAG,CAAC,GAAGyB,UAAU,CAAC3D,aAAa,CAACkC,IAAG,CAAC,CAAW,GAAGwB,IAAG;MAC3D,CAAC,MAAM;QACLpC,GAAG,CAACY,IAAG,CAAC,GAAGyB,UAAU,CAAC3D,aAAa,CAACkC,IAAG,CAAC,CAAW,GAAGwB,IAAG;MAC3D;IACF;EACF;EACAlE,KAAK,CAACiD,GAAG,CAAC1C,IAAI,EAAEuB,GAAG,CAAC;AACtB;AAEA,SAASsC,YAAY,CAAC7D,IAAiB,EAAEyC,MAAe,EAAE;EACxD,IAAMU,cAAc,GAAGtB,SAAS,CAAC7B,IAAI,CAAC;EACtC,IAAM8D,UAAU,GAAGlE,cAAc,CAACI,IAAI,CAAC;EACvC,IAAM+D,QAAQ,GAAG;IAAElD,CAAC,EAAEiD,UAAU,CAACjD,CAAC;IAAEI,CAAC,EAAE6C,UAAU,CAAC7C;EAAE,CAAC;EACrD,IAAIwB,MAAM,CAACzB,IAAI,KAAKgD,SAAS,EAAE;IAC7BD,QAAQ,CAAClD,CAAC,GAAGiD,UAAU,CAACjD,CAAC,GAAG4B,MAAM,CAACzB,IAAI,GAAGmC,cAAc,CAACnC,IAAI;EAC/D;EACA,IAAIyB,MAAM,CAACvB,GAAG,KAAK8C,SAAS,EAAE;IAC5BD,QAAQ,CAAC9C,CAAC,GAAG6C,UAAU,CAAC7C,CAAC,GAAGwB,MAAM,CAACvB,GAAG,GAAGiC,cAAc,CAACjC,GAAG;EAC7D;EACArB,cAAc,CAACG,IAAI,EAAE+D,QAAQ,CAAC;AAChC;AAEA,SAASE,SAAS,CAACjE,IAAiB,EAAEyC,MAAe,EAAEL,MAAe,EAAQ;EAC5E,IAAIA,MAAM,CAAC8B,WAAW,EAAE;IAAA;IACtB,IAAMC,SAAS,GAAGtC,SAAS,CAAC7B,IAAI,CAAC;IAEjC,IAAMoE,KAAK,GAAGD,SAAS,CAACnD,IAAI,CAACqD,OAAO,CAAC,CAAC,CAAC;IACvC,IAAMC,IAAI,GAAGH,SAAS,CAACjD,GAAG,CAACmD,OAAO,CAAC,CAAC,CAAC;IACrC,IAAME,KAAK,mBAAG9B,MAAM,CAACzB,IAAI,qBAAX,aAAaqD,OAAO,CAAC,CAAC,CAAC;IACrC,IAAMG,IAAI,kBAAG/B,MAAM,CAACvB,GAAG,qBAAV,YAAYmD,OAAO,CAAC,CAAC,CAAC;;IAEnC;IACA,IAAID,KAAK,KAAKG,KAAK,IAAID,IAAI,KAAKE,IAAI,EAAE;MACpC;IACF;EACF;EAEA,IAAIpC,MAAM,CAACC,WAAW,IAAID,MAAM,CAACE,YAAY,EAAE;IAC7CE,UAAU,CAACxC,IAAI,EAAEyC,MAAM,EAAEL,MAAM,CAAC;EAClC,CAAC,MAAM,IACLA,MAAM,CAACqC,eAAe,IACtB3E,gBAAgB,EAAE,IAAI4B,QAAQ,CAAClB,IAAI,CAACN,KAAK,EACzC;IACA2D,YAAY,CAAC7D,IAAI,EAAEyC,MAAM,CAAC;EAC5B,CAAC,MAAM;IACLD,UAAU,CAACxC,IAAI,EAAEyC,MAAM,EAAEL,MAAM,CAAC;EAClC;AACF;AAEA,SACER,YAAY,EACZD,aAAa,EACbE,SAAS,EACToC,SAAS"}