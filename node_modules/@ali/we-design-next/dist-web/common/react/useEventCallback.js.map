{"version":3,"file":"useEventCallback.js","names":["useLayoutEffect","useMemo","useRef","useEventCallback","fn","fnRef","current"],"sources":["../../../../src/common/react/useEventCallback.ts"],"sourcesContent":["/**\n * 生成固定的 event callback 函数，替代 useCallback，避免因 state/props 变化而频繁更新事件，提高性能\n * 源自 UseEvent 提案中提到的「足够接近(close enough)的实现」\n * \n * 提案：https://github.com/reactjs/rfcs/pull/220\n * 实现：https://github.com/Volune/use-event-callback/blob/master/src/index.ts\n */\n\nimport { useLayoutEffect, useMemo, useRef } from 'react';\n\ntype Fn<T extends any[], R> = (...args: T) => R;\n\nexport const useEventCallback =\n  <T extends any[], R>(fn: Fn<T, R>): Fn<T, R> => {\n\n    const fnRef = useRef<Fn<T, R>>(fn);\n    useLayoutEffect(() => { fnRef.current = fn; });\n\n    return useMemo(() =>\n      (...args: T): R => {\n        const { current } = fnRef;\n        return current(...args);\n      },\n      []\n    );\n  };\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASA,eAAe,EAAEC,OAAO,EAAEC,MAAM,QAAQ,OAAO;AAIxD,OAAO,IAAMC,gBAAgB,GAC3B,SADWA,gBAAgB,CACNC,EAAY,EAAe;EAE9C,IAAMC,KAAK,GAAGH,MAAM,CAAWE,EAAE,CAAC;EAClCJ,eAAe,CAAC,YAAM;IAAEK,KAAK,CAACC,OAAO,GAAGF,EAAE;EAAE,CAAC,CAAC;EAE9C,OAAOH,OAAO,CAAC;IAAA,OACb,YAAmB;MACjB,IAAQK,OAAO,GAAKD,KAAK,CAAjBC,OAAO;MACf,OAAOA,OAAO,yBAAS;IACzB,CAAC;EAAA,GACD,EAAE,CACH;AACH,CAAC"}