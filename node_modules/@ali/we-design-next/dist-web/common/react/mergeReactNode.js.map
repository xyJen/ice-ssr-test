{"version":3,"file":"mergeReactNode.js","names":["cloneElement","isValidElement","mergeRef","mergeReactNode","target","source","depth","curDepth","undefined","type","toCloneProps","sourceRef","ref","targetRef","mergedRef","sourceKey","key","targetKey","toClonedKey","p","sourceProp","props","targetProp","sourceStyle","targetStyle","children","mergedChildren"],"sources":["../../../../src/common/react/mergeReactNode.ts"],"sourcesContent":["import React, { ReactNode, ReactElement, cloneElement, isValidElement } from 'react';\nimport { mergeRef } from './mergeRef';\n\nexport const mergeReactNode = (\n  target: ReactNode,\n  source: ReactNode,\n  depth: number = 0,\n  curDepth: number = depth,\n): ReactNode => {\n\n  if (target === null) {\n    return target;\n  }\n  if (target === undefined) {\n    return source;\n  }\n  if (!isValidElement(target)) {\n    return target;\n  }\n  if (!isValidElement(source)) {\n    return target;\n  }\n\n  if (target.type === source.type) {\n\n    const toCloneProps: any = {};\n\n    const sourceRef = (source as any).ref;\n    const targetRef = (target as any).ref;\n    const mergedRef = (sourceRef && targetRef) ? mergeRef(sourceRef, targetRef) : (sourceRef || targetRef);\n    if (mergedRef) {\n      toCloneProps.ref = mergedRef;\n    }\n\n    const sourceKey = (source as any).key;\n    const targetKey = (target as any).key;\n    const toClonedKey = targetKey || sourceKey;\n    if (toClonedKey) {\n      toCloneProps.key = toClonedKey;\n    }\n\n    for (const p in source.props) {\n      const sourceProp = source.props[p];\n      const targetProp = target.props[p];\n\n      if (p === 'style') {\n        const sourceStyle = sourceProp || {};\n        const targetStyle = targetProp || {};\n        toCloneProps[p] = { ...sourceStyle, ...targetStyle };\n      } else if (targetProp === undefined) {\n        toCloneProps[p] = sourceProp;\n      } else if (isValidElement(sourceProp) && isValidElement(targetProp)) {\n        toCloneProps[p] = mergeReactNode(targetProp, sourceProp, depth);\n      } else if (typeof sourceProp === 'function' && typeof targetProp === 'function') {\n        toCloneProps[p] = (...args: any) => {\n          sourceProp(...args);\n          targetProp(...args);\n        }\n      }\n    }\n    return cloneElement(\n      target,\n      toCloneProps,\n    );\n  }\n\n  if (curDepth > 0 && isValidElement(target.props.children)) {\n    const mergedChildren = mergeReactNode(target.props.children, source, depth, curDepth - 1);\n    return cloneElement(target, {}, mergedChildren);\n  }\n\n  return target;\n}"],"mappings":";AAAA,SAAyCA,YAAY,EAAEC,cAAc,QAAQ,OAAO;AACpF,SAASC,QAAQ;AAEjB,OAAO,IAAMC,cAAc,GAAG,SAAjBA,cAAc,CACzBC,MAAiB,EACjBC,MAAiB,EACjBC,KAAa,EACbC,QAAgB,EACF;EAAA,IAFdD,KAAa;IAAbA,KAAa,GAAG,CAAC;EAAA;EAAA,IACjBC,QAAgB;IAAhBA,QAAgB,GAAGD,KAAK;EAAA;EAGxB,IAAIF,MAAM,KAAK,IAAI,EAAE;IACnB,OAAOA,MAAM;EACf;EACA,IAAIA,MAAM,KAAKI,SAAS,EAAE;IACxB,OAAOH,MAAM;EACf;EACA,IAAI,eAACJ,cAAc,CAACG,MAAM,CAAC,EAAE;IAC3B,OAAOA,MAAM;EACf;EACA,IAAI,eAACH,cAAc,CAACI,MAAM,CAAC,EAAE;IAC3B,OAAOD,MAAM;EACf;EAEA,IAAIA,MAAM,CAACK,IAAI,KAAKJ,MAAM,CAACI,IAAI,EAAE;IAE/B,IAAMC,YAAiB,GAAG,CAAC,CAAC;IAE5B,IAAMC,SAAS,GAAIN,MAAM,CAASO,GAAG;IACrC,IAAMC,SAAS,GAAIT,MAAM,CAASQ,GAAG;IACrC,IAAME,SAAS,GAAIH,SAAS,IAAIE,SAAS,GAAIX,QAAQ,CAACS,SAAS,EAAEE,SAAS,CAAC,GAAIF,SAAS,IAAIE,SAAU;IACtG,IAAIC,SAAS,EAAE;MACbJ,YAAY,CAACE,GAAG,GAAGE,SAAS;IAC9B;IAEA,IAAMC,SAAS,GAAIV,MAAM,CAASW,GAAG;IACrC,IAAMC,SAAS,GAAIb,MAAM,CAASY,GAAG;IACrC,IAAME,WAAW,GAAGD,SAAS,IAAIF,SAAS;IAC1C,IAAIG,WAAW,EAAE;MACfR,YAAY,CAACM,GAAG,GAAGE,WAAW;IAChC;IAAC,2BAEUC,CAAC;MACV,IAAMC,UAAU,GAAGf,MAAM,CAACgB,KAAK,CAACF,CAAC,CAAC;MAClC,IAAMG,UAAU,GAAGlB,MAAM,CAACiB,KAAK,CAACF,CAAC,CAAC;MAElC,IAAIA,CAAC,KAAK,OAAO,EAAE;QACjB,IAAMI,WAAW,GAAGH,UAAU,IAAI,CAAC,CAAC;QACpC,IAAMI,WAAW,GAAGF,UAAU,IAAI,CAAC,CAAC;QACpCZ,YAAY,CAACS,CAAC,CAAC,gBAAQI,WAAW,EAAKC,WAAW,CAAE;MACtD,CAAC,MAAM,IAAIF,UAAU,KAAKd,SAAS,EAAE;QACnCE,YAAY,CAACS,CAAC,CAAC,GAAGC,UAAU;MAC9B,CAAC,MAAM,IAAI,cAAAnB,cAAc,CAACmB,UAAU,CAAC,iBAAInB,cAAc,CAACqB,UAAU,CAAC,EAAE;QACnEZ,YAAY,CAACS,CAAC,CAAC,GAAGhB,cAAc,CAACmB,UAAU,EAAEF,UAAU,EAAEd,KAAK,CAAC;MACjE,CAAC,MAAM,IAAI,OAAOc,UAAU,KAAK,UAAU,IAAI,OAAOE,UAAU,KAAK,UAAU,EAAE;QAC/EZ,YAAY,CAACS,CAAC,CAAC,GAAG,YAAkB;UAClCC,UAAU,yBAAS;UACnBE,UAAU,yBAAS;QACrB,CAAC;MACH;IAAC;IAjBH,KAAK,IAAMH,CAAC,IAAId,MAAM,CAACgB,KAAK,EAAE;MAAA,MAAnBF,CAAC;IAkBZ;IACA,oBAAOnB,YAAY,CACjBI,MAAM,EACNM,YAAY,CACb;EACH;EAEA,IAAIH,QAAQ,GAAG,CAAC,iBAAIN,cAAc,CAACG,MAAM,CAACiB,KAAK,CAACI,QAAQ,CAAC,EAAE;IACzD,IAAMC,cAAc,GAAGvB,cAAc,CAACC,MAAM,CAACiB,KAAK,CAACI,QAAQ,EAAEpB,MAAM,EAAEC,KAAK,EAAEC,QAAQ,GAAG,CAAC,CAAC;IACzF,oBAAOP,YAAY,CAACI,MAAM,EAAE,CAAC,CAAC,EAAEsB,cAAc,CAAC;EACjD;EAEA,OAAOtB,MAAM;AACf,CAAC"}