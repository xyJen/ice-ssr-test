/**
 * 自定义 React Hook useDefaultProps(defaultValue, value, onChange)
 * 用于处理表单类组件中 defaultValue，value 和 onChange 的「三件套」属性
 * 
 * 关于类型推断：
 *  1. 如果 defaultProp 和 prop 都可能是 undefined，那么 value 就可能是 undefined
 *  2. 如果 defaultProp 和 prop 至少有一个一定不是 undefined，那么 value 就一定不是 undefined
 * 
 * 可参考 useDefaultProp-dev.stories.tsx
 */
import { useState } from 'react';
import { useEventCallback } from "./useEventCallback";
var noop = function noop() {};
var identity = function identity(e) {
  return e;
};
export var useDefaultProp = function useDefaultProp(defaultProp, prop, onChangeProp, eventToValue) {
  if (onChangeProp === void 0) {
    onChangeProp = noop;
  }
  if (eventToValue === void 0) {
    eventToValue = identity;
  }
  var _useState = useState(defaultProp),
    state = _useState[0],
    setState = _useState[1];
  var changeProp = useEventCallback(function (e, o) {
    var args = [e === undefined ? null : e];
    if (prop !== args[0]) {
      if (o !== undefined) {
        args.push(o);
      }
      onChangeProp.apply(void 0, args);
    }
  });
  var changeState = useEventCallback(function (e, o) {
    if (state !== e) {
      setState(e === undefined ? undefined : eventToValue(e));
      changeProp(e, o);
    }
  });
  if (prop !== undefined) {
    return [prop === null ? undefined : prop, changeProp];
  } else {
    return [state, changeState];
  }
};
//# sourceMappingURL=useDefaultProp.js.map