{"version":3,"file":"cover.js","names":["Cover","React","forwardRef","props","ref","src","thumbSrc","position","onMouseDown","noop","renderError","renderSrc","setRenderSrc","useState","isLoadError","setIsLoadError","useEffect","loadImage","then","catch","shouldShowError"],"sources":["../../../../../src/office/title-cover/components/cover.tsx"],"sourcesContent":["import { noop } from 'lodash-es';\nimport React, { useState, useEffect } from 'react';\nimport { PositionedImage } from './positionedImage';\nimport loadImage from '../utils';\n\ninterface Props {\n  src: string;\n  thumbSrc?: string;\n  position: number;\n  onMouseDown?: (e: React.MouseEvent) => void;\n  renderError?: () => React.ReactNode;\n}\n\nexport const Cover = React.forwardRef<HTMLImageElement, Props>((props: Props, ref) => {\n  const { src, thumbSrc, position, onMouseDown = noop, renderError } = props;\n  const [renderSrc, setRenderSrc] = useState(thumbSrc);\n  const [isLoadError, setIsLoadError] = useState(false);\n\n  useEffect(() => {\n    if (renderSrc === src) {\n      return;\n    }\n\n    loadImage(src)\n      .then(() => {\n        setRenderSrc(src);\n        setIsLoadError(false);\n      })\n      .catch(() => {\n        setIsLoadError(true);\n      });\n  }, [src, renderSrc]);\n\n  useEffect(() => {\n    setRenderSrc(thumbSrc || src);\n  }, [src, thumbSrc]);\n\n  const shouldShowError = isLoadError && renderError;\n\n  return shouldShowError ? (\n    <>{renderError()}</>\n  ) : (\n    <PositionedImage\n      ref={ref}\n      src={renderSrc}\n      onMouseDown={onMouseDown}\n      position={position}\n    />\n  );\n});\n"],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AAAiC;AAAA;AAAA,uBAFL;AAYrB,MAAMA,KAAK,gBAAGC,cAAK,CAACC,UAAU,CAA0B,CAACC,KAAY,EAAEC,GAAG,KAAK;EACpF,MAAM;IAAEC,GAAG;IAAEC,QAAQ;IAAEC,QAAQ;IAAEC,WAAW,GAAGC,YAAI;IAAEC;EAAY,CAAC,GAAGP,KAAK;EAC1E,MAAM,CAACQ,SAAS,EAAEC,YAAY,CAAC,GAAG,IAAAC,eAAQ,EAACP,QAAQ,CAAC;EACpD,MAAM,CAACQ,WAAW,EAAEC,cAAc,CAAC,GAAG,IAAAF,eAAQ,EAAC,KAAK,CAAC;EAErD,IAAAG,gBAAS,EAAC,MAAM;IACd,IAAIL,SAAS,KAAKN,GAAG,EAAE;MACrB;IACF;IAEA,IAAAY,cAAS,EAACZ,GAAG,CAAC,CACXa,IAAI,CAAC,MAAM;MACVN,YAAY,CAACP,GAAG,CAAC;MACjBU,cAAc,CAAC,KAAK,CAAC;IACvB,CAAC,CAAC,CACDI,KAAK,CAAC,MAAM;MACXJ,cAAc,CAAC,IAAI,CAAC;IACtB,CAAC,CAAC;EACN,CAAC,EAAE,CAACV,GAAG,EAAEM,SAAS,CAAC,CAAC;EAEpB,IAAAK,gBAAS,EAAC,MAAM;IACdJ,YAAY,CAACN,QAAQ,IAAID,GAAG,CAAC;EAC/B,CAAC,EAAE,CAACA,GAAG,EAAEC,QAAQ,CAAC,CAAC;EAEnB,MAAMc,eAAe,GAAGN,WAAW,IAAIJ,WAAW;EAElD,OAAOU,eAAe,gBACpB,8CAAGV,WAAW,EAAE,CAAI,gBAEpB,eAAC,gCAAe;IACd,GAAG,EAAEN,GAAI;IACT,GAAG,EAAEO,SAAU;IACf,WAAW,EAAEH,WAAY;IACzB,QAAQ,EAAED;EAAS,EAEtB;AACH,CAAC,CAAC;AAAC"}