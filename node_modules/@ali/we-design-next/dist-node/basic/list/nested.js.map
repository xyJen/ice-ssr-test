{"version":3,"file":"nested.js","names":["loopNested","nested","pushItem","pushRest","fromString","restIdx","i","length","it","key","Array","isArray","items","prevItem","title","flattenNested","res","t","push","isNormalized","isCustomized","isEnabled","disabled"],"sources":["../../../../src/basic/list/nested.ts"],"sourcesContent":["import React, { ReactNode } from 'react';\n\nexport type IListItemNormalized = {\n  key: string;\n  title: ReactNode;\n  prefix?: ReactNode;\n  suffix?: ReactNode;\n  disabled?: boolean;\n  selected?: boolean;\n};\n\nexport type IListItemCustomized = {\n  key: string;\n  content: ReactNode;\n};\n\nexport type IListItem = IListItemNormalized | IListItemCustomized;\n\nexport type INestedItem<Item extends IListItem> = string\n  | Item\n  | { title: string; items: Array<string | Item>; }\n  | 'divider';\n\nexport type INestedItems<Item extends IListItem> = Array<INestedItem<Item>>;\n\nexport const loopNested = <T extends IListItem>(\n  nested: INestedItems<T>,\n  pushItem: (v: T) => void,\n  pushRest: (v: ['divider', number] | ['group', string, number]) => void,\n  fromString: (v: string) => T,\n): void => {\n\n  let restIdx = 0;\n\n  for (let i = 0; i < nested.length; i++) {\n    const it = nested[i];\n    if (it === 'divider') {\n      if (i !== 0 && i !== nested.length - 1) {\n        pushRest(['divider', restIdx++]);\n      }\n    } else if (typeof it === 'string') {\n      pushItem(fromString(it));\n    } else if ('key' in it && typeof it.key === 'string') {\n      pushItem(it);\n    } else if ('title' in it && 'items' in it && Array.isArray(it.items)) {\n      if (i !== 0) {\n        const prevItem = nested[i - 1];\n        if (typeof prevItem !== 'string' && 'title' in prevItem && 'items' in prevItem && Array.isArray(prevItem.items)) {\n          // do nothing\n        } else {\n          pushRest(['divider', restIdx++]);\n        }\n      }\n      pushRest(['group', it.title, restIdx++]);\n      loopNested(it.items, pushItem, pushRest, fromString);\n      if (i !== nested.length - 1) {\n        // 最后一个分隔线不推\n        pushRest(['divider', restIdx++]);\n      }\n    }\n  }\n};\n\ntype FlattenNested = {\n\n  <T extends IListItem>(\n    nested: INestedItems<T>,\n    fromString: (s: string) => T\n  ): Array<T>;\n\n  <T extends IListItem>(\n    nested: INestedItems<T>,\n  ): IListItem extends T ? Array<T> : never;\n};\n\nexport const flattenNested: FlattenNested = <T extends IListItem>(\n  nested: INestedItems<T>,\n  fromString?: (s: string) => T\n): Array<T> => {\n  const res: Array<T> = [];\n  loopNested(\n    nested,\n    t => res.push(t),\n    () => 0,\n    fromString || ((key: string) => ({ key, title: key }) as any),\n  );\n  return res;\n};\n\nexport const isNormalized = (t: IListItem): t is IListItemNormalized => 'title' in t && !!t.title;\nexport const isCustomized = (t: IListItem): t is IListItemCustomized => !isNormalized(t);\nexport const isEnabled = (t: IListItem): t is IListItem => !isNormalized(t) || !t.disabled;\n\n"],"mappings":";;;;;;AAyBO,MAAMA,UAAU,GAAG,CACxBC,MAAuB,EACvBC,QAAwB,EACxBC,QAAsE,EACtEC,UAA4B,KACnB;EAET,IAAIC,OAAO,GAAG,CAAC;EAEf,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGL,MAAM,CAACM,MAAM,EAAED,CAAC,EAAE,EAAE;IACtC,MAAME,EAAE,GAAGP,MAAM,CAACK,CAAC,CAAC;IACpB,IAAIE,EAAE,KAAK,SAAS,EAAE;MACpB,IAAIF,CAAC,KAAK,CAAC,IAAIA,CAAC,KAAKL,MAAM,CAACM,MAAM,GAAG,CAAC,EAAE;QACtCJ,QAAQ,CAAC,CAAC,SAAS,EAAEE,OAAO,EAAE,CAAC,CAAC;MAClC;IACF,CAAC,MAAM,IAAI,OAAOG,EAAE,KAAK,QAAQ,EAAE;MACjCN,QAAQ,CAACE,UAAU,CAACI,EAAE,CAAC,CAAC;IAC1B,CAAC,MAAM,IAAI,KAAK,IAAIA,EAAE,IAAI,OAAOA,EAAE,CAACC,GAAG,KAAK,QAAQ,EAAE;MACpDP,QAAQ,CAACM,EAAE,CAAC;IACd,CAAC,MAAM,IAAI,OAAO,IAAIA,EAAE,IAAI,OAAO,IAAIA,EAAE,IAAIE,KAAK,CAACC,OAAO,CAACH,EAAE,CAACI,KAAK,CAAC,EAAE;MACpE,IAAIN,CAAC,KAAK,CAAC,EAAE;QACX,MAAMO,QAAQ,GAAGZ,MAAM,CAACK,CAAC,GAAG,CAAC,CAAC;QAC9B,IAAI,OAAOO,QAAQ,KAAK,QAAQ,IAAI,OAAO,IAAIA,QAAQ,IAAI,OAAO,IAAIA,QAAQ,IAAIH,KAAK,CAACC,OAAO,CAACE,QAAQ,CAACD,KAAK,CAAC,EAAE;UAC/G;QAAA,CACD,MAAM;UACLT,QAAQ,CAAC,CAAC,SAAS,EAAEE,OAAO,EAAE,CAAC,CAAC;QAClC;MACF;MACAF,QAAQ,CAAC,CAAC,OAAO,EAAEK,EAAE,CAACM,KAAK,EAAET,OAAO,EAAE,CAAC,CAAC;MACxCL,UAAU,CAACQ,EAAE,CAACI,KAAK,EAAEV,QAAQ,EAAEC,QAAQ,EAAEC,UAAU,CAAC;MACpD,IAAIE,CAAC,KAAKL,MAAM,CAACM,MAAM,GAAG,CAAC,EAAE;QAC3B;QACAJ,QAAQ,CAAC,CAAC,SAAS,EAAEE,OAAO,EAAE,CAAC,CAAC;MAClC;IACF;EACF;AACF,CAAC;AAAC;AAcK,MAAMU,aAA4B,GAAG,CAC1Cd,MAAuB,EACvBG,UAA6B,KAChB;EACb,MAAMY,GAAa,GAAG,EAAE;EACxBhB,UAAU,CACRC,MAAM,EACNgB,CAAC,IAAID,GAAG,CAACE,IAAI,CAACD,CAAC,CAAC,EAChB,MAAM,CAAC,EACPb,UAAU,KAAMK,GAAW,KAAM;IAAEA,GAAG;IAAEK,KAAK,EAAEL;EAAI,CAAC,CAAQ,CAAC,CAC9D;EACD,OAAOO,GAAG;AACZ,CAAC;AAAC;AAEK,MAAMG,YAAY,GAAIF,CAAY,IAA+B,OAAO,IAAIA,CAAC,IAAI,CAAC,CAACA,CAAC,CAACH,KAAK;AAAC;AAC3F,MAAMM,YAAY,GAAIH,CAAY,IAA+B,CAACE,YAAY,CAACF,CAAC,CAAC;AAAC;AAClF,MAAMI,SAAS,GAAIJ,CAAY,IAAqB,CAACE,YAAY,CAACF,CAAC,CAAC,IAAI,CAACA,CAAC,CAACK,QAAQ;AAAC"}