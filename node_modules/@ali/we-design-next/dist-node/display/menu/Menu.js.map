{"version":3,"file":"Menu.js","names":["hasSubMenu","it","subMenu","hasAsyncSubMenu","hasSyncSubMenu","Array","isArray","Menu","memo","forwardRef","props","ref","path","_path","onPathChange","onSelect","noop","items","renderItem","keyboard","rest","flattenItems","useMemo","flattenNested","setPath","useDefaultProp","smiState","smiDispatch","useReducer","state","action","key","wrapRef","useRef","focusTargetId","focusTarget","focusOwner","useFocusTarget","onActiveChange","k","op","find","from","undefined","length","onKeydownLeaf","e","kbKey","toLowerCase","isArrowRight","keyCode","KEY_CODES","RIGHT","isEnter","ENTER","curItem","subMenuItems","subFlattenItems","filter","isNormalized","isEnabled","rightKey","stopPropagation","onKeydownSecondaryLeaf","isArrowLeft","onKeydown","Boolean","subMenuRef","renderListItem","sourceNode","item","itemHasSubMenu","targetItemChildren","description","title","disabled","children","toCloned","suffix","targetItemWithChildren","cloneElement","targetNode","renderReactNode","isExpaned","subItems","v","current","document","body","slice","p","isValidElement","onMouseLeave","t","clientX","x","clientY","y","subMenuRect","getBoundingClientRect","right","left","bottom","top","useEffect","then","mergeRestProps","mergeRef","displayName","MenuItem","List","Item"],"sources":["../../../../src/display/menu/Menu.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useReducer, useRef, memo, forwardRef, cloneElement, isValidElement } from 'react';\nimport { IconArrowRight, IconLoading } from '../../basic/icon';\nimport { List } from '../../basic/list';\nimport { IListItemNormalized, IListItemCustomized, flattenNested, INestedItems, isNormalized, isEnabled } from '../../basic/list/nested';\nimport { MenuItemDescription, MenuItemTitleDescription } from './styled';\nimport { Popover } from '../popover';\nimport { useDefaultProp, IRestProps, mergeRestProps, useFocusTarget, mergeRef, renderReactNode, IRenderReactNode, KEY_CODES } from '../../common';\nimport { noop } from 'lodash-es';\n\nexport type IMenuItemNormalized = IListItemNormalized & {\n  description?: string;\n  subMenu?: INestedItems<IMenuItem> | (() => Promise<INestedItems<IMenuItem>>);\n};\n\nexport type IMenuItemCustomized = IListItemCustomized;\n\nexport type IMenuItem = IMenuItemNormalized | IMenuItemCustomized;\n\nconst hasSubMenu = (it: IMenuItem): it is (IMenuItemNormalized & { subMenu: Required<IMenuItemNormalized>['subMenu'] }) => {\n  return 'subMenu' in it && !!it.subMenu;\n};\n\nconst hasAsyncSubMenu = (it: IMenuItem): it is (IMenuItemNormalized & { subMenu: () => Promise<INestedItems<IMenuItem>> }) => {\n  return hasSubMenu(it) && typeof it.subMenu === 'function';\n};\n\nconst hasSyncSubMenu = (it: IMenuItem): it is (IMenuItemNormalized & { subMenu: INestedItems<IMenuItem> }) => {\n  return hasSubMenu(it) && Array.isArray(it.subMenu);\n};\n\nexport type IMenuProps = {\n  /**\n   * 菜单项配置\n   */\n  items?: INestedItems<IMenuItem>;\n  /**\n   * 当前激活的路径，每一项为 item 的 key；最后一项可能为 undefined，表示下级菜单被展开，但未激活其中的任意项\n   */\n  path?: Array<string | undefined>;\n  /**\n   * 当前激活路径变化\n   */\n  onPathChange?: (path: Array<string | undefined>) => void;\n  /**\n   * 某个菜单项被选中\n   */\n  onSelect?: (path: Array<string>) => void;\n  /**\n   * 是否响应键盘事件\n   */\n  keyboard?: boolean;\n  /**\n   * 自定义菜单项渲染\n   */\n  renderItem?: IRenderReactNode<{ key: string }>;\n} & IRestProps & Omit<React.DOMAttributes<HTMLDivElement>, 'onSelect'>;\n\nexport const Menu = memo(\n  forwardRef<HTMLDivElement, IMenuProps>(\n    (props, ref) => {\n\n      const {\n        path: _path,\n        onPathChange,\n        onSelect = noop as Required<IMenuProps>['onSelect'],\n        items = [],\n        renderItem,\n        keyboard = true,\n        ...rest\n      } = props;\n\n      const flattenItems = useMemo(() => flattenNested(items), [items]);\n\n      const [path, setPath] = useDefaultProp<Array<string | undefined>>([], _path, onPathChange);\n\n      // 存储异步菜单项数据\n      const [smiState, smiDispatch] = useReducer(\n        (\n          state: Record<string, INestedItems<IMenuItem> | undefined>,\n          action: [string, INestedItems<IMenuItem>]\n        ) => {\n          const [key, items] = action;\n          return {\n            ...state,\n            [key]: items\n          };\n        },\n        {}\n      );\n\n      const wrapRef = useRef<HTMLDivElement>(null);\n      const [focusTargetId, focusTarget, focusOwner] = useFocusTarget(wrapRef);\n\n      // 根据列表中的当前激活项变化，设置 path\n      // 注意：当通过鼠标悬浮到具有子菜单的菜单项时，自动展开子菜单\n      const onActiveChange: React.ComponentProps<typeof List>['onActiveChange'] = (k, op) => {\n        const it = flattenItems.find(it => it.key === k);\n        if (it) {\n          if (hasSubMenu(it)) {\n            if (op.from === 'mouse') {\n              setPath([it.key, undefined]);\n            } else {\n              setPath([it.key]);\n            }\n          } else {\n            setPath([it.key]);\n          }\n        } else {\n          if (path.length === 1) {\n            setPath([undefined]);\n          }\n        }\n      };\n\n      // 键盘方向键控制子菜单的打开关闭\n      // 如果当前菜单叶子级：\n      //    按下 Right 键：如果当前项有子菜单，则打开\n      //    按下 Enter 键：如果当前项有子菜单，则打开\n      // 如果当前菜单次叶子级（即从叶子级开始向上追溯的第二级）：\n      //    按下 Left 键：收起当前子菜单\n      const onKeydownLeaf = (e: React.KeyboardEvent) => {\n        const kbKey = e.key.toLowerCase();\n        const isArrowRight = kbKey === 'arrowright' || e.keyCode === KEY_CODES.RIGHT;\n        const isEnter = kbKey === 'enter' || e.keyCode === KEY_CODES.ENTER;\n\n        const curItem = flattenItems.find(it => it.key === path[0])!;\n        if (isArrowRight || isEnter) {\n\n          if (hasSubMenu(curItem)) {\n\n            const subMenuItems = curItem.subMenu === undefined ? undefined :\n              typeof curItem.subMenu === 'function' ? smiState[curItem.key] :\n                curItem.subMenu;\n\n            if (subMenuItems) {\n\n              const subFlattenItems = flattenNested(subMenuItems).filter(isNormalized).filter(isEnabled);\n\n              if (subFlattenItems.length > 0) {\n                const rightKey = subFlattenItems[0].key;\n                focusTarget(\n                  () => {\n                    setPath([path[0], rightKey]);\n                  }\n                );\n                e.stopPropagation();\n                return;\n              }\n            } else {\n              focusTarget(\n                () => {\n                  setPath([path[0], undefined]);\n                }\n              );\n              e.stopPropagation();\n              return;\n            }\n          }\n        }\n      };\n      const onKeydownSecondaryLeaf = (e: React.KeyboardEvent) => {\n        const isArrowLeft = e.key.toLowerCase() === 'arrowleft' || e.keyCode === 37;\n        if (isArrowLeft) {\n          focusOwner(\n            () => {\n              setPath([path[0]]);\n            }\n          );\n          e.stopPropagation();\n        }\n      };\n      const onKeydown = keyboard ? (\n        path.filter(Boolean).length === 1 /** isLeaf */ ?\n          onKeydownLeaf :\n          path.filter(Boolean).length === 2 /** isSecondaryLeaf */ ?\n            onKeydownSecondaryLeaf :\n            undefined\n      ) : undefined;\n\n      const subMenuRef = useRef<HTMLDivElement>(null);\n\n      // 自定义列表项渲染\n      const renderListItem: React.ComponentProps<typeof List>['renderItem'] =\n        ({ key }) =>\n          /* 以下 arrow function 不是一个 React 组件 */\n          /* eslint-disable react/display-name */\n          (sourceNode) => {\n\n            const item = flattenItems.find(it => it.key === key);\n\n            if (item && isNormalized(item)) {\n\n              const itemHasSubMenu = hasSubMenu(item);\n\n              const targetItemChildren = item.description ? <>\n                <MenuItemTitleDescription>{item.title}</MenuItemTitleDescription>\n                <MenuItemDescription disabled={!!item.disabled}>{item.description}</MenuItemDescription>\n              </> : sourceNode.props.children;\n\n              const toCloned = {\n                children: targetItemChildren,\n                suffix: itemHasSubMenu ? <IconArrowRight size={16} /> : item.suffix,\n              };\n              if (toCloned.suffix === undefined) {\n                delete toCloned.suffix;\n              }\n\n              const targetItemWithChildren: React.ReactNode = cloneElement(sourceNode, toCloned);\n\n              const targetNode = renderReactNode(renderItem, targetItemWithChildren, { key });\n\n              if (itemHasSubMenu) {\n\n                const isExpaned = path[0] === item.key && path.length > 1;\n\n                if (isExpaned) {\n\n                  const subItems = hasSyncSubMenu(item) ? item.subMenu : smiState[item.key];\n\n                  // 对于正在加载的子菜单，subItems 为 undefined\n\n                  if (subItems) {\n\n                    return <Popover\n                      animation={true}\n                      visible={true}\n                      onVisibleChange={v => {\n                        if (v === false) {\n                          setPath([path[0]]);\n                        }\n                      }}\n                      placement='rightTop'\n                      placementOffset={[-2, -5]}\n                      getContainer={() => wrapRef.current || document.body}\n                      content={\n                        <Menu\n                          ref={subMenuRef}\n                          path={path.slice(1)}\n                          onPathChange={p => {\n                            setPath([item.key, ...p]);\n                          }}\n                          items={subItems}\n                          onSelect={(path) => onSelect([item.key, ...path])}\n                          renderItem={renderItem}\n                          {...rest}\n                          id={focusTargetId}\n                        />\n                      }\n                    >\n                      {\n                        isValidElement(targetNode) ? cloneElement(\n                          targetNode as React.ReactElement,\n                          {\n                            onMouseLeave: (e: React.MouseEvent) => {\n                              const t = 10;\n                              const { clientX: x, clientY: y } = e;\n                              const subMenu = subMenuRef.current;\n                              if (subMenu) {\n                                const subMenuRect = subMenu.getBoundingClientRect();\n                                if (\n                                  x < subMenuRect.right + t &&\n                                  x > subMenuRect.left - t &&\n                                  y < subMenuRect.bottom + t &&\n                                  y > subMenuRect.top - t\n                                ) {\n                                  return;\n                                }\n                              }\n                              setPath([undefined]);\n                            }\n                          }\n                        ) : targetNode\n                      }\n                    </Popover>\n                  } else {\n                    return targetNode;\n                  }\n                } else {\n                  return targetNode;\n                }\n              } else {\n                return targetNode;\n              }\n            } else {\n              return null;\n            }\n          };\n          /* eslint-enable react/display-name */\n\n      // 根据菜单 path 变化，尝试发起异步子菜单数据获取\n      const key = path[0];\n      useEffect(() => {\n        if (typeof key === 'string') {\n          const item = flattenItems.find(it => it.key === key);\n          if (item && hasAsyncSubMenu(item) && smiState[key] === undefined) {\n            item.subMenu().then(e => {\n              smiDispatch([key, e]);\n            });\n          }\n        }\n      }, [flattenItems, key, smiState]);\n\n      return <List\n        items={items}\n        active={path[0] || null}\n        onActiveChange={onActiveChange}\n        onSelect={k => onSelect([k])}\n        onKeyDown={onKeydown}\n        renderItem={renderListItem}\n        keyboard={keyboard}\n        {...mergeRestProps(rest, 'wdn-menu')}\n        ref={mergeRef(ref, wrapRef)}\n      />;\n    }\n  )\n);\n\nMenu.displayName = 'Menu';\n\nexport const MenuItem = List.Item;\n"],"mappings":"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"}