{"version":3,"file":"getComputedStyle.js","names":["getComputedStyleX","_getComputedStyle","elem","name","cs","computedStyle","val","d","utils","getDocument","defaultView","getComputedStyle","getPropertyValue","RE_NUM","source","_RE_NUM_NO_PX","RegExp","RE_POS","CURRENT_STYLE","RUNTIME_STYLE","LEFT","PX","_getComputedStyleIE","ret","test","style","left","rsLeft","pixelLeft","window"],"sources":["../../../../../src/common/domAlign/utils/getComputedStyle.tsx"],"sourcesContent":["import React from 'react';\nimport type { ICssPropertyName } from '../interface';\nimport { utils } from './utils';\n\nlet getComputedStyleX: Function;\n\n\nfunction _getComputedStyle(elem: HTMLElement, name: keyof React.CSSProperties, cs: React.CSSProperties): string {\n  let computedStyle: CSSStyleDeclaration | React.CSSProperties = cs;\n  let val = '';\n  const d = utils.getDocument(elem);\n  computedStyle = computedStyle || d.defaultView?.getComputedStyle(elem, null);\n\n  // https://github.com/kissyteam/kissy/issues/61\n  if (computedStyle) {\n    val = ((computedStyle as CSSStyleDeclaration).getPropertyValue(name) || computedStyle[name]) as string;\n  }\n\n  return val;\n}\n\n// eslint-disable-next-line\nconst RE_NUM: string = /[\\-+]?(?:\\d*\\.|)\\d+(?:[eE][\\-+]?\\d+|)/.source;\nconst _RE_NUM_NO_PX = new RegExp(`^(${RE_NUM})(?!px)[a-z%]+$`, 'i');\nconst RE_POS = /^(top|right|bottom|left)$/;\nconst CURRENT_STYLE: string = 'currentStyle';\nconst RUNTIME_STYLE = 'runtimeStyle';\nconst LEFT = 'left';\nconst PX = 'px';\n\nfunction _getComputedStyleIE(elem: HTMLElement, name: ICssPropertyName): string {\n  // currentStyle maybe null\n  // http://msdn.microsoft.com/en-us/library/ms535231.aspx\n  let ret: string = (elem[CURRENT_STYLE as keyof HTMLElement] && (elem[CURRENT_STYLE as keyof HTMLElement] as React.CSSProperties)[name]) as string;\n\n  // 当 width/height 设置为百分比时，通过 pixelLeft 方式转换的 width/height 值\n  // 一开始就处理了! CUSTOM_STYLE.height,CUSTOM_STYLE.width ,cssHook 解决@2011-08-19\n  // 在 ie 下不对，需要直接用 offset 方式\n  // borderWidth 等值也有问题，但考虑到 borderWidth 设为百分比的概率很小，这里就不考虑了\n\n  // From the awesome hack by Dean Edwards\n  // http://erik.eae.net/archives/2007/07/27/18.54.15/#comment-102291\n  // If we're not dealing with a regular pixel number\n  // but a number that has a weird ending, we need to convert it to pixels\n  // exclude left right for relativity\n  if (_RE_NUM_NO_PX.test(ret) && !RE_POS.test(name)) {\n    // Remember the original values\n    const style = elem.style as (React.CSSProperties & { pixelLeft?: number });\n    const left = style[LEFT];\n    const rsLeft = (elem[RUNTIME_STYLE as keyof HTMLElement]as React.CSSProperties)[LEFT];\n\n    // prevent flashing of content\n    (elem[RUNTIME_STYLE as keyof HTMLElement] as React.CSSProperties)[LEFT] = (elem[CURRENT_STYLE as keyof HTMLElement] as React.CSSProperties)[LEFT];\n\n    // Put in the new values to get a computed value out\n    style[LEFT] = name === 'fontSize' ? '1em' : ret || 0;\n    ret = style.pixelLeft + PX;\n\n    // Revert the changed values\n    style[LEFT] = left;\n\n    (elem[RUNTIME_STYLE as keyof HTMLElement] as React.CSSProperties)[LEFT] = rsLeft;\n  }\n  return ret === '' ? 'auto' : ret;\n}\n\nif (typeof window !== 'undefined') {\n  getComputedStyleX = typeof window.getComputedStyle === 'function'\n    ? _getComputedStyle\n    : _getComputedStyleIE;\n}\n\nexport { getComputedStyleX };\n"],"mappings":";;;;;;AAEA;AAEA,IAAIA,iBAA2B;AAAC;AAGhC,SAASC,iBAAiB,CAACC,IAAiB,EAAEC,IAA+B,EAAEC,EAAuB,EAAU;EAAA;EAC9G,IAAIC,aAAwD,GAAGD,EAAE;EACjE,IAAIE,GAAG,GAAG,EAAE;EACZ,MAAMC,CAAC,GAAGC,YAAK,CAACC,WAAW,CAACP,IAAI,CAAC;EACjCG,aAAa,GAAGA,aAAa,uBAAIE,CAAC,CAACG,WAAW,mDAAb,eAAeC,gBAAgB,CAACT,IAAI,EAAE,IAAI,CAAC;;EAE5E;EACA,IAAIG,aAAa,EAAE;IACjBC,GAAG,GAAKD,aAAa,CAAyBO,gBAAgB,CAACT,IAAI,CAAC,IAAIE,aAAa,CAACF,IAAI,CAAY;EACxG;EAEA,OAAOG,GAAG;AACZ;;AAEA;AACA,MAAMO,MAAc,GAAG,uCAAuC,CAACC,MAAM;AACrE,MAAMC,aAAa,GAAG,IAAIC,MAAM,CAAE,KAAIH,MAAO,iBAAgB,EAAE,GAAG,CAAC;AACnE,MAAMI,MAAM,GAAG,2BAA2B;AAC1C,MAAMC,aAAqB,GAAG,cAAc;AAC5C,MAAMC,aAAa,GAAG,cAAc;AACpC,MAAMC,IAAI,GAAG,MAAM;AACnB,MAAMC,EAAE,GAAG,IAAI;AAEf,SAASC,mBAAmB,CAACpB,IAAiB,EAAEC,IAAsB,EAAU;EAC9E;EACA;EACA,IAAIoB,GAAW,GAAIrB,IAAI,CAACgB,aAAa,CAAsB,IAAKhB,IAAI,CAACgB,aAAa,CAAsB,CAAyBf,IAAI,CAAY;;EAEjJ;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA,IAAIY,aAAa,CAACS,IAAI,CAACD,GAAG,CAAC,IAAI,CAACN,MAAM,CAACO,IAAI,CAACrB,IAAI,CAAC,EAAE;IACjD;IACA,MAAMsB,KAAK,GAAGvB,IAAI,CAACuB,KAAuD;IAC1E,MAAMC,IAAI,GAAGD,KAAK,CAACL,IAAI,CAAC;IACxB,MAAMO,MAAM,GAAIzB,IAAI,CAACiB,aAAa,CAAsB,CAAwBC,IAAI,CAAC;;IAErF;IACClB,IAAI,CAACiB,aAAa,CAAsB,CAAyBC,IAAI,CAAC,GAAIlB,IAAI,CAACgB,aAAa,CAAsB,CAAyBE,IAAI,CAAC;;IAEjJ;IACAK,KAAK,CAACL,IAAI,CAAC,GAAGjB,IAAI,KAAK,UAAU,GAAG,KAAK,GAAGoB,GAAG,IAAI,CAAC;IACpDA,GAAG,GAAGE,KAAK,CAACG,SAAS,GAAGP,EAAE;;IAE1B;IACAI,KAAK,CAACL,IAAI,CAAC,GAAGM,IAAI;IAEjBxB,IAAI,CAACiB,aAAa,CAAsB,CAAyBC,IAAI,CAAC,GAAGO,MAAM;EAClF;EACA,OAAOJ,GAAG,KAAK,EAAE,GAAG,MAAM,GAAGA,GAAG;AAClC;AAEA,IAAI,OAAOM,MAAM,KAAK,WAAW,EAAE;EACjC,4BAAA7B,iBAAiB,GAAG,OAAO6B,MAAM,CAAClB,gBAAgB,KAAK,UAAU,GAC7DV,iBAAiB,GACjBqB,mBAAmB;AACzB"}