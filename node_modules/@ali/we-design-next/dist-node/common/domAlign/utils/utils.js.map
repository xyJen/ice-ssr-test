{"version":3,"file":"utils.js","names":["utils","getWindow","node","document","setTimeout","doc","ownerDocument","defaultView","parentWindow","getDocument","isWindow","isDocument","obj","undefined","window","ele","nodeType","getWindowScrollLeft","w","getScrollLeft","getWindowScrollTop","getScrollTop","offset","el","option","setOffset","getOffset","css","name","v","value","i","Object","prototype","hasOwnProperty","call","style","getComputedStyleX","clone","ret","assign","overflow","keys","forEach","mix","to","from","each","arr","fn","length","merge","args"],"sources":["../../../../../src/common/domAlign/utils/utils.tsx"],"sourcesContent":["import React from 'react';\nimport { getComputedStyleX } from './getComputedStyle';\nimport { IRegion, IOption, IOffset, ICssPropertyName } from '../interface';\nimport { getOffset, setOffset, getScrollLeft, getScrollTop } from './position-utils';\n\n// typescript 1.5版本从document上移除了parentWindow属性;\n// https://stackoverflow.com/questions/38973426/using-documentmode-with-typescript\nexport interface OurDocument extends Document {\n  parentWindow?: Window;\n}\n\ntype UtilType = {\n  getWindow: (node: any) => Window;\n  getDocument: (node: HTMLElement) => OurDocument;\n  isWindow: (obj: any) => obj is Window;\n  isDocument: (ele: any) => ele is OurDocument;\n\n  getWindowScrollLeft: (w: Window) => number;\n  getWindowScrollTop: (w: Window) => number;\n\n  // 传offset，则设置元素相对文档的左上距离；否则获取元素相对文档的左上距离\n  offset: (el: HTMLElement, offset?: IOffset, option?: IOption) => IRegion | undefined;\n  css: (el: HTMLElement, name: ICssPropertyName | React.CSSProperties, v?: number | string) => any;\n\n  clone: (obj: object) => object;\n  mix: (to: Object, from: Object) => Object;\n  each: (arr: any[], fn: Function) => void;\n  merge: (...args: any[]) => any;\n};\n\nconst utils: UtilType = {\n  getWindow: (node: any): Window => {\n    if (node && node.document && node.setTimeout) {\n      return node;\n    }\n    const doc = node.ownerDocument || node;\n    return doc.defaultView || doc.parentWindow;\n  },\n  getDocument: (node: HTMLElement): OurDocument => {\n    if (utils.isWindow(node)) {\n      return node.document;\n    }\n    if (utils.isDocument(node)) {\n      return node;\n    }\n    return node.ownerDocument;\n  },\n  /**\n   * A crude way of determining if an object is a window\n   * @member util\n   */\n  isWindow: (obj: any): obj is Window => {\n    // must use == for ie8\n    /* eslint eqeqeq:0 */\n    return obj !== null && obj !== undefined && obj == obj.window;\n  },\n  isDocument: (ele: any): ele is OurDocument => {\n    return ele.nodeType === 9;\n  },\n  getWindowScrollLeft: (w: Window) => {\n    return getScrollLeft(w);\n  },\n  getWindowScrollTop: (w: Window) => {\n    return getScrollTop(w);\n  },\n  offset: (el: HTMLElement, offset?: IOffset, option?: IOption): IRegion | undefined => {\n    if (typeof offset !== 'undefined') {\n      setOffset(el, offset, option || {});\n    } else {\n      return getOffset(el);\n    }\n  },\n  css: (el: HTMLElement, name: ICssPropertyName | React.CSSProperties, v?: number | string): any => {\n    let value: number | string | undefined = v;\n    if (typeof name === 'object') {\n      for (const i in name) {\n        if (Object.prototype.hasOwnProperty.call(name, i)) {\n          utils.css(el, i as ICssPropertyName, name[i as ICssPropertyName]);\n        }\n      }\n      return undefined;\n    }\n    if (typeof value !== 'undefined') {\n      if (typeof value === 'number') {\n        value = `${value}px`;\n      }\n      el.style[name as any] = value;\n      return undefined;\n    }\n    return getComputedStyleX(el, name);\n  },\n  clone: (obj: React.CSSProperties): React.CSSProperties => {\n    let ret: React.CSSProperties = {};\n    // 老的写法\n    // for (const i in obj) {\n    //   if (obj.hasOwnProperty(i)) {\n    //     ret[i] = obj[i as keyof Object];\n    //   }\n    // }\n    Object.assign(ret, obj);\n    const overflow = obj.overflow;\n    if (overflow) {\n      // 老的写法\n      // for (const i in obj) {\n      //   if (obj.hasOwnProperty(i)) {\n      //     (ret.overflow!!)[i] = overflow[i];\n      //   }\n      // }\n      Object.keys(obj).forEach((i) => {\n        (ret.overflow!! as any)[i] = (overflow as any)[i];\n      });\n    }\n    return ret;\n  },\n  mix: (to: Object, from: Object) => {\n    // 老的写法\n    // for (const i in from) {\n    //   if (from.hasOwnProperty(i)) {\n    //     to[i] = from[i as keyof Object];\n    //   }\n    // }\n    Object.assign(to, from);\n    return to;\n  },\n  each: (arr: any[], fn: Function) => {\n    for (let i = 0; i < arr.length; i++) {\n      fn(arr[i]);\n    }\n  },\n  merge: (...args: any[]): any => {\n    const ret = {};\n    for (let i = 0; i < args.length; i++) {\n      utils.mix(ret, args[i]);\n    }\n    return ret;\n  },\n};\n\n\nexport { utils };"],"mappings":"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"}