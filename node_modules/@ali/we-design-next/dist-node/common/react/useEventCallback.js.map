{"version":3,"file":"useEventCallback.js","names":["useEventCallback","fn","fnRef","useRef","useLayoutEffect","current","useMemo","args"],"sources":["../../../../src/common/react/useEventCallback.ts"],"sourcesContent":["/**\n * 生成固定的 event callback 函数，替代 useCallback，避免因 state/props 变化而频繁更新事件，提高性能\n * 源自 UseEvent 提案中提到的「足够接近(close enough)的实现」\n * \n * 提案：https://github.com/reactjs/rfcs/pull/220\n * 实现：https://github.com/Volune/use-event-callback/blob/master/src/index.ts\n */\n\nimport { useLayoutEffect, useMemo, useRef } from 'react';\n\ntype Fn<T extends any[], R> = (...args: T) => R;\n\nexport const useEventCallback =\n  <T extends any[], R>(fn: Fn<T, R>): Fn<T, R> => {\n\n    const fnRef = useRef<Fn<T, R>>(fn);\n    useLayoutEffect(() => { fnRef.current = fn; });\n\n    return useMemo(() =>\n      (...args: T): R => {\n        const { current } = fnRef;\n        return current(...args);\n      },\n      []\n    );\n  };\n"],"mappings":";;;;;;AAQA;AARA;AACA;AACA;AACA;AACA;AACA;AACA;;AAMO,MAAMA,gBAAgB,GACNC,EAAY,IAAe;EAE9C,MAAMC,KAAK,GAAG,IAAAC,aAAM,EAAWF,EAAE,CAAC;EAClC,IAAAG,sBAAe,EAAC,MAAM;IAAEF,KAAK,CAACG,OAAO,GAAGJ,EAAE;EAAE,CAAC,CAAC;EAE9C,OAAO,IAAAK,cAAO,EAAC,MACb,CAAC,GAAGC,IAAO,KAAQ;IACjB,MAAM;MAAEF;IAAQ,CAAC,GAAGH,KAAK;IACzB,OAAOG,OAAO,CAAC,GAAGE,IAAI,CAAC;EACzB,CAAC,EACD,EAAE,CACH;AACH,CAAC;AAAC"}