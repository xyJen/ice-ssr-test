{"version":3,"file":"mergeReactNode.js","names":["mergeReactNode","target","source","depth","curDepth","undefined","isValidElement","type","toCloneProps","sourceRef","ref","targetRef","mergedRef","mergeRef","sourceKey","key","targetKey","toClonedKey","p","props","sourceProp","targetProp","sourceStyle","targetStyle","args","cloneElement","children","mergedChildren"],"sources":["../../../../src/common/react/mergeReactNode.ts"],"sourcesContent":["import React, { ReactNode, ReactElement, cloneElement, isValidElement } from 'react';\nimport { mergeRef } from './mergeRef';\n\nexport const mergeReactNode = (\n  target: ReactNode,\n  source: ReactNode,\n  depth: number = 0,\n  curDepth: number = depth,\n): ReactNode => {\n\n  if (target === null) {\n    return target;\n  }\n  if (target === undefined) {\n    return source;\n  }\n  if (!isValidElement(target)) {\n    return target;\n  }\n  if (!isValidElement(source)) {\n    return target;\n  }\n\n  if (target.type === source.type) {\n\n    const toCloneProps: any = {};\n\n    const sourceRef = (source as any).ref;\n    const targetRef = (target as any).ref;\n    const mergedRef = (sourceRef && targetRef) ? mergeRef(sourceRef, targetRef) : (sourceRef || targetRef);\n    if (mergedRef) {\n      toCloneProps.ref = mergedRef;\n    }\n\n    const sourceKey = (source as any).key;\n    const targetKey = (target as any).key;\n    const toClonedKey = targetKey || sourceKey;\n    if (toClonedKey) {\n      toCloneProps.key = toClonedKey;\n    }\n\n    for (const p in source.props) {\n      const sourceProp = source.props[p];\n      const targetProp = target.props[p];\n\n      if (p === 'style') {\n        const sourceStyle = sourceProp || {};\n        const targetStyle = targetProp || {};\n        toCloneProps[p] = { ...sourceStyle, ...targetStyle };\n      } else if (targetProp === undefined) {\n        toCloneProps[p] = sourceProp;\n      } else if (isValidElement(sourceProp) && isValidElement(targetProp)) {\n        toCloneProps[p] = mergeReactNode(targetProp, sourceProp, depth);\n      } else if (typeof sourceProp === 'function' && typeof targetProp === 'function') {\n        toCloneProps[p] = (...args: any) => {\n          sourceProp(...args);\n          targetProp(...args);\n        }\n      }\n    }\n    return cloneElement(\n      target,\n      toCloneProps,\n    );\n  }\n\n  if (curDepth > 0 && isValidElement(target.props.children)) {\n    const mergedChildren = mergeReactNode(target.props.children, source, depth, curDepth - 1);\n    return cloneElement(target, {}, mergedChildren);\n  }\n\n  return target;\n}"],"mappings":"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"}