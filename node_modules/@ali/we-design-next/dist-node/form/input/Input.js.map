{"version":3,"file":"Input.js","names":["blockEvent","e","stopPropagation","preventDefault","Input","memo","forwardRef","props","ref","value","_value","suffix","prefix","allowClear","disabled","size","bordered","onEnter","onKeyDown","defaultValue","onChange","error","children","style","className","id","testid","role","rest","setValue","useDefaultProp","target","handlerClear","useCallback","handleKeyDown","which","KEY_CODES","ENTER","mergeRestProps","React","cloneElement","cursor"],"sources":["../../../../src/form/input/Input.tsx"],"sourcesContent":["import React, { useCallback, memo, forwardRef } from 'react';\nimport { useDefaultProp } from '../../common/react/useDefaultProp';\nimport { IconCloseFill } from '../../basic/icon';\nimport { InputEle, InputWrap, InputErrorMessage } from './styled';\nimport { KEY_CODES } from '../../common/consts';\nimport { mergeRestProps, MergePropsType } from '../../common/';\n\nexport type IInputProps = MergePropsType<{\n  /**\n   * 输入框值\n   */\n  value?: string;\n  /**\n   * 输入框默认值\n   */\n  defaultValue?: string;\n  /**\n   * 输入框内容变化时的回调\n   */\n  onChange?: React.ChangeEventHandler<HTMLInputElement>;\n  /**\n   * 带有前缀图标的 input\n   */\n  prefix?: React.ReactElement;\n  /**\n   * 带有后缀图标的 input\n   */\n  suffix?: React.ReactElement;\n  /**\n   * 可以点击清除图标删除内容\n   */\n  allowClear?: boolean;\n  /**\n   * 回车\n   */\n  onEnter?: React.KeyboardEventHandler<HTMLInputElement>;\n  /**\n   * 是否有边框\n   */\n  bordered?: boolean;\n  /**\n   * 尺寸\n   */\n  size?: 'small' | 'normal';\n  /**\n   * 错误提示\n   */\n  error?: string;\n}, React.InputHTMLAttributes<HTMLInputElement>>;\n\nfunction blockEvent(e: React.MouseEvent) {\n  e.stopPropagation();\n  e.preventDefault();\n}\n\nexport const Input = memo(\n  forwardRef<HTMLInputElement, IInputProps>((props, ref) => {\n    const {\n      value: _value,\n      suffix,\n      prefix,\n      allowClear,\n      disabled,\n      size = 'normal',\n      bordered = true,\n      onEnter,\n      onKeyDown,\n      defaultValue = '',\n      onChange,\n      error,\n      children,\n      style,\n      className,\n      id,\n      ['data-testid']: testid,\n      ['data-role']: role,\n      ...rest\n    } = props;\n\n    const [value, setValue] = useDefaultProp<string, React.ChangeEvent<HTMLInputElement>>(defaultValue, _value, onChange, (e) => e.target.value);\n\n    const handlerClear = useCallback(() => {\n      setValue({\n        target: { value: '' },\n      } as React.FocusEvent<HTMLInputElement>);\n    }, [setValue]);\n\n    const handleKeyDown = useCallback(\n      (e: React.KeyboardEvent<HTMLInputElement>) => {\n        if (onKeyDown) {\n          onKeyDown(e);\n        }\n        if (e.which === KEY_CODES.ENTER && onEnter) {\n          onEnter(e);\n        }\n      },\n      [onKeyDown, onEnter],\n    );\n\n    return (\n      <>\n      <InputWrap\n        size={size}\n        bordered={bordered}\n        disabled={!!disabled}\n        error={!!error}\n        tabIndex={-1} /** 目的：使得在对前后缀图标点击时，在 mouse-down 的瞬间即进入 focus 状态（而不是 mouse-up 之后）*/\n        {...mergeRestProps({ className, style, id, ['data-testid']: testid, ['data-role']: role }, 'wdn-input')}\n      >\n        {prefix ? React.cloneElement(prefix, { style: { cursor: 'default' } }) : null}\n        <InputEle\n          ref={ref}\n          value={value}\n          onChange={setValue}\n          disabled={!!disabled}\n          onKeyDown={handleKeyDown}\n          {...rest}\n        />\n        {(allowClear && !!value) ? <IconCloseFill className=\"icon-close\" onClick={handlerClear} onMouseDown={blockEvent} /> : null}\n        {(!!suffix && !allowClear) ? React.cloneElement(suffix, { style: { cursor: 'default' } }) : null}\n      </InputWrap>\n      {error ? <InputErrorMessage>{error}</InputErrorMessage> : null}\n      </>\n    );\n  })\n);\n"],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAA+D;AAAA;AAAA,uBAJnC;AAiD5B,SAASA,UAAU,CAACC,CAAmB,EAAE;EACvCA,CAAC,CAACC,eAAe,EAAE;EACnBD,CAAC,CAACE,cAAc,EAAE;AACpB;AAEO,MAAMC,KAAK,gBAAG,IAAAC,WAAI,gBACvB,IAAAC,iBAAU,EAAgC,CAACC,KAAK,EAAEC,GAAG,KAAK;EACxD,MAAM;IACJC,KAAK,EAAEC,MAAM;IACbC,MAAM;IACNC,MAAM;IACNC,UAAU;IACVC,QAAQ;IACRC,IAAI,GAAG,QAAQ;IACfC,QAAQ,GAAG,IAAI;IACfC,OAAO;IACPC,SAAS;IACTC,YAAY,GAAG,EAAE;IACjBC,QAAQ;IACRC,KAAK;IACLC,QAAQ;IACRC,KAAK;IACLC,SAAS;IACTC,EAAE;IACF,CAAC,aAAa,GAAGC,MAAM;IACvB,CAAC,WAAW,GAAGC,IAAI;IACnB,GAAGC;EACL,CAAC,GAAGrB,KAAK;EAET,MAAM,CAACE,KAAK,EAAEoB,QAAQ,CAAC,GAAG,IAAAC,8BAAc,EAA8CX,YAAY,EAAET,MAAM,EAAEU,QAAQ,EAAGnB,CAAC,IAAKA,CAAC,CAAC8B,MAAM,CAACtB,KAAK,CAAC;EAE5I,MAAMuB,YAAY,GAAG,IAAAC,kBAAW,EAAC,MAAM;IACrCJ,QAAQ,CAAC;MACPE,MAAM,EAAE;QAAEtB,KAAK,EAAE;MAAG;IACtB,CAAC,CAAuC;EAC1C,CAAC,EAAE,CAACoB,QAAQ,CAAC,CAAC;EAEd,MAAMK,aAAa,GAAG,IAAAD,kBAAW,EAC9BhC,CAAwC,IAAK;IAC5C,IAAIiB,SAAS,EAAE;MACbA,SAAS,CAACjB,CAAC,CAAC;IACd;IACA,IAAIA,CAAC,CAACkC,KAAK,KAAKC,iBAAS,CAACC,KAAK,IAAIpB,OAAO,EAAE;MAC1CA,OAAO,CAAChB,CAAC,CAAC;IACZ;EACF,CAAC,EACD,CAACiB,SAAS,EAAED,OAAO,CAAC,CACrB;EAED,oBACE,2DACA,eAAC,iBAAS;IACR,IAAI,EAAEF,IAAK;IACX,QAAQ,EAAEC,QAAS;IACnB,QAAQ,EAAE,CAAC,CAACF,QAAS;IACrB,KAAK,EAAE,CAAC,CAACO,KAAM;IACf,QAAQ,EAAE,CAAC,CAAE,CAAC;EAAA,GACV,IAAAiB,sBAAc,EAAC;IAAEd,SAAS;IAAED,KAAK;IAAEE,EAAE;IAAE,CAAC,aAAa,GAAGC,MAAM;IAAE,CAAC,WAAW,GAAGC;EAAK,CAAC,EAAE,WAAW,CAAC,GAEtGf,MAAM,gBAAG2B,cAAK,CAACC,YAAY,CAAC5B,MAAM,EAAE;IAAEW,KAAK,EAAE;MAAEkB,MAAM,EAAE;IAAU;EAAE,CAAC,CAAC,GAAG,IAAI,eAC7E,eAAC,gBAAQ;IACP,GAAG,EAAEjC,GAAI;IACT,KAAK,EAAEC,KAAM;IACb,QAAQ,EAAEoB,QAAS;IACnB,QAAQ,EAAE,CAAC,CAACf,QAAS;IACrB,SAAS,EAAEoB;EAAc,GACrBN,IAAI,EACR,EACAf,UAAU,IAAI,CAAC,CAACJ,KAAK,gBAAI,eAAC,mBAAa;IAAC,SAAS,EAAC,YAAY;IAAC,OAAO,EAAEuB,YAAa;IAAC,WAAW,EAAEhC;EAAW,EAAG,GAAG,IAAI,EACxH,CAAC,CAACW,MAAM,IAAI,CAACE,UAAU,gBAAI0B,cAAK,CAACC,YAAY,CAAC7B,MAAM,EAAE;IAAEY,KAAK,EAAE;MAAEkB,MAAM,EAAE;IAAU;EAAE,CAAC,CAAC,GAAG,IAAI,CACtF,EACXpB,KAAK,gBAAG,eAAC,yBAAiB,QAAEA,KAAK,CAAqB,GAAG,IAAI,CAC3D;AAEP,CAAC,CAAC,CACH;AAAC"}