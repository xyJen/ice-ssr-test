{"version":3,"file":"TimeColumn.js","names":["generateUnits","start","end","step","units","i","push","label","leftPad","value","TimeColumn","React","memo","props","onSelect","title","showNow","ulRef","useRef","useLayoutEffect","current","targetValue","LI_HEIGHT","currentValue","scrollTop","animation","Animation","duration","progress","p","done","clear","useEffect","dom","stopPropagation","e","addEventListener","removeEventListener","map","unit","mergeClassName","undefined"],"sources":["../../../../../../src/form/date-picker/panels/TimePanel/TimeColumn.tsx"],"sourcesContent":["import React, { useRef, useLayoutEffect, useEffect } from \"react\";\nimport { mergeClassName } from \"../../../../common\";\nimport { UlWrapper, LiWrapper, NumberWrapper, TitleLiWrapper, TitleWrapper, LI_HEIGHT } from \"./styled\";\nimport { leftPad } from \"../../date-util\";\nimport Animation from './Animation';\n\ntype TimeUnit = {\n  value: number;\n  label: string;\n};\n\ninterface ITimeColumnProps {\n  value?: number; // 当前时间列的值\n  units: TimeUnit[];\n  onSelect?: (value: number) => void;\n  title?: string; // 列标题\n  showNow?: boolean;\n}\n\nexport const generateUnits = (\n  start: number,\n  end: number,\n  step: number = 1\n): TimeUnit[] => {\n  const units: TimeUnit[] = [];\n  for (let i = start; i <= end; i += step) {\n    units.push({\n      label: leftPad(i, 2),\n      value: i,\n    });\n  }\n  return units;\n};\n\nexport const TimeColumn: React.FC<ITimeColumnProps> = React.memo((props) => {\n  const { value = 0, units, onSelect, title, showNow } = props;\n\n  const ulRef = useRef<HTMLUListElement>(null);\n\n  useLayoutEffect(() => {\n    if (!ulRef.current) {\n      return;\n    }\n    const targetValue = LI_HEIGHT * value;\n    const currentValue = ulRef.current.scrollTop;\n  \n    const animation = new Animation({\n      duration: 240,\n      progress(p: number): void {\n        if (ulRef.current) {\n          ulRef.current.scrollTop = p * (targetValue - currentValue) + currentValue;\n        }\n      },\n      done(): void {\n        if (ulRef.current) {\n          ulRef.current.scrollTop = targetValue;\n        }\n      },\n    }).start();\n\n    return () => {\n      animation.clear();\n    };\n  }, [value]);\n\n  useEffect(() => {\n    const dom = ulRef && ulRef.current;\n    const stopPropagation = (e: Event) => e.stopPropagation();\n    dom?.addEventListener('mousewheel', stopPropagation);\n    return () => dom?.removeEventListener('mousewheel', stopPropagation);\n  }, []);\n\n  return (\n    <UlWrapper ref={ulRef} showNow={showNow}>\n      {title ? (\n        <TitleLiWrapper>\n          <TitleWrapper>{title}</TitleWrapper>\n        </TitleLiWrapper>\n      ) : null}\n      {units.map((unit) => (\n        <LiWrapper\n          key={unit.value}\n          onClick={() => onSelect?.(unit.value)}\n          className={mergeClassName(\n            value === unit.value ? \"selected\" : undefined\n          )}\n        >\n          <NumberWrapper>{unit.label}</NumberWrapper>\n        </LiWrapper>\n      ))}\n    </UlWrapper>\n  );\n});\n"],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AAAoC;AAAA;AAAA,uBAHR;AAkBrB,MAAMA,aAAa,GAAG,CAC3BC,KAAa,EACbC,GAAW,EACXC,IAAY,GAAG,CAAC,KACD;EACf,MAAMC,KAAiB,GAAG,EAAE;EAC5B,KAAK,IAAIC,CAAC,GAAGJ,KAAK,EAAEI,CAAC,IAAIH,GAAG,EAAEG,CAAC,IAAIF,IAAI,EAAE;IACvCC,KAAK,CAACE,IAAI,CAAC;MACTC,KAAK,EAAE,IAAAC,iBAAO,EAACH,CAAC,EAAE,CAAC,CAAC;MACpBI,KAAK,EAAEJ;IACT,CAAC,CAAC;EACJ;EACA,OAAOD,KAAK;AACd,CAAC;AAAC;AAEK,MAAMM,UAAsC,gBAAGC,cAAK,CAACC,IAAI,CAAEC,KAAK,IAAK;EAC1E,MAAM;IAAEJ,KAAK,GAAG,CAAC;IAAEL,KAAK;IAAEU,QAAQ;IAAEC,KAAK;IAAEC;EAAQ,CAAC,GAAGH,KAAK;EAE5D,MAAMI,KAAK,GAAG,IAAAC,aAAM,EAAmB,IAAI,CAAC;EAE5C,IAAAC,sBAAe,EAAC,MAAM;IACpB,IAAI,CAACF,KAAK,CAACG,OAAO,EAAE;MAClB;IACF;IACA,MAAMC,WAAW,GAAGC,iBAAS,GAAGb,KAAK;IACrC,MAAMc,YAAY,GAAGN,KAAK,CAACG,OAAO,CAACI,SAAS;IAE5C,MAAMC,SAAS,GAAG,IAAIC,kBAAS,CAAC;MAC9BC,QAAQ,EAAE,GAAG;MACbC,QAAQ,CAACC,CAAS,EAAQ;QACxB,IAAIZ,KAAK,CAACG,OAAO,EAAE;UACjBH,KAAK,CAACG,OAAO,CAACI,SAAS,GAAGK,CAAC,IAAIR,WAAW,GAAGE,YAAY,CAAC,GAAGA,YAAY;QAC3E;MACF,CAAC;MACDO,IAAI,GAAS;QACX,IAAIb,KAAK,CAACG,OAAO,EAAE;UACjBH,KAAK,CAACG,OAAO,CAACI,SAAS,GAAGH,WAAW;QACvC;MACF;IACF,CAAC,CAAC,CAACpB,KAAK,EAAE;IAEV,OAAO,MAAM;MACXwB,SAAS,CAACM,KAAK,EAAE;IACnB,CAAC;EACH,CAAC,EAAE,CAACtB,KAAK,CAAC,CAAC;EAEX,IAAAuB,gBAAS,EAAC,MAAM;IACd,MAAMC,GAAG,GAAGhB,KAAK,IAAIA,KAAK,CAACG,OAAO;IAClC,MAAMc,eAAe,GAAIC,CAAQ,IAAKA,CAAC,CAACD,eAAe,EAAE;IACzDD,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEG,gBAAgB,CAAC,YAAY,EAAEF,eAAe,CAAC;IACpD,OAAO,MAAMD,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEI,mBAAmB,CAAC,YAAY,EAAEH,eAAe,CAAC;EACtE,CAAC,EAAE,EAAE,CAAC;EAEN,oBACE,eAAC,iBAAS;IAAC,GAAG,EAAEjB,KAAM;IAAC,OAAO,EAAED;EAAQ,GACrCD,KAAK,gBACJ,eAAC,sBAAc,qBACb,eAAC,oBAAY,QAAEA,KAAK,CAAgB,CACrB,GACf,IAAI,EACPX,KAAK,CAACkC,GAAG,CAAEC,IAAI,iBACd,eAAC,iBAAS;IACR,GAAG,EAAEA,IAAI,CAAC9B,KAAM;IAChB,OAAO,EAAE,MAAMK,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAGyB,IAAI,CAAC9B,KAAK,CAAE;IACtC,SAAS,EAAE,IAAA+B,sBAAc,EACvB/B,KAAK,KAAK8B,IAAI,CAAC9B,KAAK,GAAG,UAAU,GAAGgC,SAAS;EAC7C,gBAEF,eAAC,qBAAa,QAAEF,IAAI,CAAChC,KAAK,CAAiB,CAE9C,CAAC,CACQ;AAEhB,CAAC,CAAC;AAAC"}