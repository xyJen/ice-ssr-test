{"version":3,"file":"ColorSquare.js","names":["getContrastingColor","color","COLORS","WHITE","toColorObj","colorStr","oldHue","tinyColor","tinycolor","hsl","toHsl","hsv","toHsv","rgb","toRgb","hex","toHex","s","h","transparent","a","source","colorObj","yiq","r","g","b","ColorSquare","React","memo","props","active","mode","rest","mergeRestProps","background","textAColor","useMemo","isWhite"],"sources":["../../../../src/form/color-picker/ColorSquare.tsx"],"sourcesContent":["\nimport React, { useMemo, DOMAttributes } from 'react';\nimport tinycolor from 'tinycolor2';\nimport { COLORS } from '../../common';\nimport { ColorSquareWrap, NullColorSquareWrap, ColorTextA } from './styled';\nimport { IRestProps, mergeRestProps } from '../../common/react/mergeRestProps';\nimport { isWhite } from './isWhite';\n\n/**\n * 获取对比色，即：色块选中时打勾的颜色，要和色块本身的背景色形成反差\n */\nconst getContrastingColor = (color: string): string => {\n\n  // 颜色对象（包含多种颜色空间的类型）\n  type IColorObj = {\n    // 颜色的16进展表示\n    hex: string;\n    // hsl颜色空间\n    hsl: { h: number; s: number; l: number; a?: number };\n    // rgba颜色空间\n    rgb: { r: number; g: number; b: number; a?: number };\n    // hsv颜色空间\n    hsv: { h: number; s: number; v: number };\n    // 原始颜色值（转换之前的数据）\n    source: string;\n  };\n\n  if (!color) {\n    return COLORS.WHITE;\n  }\n\n  const toColorObj = (colorStr: string, oldHue?: number): IColorObj => {\n    const tinyColor = tinycolor(colorStr);\n    const hsl = tinyColor.toHsl();\n    const hsv = tinyColor.toHsv();\n    const rgb = tinyColor.toRgb();\n    const hex = tinyColor.toHex();\n    if (hsl.s === 0) {\n      hsl.h = oldHue || 0;\n      hsv.h = oldHue || 0;\n    }\n    const transparent = hex === '000000' && rgb.a === 0;\n\n    return {\n      hsl,\n      hex: transparent ? 'transparent' : `#${hex}`,\n      rgb,\n      hsv,\n      source: colorStr,\n    };\n  };\n\n  const colorObj: IColorObj = toColorObj(color);\n  if (colorObj.hex === 'transparent') {\n    return 'rgba(0,0,0,0.4)';\n  } else {\n    const yiq =\n      (colorObj.rgb.r * 299 + colorObj.rgb.g * 587 + colorObj.rgb.b * 114) /\n      1000;\n    return yiq >= 210 ? '#8C8C8C' : COLORS.WHITE;\n  }\n};\n\n\ntype IColorSquareProps = {\n  color: string | null;\n  active: boolean;\n  mode?: 'square' | 'text';\n} & IRestProps & DOMAttributes<HTMLSpanElement>;\n\n\nexport const ColorSquare = React.memo(\n  (props: IColorSquareProps) => {\n\n    const {\n      color,\n      active,\n      mode = 'text',\n      ...rest\n    } = props;\n\n    if (color === null) {\n\n      return <NullColorSquareWrap {...mergeRestProps(rest, 'wdn-color-square', { background: COLORS.WHITE })}/>;\n    } else {\n\n      const textAColor = useMemo(() => getContrastingColor(color), [color]);\n      return (\n        <ColorSquareWrap color={color} alwaysShowBorder={isWhite(color)} {...mergeRestProps(rest, 'wdn-color-square', { background: color })}>\n          {\n            active ?\n              <svg width=\"14\" height=\"10\" viewBox=\"0 0 16 12\" fill=\"none\">\n                <path d=\"M13.965 2.15533L5.63499 10.485L1.46999 6.32034\" stroke={textAColor} strokeOpacity=\"0.6\" strokeWidth=\"2.38\" strokeLinecap=\"round\" strokeLinejoin=\"round\"></path>\n              </svg>\n              :\n              mode === 'text' ?\n                <ColorTextA className='_wdn-color-picker-text-a' style={{ color: textAColor }}>A</ColorTextA> : null\n          }\n        </ColorSquareWrap>\n      );\n    }\n  }\n);\n"],"mappings":"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"}