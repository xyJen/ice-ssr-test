{"version":3,"file":"ColorPicker.js","names":["PRESETS","DEFAULT","ART","PRESET_KEY","PRESET_TITLE","title","t","startsWith","ColorPicker","React","memo","props","color","defaultColor","onColorChange","currentPreset","_currentPreset","onCurrentPresetChange","_onCurrentPresetChange","autoColor","recentColors","advance","hoverMode","presets","_presets","rest","value","setValue","useDefaultProp","advancePickerVisible","setAdvancePickerVisible","useState","useTranslate","useMemo","map","p","setCurrentPreset","key","ref","useRef","advanceGroupRef","mergeRestProps","fromSketch","intermediate","marginLeft","flexGrow","undefined","length","current","document","body","find","colors","i","isValidElement","j","COLORS","LIGHT","LEVEL2_BASE_COLOR","marginBottom","WHITE","e","background","OTHERS","DAO_HOVER_BG_COLOR","iconAdvanceColorPicker"],"sources":["../../../../src/form/color-picker/ColorPicker.tsx"],"sourcesContent":["\nimport React, { isValidElement, ReactElement, useCallback, useState, useMemo, useRef, DOMAttributes } from 'react';\nimport { IRestProps, mergeRestProps, useDefaultProp, COLORS } from '../../common';\nimport { useTranslate } from '../../locale';\nimport { DEFAULT, ART } from './presets';\nimport { Text } from '../../basic/text';\nimport { Select } from '../select';\nimport { ColorSquare } from './ColorSquare';\nimport { Popover } from '../../display/popover';\nimport {\n  ColorPickerWrapper,\n  HeaderGroup,\n  AutoColorWrapper,\n  NoColorWrapper,\n  Row,\n  Divider,\n  AdvanceGroup,\n  Group,\n  RecentGroup,\n  SketchPickerWrap,\n  ArrowRight,\n} from './styled';\nimport { ColorPickerSketch } from './ColorPickerSketch';\n\nexport type IColorPickerProps = {\n  /**\n   * 当前选中的颜色\n   */\n  color?: string | null;\n  /**\n   * 初始颜色值\n   */\n  defaultColor?: string;\n  /**\n   * 颜色选中后的回调函数，intermediate 表示是否处在中间过渡态，即在高级的 Sketch 风格面板中按下鼠标拖拽过程产生的事件\n   */\n  onColorChange?: (color: string | null, options: { intermediate: boolean, fromSketch: boolean }) => void;\n  /**\n   * 色卡\n   */\n  presets?: Array<{ key: string, title: string, colors: Array<Array<string> | ReactElement> }>;\n  /**\n   * 当前色卡\n   */\n  currentPreset?: string;\n  /**\n   * 当前色卡\n   */\n  onCurrentPresetChange?: (v: string) => void;\n  /**\n   * 自动颜色，不传显示为「无颜色」\n   */\n  autoColor?: string;\n  /**\n   * 最近使用的颜色\n   */\n  recentColors?: string[];\n  /**\n   * 显示高级选择器\n   */\n  advance?: boolean;\n  /**\n   * 颜色块在悬浮时显示为文本或颜色块\n   */\n  hoverMode?: 'square' | 'text';\n} & IRestProps & DOMAttributes<HTMLDivElement>;\n\nconst PRESETS = [DEFAULT, ART];\nconst PRESET_KEY = 'wdn_color_picker_';\nconst PRESET_TITLE = (title: string, t: (k: any) => string): string => title.startsWith(PRESET_KEY) ? t(title) : title;\n\nexport const ColorPicker = React.memo(\n  (props: IColorPickerProps) => {\n\n    const {\n      color,\n      defaultColor,\n      onColorChange,\n      currentPreset: _currentPreset,\n      onCurrentPresetChange: _onCurrentPresetChange,\n      autoColor,\n      recentColors,\n      advance,\n      hoverMode = 'square',\n      presets: _presets = PRESETS,\n      ...rest\n    } = props;\n\n    const [value, setValue] = useDefaultProp(defaultColor, color, onColorChange);\n\n    const [advancePickerVisible, setAdvancePickerVisible] = useState<boolean>(false);\n\n    const t = useTranslate();\n\n    const presets = useMemo(() => _presets.map(p => ({ ...p, title: PRESET_TITLE(p.title, t) })), [_presets, t]);\n    const [currentPreset, setCurrentPreset] = useDefaultProp(presets[0].key, _currentPreset, _onCurrentPresetChange);\n\n    const ref = useRef<HTMLDivElement>(null);\n    const advanceGroupRef = useRef<HTMLDivElement>(null);\n\n    return (\n      <ColorPickerWrapper\n        ref={ref}\n        {...mergeRestProps(rest, 'wdn-color-picker')}\n      >\n        <HeaderGroup>\n          {\n            autoColor ?\n              <AutoColorWrapper>\n                <ColorSquare\n                  color={autoColor}\n                  active={value === autoColor}\n                  onClick={() => setValue(autoColor, { fromSketch: false, intermediate: false })}\n                  mode={hoverMode}\n                />\n                <Text style={{ marginLeft: 4, flexGrow: 1 }} onClick={() => setValue(autoColor, { fromSketch: false, intermediate: false })}>\n                  {t('wdn_color_picker_auto_color')}\n                </Text>\n              </AutoColorWrapper>\n              :\n              <NoColorWrapper>\n                <ColorSquare\n                  color={null}\n                  active={value === null}\n                  onClick={() => setValue(undefined, { fromSketch: false, intermediate: false })}\n                  mode={'square'}\n                />\n                <Text style={{ marginLeft: 4, flexGrow: 1 }} onClick={() => setValue(undefined, { fromSketch: false, intermediate: false })}>\n                  {t('wdn_color_picker_no_color')}\n                </Text>\n              </NoColorWrapper>\n          }\n          {\n            presets.length > 1 ?\n              <Select size='small' bordered={false} options={presets.map(p => ({ key: p.key, title: p.title }))}\n                value={currentPreset}\n                onChange={setCurrentPreset}\n                getContainer={() => (ref.current || document.body)}\n              /> :\n              null\n          }\n        </HeaderGroup>\n        <Group>\n          {\n            (presets.find(p => p.key === currentPreset) || presets[0]).colors.map((colors: Array<string> | ReactElement, i: number) => {\n\n              return isValidElement(colors) ?\n                colors :\n                <Row key={`${colors[0]}-${i}`}>\n                  {\n                    colors.map(\n                      (color, j) =>\n                        <ColorSquare\n                          key={`${color}-${j}`}\n                          color={color}\n                          active={color === value}\n                          onClick={() => { setValue(color, { fromSketch: false, intermediate: false }) }}\n                          mode={hoverMode}\n                        />\n                    )\n                  }\n                </Row>\n            })\n          }\n        </Group>\n        {\n          (recentColors && recentColors.length > 0) ?\n            <>\n              <Divider />\n              <RecentGroup>\n                <Text style={{ color: COLORS.LIGHT.LEVEL2_BASE_COLOR, marginBottom: 4 }}>\n                  {t('wdn_color_picker_recent_colors')}\n                </Text>\n                <Row>\n                  {\n                    recentColors.map((color, j) =>\n                      <ColorSquare\n                        key={`${color}-${j}`}\n                        color={color}\n                        active={color === value}\n                        onClick={() => { setValue(color, { fromSketch: false, intermediate: false }) }}\n                        mode={hoverMode}\n                      />\n                    )\n                  }\n                </Row>\n              </RecentGroup>\n            </> : null\n        }\n        {\n          advance ?\n            <>\n              <Divider />\n              <Popover\n                placement='rightBottom'\n                placementOffset={[12, -6]}\n                trigger='mouse-enter'\n                visible={advancePickerVisible}\n                onVisibleChange={setAdvancePickerVisible}\n                animation\n                getContainer={() => advanceGroupRef.current || document.body}\n                content={\n                  <SketchPickerWrap>\n                    <ColorPickerSketch\n                      color={value || COLORS.WHITE}\n                      onChange={e => setValue(e, { fromSketch: true, intermediate: true })}\n                      onChangeComplete={e => setValue(e, { fromSketch: true, intermediate: false })}\n                    />\n                  </SketchPickerWrap>\n                }\n              >\n                <AdvanceGroup style={{ background: advancePickerVisible ? COLORS.OTHERS.DAO_HOVER_BG_COLOR : undefined }} ref={advanceGroupRef}>\n                  {iconAdvanceColorPicker}\n                  <Text style={{ marginLeft: 8, flexGrow: 1 }}>\n                    {t('wdn_color_picker_more_colors')}\n                  </Text>\n                  <ArrowRight />\n                </AdvanceGroup>\n              </Popover>\n            </>\n            : null\n        }\n      </ColorPickerWrapper >\n    );\n  });\n\nconst iconAdvanceColorPicker = <svg width=\"20\" height=\"20\" viewBox=\"0 0 1024 1024\">\n  <path d=\"M512 512m-448 0a448 448 0 1 0 896 0 448 448 0 1 0-896 0Z\" fill=\"#FDD66F\"></path>\n  <path d=\"M512 64v448L96.106667 345.173333C162.261333 180.352 323.541333 64 512 64z\" fill=\"#FB9855\"></path>\n  <path d=\"M512 512l283.52 346.901333A446.144 446.144 0 0 1 512 960a445.952 445.952 0 0 1-259.498667-82.773333L512 512z\" fill=\"#4897DA\"></path>\n  <path d=\"M101.162667 333.077333L512 510.250667 259.52 882.133333C141.482667 801.450667 64 665.770667 64 512c0-63.616 13.248-124.117333 37.162667-178.922667z\" fill=\"#DA625A\"></path>\n  <path d=\"M922.837333 333.077333A446.506667 446.506667 0 0 1 960 512c0 153.770667-77.482667 289.450667-195.52 370.133333L512 510.250667z\" fill=\"#69B763\"></path>\n</svg>;\n"],"mappings":"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"}