{"version":3,"file":"SheetTabs.js","names":["SheetTabsProvider","React","createContext","getDraggingTabStyle","isDragging","draggableStyle","transform","translateX","slice","indexOf","SheetTabsRaw","memo","forwardRef","props","ref","tabs","defaultTab","length","key","tab","_tab","onTabChange","onAdd","onRename","onMove","onContextMenu","switchable","movable","addable","renamable","renderTab","renderInlineTab","renderAddButton","rest","setTab","useDefaultProp","editTab","setEditTab","useState","tabsWithoutHidden","useMemo","filter","item","hidden","editHandlers","useRef","setIsDragging","contentRef","arrowState","setArrowState","arrowVisible","canTranslatePrev","canTranslateNext","t","useTranslate","useImperativeHandle","startEdit","current","handleMouseLeaveWhenDragging","useCallback","window","self","top","setTimeout","event","document","createEvent","initEvent","dispatchEvent","useEffect","body","addEventListener","removeEventListener","sheetTabsContext","activeTabScrollIntoView","requestAnimationFrame","getElementById","TAB_ID_PREFIX","scrollIntoView","handleArrow","debounce","scrollDom","newArrowVisible","scrollWidth","clientWidth","newCanTranslatePrev","scrollLeft","newCanTranslateNext","prevState","handleScrollToEdge","Math","ceil","debouncedResize","resizeObserver","ResizeObserver","observe","disconnect","cancel","handleTranslatePrev","preLeft","scrollTo","left","handleTranslateNext","maxLeft","convertDestinationToAfter","sourceIndex","destinationIndex","handleDragStart","handleDragEnd","e","destination","source","draggableId","index","after","handleEditTab","handleQuitEditTab","addButton","mergeClassName","undefined","marginLeft","prevButton","nextButton","Handler","DND","mergeRestProps","dropProvided","mergeRef","innerRef","droppableProps","map","tabInfo","title","dragProvider","dragSnapshot","renderReactNode","draggableProps","dragHandleProps","style","SheetTabs","combineReactComponent","init","handler","Tab","InlineTab"],"sources":["../../../../src/navigator/sheet-tabs/SheetTabs.tsx"],"sourcesContent":["import React, { ReactElement, useCallback, useState, useRef, useEffect, useMemo, useImperativeHandle } from \"react\";\nimport { debounce } from 'lodash-es';\nimport { useDefaultProp, combineReactComponent, mergeRef, mergeClassName, IRestProps, mergeRestProps, IRenderReactNode, renderReactNode } from \"../../common\";\nimport { useTranslate } from '../../locale';\nimport { Tooltip } from \"../../display/tooltip\";\nimport { IconAdd, IconArrowLeft, IconArrowRight } from \"../../basic/icon\";\nimport { Tab, TAB_ID_PREFIX } from \"./Tab\";\nimport { InlineTab } from \"./InlineTab\";\nimport { SheetSelect } from './SheetSelect';\nimport {\n  SheetTabsWrapper,\n  LeftIcons,\n  TabsWrapper,\n  RightIcons,\n  IconWrapper,\n} from \"./styled\";\nimport type { IMoveHandler } from \"./MoveHandler\";\nimport type { DropResult } from 'react-beautiful-dnd'\nimport ResizeObserver from 'resize-observer-polyfill';\n\nexport type TabInfo = {\n  key: string;\n  title: string;\n  hidden?: boolean;\n}\n\nexport type ISheetTabsProps = {\n  /**\n   * 标签项\n   */\n  tabs: TabInfo[];\n  /**\n   * 默认选中的标签的key\n   */\n  defaultTab?: string;\n  /**\n   * 选中的标签的key\n   */\n  tab?: string;\n  /**\n   * 标签切换时的回调\n   */\n  onTabChange?: (key: string) => void;\n  /**\n   * 标签添加时的回调\n   */\n  onAdd?: (after: string | null) => void;\n  /**\n   * 标签重命名时的回调\n   */\n  onRename?: (key: string, title: string) => void;\n  /**\n   * 标签移动时的回调\n   */\n  onMove?: (key: string, after: string | null) => void;\n  /**\n   * 标签触发右键菜单时的回调\n   */\n  onContextMenu?: (key: string, e: React.MouseEvent) => void;\n  /**\n   * 标签是否可切换\n   */\n  switchable?: boolean;\n  /**\n   * 标签是否可移动\n   */\n  movable?: boolean;\n  /**\n   * 标签是否可添加，默认显示\n   * true显示，false不显示, disabled表示显示但是点击无效\n   */\n  addable?: boolean | \"disabled\";\n  /**\n   * 标签是否可以重命名\n   */\n  renamable?: boolean;\n  /**\n   * 标签自定义渲染\n   */\n  renderTab?: IRenderReactNode<{ key: string }>;\n  /**\n   * 选项列表的标签自定义渲染\n   */\n  renderInlineTab?: IRenderReactNode<{ key: string }>;\n  /**\n   * 添加按钮自定义渲染\n   */\n  renderAddButton?: () => ReactElement;\n} & IRestProps;\n\ntype ISheetTabsHandler = {\n  startEdit: () => void;\n};\n\ninterface ISheetTabsContext {\n  editHandlers: React.MutableRefObject<Record<string, (key: string) => void>>;\n}\nexport const SheetTabsProvider = React.createContext({} as ISheetTabsContext);\n\nconst getDraggingTabStyle = (isDragging: boolean, draggableStyle: React.CSSProperties): React.CSSProperties => {\n  const { transform } = draggableStyle;\n  if (isDragging && transform) {\n    const translateX = transform.slice(\n      transform.indexOf('(') + 1,\n      transform.indexOf(','),\n    );\n    return {\n      ...draggableStyle,\n      transform: `translate(${translateX}, 0)`,\n    };\n  }\n  return draggableStyle;\n};\n\nconst SheetTabsRaw = React.memo(React.forwardRef<ISheetTabsHandler, ISheetTabsProps>((props, ref) => {\n  const {\n    tabs,\n    defaultTab = tabs.length > 0 ? tabs[0].key : '',\n    tab: _tab,\n    onTabChange,\n    onAdd,\n    onRename,\n    onMove,\n    onContextMenu,\n    switchable = true,\n    movable = true,\n    addable = true,\n    renamable = false,\n    renderTab,\n    renderInlineTab,\n    renderAddButton,\n    ...rest\n  } = props;\n\n  const [tab, setTab] = useDefaultProp<string>(defaultTab, _tab, onTabChange);\n  const [editTab, setEditTab] = useState<string | null>(null);\n  const tabsWithoutHidden = useMemo(() => tabs.filter((item) => !item.hidden), [tabs]);\n  const editHandlers = useRef<Record<string, () => void>>({});\n  const [isDragging, setIsDragging] = useState<boolean>(false);\n\n  const contentRef = useRef<HTMLDivElement>(null);\n  const [arrowState, setArrowState] = useState({\n    arrowVisible: false,\n    canTranslatePrev: false,\n    canTranslateNext: false,\n  });\n\n  const t = useTranslate();\n\n  useImperativeHandle(ref, () => ({\n    startEdit: editHandlers.current[tab],\n  }));\n\n  // iframe 条件下，鼠标拖出视口外，没有触发 mouseup，因此此处进行 hack\n  const handleMouseLeaveWhenDragging = useCallback(() => {\n    if (isDragging && window.self !== window.top) {\n      // trigger mouseup\n      setTimeout(() => {\n        const event = document.createEvent('MouseEvents');\n        event.initEvent('mouseup', true, true);\n        contentRef.current?.dispatchEvent(event);\n      }, 200);\n    }\n  }, [isDragging]);\n\n  useEffect(() => {\n    document.body.addEventListener('mouseleave', handleMouseLeaveWhenDragging);\n    return () => {\n      document.body.removeEventListener('mouseleave', handleMouseLeaveWhenDragging);\n    };\n  }, [handleMouseLeaveWhenDragging]);\n\n  const sheetTabsContext = useMemo(() => {\n    return { editHandlers };\n  }, [editHandlers]);\n\n  const activeTabScrollIntoView = useCallback(() => {\n    requestAnimationFrame(() => {\n      document.getElementById(`${TAB_ID_PREFIX}${tab}`)?.scrollIntoView();\n    });\n  }, [tab]);\n\n  const handleArrow = useCallback(debounce(() => {\n    const scrollDom = contentRef?.current;\n    if (!scrollDom) return;\n    const newArrowVisible = scrollDom.scrollWidth > scrollDom.clientWidth;\n    const newCanTranslatePrev = scrollDom.scrollLeft > 0;\n    const newCanTranslateNext =\n      scrollDom.scrollLeft < scrollDom.scrollWidth - scrollDom.clientWidth;\n    setArrowState((prevState) => {\n      if (\n        newArrowVisible !== prevState.arrowVisible ||\n        newCanTranslatePrev !== prevState.canTranslatePrev ||\n        newCanTranslateNext !== prevState.canTranslateNext\n      ) {\n        return {\n          arrowVisible: newArrowVisible,\n          canTranslatePrev: newCanTranslatePrev,\n          canTranslateNext: newCanTranslateNext,\n        };\n      }\n      return prevState;\n    });\n    activeTabScrollIntoView();\n  }, 0), [activeTabScrollIntoView]);\n\n  const handleScrollToEdge = useCallback(debounce((): void => {\n    const scrollDom = contentRef?.current;\n    if (!scrollDom) return;\n    const newCanTranslatePrev = scrollDom.scrollLeft > 0;\n    // ceil消除scrollDom.scrollLeft最大值有时是小数, 小0.5像素\n    const newCanTranslateNext = Math.ceil(scrollDom.scrollLeft) < scrollDom.scrollWidth - scrollDom.clientWidth;\n    setArrowState((prevState) => {\n      if (newCanTranslatePrev !== prevState.canTranslatePrev || newCanTranslateNext !== prevState.canTranslateNext) {\n        return {\n          arrowVisible: prevState.arrowVisible,\n          canTranslateNext: newCanTranslateNext,\n          canTranslatePrev: newCanTranslatePrev,\n        };\n      }\n      return prevState;\n    });\n  }, 100), []);\n\n  useEffect(() => {\n    handleArrow();\n  }, [tabs.length, tab, handleArrow]);\n\n  useEffect(() => {\n    const debouncedResize = debounce(() => {\n      handleArrow();\n    }, 200);\n    const resizeObserver = new ResizeObserver(debouncedResize);\n    resizeObserver.observe(contentRef.current!);\n    return () => {\n      resizeObserver.disconnect();\n      if (debouncedResize.cancel) {\n        debouncedResize.cancel();\n      }\n    };\n  }, [handleArrow]);\n\n  const handleTranslatePrev = useCallback(() => {\n    const scrollDom = contentRef?.current;\n    if (!scrollDom) return;\n    const preLeft = scrollDom.scrollLeft - scrollDom.clientWidth;\n    scrollDom.scrollTo({\n      left: preLeft < 0 ? 0 : preLeft,\n    });\n  }, []);\n\n  const handleTranslateNext = useCallback(() => {\n    const scrollDom = contentRef?.current;\n    if (!scrollDom) return;\n    const preLeft = scrollDom.scrollLeft + scrollDom.clientWidth;\n    const maxLeft = scrollDom.scrollWidth - scrollDom.clientWidth;\n    scrollDom.scrollTo({\n      left: preLeft > maxLeft ? maxLeft : preLeft,\n    });\n  }, []);\n\n  const convertDestinationToAfter = useCallback((sourceIndex: number, destinationIndex: number): string | null => {\n    if (destinationIndex === 0) return null;\n    if (sourceIndex < destinationIndex) {\n      return tabs[destinationIndex].key;\n    }\n    return tabs[destinationIndex - 1].key;\n  }, [tabs]);\n\n  const handleDragStart = useCallback(() => {\n    setIsDragging(true);\n  }, []);\n\n  const handleDragEnd = useCallback((e: DropResult): void => {\n    setIsDragging(false);\n    const { destination, source, draggableId } = e;\n    if (destination && destination.index !== source.index) {\n      const after = convertDestinationToAfter(source.index, destination.index);\n      onMove?.(draggableId, after);\n    }\n  }, [onMove]);\n\n  const handleEditTab = useCallback((key: string) => {\n    if (editTab !== key) {\n      setEditTab(key);\n    }\n  }, [editTab]);\n\n  const handleQuitEditTab = useCallback((key: string) => {\n    if (editTab === key) {\n      setEditTab(null);\n    }\n  }, [editTab]);\n\n  const addButton = (\n    <IconWrapper\n      className={mergeClassName(\n        addable === \"disabled\" ? \"disabled\" : undefined\n      )}\n      style={{ marginLeft: 8 }}\n      onClick={() => onAdd?.(tab)}\n    >\n      <IconAdd />\n    </IconWrapper>\n  );\n\n  const prevButton = (\n    <IconWrapper\n      className={mergeClassName(\n        arrowState.canTranslatePrev ? undefined : \"disabled\"\n      )}\n      onClick={arrowState.canTranslatePrev ? handleTranslatePrev : undefined}\n    >\n      <IconArrowLeft />\n    </IconWrapper>\n  );\n\n  const nextButton = (\n    <IconWrapper\n      className={mergeClassName(\n        arrowState.canTranslateNext ? undefined : \"disabled\"\n      )}\n      onClick={arrowState.canTranslateNext ? handleTranslateNext : undefined}\n    >\n      <IconArrowRight />\n    </IconWrapper>\n  );\n\n  const Handler = DND.Handler as any;\n\n  return (\n    <SheetTabsWrapper {...mergeRestProps(rest, 'wdn-sheet-tabs')}>\n      <LeftIcons>\n        <SheetSelect\n          tabs={tabs}\n          tab={tab}\n          setActiveTab={setTab}\n          disabled={!switchable}\n          renderInlineTab={renderInlineTab}\n        />\n        {addable\n          ? renderAddButton?.() || (addable === \"disabled\" ? addButton :\n            <Tooltip title={t('wdn_sheet_tabs_add')} placement=\"top\">\n              {addButton}\n            </Tooltip>\n          )\n          : null}\n      </LeftIcons>\n      <SheetTabsProvider.Provider value={sheetTabsContext}>\n        {movable && Handler ? (\n          <Handler.DragDropContext onDragStart={handleDragStart} onDragEnd={handleDragEnd}>\n            <Handler.Droppable\n              droppableId=\"wdn-sheet-tabs\"\n              direction=\"horizontal\"\n            >\n              {(dropProvided: any) => (\n                <TabsWrapper\n                  ref={mergeRef(dropProvided.innerRef, contentRef)}\n                  {...dropProvided.droppableProps}\n                  onScroll={handleScrollToEdge}\n                >\n                  {tabsWithoutHidden.map((tabInfo, index) => {\n                    const { key, title } = tabInfo;\n                    return (\n                      <Handler.Draggable\n                        key={key}\n                        draggableId={key}\n                        index={index}\n                      >\n                        {(dragProvider: any, dragSnapshot: any) =>\n                          renderReactNode(\n                            renderTab,\n                            <Tab\n                              {...dragProvider.draggableProps}\n                              {...dragProvider.dragHandleProps}\n                              ref={dragProvider.innerRef}\n                              tab={key}\n                              title={title}\n                              active={key === tab}\n                              editing={key === editTab}\n                              setActiveTab={setTab}\n                              onEditingTab={handleEditTab}\n                              onQuitEditingTab={handleQuitEditTab}\n                              switchable={switchable}\n                              renamable={renamable}\n                              onRename={onRename}\n                              onContextMenu={onContextMenu}\n                              style={getDraggingTabStyle(\n                                dragSnapshot.isDragging,\n                                dragProvider.draggableProps.style\n                              )}\n                            />,\n                            { key }\n                          )\n                        }\n                      </Handler.Draggable>\n                    );\n                  })}\n                </TabsWrapper>\n              )}\n            </Handler.Droppable>\n          </Handler.DragDropContext>\n        ) : (\n          <TabsWrapper ref={contentRef} onScroll={handleScrollToEdge}>\n            {tabsWithoutHidden.map((tabInfo) => {\n              const { key, title } = tabInfo;\n              return renderReactNode(\n                renderTab,\n                <Tab\n                  key={key}\n                  tab={key}\n                  title={title}\n                  active={key === tab}\n                  editing={key === editTab}\n                  setActiveTab={setTab}\n                  onEditingTab={handleEditTab}\n                  onQuitEditingTab={handleQuitEditTab}\n                  switchable={switchable}\n                  renamable={renamable}\n                  onRename={onRename}\n                  onContextMenu={onContextMenu}\n                />,\n                { key }\n              );\n            })}\n          </TabsWrapper>\n        )}\n      </SheetTabsProvider.Provider>\n      {arrowState.arrowVisible ? (\n        <RightIcons>\n          {arrowState.canTranslatePrev ? <Tooltip title={t('wdn_sheet_tabs_scroll_left')} placement=\"top\">\n            {prevButton}\n          </Tooltip> : prevButton}\n          {arrowState.canTranslateNext ? <Tooltip title={t('wdn_sheet_tabs_scroll_right')} placement=\"top\">\n            {nextButton}\n          </Tooltip> : nextButton}\n        </RightIcons>\n      ) : null}\n    </SheetTabsWrapper>\n  );\n}));\n\nconst DND: { Handler?: IMoveHandler } = {};\n\nexport const SheetTabs = combineReactComponent(SheetTabsRaw, {\n  init: (handler?: IMoveHandler) => (DND.Handler = handler),\n  Tab: Tab as React.FC<Partial<Pick<React.ComponentProps<typeof Tab>, 'title' | 'prefix' | 'suffix'> & Omit<IRestProps, 'id' | 'style'>>>,\n  InlineTab: InlineTab as React.FC<Partial<Pick<React.ComponentProps<typeof InlineTab>, 'title' | 'disabled' | 'tooltipTitle' | 'onClick'>> & IRestProps>,\n});\n"],"mappings":"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"}