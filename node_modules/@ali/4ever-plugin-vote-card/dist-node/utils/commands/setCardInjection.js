"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = setCardInjection;

var _everCangjie = require("@ali/4ever-cangjie");

var _everLogger = _interopRequireDefault(require("@ali/4ever-logger"));

// 这个方法在 bi 中有一份，但是 bamboo 不建议引用 bi，所以这里重写了一份
function setCardInjection(controller, node, injectionData) {
  if (!node) {
    // FIX: 怀疑 hetu 业务方设置 injection 时未判断 node 是否存在
    _everLogger.default.error(`Invalid node! injection is ${JSON.stringify(injectionData)}`);

    return controller;
  }

  const {
    injections
  } = controller.value;

  const injection = _everCangjie.Injection.create({
    key: node.key,
    data: injectionData
  });

  const excludeInjections = injections.filter(inj => inj.key !== node.key);
  return controller.setInjections(excludeInjections.concat(injection));
}
//# sourceMappingURL=setCardInjection.js.map