{"version":3,"sources":["../../../../src/mo/serializer/htmlToJsonML.ts"],"names":["name","onOpenTag","state","attrs","value","mode","type","metadata","id","formula","formulaTag","tagType","jc","push","onCloseTag","pop","append"],"mappings":";;;;;;;AAEA;;AACA;;eAEe;AACbA,EAAAA,IAAI,EAAE,SADO;AAGbC,EAAAA,SAAS,EAAE,CAACC,KAAD,EAAeF,IAAf,EAA6BG,KAA7B,KAA4D;AACrE,UAAM;AAAEC,MAAAA,KAAF;AAASC,MAAAA,IAAT;AAAeC,MAAAA;AAAf,QAAwBH,KAA9B;AACA,QAAIH,IAAI,KAAK,MAAT,IAAmBM,IAAI,KAAK,SAAhC,EAA2C,OAAO,KAAP;AAE3C,UAAMC,QAAQ,GAAG;AACfC,MAAAA,EAAE,EAAE,eADW;AAEfF,MAAAA,IAAI,EAAE,sCAFS;AAGfG,MAAAA,OAAO,EAAEL;AAHM,KAAjB;AAKA,UAAMM,UAAkB,GAAG,CACzB,KADyB,EAEzB;AACEC,MAAAA,OAAO,EAAE,MADX;AAEEJ,MAAAA;AAFF,KAFyB,EAMzB,uCAAqB,EAArB,CANyB,CAA3B;AAQA,UAAME,OAAe,GAAGJ,IAAI,KAAK,QAAT,GACnBK,UADmB,GAEpB,CACA,GADA,EAEA;AACEE,MAAAA,EAAE,EAAE;AADN,KAFA,EAKA,uCAAqB,EAArB,CALA,EAMAF,UANA,EAOA,uCAAqB,EAArB,CAPA,CAFJ;AAYAR,IAAAA,KAAK,CAACW,IAAN,CAAWJ,OAAX;AACA,WAAO,IAAP;AACD,GAlCY;AAoCbK,EAAAA,UAAU,EAAE,CAACZ,KAAD,EAAeF,IAAf,EAA6BG,KAA7B,KAA4D;AACtE,QAAIH,IAAI,KAAK,MAAT,IAAmBG,KAAK,CAACG,IAAN,KAAe,SAAtC,EAAiD,OAAO,KAAP;AACjD,UAAMG,OAAO,GAAGP,KAAK,CAACa,GAAN,EAAhB;AACAb,IAAAA,KAAK,CAACc,MAAN,CAAaP,OAAb;AACA,WAAO,IAAP;AACD;AAzCY,C","sourcesContent":["import { JsonML } from '@ali/4ever-utils';\nimport { MoState as State, MoAttributes as Attributes } from '@ali/4ever-cangjie';\nimport { v4 as uuid } from 'uuid';\nimport { createTextWithString } from '@ali/4ever-cangjie';\n\nexport default {\n  name: 'formula',\n\n  onOpenTag: (state: State, name: string, attrs: Attributes): boolean => {\n    const { value, mode, type } = attrs;\n    if (name !== 'span' || type !== 'formula') return false;\n\n    const metadata = {\n      id: uuid(),\n      type: 'application/x-alidocs-plugin-formula',\n      formula: value,\n    };\n    const formulaTag: JsonML = [\n      'tag',\n      {\n        tagType: 'hetu',\n        metadata,\n      },\n      createTextWithString('')\n    ];\n    const formula: JsonML = mode === 'inline'\n      ?  formulaTag\n      : [\n        'p',\n        {\n          jc: 'center',\n        },\n        createTextWithString(''),\n        formulaTag,\n        createTextWithString('')\n      ];\n\n    state.push(formula);\n    return true;\n  },\n\n  onCloseTag: (state: State, name: string, attrs: Attributes): boolean => {\n    if (name !== 'span' || attrs.type !== 'formula') return false;\n    const formula = state.pop();\n    state.append(formula);\n    return true;\n  },\n};\n"],"file":"htmlToJsonML.js"}