import { useRef, useEffect } from 'react';
import { elementContain } from "../utils/dom";
export default (function (handler, otherNodes, passRef) {
  var newRef = useRef(null);
  var ref = passRef || newRef;
  var callback = useRef(function () {});
  callback.current = handler;
  useEffect(function () {
    /**
     * 点击处理
     */
    var handleDoubleClickBody = function handleDoubleClickBody(event) {
      var isOuter = [ref.current].concat(otherNodes || []).every(function (oElem) {
        return !elementContain(oElem, event.target);
      });

      if (isOuter && callback.current) {
        callback.current(event);
      }
    };

    document.body.addEventListener('contextmenu', handleDoubleClickBody);
    return function () {
      document.body.removeEventListener('contextmenu', handleDoubleClickBody);
    };
  }, [otherNodes, ref]);
  return ref;
});