import { useRef, useMemo, useEffect } from 'react';
import ReactDOM from 'react-dom';
export var PortalComponent = function PortalComponent(props) {
  var visible = props.visible,
      getContainer = props.getContainer,
      children = props.children;
  var isAppended = useRef(false);
  var oContainer = getContainer ? getContainer() || document.body : document.body;
  var oComponentContainer = useMemo(function () {
    var node = document.createElement('div');
    node.style.position = 'absolute';
    node.style.left = '0px';
    node.style.top = '0px';
    node.style.width = '100%';
    isAppended.current = false;
    return node; // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [oContainer]); // 首次visible append 到body中

  if (!isAppended.current) {
    if (visible) {
      isAppended.current = true;
      oContainer.appendChild(oComponentContainer);
    }
  }

  useEffect(function () {
    var didAppended = isAppended.current;
    return function () {
      if (didAppended && oComponentContainer.parentElement === oContainer) {
        oContainer.removeChild(oComponentContainer);
        isAppended.current = false;
      }
    };
  }, [oComponentContainer, oContainer]);
  return /*#__PURE__*/ReactDOM.createPortal(children, oComponentContainer);
};