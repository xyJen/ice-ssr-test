{"version":3,"sources":["../../../../../src/plugins/alignment/commands/setAlignment.ts"],"names":["Commands","getClosestParagraph","isEqualWithDefault","getBlocksFromEditor","DEFAULT_ALIGNMENT","setAlignment","controller","align","key","value","blocks","curBlock","document","getClosestBlock","forEach","block","currentAlignment","prevAlignment","data","jc","newAlignment","command","setNodeByKey"],"mappings":";AAAA,SAAqBA,QAArB,QAAqC,oBAArC;AACA,SAASC,mBAAT,QAAoC,kBAApC;AACA,SAASC,kBAAT,EAA6BC,mBAA7B,QAAwD,kBAAxD;AACA,SAASC,iBAAT;AAEA;;AACA,eAAe,SAASC,YAAT,CAAsBC,UAAtB,EAA8CC,KAA9C,EAA6DC,GAA7D,EAA2E;AAAA,MAChFC,KADgF,GACtEH,UADsE,CAChFG,KADgF;AAGxF,MAAIC,MAAJ;;AACA,MAAIF,GAAJ,EAAS;AACP,QAAMG,QAAQ,GAAGF,KAAK,CAACG,QAAN,CAAeC,eAAf,CAA+BL,GAA/B,CAAjB;AACAE,IAAAA,MAAM,GAAGC,QAAQ,GAAG,CAACA,QAAD,CAAH,GAAgB,EAAjC;AACD,GAHD,MAGO;AACLD,IAAAA,MAAM,GAAGP,mBAAmB,CAACG,UAAD,CAA5B;AACD;;AAGDI,EAAAA,MAAM,CAACI,OAAP,CAAe,UAACC,KAAD,EAAW;AACxB,QAAMC,gBAAgB,GAAGf,mBAAmB,CAACQ,KAAD,EAAQM,KAAR,CAA5C;;AACA,QAAIC,gBAAJ,EAAsB;AACpB,UAAMC,aAAa,GAAGD,gBAAgB,CAACE,IAAjB,CAAsBC,EAAtB,GAA2B;AAAEA,QAAAA,EAAE,EAAEH,gBAAgB,CAACE,IAAjB,CAAsBC;AAA5B,OAA3B,GAA8D,EAApF;AACA,UAAMC,YAAY,GAAG;AAAED,QAAAA,EAAE,EAAEZ;AAAN,OAArB;;AACA,UAAIL,kBAAkB,CAACe,aAAD,EAAgBG,YAAhB,EAA8BhB,iBAA9B,CAAtB,EAAwE;AACtE;AACD;;AACDE,MAAAA,UAAU,CAACe,OAAX,CAAmBrB,QAAQ,CAACsB,YAA5B,EAA0CN,gBAAgB,CAACR,GAA3D,EAAgE;AAC9DU,QAAAA,IAAI,eACCF,gBAAgB,CAACE,IADlB;AAEFC,UAAAA,EAAE,EAAEZ;AAFF;AAD0D,OAAhE;AAMD;AACF,GAfD;AAiBA,SAAOD,UAAP;AACD","sourcesContent":["import { Controller, Commands } from '@ali/4ever-cangjie';\nimport { getClosestParagraph } from '@ali/4ever-utils';\nimport { isEqualWithDefault, getBlocksFromEditor } from '@ali/4ever-utils';\nimport { DEFAULT_ALIGNMENT } from '../utils';\n\n/* eslint-disable max-len */\nexport default function setAlignment(controller: Controller, align: string, key?: string) {\n  const { value } = controller;\n\n  let blocks;\n  if (key) {\n    const curBlock = value.document.getClosestBlock(key);\n    blocks = curBlock ? [curBlock] : [];\n  } else {\n    blocks = getBlocksFromEditor(controller);\n  }\n\n\n  blocks.forEach((block) => {\n    const currentAlignment = getClosestParagraph(value, block);\n    if (currentAlignment) {\n      const prevAlignment = currentAlignment.data.jc ? { jc: currentAlignment.data.jc } : {};\n      const newAlignment = { jc: align };\n      if (isEqualWithDefault(prevAlignment, newAlignment, DEFAULT_ALIGNMENT)) {\n        return;\n      }\n      controller.command(Commands.setNodeByKey, currentAlignment.key, {\n        data: {\n          ...currentAlignment.data,\n          jc: align,\n        },\n      });\n    }\n  });\n\n  return controller;\n}\n"],"file":"setAlignment.js"}