import { Sticker } from '@ali/4ever-mo';
import { insertSticker, setSticker } from "../actions";

/**
 * @description 创建插入表情函数
 * @param {controller}
 * @param {sticker}
 * */
function createOnClickSticker(_ref) {
  var controller = _ref.controller,
      sticker = _ref.sticker;
  return function (_ref2) {
    var event = _ref2.event,
        code = _ref2.code;
    event.preventDefault();
    event.stopPropagation();
    var _controller$value = controller.value,
        document = _controller$value.document,
        selection = _controller$value.selection;
    var stickerInfo = sticker.getInfoByCode(code);
    if (!stickerInfo) return;
    var width = stickerInfo.width,
        height = stickerInfo.height;
    var point = document.getNode(selection.anchor.key);
    var currentNode = point && document.getParent(point.key);
    var payload = {
      code: code,
      width: width,
      height: height,
      node: currentNode || {}
    };

    if (Sticker.isSticker(currentNode)) {
      return controller.run('onAction', setSticker(payload));
    }

    return controller.run('onAction', insertSticker(payload));
  };
}

export default createOnClickSticker;
//# sourceMappingURL=createOnClickSticker.js.map