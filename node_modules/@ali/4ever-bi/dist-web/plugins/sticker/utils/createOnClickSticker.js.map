{"version":3,"sources":["../../../../../src/plugins/sticker/utils/createOnClickSticker.ts"],"names":["Sticker","insertSticker","setSticker","createOnClickSticker","controller","sticker","event","code","preventDefault","stopPropagation","value","document","selection","stickerInfo","getInfoByCode","width","height","point","getNode","anchor","key","currentNode","getParent","payload","node","isSticker","run"],"mappings":"AAEA,SAASA,OAAT,QAAwB,eAAxB;AACA,SAASC,aAAT,EAAwBC,UAAxB;;AAOA;AACA;AACA;AACA;AACA;AACA,SAASC,oBAAT,OAG+B;AAAA,MAF7BC,UAE6B,QAF7BA,UAE6B;AAAA,MAD7BC,OAC6B,QAD7BA,OAC6B;AAC7B,SAAO,iBAA2B;AAAA,QAAfC,KAAe,SAAfA,KAAe;AAAA,QAARC,IAAQ,SAARA,IAAQ;AAChCD,IAAAA,KAAK,CAACE,cAAN;AACAF,IAAAA,KAAK,CAACG,eAAN;AAFgC,4BAGAL,UAAU,CAACM,KAHX;AAAA,QAGxBC,QAHwB,qBAGxBA,QAHwB;AAAA,QAGdC,SAHc,qBAGdA,SAHc;AAIhC,QAAMC,WAAW,GAAGR,OAAO,CAACS,aAAR,CAAsBP,IAAtB,CAApB;AACA,QAAI,CAACM,WAAL,EAAkB;AALc,QAMxBE,KANwB,GAMNF,WANM,CAMxBE,KANwB;AAAA,QAMjBC,MANiB,GAMNH,WANM,CAMjBG,MANiB;AAOhC,QAAMC,KAAK,GAAGN,QAAQ,CAACO,OAAT,CAAiBN,SAAS,CAACO,MAAV,CAAiBC,GAAlC,CAAd;AACA,QAAMC,WAAW,GAAGJ,KAAK,IAAIN,QAAQ,CAACW,SAAT,CAAmBL,KAAK,CAACG,GAAzB,CAA7B;AACA,QAAMG,OAAO,GAAG;AACdhB,MAAAA,IAAI,EAAJA,IADc;AAEdQ,MAAAA,KAAK,EAALA,KAFc;AAGdC,MAAAA,MAAM,EAANA,MAHc;AAIdQ,MAAAA,IAAI,EAAGH,WAAW,IAAI;AAJR,KAAhB;;AAMA,QAAIrB,OAAO,CAACyB,SAAR,CAAkBJ,WAAlB,CAAJ,EAAoC;AAClC,aAAOjB,UAAU,CAACsB,GAAX,CACL,UADK,EAELxB,UAAU,CAACqB,OAAD,CAFL,CAAP;AAID;;AACD,WAAOnB,UAAU,CAACsB,GAAX,CAAe,UAAf,EAA2BzB,aAAa,CAACsB,OAAD,CAAxC,CAAP;AACD,GAtBD;AAuBD;;AAED,eAAepB,oBAAf","sourcesContent":["import { Controller } from '@ali/4ever-cangjie';\nimport { StickerPlugin } from '@ali/4ever-bamboo';\nimport { Sticker } from '@ali/4ever-mo';\nimport { insertSticker, setSticker } from '../actions';\n\ninterface ICreateOnClickStickerProps {\n  controller: Controller;\n  sticker: StickerPlugin.Sticker;\n}\n\n/**\n * @description 创建插入表情函数\n * @param {controller}\n * @param {sticker}\n * */\nfunction createOnClickSticker({\n  controller,\n  sticker,\n}: ICreateOnClickStickerProps) {\n  return function ({ event, code }) {\n    event.preventDefault();\n    event.stopPropagation();\n    const { document, selection } = controller.value;\n    const stickerInfo = sticker.getInfoByCode(code);\n    if (!stickerInfo) return;\n    const { width, height } = stickerInfo;\n    const point = document.getNode(selection.anchor.key);\n    const currentNode = point && document.getParent(point.key);\n    const payload = {\n      code,\n      width,\n      height,\n      node: (currentNode || {}) as Sticker,\n    };\n    if (Sticker.isSticker(currentNode)) {\n      return controller.run(\n        'onAction',\n        setSticker(payload),\n      );\n    }\n    return controller.run('onAction', insertSticker(payload));\n  };\n}\n\nexport default createOnClickSticker;\n"],"file":"createOnClickSticker.js"}