{"version":3,"sources":["../../../../../src/plugins/sticker/commands/insertSticker.ts"],"names":["Commands","Inline","Text","STICKER_NODE_TYPE","getMarksAtAnchor","insertSticker","controller","payload","marks","code","node","command","insertInline","create","type","data","nodes","addMarks","moveToStartOfNextText","focus"],"mappings":"AAAA,SAAqBA,QAArB,EAA+BC,MAA/B,EAAuCC,IAAvC,QAAmD,oBAAnD;AACA,SAASC,iBAAT;AACA,SAASC,gBAAT;AAGA,eAAe,SAASC,aAAT,CACbC,UADa,EAEbC,OAFa,EAGb;AACA,MAAMC,KAAK,GAAGJ,gBAAgB,CAACE,UAAD,CAA9B;AADA,MAEQG,IAFR,GAEuBF,OAFvB,CAEQE,IAFR;AAAA,MAEcC,IAFd,GAEuBH,OAFvB,CAEcG,IAFd;AAGAJ,EAAAA,UAAU,CAACK,OAAX,CACEX,QAAQ,CAACY,YADX,EAEEX,MAAM,CAACY,MAAP,CAAc;AACZC,IAAAA,IAAI,EAAEX,iBADM;AAEZY,IAAAA,IAAI,EAAE;AAAEN,MAAAA,IAAI,EAAJA;AAAF,KAFM;AAGZO,IAAAA,KAAK,EAAE,CAACd,IAAI,CAACW,MAAL,CAAY,EAAZ,EAAgBI,QAAhB,CAAyB,CAAzB,EAA4B,CAA5B,EAA+BT,KAA/B,CAAD;AAHK,GAAd,CAFF;AAQA,MAAI,CAACE,IAAL,EAAW,OAAOJ,UAAP,CAXX,CAYA;;AACA,SAAOA,UAAU,CACdK,OADI,CACIX,QAAQ,CAACkB,qBADb,EAEJP,OAFI,CAEIX,QAAQ,CAACmB,KAFb,CAAP;AAGD","sourcesContent":["import { Controller, Commands, Inline, Text } from '@ali/4ever-cangjie';\nimport { STICKER_NODE_TYPE } from '../constants';\nimport { getMarksAtAnchor } from '../utils';\nimport { InsertStickerProps } from '../types';\n\nexport default function insertSticker(\n  controller: Controller,\n  payload: InsertStickerProps,\n) {\n  const marks = getMarksAtAnchor(controller);\n  const { code, node } = payload;\n  controller.command(\n    Commands.insertInline,\n    Inline.create({\n      type: STICKER_NODE_TYPE,\n      data: { code },\n      nodes: [Text.create('').addMarks(0, 0, marks)],\n    }),\n  );\n  if (!node) return controller;\n  // 通过面板连续添加表情，需要移除表情的选中状态\n  return controller\n    .command(Commands.moveToStartOfNextText)\n    .command(Commands.focus);\n}\n"],"file":"insertSticker.js"}