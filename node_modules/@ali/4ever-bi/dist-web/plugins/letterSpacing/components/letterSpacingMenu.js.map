{"version":3,"sources":["../../../../../src/plugins/letterSpacing/components/letterSpacingMenu.tsx"],"names":["React","Link","Paragraph","Heading","SubMenu","Button","PlusBetaNormal","MinusBetaNormal","PluginRoles","setLetterSpacing","SpacingSet","SpacingValue","commonButtonStyle","MIN","MAX","STEP","canSetMark","controller","value","selection","isCollapsedAtEdge","isExpanded","startBlock","startInline","isLink","isParagraph","isHeading","LetterSpacingMenu","props","menuItem","title","rest","isDisabled","letterSpacing","query","handleMinusClick","spacing","run","handlePlusClick","letterSpacingMinus","letterSpacingPlus"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Controller } from '@ali/4ever-cangjie';\nimport { Link, Paragraph, Heading } from '@ali/4ever-mo';\nimport { SubMenu, Button, PlusBetaNormal, MinusBetaNormal } from '@ali/we-design';\nimport { PluginRoles } from '@ali/4ever-bamboo';\nimport { MenuItemInnerProps } from '@ali/4ever-component';\nimport { setLetterSpacing } from '../actions';\nimport {\n  SpacingSet,\n  SpacingValue,\n  commonButtonStyle,\n} from './style';\n\nconst MIN = -10;\nconst MAX = 10;\nconst STEP = 0.5;\n\nfunction canSetMark(controller: Controller) {\n  const { isCollapsedAtEdge, isExpanded } = controller.value.selection;\n  if (isCollapsedAtEdge || isExpanded) return true;\n\n  const { startBlock, startInline } = controller.value;\n\n  if (startInline && !Link.isLink(startInline)) {\n    // 仅支持 link\n    return false;\n  }\n  if (Paragraph.isParagraph(startBlock) || Heading.isHeading(startBlock)) {\n    // 仅支持文字段落\n    return true;\n  }\n\n  return false;\n}\n\nexport default function LetterSpacingMenu(props: MenuItemInnerProps) {\n  const { menuItem, controller } = props;\n  const { title, ...rest } = menuItem;\n\n  const isDisabled = !canSetMark(controller);\n  const letterSpacing = controller.query('getLetterSpacing') as number;\n\n  const handleMinusClick = () => {\n    const spacing = letterSpacing - STEP;\n    if (spacing < MIN) return;\n    controller.run('onAction', setLetterSpacing(spacing));\n  };\n\n  const handlePlusClick = () => {\n    const spacing = letterSpacing + STEP;\n    if (spacing > MAX) return;\n    controller.run('onAction', setLetterSpacing(spacing));\n  };\n\n  return (\n    <SubMenu {...rest} title={title} disabled={isDisabled}>\n      <SpacingSet>\n        <Button\n          icon={<MinusBetaNormal />}\n          style={commonButtonStyle}\n          bordered={false}\n          onClick={handleMinusClick}\n          role={PluginRoles.letterSpacingMinus}\n        />\n        <SpacingValue>{letterSpacing}pt</SpacingValue>\n        <Button\n          icon={<PlusBetaNormal />}\n          style={commonButtonStyle}\n          bordered={false}\n          onClick={handlePlusClick}\n          role={PluginRoles.letterSpacingPlus}\n        />\n      </SpacingSet>\n    </SubMenu>\n  );\n}\n"],"file":"letterSpacingMenu.js"}