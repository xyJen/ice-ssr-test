import { domUtils } from '@ali/4ever-cangjie';
var TOP_SPACE = 100;
var OFFSET = 10;
/**
 * 获取屏幕顶部的 selection，聚焦的时候避免滚动
 */

export function getScreenSelection(controller) {
  var key = controller.value.document.key;
  var docNode = domUtils.findDOMNodeSafely(key);

  if (!docNode) {
    return null;
  }

  var _docNode$getBoundingC = docNode.getBoundingClientRect(),
      left = _docNode$getBoundingC.left,
      top = _docNode$getBoundingC.top,
      bottom = _docNode$getBoundingC.bottom;

  var clientX = left + OFFSET;
  var clientY = TOP_SPACE;

  if (top > TOP_SPACE) {
    clientY = top + OFFSET;
  } else if (bottom < TOP_SPACE) {
    clientY = bottom - OFFSET;
  }

  var hitedTarget = window.document.elementFromPoint(clientX, clientY);

  if (!hitedTarget) {
    return null;
  }

  return domUtils.caretRangeFromTargetAndCoord(hitedTarget, clientX, clientY, controller);
}
//# sourceMappingURL=getScreenSelection.js.map