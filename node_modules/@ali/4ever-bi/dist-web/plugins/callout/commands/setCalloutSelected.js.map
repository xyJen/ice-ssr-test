{"version":3,"sources":["../../../../../src/plugins/callout/commands/setCalloutSelected.ts"],"names":["Commands","setCalloutSelected","controller","block","selection","value","command","moveAnchorToEndOfNode","moveFocusToEndOfNode","setData","data","selectedCallout","key","focus"],"mappings":";AAAA,SAAqBA,QAArB,QAA4C,oBAA5C;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,SAASC,kBAAT,CACLC,UADK,EAELC,KAFK,EAGL;AAAA,MACQC,SADR,GACsBF,UAAU,CAACG,KADjC,CACQD,SADR;;AAEA,MAAIA,SAAJ,EAAe;AACbF,IAAAA,UAAU,CACPI,OADH,CACWN,QAAQ,CAACO,qBADpB,EAC2CJ,KAD3C,EAEGG,OAFH,CAEWN,QAAQ,CAACQ,oBAFpB,EAE0CL,KAF1C;AAGD;;AAEDD,EAAAA,UAAU,CAACO,OAAX,cACKP,UAAU,CAACG,KAAX,CAAiBK,IADtB;AAEE;AACA;AACAC,IAAAA,eAAe,EAAER,KAAK,CAACS;AAJzB;AAMA,SAAOV,UAAU,CAACI,OAAX,CAAmBN,QAAQ,CAACa,KAA5B,CAAP;AACD","sourcesContent":["import { Controller, Commands, Block } from '@ali/4ever-cangjie';\n/**\n * block 为高亮块中最后一个段落\n * 高亮块整体选中时，会选中高亮块最后一个段落后方，并视觉上隐藏光标\n * 同时将 controller.value.data.selectedCallout 置为 true\n */\nexport function setCalloutSelected(\n  controller: Controller,\n  block: Block,\n) {\n  const { selection } = controller.value;\n  if (selection) {\n    controller\n      .command(Commands.moveAnchorToEndOfNode, block)\n      .command(Commands.moveFocusToEndOfNode, block);\n  }\n\n  controller.setData({\n    ...controller.value.data,\n    // 存 view 数据不太合理，改存最后一个 callout 段落的 key\n    // 展示判定时，只要命中 group 中任何一个 key，就算命中\n    selectedCallout: block.key,\n  });\n  return controller.command(Commands.focus);\n}\n"],"file":"setCalloutSelected.js"}