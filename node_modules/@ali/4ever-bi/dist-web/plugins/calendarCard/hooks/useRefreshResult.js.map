{"version":3,"sources":["../../../../../src/plugins/calendarCard/hooks/useRefreshResult.tsx"],"names":["React","useRef","useMemo","useState","useCallback","useEffect","RoundcloseThickNormal","theme","CalendarCardPlugin","ERROR_TIPS_TIMEOUT","RefreshTipsTextWrapper","useRefreshResult","result","setResult","tipsNode","status","message","color","errorColor","marginRight","timeoutRef","setRefreshResult","res","current","window","setTimeout","clearTimeout","refreshTipsNode"],"mappings":"AAAA,OAAOA,KAAP,IAAgBC,MAAhB,EAAwBC,OAAxB,EAAiCC,QAAjC,EAA2CC,WAA3C,EAAwDC,SAAxD,QAAyE,OAAzE;qBAC4B,a;AAA5B,SAASC,qBAAT,EAAgCC,KAAhC,QAA6C,gBAA7C;AACA,SAASC,kBAAT,QAAmC,mBAAnC;AAGA,IAAMC,kBAAkB,GAAG,IAA3B;IAEQC,sB,GAA2BF,kB,CAA3BE,sB;;AAER,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;AAAA,kBACDR,QAAQ,CAAwB,IAAxB,CADP;AAAA,MACtBS,MADsB;AAAA,MACdC,SADc;;AAG7B,MAAMC,QAAQ,GAAGZ,OAAO,CAAC,YAAM;AAC7B,QAAI,CAACU,MAAL,EAAa,OAAO,IAAP;AADgB,QAErBG,MAFqB,GAEDH,MAFC,CAErBG,MAFqB;AAAA,QAEbC,OAFa,GAEDJ,MAFC,CAEbI,OAFa;AAG7B,QAAID,MAAM,KAAK,SAAf,EAA0B,OAAO,IAAP;AAC1B,wBACE,kDACE,eAAC,qBAAD;AAAuB,MAAA,KAAK,EAAE;AAAEE,QAAAA,KAAK,EAAEV,KAAK,CAACW,UAAf;AAA2BC,QAAAA,WAAW,EAAE;AAAxC;AAA9B,MADF,eAEE,eAAC,sBAAD,QAAyBH,OAAzB,CAFF,CADF;AAMD,GAVuB,EAUrB,CAACJ,MAAD,CAVqB,CAAxB;AAYA,MAAMQ,UAAU,GAAGnB,MAAM,EAAzB;AAEA,MAAMoB,gBAAgB,GAAGjB,WAAW,CAAC,UAACkB,GAAD,EAAyB;AAC5DT,IAAAA,SAAS,CAACS,GAAD,CAAT,CAD4D,CAE5D;;AACAF,IAAAA,UAAU,CAACG,OAAX,GAAqBC,MAAM,CAACC,UAAP,CAAkB,YAAM;AAC3CZ,MAAAA,SAAS,CAAC,IAAD,CAAT;AACAO,MAAAA,UAAU,CAACG,OAAX,GAAqB,IAArB;AACD,KAHoB,EAGlBd,kBAHkB,CAArB;AAID,GAPmC,EAOjC,CAACI,SAAD,CAPiC,CAApC;AASAR,EAAAA,SAAS,CAAC,YAAM;AACd,WAAO,YAAM;AACX,UAAIe,UAAU,CAACG,OAAf,EAAwBG,YAAY,CAACN,UAAU,CAACG,OAAZ,CAAZ;AACzB,KAFD;AAGD,GAJQ,EAIN,EAJM,CAAT;AAKA,SAAO;AAAEI,IAAAA,eAAe,EAAEb,QAAnB;AAA6BO,IAAAA,gBAAgB,EAAhBA;AAA7B,GAAP;AACD,CAhCD;;AAkCA,eAAeV,gBAAf","sourcesContent":["import React, { useRef, useMemo, useState, useCallback, useEffect } from 'react';\nimport { RoundcloseThickNormal, theme } from '@ali/we-design';\nimport { CalendarCardPlugin } from '@ali/4ever-bamboo';\nimport { RefreshReponse } from '../types';\n\nconst ERROR_TIPS_TIMEOUT = 5000;\n\nconst { RefreshTipsTextWrapper } = CalendarCardPlugin;\n\nconst useRefreshResult = () => {\n  const [result, setResult] = useState<RefreshReponse | null>(null);\n\n  const tipsNode = useMemo(() => {\n    if (!result) return null;\n    const { status, message } = result;\n    if (status === 'success') return null;\n    return (\n      <>\n        <RoundcloseThickNormal style={{ color: theme.errorColor, marginRight: '3px' }} />\n        <RefreshTipsTextWrapper>{message}</RefreshTipsTextWrapper>\n      </>\n    );\n  }, [result]);\n\n  const timeoutRef = useRef<number | null>();\n\n  const setRefreshResult = useCallback((res: RefreshReponse) => {\n    setResult(res);\n    // 5s 后错误 tips 消失\n    timeoutRef.current = window.setTimeout(() => {\n      setResult(null);\n      timeoutRef.current = null;\n    }, ERROR_TIPS_TIMEOUT);\n  }, [setResult]);\n\n  useEffect(() => {\n    return () => {\n      if (timeoutRef.current) clearTimeout(timeoutRef.current);\n    };\n  }, []);\n  return { refreshTipsNode: tipsNode, setRefreshResult };\n};\n\nexport default useRefreshResult;\n"],"file":"useRefreshResult.js"}