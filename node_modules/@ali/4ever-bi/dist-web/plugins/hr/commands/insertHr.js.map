{"version":3,"sources":["../../../../../src/plugins/hr/commands/insertHr.ts"],"names":["Commands","generateKey","updateHr","DEFAULT_HR_COLOR","shouldDeleteParagraph","controller","payload","value","focusBlock","type","color","sz","hrColor","command","insertBlock","data","width","id","removeNodeByKey","key"],"mappings":"AAAA,SAAqBA,QAArB,QAAqC,oBAArC;AAEA,SAASC,WAAT,QAA2B,kBAA3B;AACA,OAAOC,QAAP;AACA,SAASC,gBAAT;AACA,SAASC,qBAAT;AAEA,gBAAe,UAACC,UAAD,EAAyBC,OAAzB,EAAkD;AAAA,MAAzBA,OAAyB;AAAzBA,IAAAA,OAAyB,GAAP,EAAO;AAAA;;AAAA,MACvDC,KADuD,GAC7CF,UAD6C,CACvDE,KADuD;AAAA,MAEvDC,UAFuD,GAExCD,KAFwC,CAEvDC,UAFuD;;AAG/D,MAAI,CAAAA,UAAU,QAAV,YAAAA,UAAU,CAAEC,IAAZ,MAAqB,IAAzB,EAA+B;AAC7B,WAAOP,QAAQ,CAACG,UAAD,EAAaG,UAAb,EAAyBF,OAAzB,CAAf;AACD;;AAL8D,iBAOnCA,OAPmC;AAAA,MAOvDI,KAPuD,YAOvDA,KAPuD;AAAA,MAOhDD,IAPgD,YAOhDA,IAPgD;AAAA,MAO1CE,EAP0C,YAO1CA,EAP0C;AAQ/D,MAAMC,OAAO,GAAGF,KAAH,WAAGA,KAAH,GAAYP,gBAAzB;AACAE,EAAAA,UAAU,CACPQ,OADH,CACWb,QAAQ,CAACc,WADpB,EACiC;AAC7BL,IAAAA,IAAI,EAAE,IADuB;AAE7BM,IAAAA,IAAI,EAAE;AACJL,MAAAA,KAAK,EAAEE,OADH;AAEJH,MAAAA,IAAI,EAAJA,IAFI;AAGJO,MAAAA,KAAK,EAAE,MAHH;AAGW;AACfL,MAAAA,EAAE,EAAEA,EAAE,IAAI,CAJN;AAIS;AACbM,MAAAA,EAAE,EAAEhB,WAAW;AALX;AAFuB,GADjC,EAWGY,OAXH,CAWWb,QAAQ,CAACc,WAXpB,EAWiC,WAXjC,EAT+D,CAqB/D;;AACA,MAAIV,qBAAqB,CAACI,UAAD,CAAzB,EAAuC;AACrCH,IAAAA,UAAU,CAACQ,OAAX,CAAmBb,QAAQ,CAACkB,eAA5B,EAA6CV,UAAU,CAACW,GAAxD;AACD;;AAED,SAAOd,UAAP;AACD,CA3BD","sourcesContent":["import { Controller, Commands } from '@ali/4ever-cangjie';\nimport { HrData } from '@ali/4ever-mo';\nimport { generateKey} from '@ali/4ever-utils';\nimport updateHr from './updateHr';\nimport { DEFAULT_HR_COLOR } from '../constants';\nimport { shouldDeleteParagraph } from '../utils';\n\nexport default (controller: Controller, payload: HrData = {}) => {\n  const { value } = controller;\n  const { focusBlock } = value;\n  if (focusBlock?.type === 'hr') {\n    return updateHr(controller, focusBlock, payload);\n  }\n\n  const { color, type, sz } = payload;\n  const hrColor = color ?? DEFAULT_HR_COLOR;\n  controller\n    .command(Commands.insertBlock, {\n      type: 'hr',\n      data: {\n        color: hrColor,\n        type,\n        width: '100%', // 默认占满一行\n        sz: sz || 2, // size 默认为 2\n        id: generateKey(),\n      },\n    })\n    .command(Commands.insertBlock, 'paragraph');\n  // 插入前是空行则删除\n  if (shouldDeleteParagraph(focusBlock)) {\n    controller.command(Commands.removeNodeByKey, focusBlock.key);\n  }\n\n  return controller;\n};\n"],"file":"insertHr.js"}