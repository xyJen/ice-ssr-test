{"version":3,"sources":["../../../../../src/plugins/voteCard/handlers/createOnCangjieCopy.ts"],"names":["constants","transferUtils","logger","filterFragment","MIME_TYPES","createOnCangjieCopy","onCangjieCopyOrCut","event","_","next","clipboardData","encodedFragment","getData","FRAGMENT","fragment","decodeFragment","newFragment","setData","encodeFragment","error"],"mappings":"AAAA,SAAiBA,SAAjB,EAA4BC,aAA5B,QAAwE,oBAAxE;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,OAAOC,cAAP;IAEQC,U,GAAeJ,S,CAAfI,U;AAGR,eAAe,SAASC,mBAAT,GAAwD;AACrE,SAAO,SAASC,kBAAT,CAA4BC,KAA5B,EAA0DC,CAA1D,EAA6DC,IAA7D,EAAmE;AACxE,QAAI,CAACF,KAAK,CAACG,aAAX,EAA0B;AACxB,aAAOD,IAAI,EAAX;AACD;;AAED,QAAI;AACF,UAAME,eAAe,GAAGJ,KAAK,CAACG,aAAN,CAAoBE,OAApB,CAA4BR,UAAU,CAACS,QAAvC,CAAxB;AACA,UAAMC,QAAQ,GAAGb,aAAa,CAACc,cAAd,CAA6BJ,eAA7B,CAAjB;AAEA,UAAMK,WAAW,GAAGb,cAAc,CAACW,QAAD,CAAlC;AACAP,MAAAA,KAAK,CAACG,aAAN,CAAoBO,OAApB,CACEb,UAAU,CAACS,QADb,EAEEZ,aAAa,CAACiB,cAAd,CAA6BF,WAA7B,CAFF;AAID,KATD,CASE,OAAOG,KAAP,EAAc;AACdjB,MAAAA,MAAM,CAACiB,KAAP,CAAaA,KAAb;AACD;;AACD,WAAOV,IAAI,EAAX;AACD,GAlBD;AAmBD","sourcesContent":["import { Plugin, constants, transferUtils, CangjieClipboardEvent } from '@ali/4ever-cangjie';\nimport logger from '@ali/4ever-logger';\nimport filterFragment from '../util/filterFragment';\n\nconst { MIME_TYPES } = constants;\n\n\nexport default function createOnCangjieCopy(): Plugin['onCangjieCopy'] {\n  return function onCangjieCopyOrCut(event: CangjieClipboardEvent, _, next) {\n    if (!event.clipboardData) {\n      return next();\n    }\n\n    try {\n      const encodedFragment = event.clipboardData.getData(MIME_TYPES.FRAGMENT);\n      const fragment = transferUtils.decodeFragment(encodedFragment);\n\n      const newFragment = filterFragment(fragment);\n      event.clipboardData.setData(\n        MIME_TYPES.FRAGMENT,\n        transferUtils.encodeFragment(newFragment),\n      );\n    } catch (error) {\n      logger.error(error);\n    }\n    return next();\n  };\n}\n"],"file":"createOnCangjieCopy.js"}