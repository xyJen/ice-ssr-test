import { transferUtils, constants } from '@ali/4ever-cangjie';
import { deleteSubject, unselectSubject } from "../commands";
import { SELECTED_SUBJECT_KEY } from "../constants";
import { hasSubjectBeenSelected } from "../helpers";
import { getSubjectFragment } from "../queries";
import { isSubjectHeading } from "../utils";
var MIME_TYPES = constants.MIME_TYPES;

function createOnCangjieCut() {
  return function onCangjieCut(event, controller, next) {
    if (hasSubjectBeenSelected(controller)) {
      var _controller$value = controller.value,
          document = _controller$value.document,
          data = _controller$value.data;
      var selectedKey = data[SELECTED_SUBJECT_KEY];
      var block = document.getNode(selectedKey);

      if (isSubjectHeading(block) && event.clipboardData) {
        var fragment = controller.query(getSubjectFragment, block);
        event.clipboardData.setData(MIME_TYPES.FRAGMENT, transferUtils.encodeFragment(fragment));
        controller.command(deleteSubject, block).command(unselectSubject);
      }
    }

    return next();
  };
}

export default createOnCangjieCut;
//# sourceMappingURL=createOnCangjieCut.js.map