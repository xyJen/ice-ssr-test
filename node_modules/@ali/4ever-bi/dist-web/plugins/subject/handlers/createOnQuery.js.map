{"version":3,"sources":["../../../../../src/plugins/subject/handlers/createOnQuery.ts"],"names":["SzUtil","hasSubjectBeenSelected","isDisableNewLineGuide","isSubjectHeading","createOnQuery","onQuery","event","controller","next","type","args","node","document","value","startBlock","toPt"],"mappings":"AACA,SAASA,MAAT,QAAuB,mBAAvB;AACA,SAASC,sBAAT,EAAiCC,qBAAjC;AACA,SAASC,gBAAT;;AAEA,SAASC,aAAT,GAA4C;AAC1C,SAAO,SAASC,OAAT,CAAiBC,KAAjB,EAAwBC,UAAxB,EAAoCC,IAApC,EAA0C;AAAA,QACvCC,IADuC,GACxBH,KADwB,CACvCG,IADuC;AAAA,QACjCC,IADiC,GACxBJ,KADwB,CACjCI,IADiC,EAG/C;;AACA,QAAID,IAAI,KAAK,WAAb,EAA0B;AAAA,UAChBE,IADgB,GACPD,IAAI,CAAC,CAAD,CADG,CAChBC,IADgB;AAAA,UAEhBC,QAFgB,GAEHL,UAAU,CAACM,KAFR,CAEhBD,QAFgB;AAGxB,aAAO,CAAC,CAACD,IAAF,IAAUH,IAAI,EAAd,IAAoB,CAACN,qBAAqB,CAACS,IAAD,EAAOC,QAAP,CAAjD;AACD,KAR8C,CAU/C;;;AACA,QAAIH,IAAI,KAAK,SAAb,EAAwB;AAAA,UACdK,UADc,GACCP,UAAU,CAACM,KADZ,CACdC,UADc;;AAEtB,UAAIX,gBAAgB,CAACW,UAAD,CAApB,EAAkC;AAChC,eAAOd,MAAM,CAACe,IAAP,CAAY,EAAZ,EAAgB,IAAhB,CAAP;AACD;AACF,KAhB8C,CAkB/C;;;AACA,QAAIN,IAAI,KAAK,iBAAT,IAA8BR,sBAAsB,CAACM,UAAD,CAAxD,EAAsE;AACpE,aAAO,IAAP;AACD;;AAED,WAAOC,IAAI,EAAX;AACD,GAxBD;AAyBD;;AAED,eAAeJ,aAAf","sourcesContent":["import { Plugin } from '@ali/4ever-cangjie';\nimport { SzUtil } from '@ali/4ever-bamboo';\nimport { hasSubjectBeenSelected, isDisableNewLineGuide } from '../helpers';\nimport { isSubjectHeading } from '../utils';\n\nfunction createOnQuery(): Plugin['onQuery'] {\n  return function onQuery(event, controller, next) {\n    const { type, args } = event;\n\n    // 有 placeholder 展示则不显示 newLineGuide\n    if (type === 'isNewLine') {\n      const { node } = args[0];\n      const { document } = controller.value;\n      return !!node && next() && !isDisableNewLineGuide(node, document);\n    }\n\n    // 议题处读取 size 则默认 20px by @狗毛\n    if (type === 'getSize') {\n      const { startBlock } = controller.value;\n      if (isSubjectHeading(startBlock)) {\n        return SzUtil.toPt(20, 'px');\n      }\n    }\n\n    // 若议题组完全选中，则隐藏光标\n    if (type === 'isHideSelection' && hasSubjectBeenSelected(controller)) {\n      return true;\n    }\n\n    return next();\n  };\n}\n\nexport default createOnQuery;\n"],"file":"createOnQuery.js"}