{"version":3,"sources":["../../../../../src/plugins/subject/handlers/createOnCangjieCut.ts"],"names":["transferUtils","constants","deleteSubject","unselectSubject","SELECTED_SUBJECT_KEY","hasSubjectBeenSelected","getSubjectFragment","isSubjectHeading","MIME_TYPES","createOnCangjieCut","onCangjieCut","event","controller","next","value","document","data","selectedKey","block","getNode","clipboardData","fragment","query","setData","FRAGMENT","encodeFragment","command"],"mappings":"AAAA,SAAiBA,aAAjB,EAAgCC,SAAhC,QAAiD,oBAAjD;AACA,SAASC,aAAT,EAAwBC,eAAxB;AACA,SAASC,oBAAT;AACA,SAASC,sBAAT;AACA,SAASC,kBAAT;AACA,SAASC,gBAAT;IAGQC,U,GAAeP,S,CAAfO,U;;AAER,SAASC,kBAAT,GAAsD;AACpD,SAAO,SAASC,YAAT,CAAsBC,KAAtB,EAA6BC,UAA7B,EAAyCC,IAAzC,EAA+C;AACpD,QAAIR,sBAAsB,CAACO,UAAD,CAA1B,EAAwC;AAAA,8BACXA,UAAU,CAACE,KADA;AAAA,UAC9BC,QAD8B,qBAC9BA,QAD8B;AAAA,UACpBC,IADoB,qBACpBA,IADoB;AAAA,UAENC,WAFM,GAEUD,IAFV,CAE7BZ,oBAF6B;AAGtC,UAAMc,KAAK,GAAGH,QAAQ,CAACI,OAAT,CAAiBF,WAAjB,CAAd;;AACA,UAAIV,gBAAgB,CAACW,KAAD,CAAhB,IAA2BP,KAAK,CAACS,aAArC,EAAoD;AAClD,YAAMC,QAAQ,GAAGT,UAAU,CAACU,KAAX,CAAiBhB,kBAAjB,EAAqCY,KAArC,CAAjB;AACAP,QAAAA,KAAK,CAACS,aAAN,CAAoBG,OAApB,CAA4Bf,UAAU,CAACgB,QAAvC,EAAiDxB,aAAa,CAACyB,cAAd,CAA6BJ,QAA7B,CAAjD;AACAT,QAAAA,UAAU,CAACc,OAAX,CAAmBxB,aAAnB,EAAkCgB,KAAlC,EAAoDQ,OAApD,CAA4DvB,eAA5D;AACD;AACF;;AACD,WAAOU,IAAI,EAAX;AACD,GAZD;AAaD;;AAED,eAAeJ,kBAAf","sourcesContent":["import { Plugin, transferUtils, constants } from '@ali/4ever-cangjie';\nimport { deleteSubject, unselectSubject } from '../commands';\nimport { SELECTED_SUBJECT_KEY } from '../constants';\nimport { hasSubjectBeenSelected } from '../helpers';\nimport { getSubjectFragment } from '../queries';\nimport { isSubjectHeading } from '../utils';\nimport type { Subject } from '../utils';\n\nconst { MIME_TYPES } = constants;\n\nfunction createOnCangjieCut(): Plugin['onCangjieCut'] {\n  return function onCangjieCut(event, controller, next) {\n    if (hasSubjectBeenSelected(controller)) {\n      const { document, data } = controller.value;\n      const { [SELECTED_SUBJECT_KEY]: selectedKey } = data;\n      const block = document.getNode(selectedKey);\n      if (isSubjectHeading(block) && event.clipboardData) {\n        const fragment = controller.query(getSubjectFragment, block as Subject);\n        event.clipboardData.setData(MIME_TYPES.FRAGMENT, transferUtils.encodeFragment(fragment));\n        controller.command(deleteSubject, block as Subject).command(unselectSubject);\n      }\n    }\n    return next();\n  };\n}\n\nexport default createOnCangjieCut;\n"],"file":"createOnCangjieCut.js"}