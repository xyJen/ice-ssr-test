import { constants, transferUtils } from '@ali/4ever-cangjie';
import { SELECTED_SUBJECT_KEY } from "../constants";
import { hasSubjectBeenSelected } from "../helpers";
import { getSubjectFragment } from "../queries";
import { isSubjectHeading } from "../utils";
var MIME_TYPES = constants.MIME_TYPES;

function createOnCangjieCopy() {
  return function onCangjieCopy(event, controller, next) {
    if (hasSubjectBeenSelected(controller)) {
      var _controller$value = controller.value,
          document = _controller$value.document,
          data = _controller$value.data;
      var selectedKey = data[SELECTED_SUBJECT_KEY];
      var block = document.getNode(selectedKey);

      if (isSubjectHeading(block) && event.clipboardData) {
        var fragment = controller.query(getSubjectFragment, block);
        event.clipboardData.setData(MIME_TYPES.FRAGMENT, transferUtils.encodeFragment(fragment));
      }
    }

    return next();
  };
}

export default createOnCangjieCopy;
//# sourceMappingURL=createOnCangjieCopy.js.map