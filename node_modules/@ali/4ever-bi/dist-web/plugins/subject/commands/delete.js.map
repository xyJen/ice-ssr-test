{"version":3,"sources":["../../../../../src/plugins/subject/commands/delete.ts"],"names":["Commands","getSubjectEndBlock","deleteSubject","controller","subject","value","selection","document","endBlock","query","prevBlock","getPreviousBlock","key","sel","moveAnchorToEndOfNode","moveAnchorToStartOfNode","moveFocusToEndOfNode","command","select","del"],"mappings":"AAAA,SAASA,QAAT,QAAqC,oBAArC;AACA,SAASC,kBAAT;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,aAAT,CAAuBC,UAAvB,EAA+CC,OAA/C,EAAiE;AAAA,0BACtCD,UAAU,CAACE,KAD2B;AAAA,MAC9DC,SAD8D,qBAC9DA,SAD8D;AAAA,MACnDC,QADmD,qBACnDA,QADmD;AAEtE,MAAMC,QAAQ,GAAGL,UAAU,CAACM,KAAX,CAAiBR,kBAAjB,EAAqCG,OAArC,CAAjB;;AAEA,MAAI,CAACI,QAAL,EAAe;AACb,WAAOL,UAAP;AACD;;AAED,MAAMO,SAAS,GAAGH,QAAQ,CAACI,gBAAT,CAA0BP,OAAO,CAACQ,GAAlC,CAAlB,CARsE,CAUtE;;AACA,MAAIC,GAAG,GAAGH,SAAS,GACfJ,SAAS,CAACQ,qBAAV,CAAgCJ,SAAhC,EAA2CP,UAA3C,CADe,GAEfG,SAAS,CAACS,uBAAV,CAAkCX,OAAlC,EAA2CD,UAA3C,CAFJ,CAXsE,CAetE;;AACAU,EAAAA,GAAG,GAAGA,GAAG,CAACG,oBAAJ,CAAyBR,QAAzB,EAAmCL,UAAnC,CAAN;AAEA,SAAOA,UAAU,CAACc,OAAX,CAAmBjB,QAAQ,CAACkB,MAA5B,EAAoCL,GAApC,EAAyCI,OAAzC,CAAiDjB,QAAQ,CAACmB,GAA1D,CAAP;AACD","sourcesContent":["import { Commands, Controller } from '@ali/4ever-cangjie';\nimport { getSubjectEndBlock } from '../queries';\nimport { Subject } from '../utils';\n\n/**\n * 删除 Subject 组\n * @param controller\n * @param subject\n * @returns\n */\nexport function deleteSubject(controller: Controller, subject: Subject) {\n  const { selection, document } = controller.value;\n  const endBlock = controller.query(getSubjectEndBlock, subject);\n\n  if (!endBlock) {\n    return controller;\n  }\n\n  const prevBlock = document.getPreviousBlock(subject.key);\n\n  // 若存在上一个兄弟节点，则选中上一个节点的末尾\n  let sel = prevBlock\n    ? selection.moveAnchorToEndOfNode(prevBlock, controller)\n    : selection.moveAnchorToStartOfNode(subject, controller);\n\n  // 选中议题 end 节点的末尾\n  sel = sel.moveFocusToEndOfNode(endBlock, controller);\n\n  return controller.command(Commands.select, sel).command(Commands.del);\n}\n"],"file":"delete.js"}