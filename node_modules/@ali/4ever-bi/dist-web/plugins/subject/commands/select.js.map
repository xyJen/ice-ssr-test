{"version":3,"sources":["../../../../../src/plugins/subject/commands/select.ts"],"names":["Commands","SELECTED_SUBJECT_KEY","getSubjectEndBlock","selectSubject","controller","key","data","value","setData","unselectSubject","newData","selectSubjectRange","block","endBlock","query","command","moveAnchorToStartOfNode","moveFocusToEndOfNode"],"mappings":";AAAA,SAASA,QAAT,QAAqC,oBAArC;AACA,SAASC,oBAAT;AACA,SAASC,kBAAT;AAGA,OAAO,SAASC,aAAT,CAAuBC,UAAvB,EAA+CC,GAA/C,EAA4D;AAAA;;AAAA,MACzDC,IADyD,GAChDF,UAAU,CAACG,KADqC,CACzDD,IADyD;AAEjE,SAAOF,UAAU,CAACI,OAAX,cACFF,IADE,6BAEJL,oBAFI,IAEmBI,GAFnB,cAAP;AAID;AAED,OAAO,SAASI,eAAT,CAAyBL,UAAzB,EAAiD;AAAA,MAC9CE,IAD8C,GACrCF,UAAU,CAACG,KAD0B,CAC9CD,IAD8C;;AAEtD,MAAIL,oBAAoB,IAAIK,IAA5B,EAAkC;AAChC,QAAMI,OAAO,gBAAQJ,IAAR,CAAb;;AACA,WAAOI,OAAO,CAACT,oBAAD,CAAd;AACA,WAAOG,UAAU,CAACI,OAAX,CAAmBE,OAAnB,CAAP;AACD;;AACD,SAAON,UAAP;AACD;AAED,OAAO,SAASO,kBAAT,CAA4BP,UAA5B,EAAoDQ,KAApD,EAAoE;AACzE,MAAMC,QAAQ,GAAGT,UAAU,CAACU,KAAX,CAAiBZ,kBAAjB,EAAqCU,KAArC,CAAjB;;AAEA,MAAIC,QAAJ,EAAc;AACZ,WAAOT,UAAU,CACdW,OADI,CACIf,QAAQ,CAACgB,uBADb,EACsCJ,KADtC,EAEJG,OAFI,CAEIf,QAAQ,CAACiB,oBAFb,EAEmCJ,QAFnC,CAAP;AAGD;;AAED,SAAOT,UAAU,CACdW,OADI,CACIf,QAAQ,CAACgB,uBADb,EACsCJ,KADtC,EAEJG,OAFI,CAEIf,QAAQ,CAACiB,oBAFb,EAEmCL,KAFnC,CAAP;AAGD","sourcesContent":["import { Commands, Controller } from '@ali/4ever-cangjie';\nimport { SELECTED_SUBJECT_KEY } from '../constants';\nimport { getSubjectEndBlock } from '../queries';\nimport { Subject } from '../utils';\n\nexport function selectSubject(controller: Controller, key: string) {\n  const { data } = controller.value;\n  return controller.setData({\n    ...data,\n    [SELECTED_SUBJECT_KEY]: key,\n  });\n}\n\nexport function unselectSubject(controller: Controller) {\n  const { data } = controller.value;\n  if (SELECTED_SUBJECT_KEY in data) {\n    const newData = { ...data };\n    delete newData[SELECTED_SUBJECT_KEY];\n    return controller.setData(newData);\n  }\n  return controller;\n}\n\nexport function selectSubjectRange(controller: Controller, block: Subject) {\n  const endBlock = controller.query(getSubjectEndBlock, block);\n\n  if (endBlock) {\n    return controller\n      .command(Commands.moveAnchorToStartOfNode, block)\n      .command(Commands.moveFocusToEndOfNode, endBlock);\n  }\n\n  return controller\n    .command(Commands.moveAnchorToStartOfNode, block)\n    .command(Commands.moveFocusToEndOfNode, block);\n}\n"],"file":"select.js"}