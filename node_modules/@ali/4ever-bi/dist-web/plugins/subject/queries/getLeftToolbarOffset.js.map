{"version":3,"sources":["../../../../../src/plugins/subject/queries/getLeftToolbarOffset.ts"],"names":["SubjectPlugin","ColorBlocks","getSubjectStartBlock","queries","DRAGGABLE_WIDTH","blackList","node","controller","parent","value","document","getParent","key","isColorBlocks","getLeftToolbarOffset","data","subject","query","some","fn","x","y","undefined"],"mappings":"AACA,SAASA,aAAT,QAA8B,mBAA9B;AACA,SAASC,WAAT,QAA4B,eAA5B;IAEQC,oB,GAAyBF,aAAa,CAACG,O,CAAvCD,oB;AAER,IAAME,eAAe,GAAG,CAAC,EAAzB;AAEA,IAAMC,SAAS,GAAG,CAChB,UAACC,IAAD,EAAcC,UAAd,EAAyC;AACvC;AACA,MAAMC,MAAM,GAAGD,UAAU,CAACE,KAAX,CAAiBC,QAAjB,CAA0BC,SAA1B,CAAoCL,IAAI,CAACM,GAAzC,CAAf;AACA,SAAOX,WAAW,CAACY,aAAZ,CAA0BL,MAA1B,CAAP;AACD,CALe,CAAlB;AAQA,OAAO,SAASM,oBAAT,CAA+BP,UAA/B,EAAuDQ,IAAvD,EAA8E;AAAA,aAClEA,IAAI,IAAI,EAD0D;AAAA,MAC3ET,IAD2E,QAC3EA,IAD2E;;AAEnF,MAAMU,OAAO,GAAGT,UAAU,CAACU,KAAX,CAAiBf,oBAAjB,EAAuCI,IAAvC,CAAhB,CAFmF,CAGnF;AACA;;AACA,MAAI,CAAC,CAACU,OAAF,IAAa,CAACX,SAAS,CAACa,IAAV,CAAe,UAACC,EAAD;AAAA,WAAQA,EAAE,CAACb,IAAD,EAAOC,UAAP,CAAV;AAAA,GAAf,CAAlB,EAAgE;AAC9D,WAAO;AACLa,MAAAA,CAAC,EAAEhB,eADE;AAELiB,MAAAA,CAAC,EAAE;AAFE,KAAP;AAID;;AACD,SAAOC,SAAP;AACD","sourcesContent":["import { Controller, Block } from '@ali/4ever-cangjie';\nimport { SubjectPlugin } from '@ali/4ever-bamboo';\nimport { ColorBlocks } from '@ali/4ever-mo';\n\nconst { getSubjectStartBlock } = SubjectPlugin.queries;\n\nconst DRAGGABLE_WIDTH = -20;\n\nconst blackList = [\n  (node: Block, controller: Controller) => {\n    // 在高亮块中\n    const parent = controller.value.document.getParent(node.key);\n    return ColorBlocks.isColorBlocks(parent);\n  },\n]\n\nexport function getLeftToolbarOffset (controller: Controller, data: { node: Block }) {\n  const { node } = data || {};\n  const subject = controller.query(getSubjectStartBlock, node);\n  // 如果节点在议题里，那么段落拖动按钮需要加一个 offset\n  // 黑名单包含的节点会单独定义 offset\n  if (!!subject && !blackList.some((fn) => fn(node, controller))) {\n    return {\n      x: DRAGGABLE_WIDTH,\n      y: 0,\n    }\n  }\n  return undefined;\n}\n"],"file":"getLeftToolbarOffset.js"}