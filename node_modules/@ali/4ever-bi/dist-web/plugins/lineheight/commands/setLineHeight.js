import _extends from "@babel/runtime/helpers/extends";
import { Commands } from '@ali/4ever-cangjie';
import { Paragraph, Heading } from '@ali/4ever-mo';
import { isEqualWithDefault, getBlocksFromEditor } from '@ali/4ever-utils';
export default (function (controller, lineHeight, lineRule) {
  var selectedBlocks = getBlocksFromEditor(controller);

  if (!selectedBlocks.length) {
    return controller;
  }

  selectedBlocks.forEach(function (node) {
    // TODO 其他需要支持行高的 block 需要配置这里
    // 要保留spacing的其他设置，比如段落间距
    var _node$data$spacing = node.data.spacing,
        spacing = _node$data$spacing === void 0 ? {} : _node$data$spacing;
    var oldLineHeight = {
      line: spacing.line || 1,
      lineRule: spacing.lineRule || 'auto'
    };
    var newLineHeight = {
      line: lineHeight || 1,
      lineRule: lineRule || 'auto'
    };

    if (isEqualWithDefault(newLineHeight, oldLineHeight)) {
      return;
    }

    if (Paragraph.isParagraph(node) || Heading.isHeading(node)) {
      controller.command(Commands.setNodeByKey, node.key, {
        data: _extends({}, node.data, {
          spacing: _extends({}, spacing, newLineHeight)
        })
      });
    }
  });
  return controller;
});
//# sourceMappingURL=setLineHeight.js.map