import { Commands } from '@ali/4ever-cangjie';
import { getPreText, getNextText, shouldDeleteSiblingSpacing } from "../utils";
export default function onDelete(controller, next, isForward) {
  // 选中内容执行删除不进入空格清除流程
  if (controller.value.selection.isExpanded) return next();
  var deleted = isForward ? getNextText(controller).shift() : getPreText(controller).pop(); // 删除后判断是否需要清除空格

  next(); // 未删除内容提前结束

  if (!deleted) return;
  var preText = getPreText(controller);
  var nextText = getNextText(controller);
  if (!preText.length && !nextText.length) return;
  var preLastText = preText[preText.length - 1];
  var preSecondText = preText[preText.length - 2];
  var nextFirstText = nextText[0];
  var nextSecondText = nextText[1];

  var _shouldDeleteSiblingS = shouldDeleteSiblingSpacing(preSecondText, preLastText, nextFirstText, nextSecondText, deleted),
      shouldDeleteBefore = _shouldDeleteSiblingS[0],
      shouldDeleteAfter = _shouldDeleteSiblingS[1];

  if (shouldDeleteBefore) {
    controller.command(Commands.deleteBackward);
  }

  if (shouldDeleteAfter) {
    controller.command(Commands.deleteForward);
  }
}
//# sourceMappingURL=onDelete.js.map