{"version":3,"sources":["../../../../../src/plugins/autoSpacing/handlers/onDelete.ts"],"names":["Commands","getPreText","getNextText","shouldDeleteSiblingSpacing","onDelete","controller","next","isForward","value","selection","isExpanded","deleted","shift","pop","preText","nextText","length","preLastText","preSecondText","nextFirstText","nextSecondText","shouldDeleteBefore","shouldDeleteAfter","command","deleteBackward","deleteForward"],"mappings":"AAAA,SAEEA,QAFF,QAGO,oBAHP;AAIA,SACEC,UADF,EAEEC,WAFF,EAGEC,0BAHF;AAMA,eAAe,SAASC,QAAT,CACbC,UADa,EAEbC,IAFa,EAGbC,SAHa,EAIb;AACA;AACA,MAAGF,UAAU,CAACG,KAAX,CAAiBC,SAAjB,CAA2BC,UAA9B,EAA0C,OAAOJ,IAAI,EAAX;AAE1C,MAAMK,OAAO,GAAGJ,SAAS,GAAGL,WAAW,CAACG,UAAD,CAAX,CAAwBO,KAAxB,EAAH,GAAqCX,UAAU,CAACI,UAAD,CAAV,CAAuBQ,GAAvB,EAA9D,CAJA,CAMA;;AACAP,EAAAA,IAAI,GAPJ,CASA;;AACA,MAAI,CAACK,OAAL,EAAc;AAEd,MAAMG,OAAO,GAAGb,UAAU,CAACI,UAAD,CAA1B;AACA,MAAMU,QAAQ,GAAGb,WAAW,CAACG,UAAD,CAA5B;AACA,MAAI,CAACS,OAAO,CAACE,MAAT,IAAmB,CAACD,QAAQ,CAACC,MAAjC,EAAyC;AAEzC,MAAMC,WAAW,GAAGH,OAAO,CAACA,OAAO,CAACE,MAAR,GAAiB,CAAlB,CAA3B;AACA,MAAME,aAAa,GAAGJ,OAAO,CAACA,OAAO,CAACE,MAAR,GAAiB,CAAlB,CAA7B;AACA,MAAMG,aAAa,GAAGJ,QAAQ,CAAC,CAAD,CAA9B;AACA,MAAMK,cAAc,GAAGL,QAAQ,CAAC,CAAD,CAA/B;;AAnBA,8BAqBgDZ,0BAA0B,CAACe,aAAD,EAAgBD,WAAhB,EAA4BE,aAA5B,EAA2CC,cAA3C,EAA2DT,OAA3D,CArB1E;AAAA,MAqBOU,kBArBP;AAAA,MAqB2BC,iBArB3B;;AAsBA,MAAID,kBAAJ,EAAwB;AACtBhB,IAAAA,UAAU,CAACkB,OAAX,CAAmBvB,QAAQ,CAACwB,cAA5B;AACD;;AACD,MAAIF,iBAAJ,EAAuB;AACrBjB,IAAAA,UAAU,CAACkB,OAAX,CAAmBvB,QAAQ,CAACyB,aAA5B;AACD;AACF","sourcesContent":["import { \n  Controller, \n  Commands,\n} from '@ali/4ever-cangjie';\nimport { \n  getPreText,\n  getNextText,\n  shouldDeleteSiblingSpacing,\n} from '../utils';\n\nexport default function onDelete(\n  controller: Controller,\n  next: Function,\n  isForward?: boolean,\n) {\n  // 选中内容执行删除不进入空格清除流程\n  if(controller.value.selection.isExpanded) return next();\n\n  const deleted = isForward ? getNextText(controller).shift() : getPreText(controller).pop();\n  \n  // 删除后判断是否需要清除空格\n  next();\n  \n  // 未删除内容提前结束\n  if (!deleted) return;\n\n  const preText = getPreText(controller);\n  const nextText = getNextText(controller);\n  if (!preText.length && !nextText.length) return;\n\n  const preLastText = preText[preText.length - 1];\n  const preSecondText = preText[preText.length - 2];\n  const nextFirstText = nextText[0];\n  const nextSecondText = nextText[1];\n\n  const [shouldDeleteBefore, shouldDeleteAfter] = shouldDeleteSiblingSpacing(preSecondText, preLastText,nextFirstText, nextSecondText, deleted);\n  if (shouldDeleteBefore) {\n    controller.command(Commands.deleteBackward);\n  }\n  if (shouldDeleteAfter) {\n    controller.command(Commands.deleteForward);\n  }\n}\n"],"file":"onDelete.js"}