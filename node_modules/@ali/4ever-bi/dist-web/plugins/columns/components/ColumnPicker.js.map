{"version":3,"sources":["../../../../../src/plugins/columns/components/ColumnPicker.tsx"],"names":["React","useMemo","useEffect","isKeyHotkey","ColumnsPickerWrapper","ColumnItem","ColumnTitle","isArrowRightHotKey","isArrowLeftHotKey","MAX_COLUMN_COUNT","ColumnsPicker","props","activeCount","columnText","onChange","columnItems","items","i","className","onMouseEnter","push","handleKeyDown","event","count","Math","min","max","stopPropagation","document","addEventListener","removeEventListener"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,OAAhB,EAAyBC,SAAzB,QAA0C,OAA1C;qBAC4B,a;AAA5B,SAASC,WAAT,QAA4B,WAA5B;AACA,SAASC,oBAAT,EAA+BC,UAA/B,EAA2CC,WAA3C;AAEA,IAAMC,kBAAkB,GAAGJ,WAAW,CAAC,OAAD,CAAtC;AACA,IAAMK,iBAAiB,GAAGL,WAAW,CAAC,MAAD,CAArC;AACA,IAAMM,gBAAgB,GAAG,CAAzB;;AAQA,IAAMC,aAAsC,GAAG,SAAzCA,aAAyC,CAACC,KAAD,EAAW;AAAA,MAChDC,WADgD,GACVD,KADU,CAChDC,WADgD;AAAA,MACnCC,UADmC,GACVF,KADU,CACnCE,UADmC;AAAA,MACvBC,QADuB,GACVH,KADU,CACvBG,QADuB;AAGxD,MAAMC,WAAW,GAAGd,OAAO,CAAC,YAAM;AAChC,QAAMe,KAA2B,GAAG,EAApC;;AADgC,+BAEvBC,CAFuB;AAG9B,UAAMN,KAAK,GAAG;AACZO,QAAAA,SAAS,EAAED,CAAC,IAAIL,WAAW,GAAG,CAAnB,GAAuB,QAAvB,GAAkC,EADjC;AAEZO,QAAAA,YAAY,EAAE;AAAA,iBAAML,QAAQ,CAACG,CAAC,GAAG,CAAL,CAAd;AAAA;AAFF,OAAd;AAIAD,MAAAA,KAAK,CAACI,IAAN,eAAW,eAAC,UAAD,eAAgBT,KAAhB;AAAuB,QAAA,GAAG,EAAEM,CAA5B;AAA+B,kCAAqBA,CAAC,GAAG,CAAzB;AAA/B,SAAX;AAP8B;;AAEhC,SAAK,IAAIA,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGR,gBAApB,EAAsCQ,CAAC,EAAvC,EAA2C;AAAA,YAAlCA,CAAkC;AAM1C;;AACD,WAAOD,KAAP;AACD,GAV0B,EAUxB,CAACJ,WAAD,CAVwB,CAA3B;AAYAV,EAAAA,SAAS,CAAC,YAAM;AACd,QAAMmB,aAAa,GAAG,SAAhBA,aAAgB,CAACC,KAAD,EAAW;AAC/B,UAAIf,kBAAkB,CAACe,KAAD,CAAtB,EAA+B;AAC7BR,QAAAA,QAAQ,CAAC,UAACS,KAAD;AAAA,iBAAWC,IAAI,CAACC,GAAL,CAASF,KAAK,GAAG,CAAjB,EAAoBd,gBAApB,CAAX;AAAA,SAAD,CAAR;AACD,OAFD,MAEO,IAAID,iBAAiB,CAACc,KAAD,CAArB,EAA8B;AACnCR,QAAAA,QAAQ,CAAC,UAACS,KAAD;AAAA,iBAAWC,IAAI,CAACE,GAAL,CAASH,KAAK,GAAG,CAAjB,EAAoB,CAApB,CAAX;AAAA,SAAD,CAAR,CADmC,CAEnC;;AACAD,QAAAA,KAAK,CAACK,eAAN;AACD;AACF,KARD;;AASAC,IAAAA,QAAQ,CAACC,gBAAT,CAA0B,SAA1B,EAAqCR,aAArC,EAAoD,IAApD;AACA,WAAO,YAAM;AACXO,MAAAA,QAAQ,CAACE,mBAAT,CAA6B,SAA7B,EAAwCT,aAAxC,EAAuD,IAAvD;AACD,KAFD;AAGD,GAdQ,EAcN,EAdM,CAAT;AAiBA,sBACE,kDACE,eAAC,WAAD,QAAcT,WAAd,OAA4BC,UAA5B,CADF,eAEE,eAAC,oBAAD,QAAuBE,WAAvB,CAFF,CADF;AAMD,CAtCD;;AAwCA,eAAeL,aAAf","sourcesContent":["import React, { useMemo, useEffect } from 'react';\nimport { isKeyHotkey } from 'is-hotkey';\nimport { ColumnsPickerWrapper, ColumnItem, ColumnTitle } from './styled';\n\nconst isArrowRightHotKey = isKeyHotkey('right');\nconst isArrowLeftHotKey = isKeyHotkey('left');\nconst MAX_COLUMN_COUNT = 5;\n\ninterface IColumnsProps {\n  activeCount: number;\n  columnText: string;\n  onChange: React.Dispatch<React.SetStateAction<number>>;\n}\n\nconst ColumnsPicker: React.FC<IColumnsProps> = (props) => {\n  const { activeCount, columnText, onChange } = props;\n\n  const columnItems = useMemo(() => {\n    const items: React.ReactElement[] = [];\n    for (let i = 0; i < MAX_COLUMN_COUNT; i++) {\n      const props = {\n        className: i <= activeCount - 1 ? 'active' : '',\n        onMouseEnter: () => onChange(i + 1),\n      };\n      items.push(<ColumnItem {...props} key={i} data-role={`columns${i + 1}`}/>);\n    }\n    return items;\n  }, [activeCount]);\n\n  useEffect(() => {\n    const handleKeyDown = (event) => {\n      if (isArrowRightHotKey(event)) {\n        onChange((count) => Math.min(count + 1, MAX_COLUMN_COUNT));\n      } else if (isArrowLeftHotKey(event)) {\n        onChange((count) => Math.max(count - 1, 1));\n        // 防止回退到上一级 menu 菜单\n        event.stopPropagation();\n      }\n    };\n    document.addEventListener('keydown', handleKeyDown, true);\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown, true);\n    }\n  }, []);\n\n\n  return (\n    <>\n      <ColumnTitle>{activeCount} {columnText}</ColumnTitle>\n      <ColumnsPickerWrapper>{columnItems}</ColumnsPickerWrapper>\n    </>\n  );\n};\n\nexport default ColumnsPicker;\n"],"file":"ColumnPicker.js"}