import _extends from "@babel/runtime/helpers/extends";
import { Commands, Selection } from '@ali/4ever-cangjie';
import { TableCell } from '@ali/4ever-mo';
export default function setColumnsItemData(controller, key, data) {
  var node = controller.value.document.getNode(key);

  if (!TableCell.isTableCell(node)) {
    return controller;
  }

  if (typeof (data == null ? void 0 : data.color) === 'string') {
    var _controller$value = controller.value,
        range = _controller$value.selection,
        document = _controller$value.document;
    var selection = Selection.create(range.moveToRangeOfNode(node, controller).convertToTextPoints(document));
    controller.command(Commands.select, selection);
    controller.dispatch('setColor', data == null ? void 0 : data.color);
    controller.command(Commands.moveToStart);
  }

  var dataParams = data || {};

  var newData = _extends({}, node.data, dataParams);

  return controller.command(Commands.setNodeByKey, key, {
    data: newData
  });
}
//# sourceMappingURL=setColumnsItemData.js.map