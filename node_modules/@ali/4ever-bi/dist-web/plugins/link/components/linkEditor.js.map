{"version":3,"sources":["../../../../../src/plugins/link/components/linkEditor.tsx"],"names":["React","Radio","RadioGroup","theme","ToolbarDeleteLinkNormal","ItemInput","SaveButton","RemoveButton","EditorWrapper","EditorContent","EditorFooter","RadioWrapper","ItemRadio","ThemeProvider","focusLinkEditor","hideLinkEditor","hideLinkEditorAndMoveToNextText","useOnClickOutside","isJustCreated","setJustCreated","stopPropagation","event","isLinkDisplayType","value","LinkEditor","forwardRef","props","ref","nodeKey","propsHref","href","propsText","text","displayType","propsDisplayType","locale","controller","onSave","onUnlink","onHide","onClickoutside","enableCard","showPlaceholder","textInput","textInputRef","hrefInput","hrefInputRef","useState","setHref","setText","setDisplayType","inputFocused","useRef","useEffect","dataPackKey","split","current","focus","hide","useCallback","run","save","trimedText","trim","trimedHref","length","handleKeyDown","key","toLowerCase","nativeEvent","isComposing","keyCode","preventDefault","handleHrefChange","e","target","handleTextChange","handleSave","handleUnlink","handleFocus","handleBlur","handleClick","handleRadioClick","saveButtonDisbaled","useMemo","unchanged","editText","editTextPlaceholder","editHref","editHrefPlaceholder","editStyle","ui","padding","link","editStyleCard","marginRight","unlink","memo"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Radio, RadioGroup, theme, ToolbarDeleteLinkNormal } from '@ali/we-design';\nimport { Controller } from '@ali/4ever-cangjie';\nimport {\n  ItemInput,\n  SaveButton,\n  RemoveButton,\n  EditorWrapper,\n  EditorContent,\n  EditorFooter,\n  RadioWrapper,\n  ItemRadio,\n} from './styled';\nimport { ThemeProvider } from 'styled-components';\n\nimport { LinkPluginConfig, LinkDisplayType } from '../types';\nimport { focusLinkEditor, hideLinkEditor, hideLinkEditorAndMoveToNextText } from '../actions';\nimport { useOnClickOutside } from '@ali/4ever-component';\nimport { isJustCreated, setJustCreated } from '../utils/linkStore';\n\nfunction stopPropagation(event) {\n  event.stopPropagation();\n}\n\nconst isLinkDisplayType = (value: string): value is LinkDisplayType => {\n  return value === 'link' || value === 'card';\n};\n\ninterface LinkEditorProps {\n  nodeKey?: string;\n  href: string;\n  text: string;\n  displayType?: LinkDisplayType;\n  textInputRef?: React.RefObject<HTMLInputElement>;\n  hrefInputRef?: React.RefObject<HTMLInputElement>;\n  controller: Controller;\n  locale: LinkPluginConfig['locale'];\n  onHide: () => void;\n  onSave: (text: string, href: string, displayType: LinkDisplayType) => void;\n  onRemove: () => void;\n  onUnlink: () => void;\n  onClickoutside: (event: MouseEvent) => void;\n  // 仅将 text 作为 placeholder 显示\n  showPlaceholder?: boolean;\n  // todo 全量后下线配置\n  enableCard: boolean;\n}\n\nconst LinkEditor = React.forwardRef<HTMLDivElement, LinkEditorProps>(\n  (props, ref) => {\n    const {\n      nodeKey,\n      href: propsHref,\n      text: propsText,\n      displayType: propsDisplayType = 'link',\n      locale,\n      controller,\n      onSave,\n      onUnlink,\n      onHide,\n      onClickoutside,\n      enableCard,\n      showPlaceholder,\n      textInputRef: textInput,\n      hrefInputRef: hrefInput,\n    } = props;\n\n    const [href, setHref] = React.useState(propsHref);\n    const [text, setText] = React.useState(propsText);\n    const [displayType, setDisplayType] = React.useState<LinkDisplayType>(propsDisplayType);\n\n    const inputFocused = React.useRef(false);\n\n    React.useEffect(() => {\n      if (propsHref) return;\n      if (!nodeKey) return; // pureLink\n      // 这个地方 node 的 key 可能会是 viewPack 的 key\n      // 在调用 setJustCreated 的地方使用的 dataPack 中的 key\n      // 因此取一下 dataPack 的 key\n      const dataPackKey = nodeKey.split('-')[0];\n      if (!isJustCreated(dataPackKey)) return;\n      setJustCreated(dataPackKey, false);\n      // 如果是占位符，直接 focus 标题输入框\n      if (showPlaceholder && textInput?.current) {\n        textInput.current.focus();\n        return;\n      }\n      if (hrefInput?.current) hrefInput.current.focus();\n    }, [propsHref, nodeKey, showPlaceholder]);\n    useOnClickOutside(ref as React.RefObject<HTMLDivElement>, onClickoutside);\n\n    React.useEffect(() => {\n      setText(propsText);\n      setHref(propsHref);\n    }, [propsText, propsHref]);\n\n    const hide = React.useCallback(() => {\n      onHide();\n      if (showPlaceholder) {\n        // 如果是占位符点击出现的编辑框，使用 esc 退出时，将光标移动到占位符外部\n        controller.run('onAction', hideLinkEditorAndMoveToNextText());\n      } else {\n        controller.run('onAction', hideLinkEditor());\n      }\n    }, [controller, onHide, showPlaceholder]);\n\n    const save = React.useCallback(() => {\n      const trimedText = text.trim();\n      const trimedHref = href.trim();\n\n      if (trimedText.length || trimedHref.length) {\n        onSave(trimedText, trimedHref, displayType || propsDisplayType);\n      }\n      onHide();\n    }, [text, href, displayType, propsDisplayType, onSave, onHide]);\n\n    const handleKeyDown = React.useCallback((event: React.KeyboardEvent) => {\n      if (!event.key) {\n        return;\n      }\n\n      // 防止 keydown 透出到编辑器\n      event.stopPropagation();\n\n      const key = event.key.toLowerCase();\n      // React event 没有这个属性，要到原生 event 上取\n      // https://github.com/facebook/react/issues/13104\n      if (event.nativeEvent.isComposing) {\n        return;\n      }\n      if (key.toLowerCase() === 'escape' || event.keyCode === 27) {\n        event.preventDefault();\n        // ESC 退出\n        hide();\n      } else if (\n        (key === 'enter' || event.keyCode === 13) &&\n        inputFocused.current\n      ) {\n        // Enter 保存\n        event.preventDefault();\n        save();\n      }\n    }, [hide, save]);\n\n    const handleHrefChange = React.useCallback(\n      (e: React.ChangeEvent<HTMLInputElement>) => {\n        setHref(e.target.value);\n      },\n      [],\n    );\n\n    const handleTextChange = React.useCallback(\n      (e: React.ChangeEvent<HTMLInputElement>) => {\n        setText(e.target.value);\n      },\n      [],\n    );\n\n    const handleSave = React.useCallback(\n      (event: React.MouseEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n        save();\n      },\n      [save],\n    );\n\n    const handleUnlink = React.useCallback(\n      (event: React.MouseEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n        onUnlink();\n      },\n      [onUnlink],\n    );\n\n    const handleFocus = React.useCallback(\n      (event: React.FocusEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n        inputFocused.current = true;\n        controller.run('onAction', focusLinkEditor());\n      },\n      [controller],\n    );\n\n    const handleBlur = React.useCallback(() => {\n      inputFocused.current = false;\n    }, []);\n\n    const handleClick = React.useCallback((event: React.MouseEvent) => event.stopPropagation(), []);\n\n    const handleRadioClick = React.useCallback(\n      (e: string) => {\n        if (isLinkDisplayType(e)) {\n          setDisplayType(e);\n        }\n      }, [],\n    );\n\n    const saveButtonDisbaled = React.useMemo(() => {\n      const trimedHref = href.trim();\n      const trimedText = text.trim();\n      const unchanged = trimedHref === propsHref.trim()\n        && trimedText === propsText.trim()\n        && propsDisplayType === displayType;\n      // 当「链接」无内容或者未编辑时，不允许保存\n      return trimedHref.length === 0 || unchanged;\n    }, [href, text, displayType, propsHref, propsText, propsDisplayType]);\n\n    return (\n      <EditorWrapper onClick={handleClick} data-testid=\"link-editor\" ref={ref} onKeyDown={handleKeyDown}>\n        <EditorContent>\n          <ItemInput>\n            <label htmlFor=\"text\">{locale.editText}</label>\n            <input\n              name=\"text\"\n              type=\"text\"\n              value={text}\n              ref={textInput}\n              placeholder={locale.editTextPlaceholder}\n              onBlur={handleBlur}\n              onChange={handleTextChange}\n              onFocus={handleFocus}\n              onMouseDown={stopPropagation}\n              autoComplete=\"off\"\n              data-testid=\"link-editor-input-text\"\n            />\n          </ItemInput>\n          <ItemInput>\n            <label htmlFor=\"href\">{locale.editHref}</label>\n            <input\n              name=\"href\"\n              type=\"text\"\n              value={href}\n              ref={hrefInput}\n              placeholder={locale.editHrefPlaceholder}\n              onBlur={handleBlur}\n              onChange={handleHrefChange}\n              onFocus={handleFocus}\n              onMouseDown={stopPropagation}\n              autoComplete=\"off\"\n              data-testid=\"link-editor-input-href\"\n            />\n          </ItemInput>\n          {\n            enableCard &&\n            <ItemRadio>\n              <label htmlFor=\"displayType\">{locale.editStyle}</label>\n              <RadioWrapper>\n                <RadioGroup onChange={handleRadioClick} value={displayType} >\n                  <ThemeProvider theme={{ ui: { ...theme, padding: '8px' } }}>\n                    <Radio value=\"link\">\n                      {locale.link}\n                    </Radio>\n                    <Radio value=\"card\">\n                      {locale.editStyleCard}\n                    </Radio>\n                  </ThemeProvider>\n                </RadioGroup>\n              </RadioWrapper>\n            </ItemRadio>\n          }\n        </EditorContent>\n        <EditorFooter>\n          <RemoveButton\n            onMouseDown={handleUnlink}\n            data-testid=\"link-editor-unlink\"\n          >\n            <ToolbarDeleteLinkNormal style={{ marginRight: 4 }} />\n            <span className=\"text\">{locale.unlink}</span>\n          </RemoveButton>\n          <SaveButton\n            type={'primary'}\n            onMouseDown={handleSave}\n            testid=\"link-editor-save\"\n            disabled={saveButtonDisbaled}>\n            <span className=\"text\">{locale.save}</span>\n          </SaveButton>\n        </EditorFooter>\n      </EditorWrapper>\n    );\n  },\n);\n\nexport default React.memo(LinkEditor);\n"],"file":"linkEditor.js"}