{"version":3,"sources":["../../../../../src/plugins/link/commands/updatePureLink.ts"],"names":["Commands","Text","Selection","TextPoint","removePureLink","updatePureLink","controller","node","offset","text","href","srcHref","nodeText","length","point","create","key","selection","anchor","focus","command","select","insertInline","type","data","nodes"],"mappings":"AAAA,SAA2BA,QAA3B,EAAqCC,IAArC,EAA2CC,SAA3C,EAAsDC,SAAtD,QAAuE,oBAAvE;AACA,OAAOC,cAAP;AAEA,eAAe,SAASC,cAAT,CACbC,UADa,EAEbC,IAFa,EAGbC,MAHa,EAIbC,IAJa,EAKbC,IALa,EAMbC,OANa,EAOb;AACA;AACA,MAAIA,OAAO,KAAKD,IAAZ,IAAoBD,IAAxB,EAA8B;AAC5B,QAAMG,QAAQ,GAAGH,IAAI,CAACI,MAAL,GAAcJ,IAAd,GAAqBC,IAAtC;AACA,QAAMI,KAAK,GAAGX,SAAS,CAACY,MAAV,CAAiB;AAC7BC,MAAAA,GAAG,EAAET,IAAI,CAACS,GADmB;AAE7BR,MAAAA,MAAM,EAAEA;AAFqB,KAAjB,CAAd;AAIA,QAAMS,SAAS,GAAGf,SAAS,CAACa,MAAV,CAAiB;AACjCG,MAAAA,MAAM,EAAEJ,KADyB;AAEjCK,MAAAA,KAAK,EAAEL;AAF0B,KAAjB,CAAlB;AAKA,WAAOV,cAAc,CAACE,UAAD,EAAaC,IAAb,EAAmBC,MAAnB,EAA2BG,OAA3B,CAAd,CACJS,OADI,CACIpB,QAAQ,CAACqB,MADb,EACqBJ,SADrB,EAEJG,OAFI,CAEIpB,QAAQ,CAACsB,YAFb,EAE2B;AAC9BC,MAAAA,IAAI,EAAE,MADwB;AAE9BC,MAAAA,IAAI,EAAE;AAAEd,QAAAA,IAAI,EAAJA;AAAF,OAFwB;AAG9Be,MAAAA,KAAK,EAAE,CAACxB,IAAI,CAACc,MAAL,CAAYH,QAAZ,CAAD;AAHuB,KAF3B,CAAP;AAOD;;AACD,SAAON,UAAP;AACD","sourcesContent":["import { Controller, Node, Commands, Text, Selection, TextPoint } from '@ali/4ever-cangjie';\nimport removePureLink from './removePureLink';\n\nexport default function updatePureLink(\n  controller: Controller,\n  node: Node,\n  offset: number,\n  text: string,\n  href: string,\n  srcHref: string,\n) {\n  // 存在文本或者链接变化时，将 pure link 转换为 text link\n  if (srcHref !== href || text) {\n    const nodeText = text.length ? text : href;\n    const point = TextPoint.create({\n      key: node.key,\n      offset: offset,\n    });\n    const selection = Selection.create({\n      anchor: point,\n      focus: point,\n    })\n\n    return removePureLink(controller, node, offset, srcHref)\n      .command(Commands.select, selection)\n      .command(Commands.insertInline, {\n        type: 'link',\n        data: { href },\n        nodes: [Text.create(nodeText)],\n      });\n  }\n  return controller;\n}\n"],"file":"updatePureLink.js"}