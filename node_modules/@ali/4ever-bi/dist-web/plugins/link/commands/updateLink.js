import { Commands, Text } from '@ali/4ever-cangjie';
export default function updateLink(controller, node, text, href) {
  var selection = controller.value.selection;
  var nodeText = text.length ? text : href;
  var originalHref = node.data.href; // 更新需要控制粒度，避免生成额外 op

  if (href !== originalHref) {
    controller.command(Commands.setNodeByKey, node.key, {
      type: 'link',
      data: {
        href: href
      }
    }).command(Commands.moveToEndOfNode, node);
  }

  if (Text.isTextList(node.nodes) && nodeText !== node.text) {
    var range = selection.moveToRangeOfNode(node, controller);
    controller.command(Commands.select, range).command(Commands.insertText, nodeText);
  }

  return controller.command(Commands.moveToStartOfNextText);
}
//# sourceMappingURL=updateLink.js.map