{"version":3,"sources":["../../../../../src/plugins/link/commands/createCopyLink.ts"],"names":["transferUtils","Value","constants","getHtmlFromValue","createClipboardManager","createFragmentbyNodes","MIME_TYPES","createCopyLink","serializer","copyLink","controller","node","href","data","fragment","value","create","document","clip","write","FRAGMENT","encodeFragment","HTML","TEXT","valueToText"],"mappings":"AAAA,SAAqBA,aAArB,EAAoCC,KAApC,EAA2CC,SAA3C,QAA8E,oBAA9E;AACA,SAASC,gBAAT,EAA2BC,sBAA3B,QAAyD,6BAAzD;AAEA,SAASC,qBAAT;IAEQC,U,GAAeJ,S,CAAfI,U;AAER,eAAe,SAASC,cAAT,CACbC,UADa,EAEb;AACA,SAAO,SAASC,QAAT,CACLC,UADK,EAELC,IAFK,EAGL;AAAA;;AAAA,QACQC,IADR,GACiBD,IAAI,CAACE,IADtB,CACQD,IADR;AAEAJ,IAAAA,UAAU,GAAGA,UAAU,IAAIE,UAAU,CAACF,UAAtC;AAEA,QAAMM,QAAQ,GAAGT,qBAAqB,CAAC,CAACM,IAAD,CAAD,CAAtC;AAEA,QAAMI,KAAK,GAAGd,KAAK,CAACe,MAAN,CAAa;AAAEC,MAAAA,QAAQ,EAAEH;AAAZ,KAAb,CAAd;AACA,QAAMI,IAAI,GAAGd,sBAAsB,EAAnC;AACAc,IAAAA,IAAI,CAACC,KAAL,gCACGb,UAAU,CAACc,QADd,IACyBpB,aAAa,CAACqB,cAAd,CAA6BP,QAA7B,CADzB,cAEGR,UAAU,CAACgB,IAFd,IAEqBnB,gBAAgB,CAACK,UAAD,EAAaO,KAAb,CAFrC,cAGGT,UAAU,CAACiB,IAHd,IAGqBX,IAAI,IAAIJ,UAAU,CAACgB,WAAX,CAAuBT,KAAvB,CAH7B;AAMA,WAAOL,UAAP;AACD,GAlBD;AAmBD","sourcesContent":["import { Controller, transferUtils, Value, constants, Mo as Serializer } from '@ali/4ever-cangjie';\nimport { getHtmlFromValue, createClipboardManager } from '@ali/4ever-plugin-clipboard';\nimport { LinkNode } from '../types';\nimport { createFragmentbyNodes }  from '../utils/createFragmentbyNode';\n\nconst { MIME_TYPES } = constants;\n\nexport default function createCopyLink(\n  serializer?: Serializer,\n) {\n  return function copyLink(\n    controller: Controller,\n    node: LinkNode,\n  ) {\n    const { href } = node.data;\n    serializer = serializer || controller.serializer;\n\n    const fragment = createFragmentbyNodes([node]);\n\n    const value = Value.create({ document: fragment });\n    const clip = createClipboardManager();\n    clip.write({\n      [MIME_TYPES.FRAGMENT]: transferUtils.encodeFragment(fragment),\n      [MIME_TYPES.HTML]: getHtmlFromValue(serializer, value),\n      [MIME_TYPES.TEXT]: href || serializer.valueToText(value),\n    });\n\n    return controller;\n  }\n}\n"],"file":"createCopyLink.js"}