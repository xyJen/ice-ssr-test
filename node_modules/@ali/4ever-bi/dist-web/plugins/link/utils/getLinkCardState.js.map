{"version":3,"sources":["../../../../../src/plugins/link/utils/getLinkCardState.ts"],"names":["getCardInfo","getLinkCardState","readonly","node","injections","length","injection","find","i","key","data","cardInfo","title","desc","imgURL","undefined"],"mappings":"AAEA,OAAOA,WAAP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,QAAD,EAAoBC,IAApB,EAAgCC,UAAhC,EAAwE;AACtG;AACA,MAAIF,QAAJ,EAAc;AACZ,WAAO,QAAP;AACD,GAJqG,CAKtG;;;AACA,MAAIE,UAAU,IAAIA,UAAU,CAACC,MAAX,GAAoB,CAAtC,EAAyC;AACvC,QAAMC,SAAS,GAAGF,UAAU,CAACG,IAAX,CAAgB,UAACC,CAAD;AAAA,aAAOA,CAAC,CAACC,GAAF,KAAUN,IAAI,CAACM,GAAtB;AAAA,KAAhB,CAAlB;;AACA,QAAIH,SAAJ,EAAe;AACb,UAAIA,SAAS,CAACI,IAAV,CAAeC,QAAnB,EAA6B;AAC3B,eAAO,SAAP;AACD;AACF;AACF;;AACD,MAAMA,QAAQ,GAAGX,WAAW,CAACG,IAAD,CAA5B;;AAdsG,aAetEQ,QAAQ,IAAI,EAf0D;AAAA,MAe9FC,KAf8F,QAe9FA,KAf8F;AAAA,MAevFC,IAfuF,QAevFA,IAfuF;AAAA,MAejFC,MAfiF,QAejFA,MAfiF,EAgBtG;;;AACA,MAAIF,KAAK,KAAKG,SAAV,IAAuBF,IAAI,KAAKE,SAAhC,IAA6CD,MAAM,KAAKC,SAA5D,EAAuE;AACrE,WAAO,OAAP;AACD;;AAED,SAAO,QAAP;AACD,CAtBM","sourcesContent":["import { Injection, Node } from '@ali/4ever-cangjie';\nimport { CardState } from '../types';\nimport getCardInfo from './getCardInfo';\n/**\n * 在编辑形态下，如果 title、desc、imgURL 都为 undefined，则说明请求失败，需要显示 error\n * 如果存在 injection 数据，说明是 loading 状态\n * @param readonly\n * @param title\n * @param desc\n * @param imgURL\n */\nexport const getLinkCardState = (readonly: boolean, node: Node, injections?: Injection[]): CardState => {\n  // 只读情况下只返回 normal\n  if (readonly) {\n    return 'normal';\n  }\n  // injection 有状态，返回 loading\n  if (injections && injections.length > 0) {\n    const injection = injections.find((i) => i.key === node.key);\n    if (injection) {\n      if (injection.data.cardInfo) {\n        return 'loading';\n      }\n    }\n  }\n  const cardInfo = getCardInfo(node);\n  const { title, desc, imgURL } = cardInfo || {};\n  // 数据都为 undefined 返回 error\n  if (title === undefined && desc === undefined && imgURL === undefined) {\n    return 'error';\n  }\n\n  return 'normal';\n};\n"],"file":"getLinkCardState.js"}