{"version":3,"sources":["../../../../../src/plugins/link/mobile/insertLink.ts"],"names":["Text","Commands","insertLink","controller","text","href","isExpanded","value","selection","command","focus","console","warn","wrapInline","type","data","insertInline","nodes","create","moveToStartOfNextText","insertText"],"mappings":"AAAA,SAASA,IAAT,EAA2BC,QAA3B,QAA2C,oBAA3C;AAEA,eAAe,SAASC,UAAT,CACbC,UADa,EAEbC,IAFa,EAGbC,IAHa,EAIb;AAAA,MACQC,UADR,GACuBH,UAAU,CAACI,KAAX,CAAiBC,SADxC,CACQF,UADR;AAGAH,EAAAA,UAAU,CAACM,OAAX,CAAmBR,QAAQ,CAACS,KAA5B,EAHA,CAKA;;AACA,MAAI,OAAOL,IAAP,KAAgB,QAApB,EAA8B;AAC5BM,IAAAA,OAAO,CAACC,IAAR,CAAa,iBAAb;AACA,WAAOT,UAAP;AACD,GATD,CAWA;;;AACA,MAAI,CAACC,IAAD,IAASE,UAAb,EAAyB;AACvBH,IAAAA,UAAU,CAACM,OAAX,CAAmBR,QAAQ,CAACY,UAA5B,EAAwC;AACtCC,MAAAA,IAAI,EAAE,MADgC;AAEtCC,MAAAA,IAAI,EAAE;AAAEV,QAAAA,IAAI,EAAJA;AAAF;AAFgC,KAAxC;AAID,GALD,MAKO;AACLF,IAAAA,UAAU,CAACM,OAAX,CAAmBR,QAAQ,CAACe,YAA5B,EAA0C;AACxCF,MAAAA,IAAI,EAAE,MADkC;AAExCC,MAAAA,IAAI,EAAE;AAAEV,QAAAA,IAAI,EAAJA;AAAF,OAFkC;AAGxCY,MAAAA,KAAK,EAAE,CAACjB,IAAI,CAACkB,MAAL,CAAYd,IAAZ,CAAD;AAHiC,KAA1C;AAKD;;AAED,SAAOD,UAAU,CAACM,OAAX,CAAmBR,QAAQ,CAACkB,qBAA5B,EACJV,OADI,CACIR,QAAQ,CAACmB,UADb,EACyB,GADzB,CAAP;AAED","sourcesContent":["import { Text, Controller, Commands } from '@ali/4ever-cangjie';\n\nexport default function insertLink(\n  controller: Controller,\n  text: string,\n  href: string,\n) {\n  const { isExpanded } = controller.value.selection;\n\n  controller.command(Commands.focus);\n\n  // 针对移动端链接插入，如果 href 为 undefined 则直接返回。\n  if (typeof href !== 'string') {\n    console.warn('href is invalid');\n    return controller;\n  }\n\n  // 有选区无标题时执行 wrapInline\n  if (!text && isExpanded) {\n    controller.command(Commands.wrapInline, {\n      type: 'link',\n      data: { href },\n    });\n  } else {\n    controller.command(Commands.insertInline, {\n      type: 'link',\n      data: { href },\n      nodes: [Text.create(text)],\n    });\n  }\n\n  return controller.command(Commands.moveToStartOfNextText)\n    .command(Commands.insertText, ' ');\n}\n"],"file":"insertLink.js"}