{"version":3,"sources":["../../../../../src/plugins/link/mobile/index.ts"],"names":["LinkPlugin","createRenderNode","createRenderMark","createContextMenu","createCopyLink","createOpenLink","actions","createOnCangjiePaste","insertLink","locale","onAction","queries","moFactory","commands","createLinkPlugin","config","linkConfig","protocolAllowList","link","serializer","clipboard","plugin","copyLink","openLink","renderNode","contextMenu","onCangjiePaste","models","klass","type","disableTextRecognize","decorateNode","createDecorateNode","renderMark"],"mappings":";AAAA,SAASA,UAAT,QAA2B,mBAA3B;AACA,OAAOC,gBAAP;AACA,OAAOC,gBAAP;AACA,OAAOC,iBAAP;AACA,OAAOC,cAAP;AACA,OAAOC,cAAP;AACA,OAAO,KAAKC,OAAZ;AACA,OAAOC,oBAAP;AACA,OAAOC,UAAP;AAEA,OAAOC,MAAP;AAEA,OAAOC,QAAP;AACA,SAASC,OAAT;AACA,SAASC,SAAT,QAA0B,wBAA1B;AAEA,IAAMC,QAAQ,GAAG;AACfL,EAAAA,UAAU,EAAVA;AADe,CAAjB;;AAIA,SAASM,gBAAT,CAA0BC,MAA1B,EAAkD;AAAA;;AAChD,MAAMC,UAA4B;AAChCC,IAAAA,iBAAiB,EAAE,CAAC,OAAD,EAAU,QAAV,EAAoB,WAApB,EAAiC,SAAjC,CADa;AAEhCR,IAAAA,MAAM,EAAEA,MAAM,CAACS,IAAP,CAAYT;AAFY,KAG5BM,MAAM,CAACG,IAAP,IAAe,EAHa,CAAlC;;AAMA,MAAMC,UAAU,wBAAGJ,MAAM,CAACK,SAAV,qBAAG,kBAAkBD,UAArC;;AAEA,MAAME,MAAgB,gBACjBT,SAAS,CAAC,EAAD,CADQ;AAEpBC,IAAAA,QAAQ,eACHA,QADG;AAENS,MAAAA,QAAQ,EAAElB,cAAc,CAACe,UAAD,CAFlB;AAGNI,MAAAA,QAAQ,EAAElB,cAAc,CAACW,UAAU,CAACC,iBAAZ,EAAgCD,UAAU,CAACO,QAA3C;AAHlB,MAFY;AAOpBC,IAAAA,UAAU,EAAEvB,gBAAgB,CAACe,UAAD,CAPR;AAQpBS,IAAAA,WAAW,EAAEtB,iBAAiB,CAACa,UAAD,CARV;AASpBV,IAAAA,OAAO,EAAPA,OAToB;AAUpB;AACAI,IAAAA,QAAQ,EAARA,QAXoB;AAYpBgB,IAAAA,cAAc,EAAEnB,oBAAoB,CAACQ,MAAD,EAASC,UAAT,CAZhB;AAapBL,IAAAA,OAAO,EAAPA,OAboB;AAcpBgB,IAAAA,MAAM,EAAE;AACNC,MAAAA,KAAK,EAAE,QADD;AAENC,MAAAA,IAAI,EAAE;AAFA;AAdY,IAAtB,CATgD,CA6BhD;;;AACA,MAAI,CAACb,UAAU,CAACc,oBAAhB,EAAsC;AACpC;AACAT,IAAAA,MAAM,CAACU,YAAP,GAAsB/B,UAAU,CAACgC,kBAAX,CAA8BhB,UAAU,CAACC,iBAAX,IAAgC,EAA9D,CAAtB;AACAI,IAAAA,MAAM,CAACY,UAAP,GAAoB/B,gBAAgB,CAACc,UAAD,CAApC;AACD;;AAED,SAAOK,MAAP;AACD;;AAEDP,gBAAgB,CAACR,OAAjB,GAA2BA,OAA3B;AACAQ,gBAAgB,CAACD,QAAjB,GAA4BA,QAA5B;AACAC,gBAAgB,CAACH,OAAjB,GAA2BA,OAA3B;AAEA,eAAeG,gBAAf","sourcesContent":["import { LinkPlugin } from '@ali/4ever-bamboo';\nimport createRenderNode from './createRenderNode';\nimport createRenderMark from './createRenderMark';\nimport createContextMenu from './contextMenu';\nimport createCopyLink from '../commands/createCopyLink';\nimport createOpenLink from '../commands/createOpenLink';\nimport * as actions from '../actions';\nimport createOnCangjiePaste from '../handlers/createOnCangjiePaste';\nimport insertLink from './insertLink';\nimport { LinkPluginConfig } from '../types';\nimport locale from '../../../locales/zh_CN';\nimport { BiPluginConfig, BiPlugin } from '../../../types';\nimport onAction from '../handlers/onAction';\nimport { queries } from './queries';\nimport { moFactory } from '@ali/4ever-plugin-link';\n\nconst commands = {\n  insertLink,\n};\n\nfunction createLinkPlugin(config: BiPluginConfig) {\n  const linkConfig: LinkPluginConfig = {\n    protocolAllowList: ['http:', 'https:', 'dingtalk:', 'taobao:'],\n    locale: locale.link.locale,\n    ...(config.link || {}),\n  };\n\n  const serializer = config.clipboard?.serializer;\n\n  const plugin: BiPlugin = {\n    ...moFactory({}),\n    commands: {\n      ...commands,\n      copyLink: createCopyLink(serializer),\n      openLink: createOpenLink(linkConfig.protocolAllowList!, linkConfig.openLink),\n    },\n    renderNode: createRenderNode(linkConfig),\n    contextMenu: createContextMenu(linkConfig),\n    actions,\n    // @ts-ignore\n    onAction,\n    onCangjiePaste: createOnCangjiePaste(config, linkConfig),\n    queries,\n    models: {\n      klass: 'inline',\n      type: 'link',\n    },\n  };\n\n  // 支持 purelink 识别的情况下，添加 decorateNode 和 renderMark\n  if (!linkConfig.disableTextRecognize) {\n    // @ts-ignore\n    plugin.decorateNode = LinkPlugin.createDecorateNode(linkConfig.protocolAllowList || []);\n    plugin.renderMark = createRenderMark(linkConfig);\n  }\n\n  return plugin;\n}\n\ncreateLinkPlugin.actions = actions;\ncreateLinkPlugin.commands = commands;\ncreateLinkPlugin.queries = queries;\n\nexport default createLinkPlugin;\n"],"file":"index.js"}