{"version":3,"sources":["../../../../../../src/plugins/link/linkCard/commands/deleteExtraBlankLine.ts"],"names":["Commands","Text","isEmptyNode","node","nodes","length","isEmptyText","deleteExtraBlankLine","controller","currentKey","document","value","nextBlock","getNextBlock","nextNextBlock","command","removeNodeByKey","key"],"mappings":"AAAA,SAASA,QAAT,EAA+BC,IAA/B,QAA2C,oBAA3C;;AAEA,SAASC,WAAT,CAAqBC,IAArB,EAA2B;AACzB,SAAOA,IAAI,CAACC,KAAL,CAAWC,MAAX,KAAsB,CAAtB,IAA2BF,IAAI,CAACC,KAAL,CAAWC,MAAX,KAAsB,CAAtB,IAA2BJ,IAAI,CAACK,WAAL,CAAiBH,IAAI,CAACC,KAAL,CAAW,CAAX,CAAjB,CAA7D;AACD;;AAED,eAAe,SAASG,oBAAT,CAA8BC,UAA9B,EAAsDC,UAAtD,EAA0E;AAAA,MAErFC,QAFqF,GAGnFF,UAAU,CAACG,KAHwE,CAErFD,QAFqF;AAIvF,MAAME,SAAS,GAAGF,QAAQ,CAACG,YAAT,CAAsBJ,UAAtB,CAAlB,CAJuF,CAKvF;;AACA,MAAI,CAACG,SAAD,IAAc,CAACV,WAAW,CAACU,SAAD,CAA9B,EAA0C;AACxC,WAAOJ,UAAP;AACD;;AAED,MAAMM,aAAa,GAAGJ,QAAQ,CAACG,YAAT,CAAsBJ,UAAtB,CAAtB;;AACA,MAAG,CAACK,aAAJ,EAAkB;AAChB;AACA,WAAON,UAAP;AACD;;AACD,SAAOA,UAAU,CAACO,OAAX,CAAmBf,QAAQ,CAACgB,eAA5B,EAA6CJ,SAAS,CAACK,GAAvD,CAAP;AACD","sourcesContent":["import { Commands, Controller, Text } from '@ali/4ever-cangjie';\n\nfunction isEmptyNode(node) {\n  return node.nodes.length === 0 || node.nodes.length === 1 && Text.isEmptyText(node.nodes[0]);\n}\n\nexport default function deleteExtraBlankLine(controller: Controller, currentKey: string) {\n  const {\n    document\n  } = controller.value;\n  const nextBlock = document.getNextBlock(currentKey);\n  // 当前节点的下一个 block 是文档最后一个 block，或者 下一个 block 有内容。不处理\n  if (!nextBlock || !isEmptyNode(nextBlock)){\n    return controller;\n  }\n\n  const nextNextBlock = document.getNextBlock(currentKey);\n  if(!nextNextBlock){\n    // 说明 nextBlock 是文档最后一个 block，不应该删除\n    return controller;\n  }\n  return controller.command(Commands.removeNodeByKey, nextBlock.key);\n}\n"],"file":"deleteExtraBlankLine.js"}