import { Commands, Text } from '@ali/4ever-cangjie';

function isEmptyNode(node) {
  return node.nodes.length === 0 || node.nodes.length === 1 && Text.isEmptyText(node.nodes[0]);
}

export default function deleteExtraBlankLine(controller, currentKey) {
  var document = controller.value.document;
  var nextBlock = document.getNextBlock(currentKey); // 当前节点的下一个 block 是文档最后一个 block，或者 下一个 block 有内容。不处理

  if (!nextBlock || !isEmptyNode(nextBlock)) {
    return controller;
  }

  var nextNextBlock = document.getNextBlock(currentKey);

  if (!nextNextBlock) {
    // 说明 nextBlock 是文档最后一个 block，不应该删除
    return controller;
  }

  return controller.command(Commands.removeNodeByKey, nextBlock.key);
}
//# sourceMappingURL=deleteExtraBlankLine.js.map