import removePureLink from "../../commands/removePureLink";
import buildLinkCardBlock from "../utils/buildLinkCardBlock";
import { fetchLinkData } from "../utils/fetchLinkData";
import deleteExtraBlankLine from "./deleteExtraBlankLine";
export default function convertPureLinkToBlockLinkCard(controller, node, data) {
  var offset = data.offset,
      text = data.text,
      href = data.href,
      srcHref = data.srcHref,
      cardInfo = data.cardInfo,
      needFetchLinkInfo = data.needFetchLinkInfo,
      getLinkInfo = data.getLinkInfo; // 将 pure link 转换为 block link card

  var nodeText = text.length ? text : href; // 如果更新了卡片信息

  var card = buildLinkCardBlock({
    text: nodeText,
    href: href,
    cardInfo: cardInfo
  });
  controller.setOpRelatedId(card.key).command(removePureLink, node, offset, srcHref).command('insertCard', card).command(deleteExtraBlankLine, card.key);

  if (needFetchLinkInfo) {
    fetchLinkData(card, controller, href, nodeText, getLinkInfo, card.key);
  }

  return controller;
}
;
//# sourceMappingURL=convertPureLinkToBlockLinkCard.js.map