import _extends from "@babel/runtime/helpers/extends";
import { Text, Commands, Block, Inline } from '@ali/4ever-cangjie';
import removeLink from "./removeLink";
export default function convertBlockLinkCardToTextLink(controller, node, data) {
  var _ref = node.data.metadata,
      cardInfo = _ref.cardInfo;
  var _ref2 = node.data.metadata,
      text = _ref2.text,
      href = _ref2.href;

  if (data) {
    text = data.text;
    href = data.href;
  } // 将 text link 转换为 block link card


  var nodeText = text.length ? text : href;
  var textLink = Inline.create({
    type: 'link',
    nodes: [Text.create(nodeText)],
    data: {
      href: href,
      cardInfo: _extends({}, cardInfo, {
        displayType: 'link'
      })
    }
  }); // 这里需要先插入，再删除，否则会报找不到 path 的异常

  controller.command(Commands.moveToEndOfNode, node).command(Commands.insertBlock, {
    type: Block.DEFAULT_TYPE,
    nodes: [textLink]
  }).command(removeLink, node);
  return controller;
}
;
//# sourceMappingURL=convertBlockLinkCardToTextLink.js.map