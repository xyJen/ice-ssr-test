{"version":3,"sources":["../../../../../../src/plugins/link/linkCard/commands/copyLink.ts"],"names":["transferUtils","Value","constants","Document","getHtmlFromValue","createClipboardManager","MIME_TYPES","copyLink","controller","node","serializer","data","metadata","href","fragment","create","nodes","value","document","clip","write","FRAGMENT","encodeFragment","HTML","TEXT","valueToText"],"mappings":"AAAA,SAAqBA,aAArB,EAAoCC,KAApC,EAA2CC,SAA3C,EAAgEC,QAAhE,QAAkG,oBAAlG;AACA,SAASC,gBAAT,EAA2BC,sBAA3B,QAAyD,6BAAzD;IAGQC,U,GAAeJ,S,CAAfI,U;AAER,eAAe,SAASC,QAAT,CACbC,UADa,EAEbC,IAFa,EAGbC,UAHa,EAIb;AAAA;;AAAA,aACiBD,IAAI,CAACE,IAAL,CAAUC,QAD3B;AAAA,MACQC,IADR,QACQA,IADR;AAGA,MAAMC,QAAQ,GAAGX,QAAQ,CAACY,MAAT,CAAgB;AAAEC,IAAAA,KAAK,EAAE,CAACP,IAAD;AAAT,GAAhB,CAAjB;AACA,MAAMQ,KAAK,GAAGhB,KAAK,CAACc,MAAN,CAAa;AAAEG,IAAAA,QAAQ,EAAEJ;AAAZ,GAAb,CAAd;AACA,MAAMK,IAAI,GAAGd,sBAAsB,EAAnC;AACAc,EAAAA,IAAI,CAACC,KAAL,gCACGd,UAAU,CAACe,QADd,IACyBrB,aAAa,CAACsB,cAAd,CAA6BR,QAA7B,CADzB,cAEGR,UAAU,CAACiB,IAFd,IAEqBnB,gBAAgB,CAACM,UAAD,EAAaO,KAAb,CAFrC,cAGGX,UAAU,CAACkB,IAHd,IAGqBX,IAAI,IAAIH,UAAU,CAACe,WAAX,CAAuBR,KAAvB,CAH7B;AAMA,SAAOT,UAAP;AACD","sourcesContent":["import { Controller, transferUtils, Value, constants, Commands, Document, Mo as Serializer } from '@ali/4ever-cangjie';\nimport { getHtmlFromValue, createClipboardManager } from '@ali/4ever-plugin-clipboard';\nimport { BlockLinkCard } from '../../types';\n\nconst { MIME_TYPES } = constants;\n\nexport default function copyLink(\n  controller: Controller,\n  node: BlockLinkCard,\n  serializer: Serializer,\n) {\n  const { href } = node.data.metadata!;\n\n  const fragment = Document.create({ nodes: [node] });\n  const value = Value.create({ document: fragment });\n  const clip = createClipboardManager();\n  clip.write({\n    [MIME_TYPES.FRAGMENT]: transferUtils.encodeFragment(fragment),\n    [MIME_TYPES.HTML]: getHtmlFromValue(serializer, value),\n    [MIME_TYPES.TEXT]: href || serializer.valueToText(value),\n  });\n\n  return controller;\n}\n"],"file":"copyLink.js"}