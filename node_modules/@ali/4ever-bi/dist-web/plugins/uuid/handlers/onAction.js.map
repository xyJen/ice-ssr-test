{"version":3,"sources":["../../../../../src/plugins/uuid/handlers/onAction.ts"],"names":["Commands","Element","SET_NODE_UUID","onAction","action","controller","next","type","payload","node","uuid","isElement","withoutSaving","command","setNodeByKey","key","data","refblockUUID"],"mappings":";AAAA,SAAqBA,QAArB,EAA+BC,OAA/B,QAA8C,oBAA9C;AACA,SAASC,aAAT;AAEA,eAAe,SAASC,QAAT,CAAkBC,MAAlB,EAA0BC,UAA1B,EAAkDC,IAAlD,EAAwD;AAAA,MAC7DC,IAD6D,GACpDH,MADoD,CAC7DG,IAD6D;;AAGrE,MAAIA,IAAI,KAAKL,aAAb,EAA4B;AAAA,eACHE,MAAM,CAACI,OADJ;AAAA,QAClBC,IADkB,QAClBA,IADkB;AAAA,QACZC,IADY,QACZA,IADY;;AAE1B,QAAI,CAACT,OAAO,CAACU,SAAR,CAAkBF,IAAlB,CAAL,EAA8B;AAC5B;AACD;;AACD,WAAOJ,UAAU,CAACO,aAAX,CAAyB,YAAM;AACpCP,MAAAA,UAAU,CAACQ,OAAX,CAAmBb,QAAQ,CAACc,YAA5B,EAA0CL,IAAI,CAACM,GAA/C,EAAoD;AAClDR,QAAAA,IAAI,EAAEE,IAAI,CAACF,IADuC;AAElDS,QAAAA,IAAI,eACCP,IAAI,CAACO,IADN;AAEFN,UAAAA,IAAI,EAAED,IAAI,CAACO,IAAL,CAAUC,YAAV,GAAyBR,IAAI,CAACO,IAAL,CAAUC,YAAnC,GAAkDP;AAFtD;AAF8C,OAApD;AAOD,KARM,CAAP;AASD;;AAED,SAAOJ,IAAI,EAAX;AACD","sourcesContent":["import { Controller, Commands, Element } from '@ali/4ever-cangjie';\nimport { SET_NODE_UUID, ISetNodeUUIDPayload } from '../actions';\n\nexport default function onAction(action, controller: Controller, next) {\n  const { type } = action;\n\n  if (type === SET_NODE_UUID) {\n    const { node, uuid } = action.payload as ISetNodeUUIDPayload;\n    if (!Element.isElement(node)) {\n      return;\n    }\n    return controller.withoutSaving(() => {\n      controller.command(Commands.setNodeByKey, node.key, {\n        type: node.type,\n        data: {\n          ...node.data,\n          uuid: node.data.refblockUUID ? node.data.refblockUUID : uuid,\n        },\n      });\n    });\n  }\n\n  return next();\n}\n"],"file":"onAction.js"}