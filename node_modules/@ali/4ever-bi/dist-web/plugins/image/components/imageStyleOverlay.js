import React from 'react';
var _createElement = /*#__PURE__*/React.createElement;
import styled from 'styled-components';
import { ImagePlugin, PluginRoles } from '@ali/4ever-bamboo';
import { RecommendStyleMenuType, RecommendStyleMenu } from "./recommendStyleItems";
import { updateImage } from "../actions";
import { isStyleActive } from "../utils/isStyleActive";
var OverlayWrapper = /*#__PURE__*/styled.div(["width:186px;padding:10px 10px 0 10px;"]);
var Footer = /*#__PURE__*/styled.div(["margin-top:9px;border-top:1px solid rgba(126,134,142,0.16);font-size:13px;line-height:32px;text-align:center;color:#0089FF;height:32px;cursor:pointer;"]);
export var ImageStyleOverlay = function ImageStyleOverlay(props) {
  var controller = props.controller,
      getImageNode = props.getImageNode,
      locale = props.locale,
      onClick = props.onClick;
  var image = getImageNode();

  var _React$useState = React.useState((image == null ? void 0 : image.data) || ImagePlugin.DEFAULT_STYLE),
      data = _React$useState[0],
      setData = _React$useState[1];

  var handleClean = React.useCallback(function () {
    var image = getImageNode();

    if (!image) {
      return;
    }

    controller.run('onAction', updateImage(image, ImagePlugin.DEFAULT_STYLE));
    setData(ImagePlugin.DEFAULT_STYLE);
    onClick && onClick();
  }, [image, controller, onClick]);

  var handleClick = function handleClick(newData) {
    var image = getImageNode();
    if (!image) return;

    if (isStyleActive(newData, image.data)) {
      controller.run('onAction', updateImage(image, ImagePlugin.DEFAULT_STYLE));
      setData(ImagePlugin.DEFAULT_STYLE);
    } else {
      controller.run('onAction', updateImage(image, newData));
      setData(newData);
    }

    onClick && onClick();
  };

  return image ? /*#__PURE__*/_createElement(OverlayWrapper, {
    "data-testid": "overlay-image-style-menu"
  }, /*#__PURE__*/_createElement(RecommendStyleMenu, {
    onClick: handleClick,
    data: data,
    size: RecommendStyleMenuType.SMALL
  }), /*#__PURE__*/_createElement(Footer, {
    "data-testid": "image-toolbar-clear-style",
    "data-role": PluginRoles.imageClearStyle,
    onClick: handleClean
  }, locale.clearStyle)) : null;
};
//# sourceMappingURL=imageStyleOverlay.js.map