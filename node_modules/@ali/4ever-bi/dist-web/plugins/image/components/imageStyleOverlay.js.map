{"version":3,"sources":["../../../../../src/plugins/image/components/imageStyleOverlay.tsx"],"names":["React","styled","ImagePlugin","PluginRoles","RecommendStyleMenuType","RecommendStyleMenu","updateImage","isStyleActive","OverlayWrapper","div","Footer","ImageStyleOverlay","props","controller","getImageNode","locale","onClick","image","useState","data","DEFAULT_STYLE","setData","handleClean","useCallback","run","handleClick","newData","SMALL","imageClearStyle","clearStyle"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;qBAC4B,a;AAA5B,OAAOC,MAAP,MAAmB,mBAAnB;AAEA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,mBAAzC;AAEA,SAASC,sBAAT,EAAiCC,kBAAjC;AACA,SAASC,WAAT;AACA,SAASC,aAAT;AASA,IAAMC,cAAc,gBAAGP,MAAM,CAACQ,GAAV,2CAApB;AAKA,IAAMC,MAAM,gBAAGT,MAAM,CAACQ,GAAV,4JAAZ;AAWA,OAAO,IAAME,iBAAoD,GAAG,SAAvDA,iBAAuD,CAACC,KAAD,EAAW;AAAA,MACrEC,UADqE,GACvBD,KADuB,CACrEC,UADqE;AAAA,MACzDC,YADyD,GACvBF,KADuB,CACzDE,YADyD;AAAA,MAC3CC,MAD2C,GACvBH,KADuB,CAC3CG,MAD2C;AAAA,MACnCC,OADmC,GACvBJ,KADuB,CACnCI,OADmC;AAE7E,MAAMC,KAAK,GAAGH,YAAY,EAA1B;;AAF6E,wBAGrDd,KAAK,CAACkB,QAAN,CAAe,CAAAD,KAAK,QAAL,YAAAA,KAAK,CAAEE,IAAP,KAAejB,WAAW,CAACkB,aAA1C,CAHqD;AAAA,MAGtED,IAHsE;AAAA,MAGhEE,OAHgE;;AAK7E,MAAMC,WAAW,GAAGtB,KAAK,CAACuB,WAAN,CAAkB,YAAM;AAC1C,QAAMN,KAAK,GAAGH,YAAY,EAA1B;;AACA,QAAI,CAACG,KAAL,EAAY;AACV;AACD;;AACDJ,IAAAA,UAAU,CAACW,GAAX,CAAe,UAAf,EAA2BlB,WAAW,CAACW,KAAD,EAAQf,WAAW,CAACkB,aAApB,CAAtC;AACAC,IAAAA,OAAO,CAACnB,WAAW,CAACkB,aAAb,CAAP;AACAJ,IAAAA,OAAO,IAAIA,OAAO,EAAlB;AACD,GARmB,EAQjB,CAACC,KAAD,EAAQJ,UAAR,EAAoBG,OAApB,CARiB,CAApB;;AAUA,MAAMS,WAAW,GAAG,SAAdA,WAAc,CAACC,OAAD,EAAa;AAC/B,QAAMT,KAAK,GAAGH,YAAY,EAA1B;AACA,QAAI,CAACG,KAAL,EAAY;;AACZ,QAAIV,aAAa,CAACmB,OAAD,EAAUT,KAAK,CAACE,IAAhB,CAAjB,EAAwC;AACtCN,MAAAA,UAAU,CAACW,GAAX,CAAe,UAAf,EAA2BlB,WAAW,CAACW,KAAD,EAAQf,WAAW,CAACkB,aAApB,CAAtC;AACAC,MAAAA,OAAO,CAACnB,WAAW,CAACkB,aAAb,CAAP;AACD,KAHD,MAGO;AACLP,MAAAA,UAAU,CAACW,GAAX,CAAe,UAAf,EAA2BlB,WAAW,CAACW,KAAD,EAAQS,OAAR,CAAtC;AACAL,MAAAA,OAAO,CAACK,OAAD,CAAP;AACD;;AACDV,IAAAA,OAAO,IAAIA,OAAO,EAAlB;AACD,GAXD;;AAaA,SAAOC,KAAK,gBACV,eAAC,cAAD;AAAgB,mBAAY;AAA5B,kBACE,eAAC,kBAAD;AACE,IAAA,OAAO,EAAEQ,WADX;AAEE,IAAA,IAAI,EAAEN,IAFR;AAGE,IAAA,IAAI,EAAEf,sBAAsB,CAACuB;AAH/B,IADF,eAME,eAAC,MAAD;AACE,mBAAY,2BADd;AAEE,iBAAWxB,WAAW,CAACyB,eAFzB;AAGE,IAAA,OAAO,EAAEN;AAHX,KAKGP,MAAM,CAACc,UALV,CANF,CADU,GAeR,IAfJ;AAgBD,CA5CM","sourcesContent":["import React from 'react';\nimport styled from 'styled-components';\nimport type { Inline, Controller } from '@ali/4ever-cangjie';\nimport { ImagePlugin, PluginRoles } from '@ali/4ever-bamboo';\nimport { Image } from '@ali/4ever-mo';\nimport { RecommendStyleMenuType, RecommendStyleMenu } from './recommendStyleItems';\nimport { updateImage } from '../actions';\nimport { isStyleActive } from '../utils/isStyleActive';\n\nexport interface IImageStyleOverlayProps {\n  getImageNode: () => Image | null;\n  controller: Controller;\n  locale: ImagePlugin.ILocale;\n  onClick: () => void;\n}\n\nconst OverlayWrapper = styled.div`\n  width: 186px;\n  padding: 10px 10px 0 10px;\n`;\n\nconst Footer = styled.div`\n  margin-top: 9px;\n  border-top: 1px solid rgba(126, 134, 142, 0.16);\n  font-size: 13px;\n  line-height: 32px;\n  text-align: center;\n  color: #0089FF;\n  height: 32px;\n  cursor: pointer;\n`;\n\nexport const ImageStyleOverlay: React.FC<IImageStyleOverlayProps> = (props) => {\n  const { controller, getImageNode, locale, onClick } = props;\n  const image = getImageNode();\n  const [data, setData] = React.useState(image?.data || ImagePlugin.DEFAULT_STYLE);\n\n  const handleClean = React.useCallback(() => {\n    const image = getImageNode();\n    if (!image) {\n      return;\n    }\n    controller.run('onAction', updateImage(image, ImagePlugin.DEFAULT_STYLE));\n    setData(ImagePlugin.DEFAULT_STYLE);\n    onClick && onClick();\n  }, [image, controller, onClick]);\n\n  const handleClick = (newData) => {\n    const image = getImageNode();\n    if (!image) return;\n    if (isStyleActive(newData, image.data)) {\n      controller.run('onAction', updateImage(image, ImagePlugin.DEFAULT_STYLE));\n      setData(ImagePlugin.DEFAULT_STYLE);\n    } else {\n      controller.run('onAction', updateImage(image, newData));\n      setData(newData);\n    }\n    onClick && onClick();\n  }\n\n  return image ? (\n    <OverlayWrapper data-testid=\"overlay-image-style-menu\">\n      <RecommendStyleMenu\n        onClick={handleClick}\n        data={data}\n        size={RecommendStyleMenuType.SMALL}\n      />\n      <Footer\n        data-testid=\"image-toolbar-clear-style\"\n        data-role={PluginRoles.imageClearStyle}\n        onClick={handleClean}\n      >\n        {locale.clearStyle}\n      </Footer>\n    </OverlayWrapper>\n  ) : null;\n}"],"file":"imageStyleOverlay.js"}