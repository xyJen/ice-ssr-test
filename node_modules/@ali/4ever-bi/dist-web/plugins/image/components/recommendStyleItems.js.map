{"version":3,"sources":["../../../../../src/plugins/image/components/recommendStyleItems.tsx"],"names":["React","styled","classnames","ImagePlugin","PluginRoles","logger","isStyleActive","blockEvent","getRecommendStyleItems","RecommendStyleMenuType","IMAGE_EXAMPLE_URL","EXAMPLE_WIDTH","EXAMPLE_HEIGHT","EXAMPLE_RATIO","IMAGE_STYLE_MENU_SMALL","IMAGE_STYLE_MENU_ITEM_SMALL","IMAGE_STYLE_ITEM_SELECTED","IMAGE_MARGIN_SMALL","IMAGE_MARGIN_NORMAL","ItemImage","div","ItemImageWrapper","p","margin","ItemImageBorderWrapper","MenuWrapper","ItemImageStatusWrapper","RecommendItem","props","isActive","imageData","demoData","onClick","size","index","outline","radius","shadow","outlineWidth","width","loggerKey","SMALL","imageWrapperStyle","useMemo","border","getBorder","boxShadow","borderRadius","handleClick","useCallback","e","preventDefault","sum","imageRecommendStyleItem","RecommendStyleMenu","LARGE","data","items","map","item","demo"],"mappings":"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","sourcesContent":["import React from 'react';\nimport styled from 'styled-components';\nimport classnames from 'classnames';\nimport { ImageData } from '@ali/4ever-mo';\nimport { ImagePlugin, PluginRoles } from '@ali/4ever-bamboo';\nimport logger from '@ali/4ever-logger';\nimport { isStyleActive } from '../utils/isStyleActive';\nimport { blockEvent }  from '@ali/4ever-utils';\nimport { getRecommendStyleItems } from '../config';\n\nexport enum RecommendStyleMenuType {\n  SMALL = 'small',\n  LARGE = 'large',\n}\n\nexport interface IRecommendStyleMenuProps {\n  size: RecommendStyleMenuType;\n  data: ImageData;\n  onClick: (data: Pick<ImageData, 'outline' | 'shadow' | 'radius'>) => void;\n}\n\nexport interface IRecommendItemProps {\n  isActive: boolean;\n  imageData: ImageData;\n  demoData: ImageData;\n  onClick: (data: ImageData) => void;\n  size: RecommendStyleMenuType;\n  index?: number;\n}\n\nconst IMAGE_EXAMPLE_URL = 'https://img.alicdn.com/imgextra/i3/O1CN016CBXo01OH1jCj0CB4_!!6000000001679-2-tps-224-160.png';\nconst EXAMPLE_WIDTH = 224;\nconst EXAMPLE_HEIGHT = 160;\nconst EXAMPLE_RATIO = EXAMPLE_HEIGHT / EXAMPLE_WIDTH;\nconst IMAGE_STYLE_MENU_SMALL = 'image-style-menu-small'\nconst IMAGE_STYLE_MENU_ITEM_SMALL = 'image-style-menu-item-small';\nconst IMAGE_STYLE_ITEM_SELECTED = 'image-style-item-selected';\nconst IMAGE_MARGIN_SMALL = 6;\nconst IMAGE_MARGIN_NORMAL = 8;\n\nconst ItemImage = styled.div`\n  background-image: url('${IMAGE_EXAMPLE_URL}'), linear-gradient(#FAFAFB, #F2F4F5);\n  height: 100%;\n  box-sizing: border-box;\n  background-size: cover;\n  cursor: pointer;\n`;\n\nconst ItemImageWrapper = styled.div<{margin: number}>`\n  position: absolute;\n  top: ${(p) => `${p.margin}px`};\n  right: ${(p) => `${p.margin}px`};\n  width: ${(p) => `calc(100% - ${p.margin * 2}px)`};\n  height: ${(p) => `calc(100% - ${p.margin * 2}px)`};\n`;\n\nconst ItemImageBorderWrapper = styled.div`\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n`;\n\nconst MenuWrapper = styled.div`\n  display: grid;\n  grid-template-columns: repeat(3, 80px);\n  grid-row-gap: 9px;\n  grid-column-gap: 3px;\n  justify-content: space-around;\n  &.${IMAGE_STYLE_MENU_SMALL} {\n    grid-template-columns: repeat(3, 1fr);\n    grid-row-gap: 6px;\n    justify-content: space-between;\n  }\n`;\n\nconst ItemImageStatusWrapper = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding-top: calc(calc(100% * ${EXAMPLE_RATIO}) + ${(1 - EXAMPLE_RATIO) * IMAGE_MARGIN_NORMAL * 2}px);\n  border-radius: 8px;\n  background: transparent;\n  transition: background 0.3s ease-in-out;\n  &:hover {\n    background: rgba(126, 134, 142, 0.12);\n  }\n  &.${IMAGE_STYLE_ITEM_SELECTED} {\n    background: rgba(0, 137, 255, 0.12);\n  }\n  &.${IMAGE_STYLE_MENU_ITEM_SMALL} {\n    padding-top: calc(calc(100% * ${EXAMPLE_RATIO}) + ${(1 - EXAMPLE_RATIO) * IMAGE_MARGIN_SMALL * 2}px);\n    border-radius: 5px;\n  }\n`;\n\nconst RecommendItem = (props: IRecommendItemProps) => {\n  const { isActive, imageData, demoData, onClick, size, index } = props;\n  const { outline = {}, radius, shadow } = demoData;\n  const { width: outlineWidth } = outline;\n\n  const loggerKey = `${size === RecommendStyleMenuType.SMALL ? 'image-inline-toolbar-' : 'image-sidebar-'}${index}`;\n\n  const imageWrapperStyle = React.useMemo(() => {\n    const border = ImagePlugin.getBorder(outline);\n    return {\n      border,\n      boxShadow: shadow,\n      borderRadius: radius || 0,\n    }\n  }, [outlineWidth, shadow, radius]);\n\n  const handleClick = React.useCallback((e: React.MouseEvent) => {\n    e.preventDefault();\n    onClick(imageData);\n    logger.sum(loggerKey);\n  }, [onClick, imageData, loggerKey]);\n  return (\n    <ItemImageStatusWrapper\n      className={classnames({\n        [IMAGE_STYLE_ITEM_SELECTED]: isActive,\n        [IMAGE_STYLE_MENU_ITEM_SMALL]: size === RecommendStyleMenuType.SMALL,\n      })}\n      data-testid={`image-style-option-${index}`}\n    >\n      <ItemImageWrapper margin={size === RecommendStyleMenuType.SMALL ? IMAGE_MARGIN_SMALL : IMAGE_MARGIN_NORMAL}>\n        <ItemImageBorderWrapper style={imageWrapperStyle}>\n          <ItemImage\n            onClick={handleClick}\n            onMouseDown={blockEvent}\n            data-testid={`image-recommend-style-${index}`}\n            data-role={`${PluginRoles.imageRecommendStyleItem}${index}`}\n          />\n        </ItemImageBorderWrapper>\n      </ItemImageWrapper>\n    </ItemImageStatusWrapper>\n  );\n}\n\nexport const RecommendStyleMenu = (props: IRecommendStyleMenuProps) => {\n  const { size = RecommendStyleMenuType.LARGE, data, onClick } = props;\n\n  const items = React.useMemo(getRecommendStyleItems, []);\n\n  return (\n    <MenuWrapper className={classnames({\n      [IMAGE_STYLE_MENU_SMALL]: size === RecommendStyleMenuType.SMALL,\n    })}>\n      {\n        items.map((item, index) => (\n          <RecommendItem\n            imageData={item.data}\n            demoData={item.demo}\n            isActive={isStyleActive(item.data, data || null)}\n            onClick={onClick}\n            size={size}\n            key={`image_recommend_style_item_${index}`}\n            index={index}\n          />\n        ))\n      }\n    </MenuWrapper>\n  );\n};"],"file":"recommendStyleItems.js"}