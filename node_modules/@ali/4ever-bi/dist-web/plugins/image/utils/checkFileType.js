import { ImagePlugin } from '@ali/4ever-bamboo';

var checkFileType = function checkFileType(file, buffer) {
  var ImageTypeEnum = ImagePlugin.ImageTypeEnum,
      getImageTypeFromBuffer = ImagePlugin.getImageTypeFromBuffer;
  var partialBuffer = buffer.slice(0, 4);
  var imageType = getImageTypeFromBuffer(partialBuffer);
  var fileTypeRegExp = /\.([a-zA-Z0-9_]*)$/;
  var execRes = fileTypeRegExp.exec(file.name);
  var fileType = execRes && execRes[1] || '';

  if (imageType !== ImageTypeEnum.UNCERTAIN && fileType !== imageType) {
    var newFile = new File([file], file.name.replace(fileTypeRegExp, '') + "." + imageType, {
      type: "image/" + imageType
    });
    return {
      file: newFile,
      type: imageType
    };
  }

  return {
    file: file,
    type: fileType
  };
};

export default checkFileType;
//# sourceMappingURL=checkFileType.js.map