{"version":3,"sources":["../../../../../src/plugins/image/utils/calcImageSize.ts"],"names":["getClosestContainerBlock","getInnerFullWidth","width","height","controller","container","value","natural","document","maxWidth","Math","max","isAutoFit"],"mappings":"AAAA,SAASA,wBAAT,EAAmCC,iBAAnC,QAA4D,kBAA5D;AAEA,gBAAe,UAACC,KAAD,EAAQC,MAAR,EAAgBC,UAAhB,EAIV;AACH,MAAMC,SAAS,GAAGL,wBAAwB,CAACI,UAAU,CAACE,KAAZ,CAA1C;AACA,MAAMC,OAAO,GAAG;AACdL,IAAAA,KAAK,EAALA,KADc;AAEdC,IAAAA,MAAM,EAANA;AAFc,GAAhB;;AAIA,MAAI,CAACE,SAAL,EAAgB;AACd,WAAOE,OAAP;AACD;;AARE,MAUKC,QAVL,GAUkBJ,UAAU,CAACE,KAV7B,CAUKE,QAVL;AAWH,MAAMC,QAAQ,GAAGC,IAAI,CAACC,GAAL,CAASV,iBAAiB,CAACI,SAAD,EAAYG,QAAZ,CAAjB,IAA0C,CAAnD,EAAsD,CAAtD,CAAjB;;AACA,MAAIC,QAAQ,GAAGF,OAAO,CAACL,KAAvB,EAA8B;AAC5B,WAAO;AACLA,MAAAA,KAAK,EAAEO,QADF;AAELN,MAAAA,MAAM,EAAEM,QAAQ,GAAGF,OAAO,CAACL,KAAnB,GAA2BK,OAAO,CAACJ,MAFtC;AAGLS,MAAAA,SAAS,EAAE;AAHN,KAAP;AAKD;;AAED,SAAOL,OAAP;AACD,CAzBD","sourcesContent":["import { getClosestContainerBlock, getInnerFullWidth } from '@ali/4ever-utils';\n\nexport default (width, height, controller) : {\n  width: number;\n  height: number;\n  isAutoFit?: boolean;\n} => {\n  const container = getClosestContainerBlock(controller.value);\n  const natural = {\n    width,\n    height,\n  };\n  if (!container) {\n    return natural;\n  }\n\n  const { document } = controller.value;\n  const maxWidth = Math.max(getInnerFullWidth(container, document) || 0, 0);\n  if (maxWidth < natural.width) {\n    return {\n      width: maxWidth,\n      height: maxWidth / natural.width * natural.height,\n      isAutoFit: true,\n    };\n  }\n\n  return natural;\n};\n"],"file":"calcImageSize.js"}