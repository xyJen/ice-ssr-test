import { Commands, Mark } from '@ali/4ever-cangjie';
export default function toggleVertAlignMark(controller, ranges, alignType) {
  var alignMark = Mark.create({
    type: 'vertAlign',
    data: {
      value: alignType
    }
  });
  var value = controller.value;
  var selection = value.selection;
  var activeAlignMark = value.activeMarks.find(function (m) {
    return m.type === 'vertAlign';
  });

  if (ranges.length === 1 && selection && selection.isCollapsed) {
    if (!activeAlignMark) {
      return controller.command(Commands.addMark, alignMark);
    }

    if (activeAlignMark.data.value !== alignType) {
      return controller.command(Commands.removeMark, activeAlignMark).command(Commands.addMark, alignMark);
    }

    controller.command(Commands.removeMark, alignMark);
  } else {
    ranges.forEach(function (range) {
      if (!activeAlignMark) {
        return controller.command(Commands.addMarkAtRange, range, alignMark);
      }

      if (activeAlignMark.data.value !== alignType) {
        return controller.command(Commands.removeMarkAtRange, range, activeAlignMark).command(Commands.addMarkAtRange, range, alignMark);
      }

      return controller.command(Commands.removeMarkAtRange, range, alignMark);
    });
  }

  return controller;
}
//# sourceMappingURL=toggleVertAlignMark.js.map