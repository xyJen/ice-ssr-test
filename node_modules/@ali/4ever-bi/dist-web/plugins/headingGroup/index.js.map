{"version":3,"sources":["../../../../src/plugins/headingGroup/index.ts"],"names":["GroupFactory","createGroupNodes","createRenderNode","queries","groupFactory","actions","DRAG_BUTTON_OFFSET","PI_MODE","createHeadingGroupPlugin","config","headingGroup","level","shouldOffsetTypes","i","push","groupType","renderNode","groupNodes","getHeadingGroupLevel","isHeadingGroupAvailable","getLeftToolbarOffset","controller","data","node","isPi","query","includes","type","x","y","undefined"],"mappings":";AAAA,SAASA,YAAT,QAA6B,mBAA7B;AAEA,OAAOC,gBAAP;AACA,OAAOC,gBAAP;AACA,OAAO,KAAKC,OAAZ;AACA,SAASC,YAAT,QAA6B,oBAA7B;IAEQC,O,GAAYL,Y,CAAZK,O;AACR,IAAMC,kBAAkB,GAAG,CAAC,EAA5B;AACA,IAAMC,OAAO,GAAG,aAAhB;AAEA,IAAMC,wBAAwB,GAAGJ,YAAY,CAAC,UAACK,MAAD,EAA4B;AAAA,6BAC1CA,MAD0C,CAChEC,YADgE;AAAA,MAChEA,YADgE,qCACjD,EADiD;AAAA,4BAElDA,YAFkD,CAEhEC,KAFgE;AAAA,MAEhEA,KAFgE,oCAExD,CAFwD;AAGxE,MAAMC,iBAA2B,GAAG,EAApC;;AACA,OAAK,IAAIC,CAAC,GAAGF,KAAb,EAAoBE,CAAC,GAAG,CAAxB,EAA2BA,CAAC,EAA5B,EAAgC;AAC9BD,IAAAA,iBAAiB,CAACE,IAAlB,cAAkCD,CAAlC;AACD;;AAAA;AACD,SAAO;AACLE,IAAAA,SAAS,EAAE,cADN;AAELC,IAAAA,UAAU,EAAEd,gBAAgB,CAACQ,YAAD,CAFvB;AAGLO,IAAAA,UAAU,EAAEhB,gBAAgB,CAACS,YAAD,CAHvB;AAILP,IAAAA,OAAO;AACLe,MAAAA,oBAAoB,EAAE;AAAA,eAAMP,KAAN;AAAA,OADjB;AAELQ,MAAAA,uBAAuB,EAAE;AAAA,eAAM,IAAN;AAAA,OAFpB;AAGLC,MAAAA,oBAAoB,EAAE,8BAACC,UAAD,EAAaC,IAAb,EAAsB;AAAA,YAClCC,IADkC,GACzBD,IADyB,CAClCC,IADkC;AAE1C,YAAMC,IAAI,GAAGH,UAAU,CAACI,KAAX,CAAiB,eAAjB,MAAsClB,OAAnD;;AACA,YAAI,CAACiB,IAAD,IAASZ,iBAAiB,CAACc,QAAlB,CAA2BH,IAAI,CAACI,IAAhC,CAAb,EAAoD;AAClD,iBAAO;AACL;AACAC,YAAAA,CAAC,EAAEtB,kBAAkB,GAAG,CAFnB;AAGLuB,YAAAA,CAAC,EAAE;AAHE,WAAP;AAKD;;AACD,eAAOC,SAAP;AACD;AAdI,OAeF3B,OAfE;AAJF,GAAP;AAsBD,CA7B4C,CAA7C,C,CA+BA;;AACAK,wBAAwB,CAACH,OAAzB,GAAmCA,OAAnC,C,CACA;;AACAG,wBAAwB,CAACL,OAAzB,GAAmCA,OAAnC;AAEA,eAAeK,wBAAf","sourcesContent":["import { GroupFactory } from '@ali/4ever-bamboo';\nimport { BiPluginConfig } from '../../types';\nimport createGroupNodes from './handlers/createGroupNodes';\nimport createRenderNode from './handlers/createRenderNode';\nimport * as queries from './queries';\nimport { groupFactory } from '@ali/4ever-factory';\n\nconst { actions } = GroupFactory;\nconst DRAG_BUTTON_OFFSET = -20;\nconst PI_MODE = 'page_layout';\n\nconst createHeadingGroupPlugin = groupFactory((config: BiPluginConfig) => {\n  const { headingGroup = {} } = config;\n  const { level = 3 } = headingGroup;\n  const shouldOffsetTypes: string[] = [];\n  for (let i = level; i > 0; i--) {\n    shouldOffsetTypes.push(`heading-${i}`);\n  };\n  return {\n    groupType: 'headingGroup',\n    renderNode: createRenderNode(headingGroup),\n    groupNodes: createGroupNodes(headingGroup),\n    queries: {\n      getHeadingGroupLevel: () => level,\n      isHeadingGroupAvailable: () => true,\n      getLeftToolbarOffset: (controller, data) => {\n        const { node } = data;\n        const isPi = controller.query('getLayoutMode') === PI_MODE;\n        if (!isPi && shouldOffsetTypes.includes(node.type)) {\n          return {\n            // 这里加上4是因为左侧工具栏的offset为6，但是在标题场景下是2\n            x: DRAG_BUTTON_OFFSET + 4,\n            y: 0,\n          };\n        }\n        return undefined;\n      },\n      ...queries,\n    },\n  };\n});\n\n// @ts-ignore\ncreateHeadingGroupPlugin.actions = actions;\n// @ts-ignore\ncreateHeadingGroupPlugin.queries = queries;\n\nexport default createHeadingGroupPlugin;\n"],"file":"index.js"}