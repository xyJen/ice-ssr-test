{"version":3,"sources":["../../../../../src/plugins/newlineGuide/handlers/createOnKeyDown.ts"],"names":["environment","isKeyHotkey","NewlineGuideData","isMoveHotKey","event","map","key","some","isEvent","createOnKeyUp","config","newlineGuideEnabled","newlineGuide","enabled","controller","next","IS_MOBILE","get","triggered","showMenu","preventDefault"],"mappings":"AAAA,SAAqBA,WAArB,QAAwC,oBAAxC;AAEA,SAASC,WAAT,QAA4B,WAA5B;AACA,SAASC,gBAAT;;AAGA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,KAAD;AAAA,SAAgC,CAAC,IAAD,EAAO,MAAP,EAAe,MAAf,EAAuB,OAAvB,EAAgC,OAAhC,EAClDC,GADkD,CAC9C,UAACC,GAAD;AAAA,WAASL,WAAW,CAACK,GAAD,CAApB;AAAA,GAD8C,EAElDC,IAFkD,CAE7C,UAACC,OAAD;AAAA,WAAaA,OAAO,CAACJ,KAAD,CAApB;AAAA,GAF6C,CAAhC;AAAA,CAArB;AAIA;AACA;AACA;;;AACA,eAAe,SAASK,aAAT,CAAuBC,MAAvB,EAA+C;AAAA;;AAC5D,MAAMC,mBAAmB,2BAAGD,MAAM,CAACE,YAAV,qBAAG,qBAAqBC,OAAjD;AACA,SAAO,UAACT,KAAD,EAA6BU,UAA7B,EAAqDC,IAArD,EAAwE;AAC7E,QAAI,CAACJ,mBAAD,IAAwBX,WAAW,CAACgB,SAAxC,EAAmD,OAAOD,IAAI,EAAX;;AAD0B,eAG7Cb,gBAAgB,CAACe,GAAjB,CAAqBH,UAArB,KAAoC,EAHS;AAAA,QAGrEI,SAHqE,QAGrEA,SAHqE;AAAA,QAG1DC,QAH0D,QAG1DA,QAH0D,EAI7E;;;AACA,QAAID,SAAS,IAAIC,QAAb,IAAyBhB,YAAY,CAACC,KAAD,CAAzC,EAAkD;AAChD,aAAOA,KAAK,CAACgB,cAAN,EAAP;AACD;;AACD,WAAOL,IAAI,EAAX;AACD,GATD;AAUD","sourcesContent":["import { Controller, environment } from '@ali/4ever-cangjie';\nimport React from 'react';\nimport { isKeyHotkey } from 'is-hotkey';\nimport { NewlineGuideData } from '../model/newlineGuide';\nimport { BiPluginConfig } from '../../../types';\n\nconst isMoveHotKey = (event: React.KeyboardEvent) => ['up', 'down', 'left', 'right', 'enter']\n  .map((key) => isKeyHotkey(key))\n  .some((isEvent) => isEvent(event));\n\n/**\n * onKeyDown 仅仅用于在下拉菜单弹出的时候拦截方向键事件\n */\nexport default function createOnKeyUp(config: BiPluginConfig) {\n  const newlineGuideEnabled = config.newlineGuide?.enabled;\n  return (event: React.KeyboardEvent, controller: Controller, next: Function) => {\n    if (!newlineGuideEnabled || environment.IS_MOBILE) return next();\n\n    const { triggered, showMenu } = NewlineGuideData.get(controller) || {};\n    // 这里由于trigger状态发生了变化，所以需要区分展开下拉框和\n    if (triggered && showMenu && isMoveHotKey(event)) {\n      return event.preventDefault();\n    }\n    return next();\n  };\n}\n"],"file":"createOnKeyDown.js"}