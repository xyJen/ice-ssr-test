{"version":3,"sources":["../../../../../src/plugins/heading/components/headingSimpleButton.tsx"],"names":["React","HeadingSimpleSelect","OriginHeadingSimpleSelect","PluginRoles","setHeading","enableBlockquote","disableBlockquote","SUPPORT_HEADING","paragraph","blockquote","isDisabled","controller","isCollapsedAtEdge","value","selection","query","Boolean","HeadingSimpleButton","props","locale","size","heading","handleChange","useCallback","run","useMemo","buttonTitle","headingSelect"],"mappings":"AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;qBAC4B,a;AAC5B,SAASC,mBAAmB,IAAIC,yBAAhC,QAAiE,iBAAjE;AACA,SAASC,WAAT,QAA4B,mBAA5B;AACA,SAASC,UAAT;AACA,SAASC,gBAAT,EAA2BC,iBAA3B,QAAoD,kBAApD;AACA;AAGA,IAAMC,eAAe,GAAG;AACtBC,EAAAA,SAAS,EAAE,IADW;AAEtB,eAAa,IAFS;AAGtB,eAAa,IAHS;AAItB,eAAa,IAJS;AAKtB,eAAa,IALS;AAMtBC,EAAAA,UAAU,EAAE;AANU,CAAxB;AAeA,OAAO,IAAMC,UAAU,GAAG,oBAACC,UAAD,EAA4B;AAAA,MAC5CC,iBAD4C,GACtBD,UAAU,CAACE,KAAX,CAAiBC,SADK,CAC5CF,iBAD4C;AAEpD,MAAMF,UAAU,GAAGE,iBAAiB,IAC/BD,UAAU,CAACI,KAAX,CAAiB,oBAAjB,CADc,IAEdJ,UAAU,CAACI,KAAX,CAAiB,iBAAjB,CAFc,IAGdJ,UAAU,CAACI,KAAX,CAAiB,yBAAjB,CAHc,IAIdJ,UAAU,CAACI,KAAX,CAAiB,uBAAjB,CAJc,CAKjB;AALiB,KAMdJ,UAAU,CAACI,KAAX,CAAiB,6BAAjB,CANL;AAOA,SAAOC,OAAO,CAACN,UAAD,CAAd;AACD,CAVM;AAYP,eAAe,SAASO,mBAAT,CAA6BC,KAA7B,EAA8D;AAAA,MACnEP,UADmE,GACtCO,KADsC,CACnEP,UADmE;AAAA,MACvDQ,MADuD,GACtCD,KADsC,CACvDC,MADuD;AAAA,MAC/CC,IAD+C,GACtCF,KADsC,CAC/CE,IAD+C;AAE3E,MAAMC,OAAO,GAAGV,UAAU,CAACI,KAAX,CAAiB,oBAAjB,IAAyC,YAAzC,GAAwDJ,UAAU,CAACI,KAAX,CAAiB,YAAjB,CAAxE;AAEA,MAAMO,YAAY,GAAGtB,KAAK,CAACuB,WAAN,CAAkB,UAACV,KAAD,EAAmB;AACxD,QAAIA,KAAK,KAAK,YAAd,EAA4B;AAC1BF,MAAAA,UAAU,CAACa,GAAX,CAAe,UAAf,EAA2BpB,UAAU,CAAC,WAAD,CAArC;AACAO,MAAAA,UAAU,CAACa,GAAX,CAAe,UAAf,EAA2BnB,gBAAgB,EAA3C;AACD,KAHD,MAGO;AACLM,MAAAA,UAAU,CAACa,GAAX,CAAe,UAAf,EAA2BpB,UAAU,CAACS,KAAD,CAArC;AACAF,MAAAA,UAAU,CAACa,GAAX,CAAe,UAAf,EAA2BlB,iBAAiB,EAA5C;AACD;AACF,GARoB,EAQlB,CAACK,UAAD,CARkB,CAArB;AAUA,MAAMV,mBAAmB,GAAGD,KAAK,CAACyB,OAAN,CAAc;AAAA,WAAMvB,yBAAN;AAAA,GAAd,EAA+C,EAA/C,CAA5B;AAEA,sBACE,eAAC,mBAAD;AACE,IAAA,IAAI,EAAEkB,IADR;AAEE,IAAA,QAAQ,EAAEE,YAFZ;AAGE,IAAA,KAAK,EAAEf,eAAe,CAACc,OAAD,CAAf,GAAkCA,OAAlC,GAAmD,WAH5D;AAIE,IAAA,MAAM,EAAC,2BAJT;AAKE,IAAA,QAAQ,EAAEX,UAAU,CAACC,UAAD,CALtB;AAME,IAAA,OAAO,EAAEQ,MAAM,CAACO,WANlB;AAOE,IAAA,IAAI,EAAEvB,WAAW,CAACwB;AAPpB,IADF;AAWD","sourcesContent":["import * as React from 'react';\nimport styled from 'styled-components';\nimport { HeadingSimpleSelect as OriginHeadingSimpleSelect } from '@ali/we-toolbar';\nimport { PluginRoles } from '@ali/4ever-bamboo';\nimport { setHeading } from '../actions';\nimport { enableBlockquote, disableBlockquote } from '@ali/4ever-utils';\n;\nimport { Controller } from '@ali/4ever-cangjie';\n\nconst SUPPORT_HEADING = {\n  paragraph: true,\n  'heading-1': true,\n  'heading-2': true,\n  'heading-3': true,\n  'heading-4': true,\n  blockquote: true,\n};\n\nexport interface HeadingSimpleButtonProps {\n  controller: Controller;\n  locale: Record<string, string>;\n  size: 'large' | 'medium' | 'small';\n}\n\nexport const isDisabled = (controller: Controller) => {\n  const { isCollapsedAtEdge } = controller.value.selection;\n  const isDisabled = isCollapsedAtEdge\n    || controller.query('isSelectionInImage')\n    || controller.query('isSelectionInHr')\n    || controller.query('isSelectionInListSymbol')\n    || controller.query('isSelectionInLinkCard')\n    // fix: https://aone.alibaba-inc.com/v2/bug/35749970\n    || controller.query('isSelectionInSubjectHeading');\n  return Boolean(isDisabled);\n}\n\nexport default function HeadingSimpleButton(props: HeadingSimpleButtonProps) {\n  const { controller, locale, size } = props;\n  const heading = controller.query('getBlockquoteState') ? 'blockquote' : controller.query('getHeading');\n\n  const handleChange = React.useCallback((value: string) => {\n    if (value === 'blockquote') {\n      controller.run('onAction', setHeading('paragraph'));\n      controller.run('onAction', enableBlockquote());\n    } else {\n      controller.run('onAction', setHeading(value));\n      controller.run('onAction', disableBlockquote());\n    }\n  }, [controller]);\n\n  const HeadingSimpleSelect = React.useMemo(() => OriginHeadingSimpleSelect, []);\n\n  return (\n    <HeadingSimpleSelect\n      size={size}\n      onChange={handleChange}\n      value={SUPPORT_HEADING[heading as any] ? heading as any : 'paragraph'}\n      testid=\"bi-toolbar-simple-heading\"\n      disabled={isDisabled(controller)}\n      tooltip={locale.buttonTitle}\n      role={PluginRoles.headingSelect}\n    />\n  );\n}\n"],"file":"headingSimpleButton.js"}