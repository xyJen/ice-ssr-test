{"version":3,"sources":["../../../../../src/plugins/heading/handlers/createOnCangjiePaste.ts"],"names":["constants","transferUtils","MIME_TYPES","createOnCangjiePaste","config","event","controller","next","clipboardData","query","hasData","FRAGMENT","fragment","getFragment","nodes","length","nextFragment","setData","encodeFragment","onCangjiePaste"],"mappings":";;AAAA,SAAiBA,SAAjB,EAA4BC,aAA5B,QAA2D,oBAA3D;IAGQC,U,GAAeF,S,CAAfE,U;AAER,eAAe,SAASC,oBAAT,CACbC,MADa,EAEa;AAE1B;AAAA,mFAAO,iBAA8BC,KAA9B,EAAqCC,UAArC,EAAiDC,IAAjD;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACCC,cAAAA,aADD,GACiBF,UAAU,CAACG,KAAX,CAAiB,kBAAjB,EAAqCJ,KAArC,CADjB;;AAAA,kBAEAG,aAFA,YAEAA,aAAa,CAAEE,OAAf,CAAuBR,UAAU,CAACS,QAAlC,CAFA;AAAA;AAAA;AAAA;;AAAA,+CAGIJ,IAAI,EAHR;;AAAA;AAKDK,cAAAA,QALC,GAKUJ,aAAa,CAACK,WAAd,EALV;;AAAA,kBAMAD,QANA,+BAMAA,QAAQ,CAAEE,KANV,aAMA,gBAAiBC,MANjB;AAAA;AAAA;AAAA;;AAAA,+CAMgCR,IAAI,EANpC;;AAAA;AAQCS,cAAAA,YARD,GAQ6CV,UAAU,CAACG,KAAX,CAAiB,yBAAjB,EAA4CG,QAA5C,CAR7C;;AAUL,kBAAII,YAAJ,EAAkB;AAChBX,gBAAAA,KAAK,CAACG,aAAN,CAAqBS,OAArB,CACEf,UAAU,CAACS,QADb,EAEEV,aAAa,CAACiB,cAAd,CAA6BF,YAA7B,CAFF;AAID;;AAfI,+CAgBET,IAAI,EAhBN;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA,aAAsBY,cAAtB;AAAA;AAAA;;AAAA,WAAsBA,cAAtB;AAAA;AAkBD;AAAA","sourcesContent":["import { Plugin, constants, transferUtils, Document } from '@ali/4ever-cangjie';\nimport { BiPluginConfig } from '../../../types';\n\nconst { MIME_TYPES } = constants;\n\nexport default function createOnCangjiePaste(\n  config: BiPluginConfig,\n): Plugin['onCangjiePaste'] {\n\n  return async function onCangjiePaste(event, controller, next) {\n    const clipboardData = controller.query('getClipboardData', event);\n    if (!clipboardData?.hasData(MIME_TYPES.FRAGMENT)) {\n      return next();\n    }\n    let fragment = clipboardData.getFragment();\n    if (!fragment?.nodes?.length) return next();\n\n    const nextFragment: null | undefined | Document = controller.query('getHeadingPasteFragment', fragment);\n\n    if (nextFragment) {\n      event.clipboardData!.setData(\n        MIME_TYPES.FRAGMENT,\n        transferUtils.encodeFragment(nextFragment),\n      );\n    }\n    return next();\n  };\n};\n"],"file":"createOnCangjiePaste.js"}