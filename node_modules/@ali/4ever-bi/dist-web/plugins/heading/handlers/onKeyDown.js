import { hotkeys } from '@ali/4ever-cangjie';
import onEnter from "./onEnter";
import onBackspace from "./onBackspace";
import isKeyHotKey, { toKeyCode } from 'is-hotkey';
import { setHeading as setHeadingAction } from "../actions";
var MAX_TITLE_LEVEL = 6;
var ZERO_KEY_CODE = toKeyCode('0');
var hotKeys = [].concat(Array.from({
  length: MAX_TITLE_LEVEL + 1
})).map(function (_, index) {
  return "mod+alt+" + index;
});
var isHeadingHotKey = isKeyHotKey(hotKeys);
var isBackspaceHotKey = isKeyHotKey('backspace');
export default function onKeyDown(event, controller, next) {
  if (hotkeys.isEnter(event)) {
    return onEnter(event, controller, next);
  }

  if (isBackspaceHotKey(event)) {
    return onBackspace(event, controller, next);
  } // fix: https://aone.alibaba-inc.com/v2/project/1090534/bug/35667506


  if (isHeadingHotKey(event) && !controller.query('isSelectionInSubjectHeading')) {
    event.preventDefault();
    var level = event.keyCode - ZERO_KEY_CODE;

    if (level === 0) {
      controller.run('onAction', setHeadingAction('paragraph'));
      return controller;
    }

    if (level <= MAX_TITLE_LEVEL && level > 0) {
      controller.run('onAction', setHeadingAction("heading-" + level));
      return controller;
    }
  }

  return next();
}
//# sourceMappingURL=onKeyDown.js.map