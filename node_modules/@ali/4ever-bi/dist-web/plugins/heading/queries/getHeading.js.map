{"version":3,"sources":["../../../../../src/plugins/heading/queries/getHeading.ts"],"names":["environment","Block","Heading","Paragraph","getRangesFromEditor","getHeadingAtRanges","getHeading","controller","value","startBlock","endBlock","emptyHeading","IS_MOBILE","type","ranges","headings","length","heading","create","isParagraph","isHeading"],"mappings":"AAAA,SAAqBA,WAArB,EAAkCC,KAAlC,QAA+C,oBAA/C;AACA,SAASC,OAAT,EAAkBC,SAAlB,QAAmC,eAAnC;AACA,SAASC,mBAAT,QAAqC,kBAArC;AACA,OAAOC,kBAAP;AAEA,eAAe,SAASC,UAAT,CAAoBC,UAApB,EAA4C;AAAA,0BACxBA,UAAU,CAACC,KADa;AAAA,MACjDC,UADiD,qBACjDA,UADiD;AAAA,MACrCC,QADqC,qBACrCA,QADqC,EAGzD;;AACA,MAAMC,YAAY,GAAGX,WAAW,CAACY,SAAZ,GAAwB,WAAxB,GAAsC,EAA3D,CAJyD,CAMzD;;AACA,MAAI,CAAAH,UAAU,QAAV,YAAAA,UAAU,CAAEI,IAAZ,OAAqBH,QAArB,oBAAqBA,QAAQ,CAAEG,IAA/B,CAAJ,EAAyC,OAAOF,YAAP;AAEzC,MAAMG,MAAM,GAAGV,mBAAmB,CAACG,UAAD,CAAlC;AACA,MAAMQ,QAAQ,GAAGV,kBAAkB,CAACE,UAAD,EAAaO,MAAb,CAAnC;;AACA,MAAIC,QAAQ,CAACC,MAAT,KAAoB,CAAxB,EAA2B;AACzB,QAAMC,OAAO,GAAGhB,KAAK,CAACiB,MAAN,CAAa;AAC3BL,MAAAA,IAAI,EAAEE,QAAQ,CAAC,CAAD;AADa,KAAb,CAAhB;;AAGA,QAAIZ,SAAS,CAACgB,WAAV,CAAsBF,OAAtB,KAAkCf,OAAO,CAACkB,SAAR,CAAkBH,OAAlB,CAAtC,EAAkE;AAChE,aAAOA,OAAO,CAACJ,IAAf;AACD;AACF;;AAED,SAAOF,YAAP;AACD","sourcesContent":["import { Controller, environment, Block } from '@ali/4ever-cangjie';\nimport { Heading, Paragraph } from '@ali/4ever-mo';\nimport { getRangesFromEditor }  from '@ali/4ever-utils';\nimport getHeadingAtRanges from '../utils/getHeadingAtRanges';\n\nexport default function getHeading(controller: Controller) {\n  const { startBlock, endBlock } = controller.value;\n\n  // 多个块级元素时返回空，以便区分正文（移动端不做此处理）\n  const emptyHeading = environment.IS_MOBILE ? 'paragraph' : '';\n\n  // 尽量避免遍历 ranges\n  if (startBlock?.type !== endBlock?.type) return emptyHeading;\n\n  const ranges = getRangesFromEditor(controller);\n  const headings = getHeadingAtRanges(controller, ranges);\n  if (headings.length === 1) {\n    const heading = Block.create({\n      type: headings[0],\n    });\n    if (Paragraph.isParagraph(heading) || Heading.isHeading(heading)) {\n      return heading.type;\n    }\n  }\n\n  return emptyHeading;\n}\n"],"file":"getHeading.js"}