{"version":3,"sources":["../../../../../src/plugins/heading/queries/getHeadingPasteFragment.ts"],"names":["Heading","Marks","Paragraph","removeFirstNodeMarkByTypes","isSelectionAtHeading","SZ_BOLD_MARKS","Sz","TYPE","Bold","getHeadingPasteFragment","controller","fragment","nodes","isAtHeading","value","isFragStartWithHeading","isHeading","nextFragment","isParagraph"],"mappings":"AACA,SAASA,OAAT,EAAkBC,KAAlB,EAAyBC,SAAzB,QAA0C,eAA1C;AACA,SACEC,0BADF,EAEEC,oBAFF;AAKA,IAAMC,aAAa,GAAG,CAACJ,KAAK,CAACK,EAAN,CAASC,IAAV,EAAgBN,KAAK,CAACO,IAAN,CAAWD,IAA3B,CAAtB;AAEA,eAAe,SAASE,uBAAT,CAAiCC,UAAjC,EAAyDC,QAAzD,EAA8E;AAC3F,MAAI,CAACA,QAAL,EAAe,OAAOA,QAAP;AAD4E,MAEnFC,KAFmF,GAEzED,QAFyE,CAEnFC,KAFmF;AAG3F,MAAMC,WAAW,GAAGT,oBAAoB,CAACM,UAAU,CAACI,KAAZ,CAAxC;AACA,MAAMC,sBAAsB,GAAGf,OAAO,CAACgB,SAAR,CAAkBJ,KAAK,CAAC,CAAD,CAAvB,CAA/B;AAEA,MAAIK,YAAJ;;AACA,MAAIF,sBAAJ,EAA4B;AAC1B;AACAE,IAAAA,YAAY,GAAGd,0BAA0B,CAACQ,QAAD,EAAWN,aAAX,CAAzC;AACD,GAHD,MAGO,IAAIH,SAAS,CAACgB,WAAV,CAAsBN,KAAK,CAAC,CAAD,CAA3B,KAAmCC,WAAvC,EAAoD;AACzD;AACAI,IAAAA,YAAY,GAAGd,0BAA0B,CAACQ,QAAD,EAAWN,aAAX,CAAzC;AACD;;AAED,SAAOY,YAAP;AACD","sourcesContent":["import { Controller, Document } from '@ali/4ever-cangjie';\nimport { Heading, Marks, Paragraph } from '@ali/4ever-mo';\nimport {\n  removeFirstNodeMarkByTypes,\n  isSelectionAtHeading,\n} from '../utils/fragment';\n\nconst SZ_BOLD_MARKS = [Marks.Sz.TYPE, Marks.Bold.TYPE];\n\nexport default function getHeadingPasteFragment(controller: Controller, fragment?: Document) {\n  if (!fragment) return fragment;\n  const { nodes } = fragment;\n  const isAtHeading = isSelectionAtHeading(controller.value);\n  const isFragStartWithHeading = Heading.isHeading(nodes[0]);\n\n  let nextFragment: undefined | Document;\n  if (isFragStartWithHeading) {\n    // 1 复制标题内容：移除字号和加粗 mark，以便粘贴到其它段落或标题能匹配目标格式\n    nextFragment = removeFirstNodeMarkByTypes(fragment, SZ_BOLD_MARKS);\n  } else if (Paragraph.isParagraph(nodes[0]) && isAtHeading) {\n    // 2 复制普通段落内容：粘贴到标题中去除 marks 以便匹配标题格式\n    nextFragment = removeFirstNodeMarkByTypes(fragment, SZ_BOLD_MARKS);\n  }\n\n  return nextFragment;\n}"],"file":"getHeadingPasteFragment.js"}