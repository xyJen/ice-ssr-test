{"version":3,"sources":["../../../../../src/plugins/onlineVideo/handlers/onAction.ts"],"names":["Commands","ONLINEVIDEO_UPDATE","ONLINEVIDEO_INSERT","ONLINEVIDEO_REMOVE","ONLINEVIDEO_FOCUS_EDITOR","ONLINEVIDEO_SELECT","updateOnlineVideo","removeOnlineVideo","insertOnlineVideo","biActions","basicActions","FOCUSED_ONLINEVIDEO","onAction","state","action","editor","next","type","payload","node","data","run","createMergeDataAction","key","command","blur","focus","moveToRangeOfNode"],"mappings":"AAAA,SAAqBA,QAArB,QAAqC,oBAArC;AACA,SACEC,kBADF,EAEEC,kBAFF,EAGEC,kBAHF,EAIEC,wBAJF,EAKEC,kBALF;AAOA,OAAOC,iBAAP;AACA,OAAOC,iBAAP;AACA,OAAOC,iBAAP;AACA,SAASC,SAAS,IAAIC,YAAtB,QAA0C,yBAA1C;AACA,SAASC,mBAAT;;AAEA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACC,KAAD;AAAA,SAAoC,UACnDC,MADmD,EAEnDC,MAFmD,EAGnDC,IAHmD,EAIhD;AAAA,QACKC,IADL,GACuBH,MADvB,CACKG,IADL;AAAA,QACWC,OADX,GACuBJ,MADvB,CACWI,OADX;;AAEH,QAAID,IAAI,KAAKf,kBAAb,EAAiC;AAC/B,aAAOM,iBAAiB,CAACK,KAAD,CAAjB,CAAyBE,MAAzB,CAAP;AACD;;AACD,QAAIE,IAAI,KAAKhB,kBAAb,EAAiC;AAAA,UACvBkB,IADuB,GACRD,OADQ,CACvBC,IADuB;AAAA,UACjBC,IADiB,GACRF,OADQ,CACjBE,IADiB;AAE/B,aAAOd,iBAAiB,CAACS,MAAD,EAASI,IAAT,EAAeC,IAAf,CAAxB;AACD;;AACD,QAAIH,IAAI,KAAKd,kBAAb,EAAiC;AAAA,UACvBgB,KADuB,GACdD,OADc,CACvBC,IADuB;AAE/B,aAAOZ,iBAAiB,CAACQ,MAAD,EAASI,KAAT,CAAxB;AACD;;AACD,QAAIF,IAAI,KAAKb,wBAAb,EAAuC;AAAA;;AAAA,UAC7Be,MAD6B,GACpBD,OADoB,CAC7BC,IAD6B;AAErCJ,MAAAA,MAAM,CAACM,GAAP,CAAW,UAAX,EAAuBX,YAAY,CAACY,qBAAb,oDAAsCX,mBAAtC,IAA4DQ,MAAI,CAACI,GAAjE,yBAAvB;AACA,aAAOR,MAAM,CAACS,OAAP,CACLxB,QAAQ,CAACyB,IADJ,CAAP;AAGD;;AACD,QAAIR,IAAI,KAAKZ,kBAAb,EAAiC;AAAA,UACvBc,MADuB,GACdD,OADc,CACvBC,IADuB;AAE/B,aAAOJ,MAAM,CACVS,OADI,CACIxB,QAAQ,CAAC0B,KADb,EAEJF,OAFI,CAEIxB,QAAQ,CAAC2B,iBAFb,EAEgCR,MAFhC,CAAP;AAGD;;AAED,WAAOH,IAAI,EAAX;AACD,GAhCgB;AAAA,CAAjB;;AAkCA,eAAeJ,QAAf","sourcesContent":["import { Controller, Commands } from '@ali/4ever-cangjie';\nimport {\n  ONLINEVIDEO_UPDATE,\n  ONLINEVIDEO_INSERT,\n  ONLINEVIDEO_REMOVE,\n  ONLINEVIDEO_FOCUS_EDITOR,\n  ONLINEVIDEO_SELECT,\n} from '../actions';\nimport updateOnlineVideo from '../commands/updateOnlineVideo';\nimport removeOnlineVideo from '../commands/removeOnlineVideo';\nimport insertOnlineVideo from '../commands/insertOnlineVideo';\nimport { biActions as basicActions } from '@ali/4ever-plugin-basic';\nimport { FOCUSED_ONLINEVIDEO } from '../constants/value';\n\nconst onAction = (state: Record<string, boolean>) => (\n  action,\n  editor: Controller,\n  next,\n) => {\n  const { type, payload } = action;\n  if (type === ONLINEVIDEO_INSERT) {\n    return insertOnlineVideo(state)(editor);\n  }\n  if (type === ONLINEVIDEO_UPDATE) {\n    const { node, data } = payload;\n    return updateOnlineVideo(editor, node, data);\n  }\n  if (type === ONLINEVIDEO_REMOVE) {\n    const { node } = payload;\n    return removeOnlineVideo(editor, node);\n  }\n  if (type === ONLINEVIDEO_FOCUS_EDITOR) {\n    const { node } = payload;\n    editor.run('onAction', basicActions.createMergeDataAction({ [FOCUSED_ONLINEVIDEO]: node.key }));\n    return editor.command(\n      Commands.blur,\n    );\n  }\n  if (type === ONLINEVIDEO_SELECT) {\n    const { node } = payload;\n    return editor\n      .command(Commands.focus)\n      .command(Commands.moveToRangeOfNode, node);\n  }\n\n  return next();\n};\n\nexport default onAction;\n"],"file":"onAction.js"}