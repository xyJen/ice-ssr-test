"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

require("@testing-library/jest-dom/extend-expect");

var _react = require("@testing-library/react");

var _everDevTest = require("@ali/4ever-dev-test");

var _editor = _interopRequireDefault(require("../../../editor"));

/** @jsx jsx */
var _ref = (0, _everDevTest.jsx)("anchor", null);

var _ref2 = (0, _everDevTest.jsx)("m", {
  type: "bold"
}, "Hello word");

var _ref3 = (0, _everDevTest.jsx)("focus", null);

var _ref4 = (0, _everDevTest.jsx)("anchor", null);

var _ref5 = (0, _everDevTest.jsx)("m", {
  type: "bold"
}, "Hello", (0, _everDevTest.jsx)("focus", null), "word");

var _ref6 = (0, _everDevTest.jsx)("anchor", null);

var _ref7 = (0, _everDevTest.jsx)("m", {
  type: "bold"
}, "Hello", (0, _everDevTest.jsx)("focus", null), "word");

var _ref8 = (0, _everDevTest.jsx)("m", {
  type: "bold"
}, "Hello", (0, _everDevTest.jsx)("cursor", null), "word");

describe('选区复制', () => {
  [{
    type: 'heading-1',
    data: {},
    desc: '标题',
    html: '<article class=\"4ever-article\" data-clipboard-cangjie=\"[&quot;root&quot;,{&quot;copyFrom&quot;:887063969},[&quot;h1&quot;,{},[&quot;span&quot;,{&quot;data-type&quot;:&quot;text&quot;},[&quot;span&quot;,{&quot;bold&quot;:true,&quot;sz&quot;:15,&quot;szUnit&quot;:&quot;pt&quot;,&quot;data-type&quot;:&quot;leaf&quot;},&quot;Hello word&quot;]]]]\" data-identifier-application__slash__x-cangjie-fragment=\"JTdCJTIya2xhc3MlMjIlM0ElMjJkb2N1bWVudCUyMiUyQyUyMmRhdGElMjIlM0ElN0IlN0QlMkMlMjJub2RlcyUyMiUzQSU1QiU3QiUyMmtsYXNzJTIyJTNBJTIyYmxvY2slMjIlMkMlMjJ0eXBlJTIyJTNBJTIyaGVhZGluZy0xJTIyJTJDJTIyZGF0YSUyMiUzQSU3QiU3RCUyQyUyMm5vZGVzJTIyJTNBJTVCJTdCJTIya2xhc3MlMjIlM0ElMjJ0ZXh0JTIyJTJDJTIybGVhdmVzJTIyJTNBJTVCJTdCJTIya2xhc3MlMjIlM0ElMjJsZWFmJTIyJTJDJTIydGV4dCUyMiUzQSUyMkhlbGxvJTIwd29yZCUyMiUyQyUyMm1hcmtzJTIyJTNBJTVCJTdCJTIya2xhc3MlMjIlM0ElMjJtYXJrJTIyJTJDJTIydHlwZSUyMiUzQSUyMmJvbGQlMjIlMkMlMjJkYXRhJTIyJTNBJTdCJTdEJTdEJTJDJTdCJTIya2xhc3MlMjIlM0ElMjJtYXJrJTIyJTJDJTIydHlwZSUyMiUzQSUyMnN6JTIyJTJDJTIyZGF0YSUyMiUzQSU3QiUyMnZhbHVlJTIyJTNBMTUlMkMlMjJzelVuaXQlMjIlM0ElMjJwdCUyMiU3RCU3RCU1RCU3RCU1RCU3RCU1RCU3RCU1RCU3RA==\"><h1 style=\"font-size:20pt;line-height:1.45;margin-top:0;margin-bottom:0;text-align:left;text-indent:0;margin-left:0\"><span data-type=\"text\" style=\"font-weight:bold;font-size:15pt\">Hello&nbsp;word</span></h1></article>'
  }, {
    type: 'paragraph',
    data: {},
    desc: '普通段落',
    html: '<article class=\"4ever-article\" data-clipboard-cangjie=\"[&quot;root&quot;,{&quot;copyFrom&quot;:887063969},[&quot;p&quot;,{},[&quot;span&quot;,{&quot;data-type&quot;:&quot;text&quot;},[&quot;span&quot;,{&quot;bold&quot;:true,&quot;sz&quot;:15,&quot;szUnit&quot;:&quot;pt&quot;,&quot;data-type&quot;:&quot;leaf&quot;},&quot;Hello word&quot;]]]]\" data-identifier-application__slash__x-cangjie-fragment=\"JTdCJTIya2xhc3MlMjIlM0ElMjJkb2N1bWVudCUyMiUyQyUyMmRhdGElMjIlM0ElN0IlN0QlMkMlMjJub2RlcyUyMiUzQSU1QiU3QiUyMmtsYXNzJTIyJTNBJTIyYmxvY2slMjIlMkMlMjJ0eXBlJTIyJTNBJTIycGFyYWdyYXBoJTIyJTJDJTIyZGF0YSUyMiUzQSU3QiU3RCUyQyUyMm5vZGVzJTIyJTNBJTVCJTdCJTIya2xhc3MlMjIlM0ElMjJ0ZXh0JTIyJTJDJTIybGVhdmVzJTIyJTNBJTVCJTdCJTIya2xhc3MlMjIlM0ElMjJsZWFmJTIyJTJDJTIydGV4dCUyMiUzQSUyMkhlbGxvJTIwd29yZCUyMiUyQyUyMm1hcmtzJTIyJTNBJTVCJTdCJTIya2xhc3MlMjIlM0ElMjJtYXJrJTIyJTJDJTIydHlwZSUyMiUzQSUyMmJvbGQlMjIlMkMlMjJkYXRhJTIyJTNBJTdCJTdEJTdEJTJDJTdCJTIya2xhc3MlMjIlM0ElMjJtYXJrJTIyJTJDJTIydHlwZSUyMiUzQSUyMnN6JTIyJTJDJTIyZGF0YSUyMiUzQSU3QiUyMnZhbHVlJTIyJTNBMTUlMkMlMjJzelVuaXQlMjIlM0ElMjJwdCUyMiU3RCU3RCU1RCU3RCU1RCU3RCU1RCU3RCU1RCU3RA==\"><p style=\"text-align:left;text-indent:0;margin-left:0;margin-top:0;margin-bottom:0\"><span data-type=\"text\" style=\"font-weight:bold;font-size:15pt\">Hello&nbsp;word</span></p></article>'
  }, {
    type: 'paragraph',
    data: {
      list: {
        listId: 'dn7ncrq6m7j',
        level: 0,
        isOrdered: true,
        listStyleType: 'DEC_LEN_LROM_P'
      },
      ind: {
        left: 32
      }
    },
    desc: '列表',
    html: '<article class=\"4ever-article\" data-clipboard-cangjie=\"[&quot;root&quot;,{&quot;copyFrom&quot;:887063969},[&quot;p&quot;,{&quot;list&quot;:{&quot;listId&quot;:&quot;dn7ncrq6m7j&quot;,&quot;level&quot;:0,&quot;isOrdered&quot;:true,&quot;listStyleType&quot;:&quot;DEC_LEN_LROM_P&quot;},&quot;ind&quot;:{&quot;left&quot;:32}},[&quot;span&quot;,{&quot;data-type&quot;:&quot;text&quot;},[&quot;span&quot;,{&quot;bold&quot;:true,&quot;sz&quot;:15,&quot;szUnit&quot;:&quot;pt&quot;,&quot;data-type&quot;:&quot;leaf&quot;},&quot;Hello word&quot;]]]]\" data-identifier-application__slash__x-cangjie-fragment=\"JTdCJTIya2xhc3MlMjIlM0ElMjJkb2N1bWVudCUyMiUyQyUyMmRhdGElMjIlM0ElN0IlN0QlMkMlMjJub2RlcyUyMiUzQSU1QiU3QiUyMmtsYXNzJTIyJTNBJTIyYmxvY2slMjIlMkMlMjJ0eXBlJTIyJTNBJTIycGFyYWdyYXBoJTIyJTJDJTIyZGF0YSUyMiUzQSU3QiUyMmxpc3QlMjIlM0ElN0IlMjJsaXN0SWQlMjIlM0ElMjJkbjduY3JxNm03aiUyMiUyQyUyMmxldmVsJTIyJTNBMCUyQyUyMmlzT3JkZXJlZCUyMiUzQXRydWUlMkMlMjJsaXN0U3R5bGVUeXBlJTIyJTNBJTIyREVDX0xFTl9MUk9NX1AlMjIlN0QlMkMlMjJpbmQlMjIlM0ElN0IlMjJsZWZ0JTIyJTNBMzIlN0QlN0QlMkMlMjJub2RlcyUyMiUzQSU1QiU3QiUyMmtsYXNzJTIyJTNBJTIydGV4dCUyMiUyQyUyMmxlYXZlcyUyMiUzQSU1QiU3QiUyMmtsYXNzJTIyJTNBJTIybGVhZiUyMiUyQyUyMnRleHQlMjIlM0ElMjJIZWxsbyUyMHdvcmQlMjIlMkMlMjJtYXJrcyUyMiUzQSU1QiU3QiUyMmtsYXNzJTIyJTNBJTIybWFyayUyMiUyQyUyMnR5cGUlMjIlM0ElMjJib2xkJTIyJTJDJTIyZGF0YSUyMiUzQSU3QiU3RCU3RCUyQyU3QiUyMmtsYXNzJTIyJTNBJTIybWFyayUyMiUyQyUyMnR5cGUlMjIlM0ElMjJzeiUyMiUyQyUyMmRhdGElMjIlM0ElN0IlMjJ2YWx1ZSUyMiUzQTE1JTJDJTIyc3pVbml0JTIyJTNBJTIycHQlMjIlN0QlN0QlNUQlN0QlNUQlN0QlNUQlN0QlNUQlN0Q=\"><ol><li><div style=\"text-align:left;text-indent:0\"><span data-type=\"text\" style=\"font-weight:bold;font-size:15pt\">Hello&nbsp;word</span></div></li></ol></article>'
  }].forEach(({
    type,
    data,
    desc,
    html
  }) => {
    it(`全选区复制${desc}，复制数据保留${desc}类型及样式`, async () => {
      const value = (0, _everDevTest.jsx)("value", null, (0, _everDevTest.jsx)("document", null, _ref, (0, _everDevTest.jsx)("block", {
        type: type,
        data: data
      }, (0, _everDevTest.jsx)("m", {
        type: "sz",
        data: {
          value: 15,
          szUnit: 'pt'
        }
      }, _ref2)), _ref3));
      const {
        editor
      } = await (0, _everDevTest.renderEditor)((0, _everDevTest.jsx)(_editor.default, {
        defaultValue: value
      }));
      (0, _react.act)(() => {
        const setData = jest.fn();

        _everDevTest.fireEvent.copy(editor, {
          nativeEvent: {
            clipboardData: {
              setData
            },

            preventDefault() {}

          }
        });

        expect(setData.mock.calls[1]).toEqual(['text/html', html]);
      });
    });
  });
  [{
    type: 'paragraph',
    data: {},
    desc: '普通段落',
    html: '<article class=\"4ever-article\" data-clipboard-cangjie=\"[&quot;root&quot;,{&quot;copyFrom&quot;:887063969},[&quot;p&quot;,{},[&quot;span&quot;,{&quot;data-type&quot;:&quot;text&quot;},[&quot;span&quot;,{&quot;bold&quot;:true,&quot;sz&quot;:15,&quot;szUnit&quot;:&quot;pt&quot;,&quot;data-type&quot;:&quot;leaf&quot;},&quot;Hello&quot;]]]]\" data-identifier-application__slash__x-cangjie-fragment=\"JTdCJTIya2xhc3MlMjIlM0ElMjJkb2N1bWVudCUyMiUyQyUyMmRhdGElMjIlM0ElN0IlN0QlMkMlMjJub2RlcyUyMiUzQSU1QiU3QiUyMmtsYXNzJTIyJTNBJTIyYmxvY2slMjIlMkMlMjJ0eXBlJTIyJTNBJTIycGFyYWdyYXBoJTIyJTJDJTIyZGF0YSUyMiUzQSU3QiU3RCUyQyUyMm5vZGVzJTIyJTNBJTVCJTdCJTIya2xhc3MlMjIlM0ElMjJ0ZXh0JTIyJTJDJTIybGVhdmVzJTIyJTNBJTVCJTdCJTIya2xhc3MlMjIlM0ElMjJsZWFmJTIyJTJDJTIydGV4dCUyMiUzQSUyMkhlbGxvJTIyJTJDJTIybWFya3MlMjIlM0ElNUIlN0IlMjJrbGFzcyUyMiUzQSUyMm1hcmslMjIlMkMlMjJ0eXBlJTIyJTNBJTIyYm9sZCUyMiUyQyUyMmRhdGElMjIlM0ElN0IlN0QlN0QlMkMlN0IlMjJrbGFzcyUyMiUzQSUyMm1hcmslMjIlMkMlMjJ0eXBlJTIyJTNBJTIyc3olMjIlMkMlMjJkYXRhJTIyJTNBJTdCJTIydmFsdWUlMjIlM0ExNSUyQyUyMnN6VW5pdCUyMiUzQSUyMnB0JTIyJTdEJTdEJTVEJTdEJTVEJTdEJTVEJTdEJTVEJTdE\"><p style=\"text-align:left;text-indent:0;margin-left:0;margin-top:0;margin-bottom:0\"><span data-type=\"text\" style=\"font-weight:bold;font-size:15pt\">Hello</span></p></article>'
  }, {
    type: 'paragraph',
    data: {
      list: {
        listId: 'dn7ncrq6m7j',
        level: 0,
        isOrdered: true,
        listStyleType: 'DEC_LEN_LROM_P'
      },
      ind: {
        left: 32
      }
    },
    desc: '列表',
    html: '<article class=\"4ever-article\" data-clipboard-cangjie=\"[&quot;root&quot;,{&quot;copyFrom&quot;:887063969},[&quot;p&quot;,{},[&quot;span&quot;,{&quot;data-type&quot;:&quot;text&quot;},[&quot;span&quot;,{&quot;bold&quot;:true,&quot;sz&quot;:15,&quot;szUnit&quot;:&quot;pt&quot;,&quot;data-type&quot;:&quot;leaf&quot;},&quot;Hello&quot;]]]]\" data-identifier-application__slash__x-cangjie-fragment=\"JTdCJTIya2xhc3MlMjIlM0ElMjJkb2N1bWVudCUyMiUyQyUyMmRhdGElMjIlM0ElN0IlN0QlMkMlMjJub2RlcyUyMiUzQSU1QiU3QiUyMmtsYXNzJTIyJTNBJTIyYmxvY2slMjIlMkMlMjJ0eXBlJTIyJTNBJTIycGFyYWdyYXBoJTIyJTJDJTIyZGF0YSUyMiUzQSU3QiUyMmxpc3QlMjIlM0ElN0IlMjJsaXN0SWQlMjIlM0ElMjJkbjduY3JxNm03aiUyMiUyQyUyMmxldmVsJTIyJTNBMCUyQyUyMmlzT3JkZXJlZCUyMiUzQXRydWUlMkMlMjJsaXN0U3R5bGVUeXBlJTIyJTNBJTIyREVDX0xFTl9MUk9NX1AlMjIlN0QlMkMlMjJpbmQlMjIlM0ElN0IlMjJsZWZ0JTIyJTNBMzIlN0QlN0QlMkMlMjJub2RlcyUyMiUzQSU1QiU3QiUyMmtsYXNzJTIyJTNBJTIydGV4dCUyMiUyQyUyMmxlYXZlcyUyMiUzQSU1QiU3QiUyMmtsYXNzJTIyJTNBJTIybGVhZiUyMiUyQyUyMnRleHQlMjIlM0ElMjJIZWxsbyUyMiUyQyUyMm1hcmtzJTIyJTNBJTVCJTdCJTIya2xhc3MlMjIlM0ElMjJtYXJrJTIyJTJDJTIydHlwZSUyMiUzQSUyMmJvbGQlMjIlMkMlMjJkYXRhJTIyJTNBJTdCJTdEJTdEJTJDJTdCJTIya2xhc3MlMjIlM0ElMjJtYXJrJTIyJTJDJTIydHlwZSUyMiUzQSUyMnN6JTIyJTJDJTIyZGF0YSUyMiUzQSU3QiUyMnZhbHVlJTIyJTNBMTUlMkMlMjJzelVuaXQlMjIlM0ElMjJwdCUyMiU3RCU3RCU1RCU3RCU1RCU3RCU1RCU3RCU1RCU3RA==\"><p style=\"text-align:left;text-indent:0;margin-left:0;margin-top:0;margin-bottom:0\"><span data-type=\"text\" style=\"font-weight:bold;font-size:15pt\">Hello</span></p></article>'
  }].forEach(({
    type,
    data,
    desc,
    html
  }) => {
    it(`部分选区复制${desc}，复制数据保留${desc}类型及样式`, async () => {
      const value = (0, _everDevTest.jsx)("value", null, (0, _everDevTest.jsx)("document", null, _ref4, (0, _everDevTest.jsx)("block", {
        type: type,
        data: data
      }, (0, _everDevTest.jsx)("m", {
        type: "sz",
        data: {
          value: 15,
          szUnit: 'pt'
        }
      }, _ref5))));
      const {
        editor
      } = await (0, _everDevTest.renderEditor)((0, _everDevTest.jsx)(_editor.default, {
        defaultValue: value
      }));
      (0, _react.act)(() => {
        const setData = jest.fn();

        _everDevTest.fireEvent.copy(editor, {
          nativeEvent: {
            clipboardData: {
              setData
            },

            preventDefault() {}

          }
        });

        expect(setData.mock.calls[1]).toEqual(['text/html', html]);
      });
    });
  });
  [{
    type: 'heading-1',
    data: {},
    desc: 'heading'
  }].forEach(({
    type,
    data,
    desc
  }) => {
    it(`部分选区复制${desc}，复制数据保留${desc}类型及样式`, async () => {
      const value = (0, _everDevTest.jsx)("value", null, (0, _everDevTest.jsx)("document", null, _ref6, (0, _everDevTest.jsx)("block", {
        type: type,
        data: data
      }, (0, _everDevTest.jsx)("m", {
        type: "sz",
        data: {
          value: 15,
          szUnit: 'pt'
        }
      }, _ref7))));
      const {
        editor
      } = await (0, _everDevTest.renderEditor)((0, _everDevTest.jsx)(_editor.default, {
        defaultValue: value
      }));
      (0, _react.act)(() => {
        const setData = jest.fn();

        _everDevTest.fireEvent.copy(editor, {
          nativeEvent: {
            clipboardData: {
              setData
            },

            preventDefault() {}

          }
        });

        expect(setData.mock.calls[1]).toEqual(['text/html', '<article class=\"4ever-article\" data-clipboard-cangjie=\"[&quot;root&quot;,{&quot;copyFrom&quot;:887063969},[&quot;h1&quot;,{},[&quot;span&quot;,{&quot;data-type&quot;:&quot;text&quot;},[&quot;span&quot;,{&quot;bold&quot;:true,&quot;sz&quot;:15,&quot;szUnit&quot;:&quot;pt&quot;,&quot;data-type&quot;:&quot;leaf&quot;},&quot;Hello&quot;]]]]\" data-identifier-application__slash__x-cangjie-fragment=\"JTdCJTIya2xhc3MlMjIlM0ElMjJkb2N1bWVudCUyMiUyQyUyMmRhdGElMjIlM0ElN0IlN0QlMkMlMjJub2RlcyUyMiUzQSU1QiU3QiUyMmtsYXNzJTIyJTNBJTIyYmxvY2slMjIlMkMlMjJ0eXBlJTIyJTNBJTIyaGVhZGluZy0xJTIyJTJDJTIyZGF0YSUyMiUzQSU3QiU3RCUyQyUyMm5vZGVzJTIyJTNBJTVCJTdCJTIya2xhc3MlMjIlM0ElMjJ0ZXh0JTIyJTJDJTIybGVhdmVzJTIyJTNBJTVCJTdCJTIya2xhc3MlMjIlM0ElMjJsZWFmJTIyJTJDJTIydGV4dCUyMiUzQSUyMkhlbGxvJTIyJTJDJTIybWFya3MlMjIlM0ElNUIlN0IlMjJrbGFzcyUyMiUzQSUyMm1hcmslMjIlMkMlMjJ0eXBlJTIyJTNBJTIyYm9sZCUyMiUyQyUyMmRhdGElMjIlM0ElN0IlN0QlN0QlMkMlN0IlMjJrbGFzcyUyMiUzQSUyMm1hcmslMjIlMkMlMjJ0eXBlJTIyJTNBJTIyc3olMjIlMkMlMjJkYXRhJTIyJTNBJTdCJTIydmFsdWUlMjIlM0ExNSUyQyUyMnN6VW5pdCUyMiUzQSUyMnB0JTIyJTdEJTdEJTVEJTdEJTVEJTdEJTVEJTdEJTVEJTdE\"><h1 style=\"font-size:20pt;line-height:1.45;margin-top:0;margin-bottom:0;text-align:left;text-indent:0;margin-left:0\"><span data-type=\"text\" style=\"font-weight:bold;font-size:15pt\">Hello</span></h1></article>']);
      });
    });
  });
  it('collapsed 选区复制不做任何处理', async () => {
    const value = (0, _everDevTest.jsx)("value", null, (0, _everDevTest.jsx)("document", null, (0, _everDevTest.jsx)("block", {
      type: "paragraph"
    }, (0, _everDevTest.jsx)("m", {
      type: "sz",
      data: {
        value: 15,
        szUnit: 'pt'
      }
    }, _ref8))));
    const {
      editor
    } = await (0, _everDevTest.renderEditor)((0, _everDevTest.jsx)(_editor.default, {
      defaultValue: value
    }));
    (0, _react.act)(() => {
      const setData = jest.fn();

      _everDevTest.fireEvent.copy(editor, {
        nativeEvent: {
          clipboardData: {
            setData
          },

          preventDefault() {}

        }
      });

      expect(setData).not.toHaveBeenCalled();
    });
  });
});
//# sourceMappingURL=rangeSelection.test.js.map