"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _everCangjie = require("@ali/4ever-cangjie");

require("@testing-library/jest-dom/extend-expect");

var _everDevTest = require("@ali/4ever-dev-test");

var _draggable = _interopRequireDefault(require("../../plugins/draggable"));

var _leftToolbar = _interopRequireDefault(require("../../plugins/leftToolbar"));

var _image = _interopRequireDefault(require("../../plugins/image"));

var _everPluginDraggable = require("@ali/4ever-plugin-draggable");

var _ = require("../..");

/** @jsx jsx */
const createBiPlugins = (0, _.createCustomizedBiPlugins)({
  draggable: _draggable.default,
  image: _image.default,
  leftToolbar: _leftToolbar.default
});
const dragBlockCases = [{
  name: 'UpDown',
  dragKey: 'drag-1',
  in: (0, _everDevTest.jsx)("value", null, (0, _everDevTest.jsx)("document", null, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, (0, _everDevTest.jsx)("inline", {
    type: "image",
    key: "drag-1",
    data: {
      src: 'https://cn.bing.com/az/hprichbg/rb/TeslaCoil_EN-CN1604235004_1920x1080.jpg'
    }
  })), (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, (0, _everDevTest.jsx)("cursor", null)))),
  out: (0, _everDevTest.jsx)("value", null, (0, _everDevTest.jsx)("document", null, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }), (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, (0, _everDevTest.jsx)("inline", {
    type: "image",
    key: "drag-1",
    data: {
      src: 'https://cn.bing.com/az/hprichbg/rb/TeslaCoil_EN-CN1604235004_1920x1080.jpg'
    }
  }), (0, _everDevTest.jsx)("cursor", null))))
}, {
  name: 'LeftRight',
  dragKey: 'drag-1',
  in: (0, _everDevTest.jsx)("value", null, (0, _everDevTest.jsx)("document", null, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "A", (0, _everDevTest.jsx)("inline", {
    type: "image",
    key: "drag-1",
    data: {
      src: 'https://cn.bing.com/az/hprichbg/rb/TeslaCoil_EN-CN1604235004_1920x1080.jpg'
    }
  }), "B", (0, _everDevTest.jsx)("cursor", null)))),
  out: (0, _everDevTest.jsx)("value", null, (0, _everDevTest.jsx)("document", null, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "AB", (0, _everDevTest.jsx)("inline", {
    type: "image",
    key: "drag-1",
    data: {
      src: 'https://cn.bing.com/az/hprichbg/rb/TeslaCoil_EN-CN1604235004_1920x1080.jpg'
    }
  }), (0, _everDevTest.jsx)("cursor", null))))
}, {
  name: 'InTable',
  dragKey: 'drag-1',
  in: (0, _everDevTest.jsx)("value", null, (0, _everDevTest.jsx)("document", null, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "A", (0, _everDevTest.jsx)("inline", {
    type: "image",
    key: "drag-1",
    data: {
      src: 'https://cn.bing.com/az/hprichbg/rb/TeslaCoil_EN-CN1604235004_1920x1080.jpg'
    }
  })), (0, _everDevTest.jsx)("block", {
    type: "table",
    key: "table-key",
    data: {
      colsWidth: [100, 100]
    }
  }, (0, _everDevTest.jsx)("block", {
    type: "table-row"
  }, (0, _everDevTest.jsx)("block", {
    type: "table-cell"
  }, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "A")), (0, _everDevTest.jsx)("block", {
    type: "table-cell"
  }, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "B", (0, _everDevTest.jsx)("cursor", null))))))),
  out: (0, _everDevTest.jsx)("value", null, (0, _everDevTest.jsx)("document", null, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "A"), (0, _everDevTest.jsx)("block", {
    type: "table",
    key: "table-key",
    data: {
      colsWidth: [100, 100]
    }
  }, (0, _everDevTest.jsx)("block", {
    type: "table-row"
  }, (0, _everDevTest.jsx)("block", {
    type: "table-cell"
  }, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "A")), (0, _everDevTest.jsx)("block", {
    type: "table-cell"
  }, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "B", (0, _everDevTest.jsx)("inline", {
    type: "image",
    key: "drag-1",
    data: {
      src: 'https://cn.bing.com/az/hprichbg/rb/TeslaCoil_EN-CN1604235004_1920x1080.jpg'
    }
  }), (0, _everDevTest.jsx)("cursor", null)))))))
}, {
  name: 'OutTable',
  dragKey: 'drag-1',
  in: (0, _everDevTest.jsx)("value", null, (0, _everDevTest.jsx)("document", null, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "A", (0, _everDevTest.jsx)("cursor", null)), (0, _everDevTest.jsx)("block", {
    type: "table",
    key: "table-key",
    data: {
      colsWidth: [100, 100]
    }
  }, (0, _everDevTest.jsx)("block", {
    type: "table-row"
  }, (0, _everDevTest.jsx)("block", {
    type: "table-cell"
  }, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "A")), (0, _everDevTest.jsx)("block", {
    type: "table-cell"
  }, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "B", (0, _everDevTest.jsx)("inline", {
    type: "image",
    key: "drag-1",
    data: {
      src: 'https://cn.bing.com/az/hprichbg/rb/TeslaCoil_EN-CN1604235004_1920x1080.jpg'
    }
  }))))))),
  out: (0, _everDevTest.jsx)("value", null, (0, _everDevTest.jsx)("document", null, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "A", (0, _everDevTest.jsx)("inline", {
    type: "image",
    key: "drag-1",
    data: {
      src: 'https://cn.bing.com/az/hprichbg/rb/TeslaCoil_EN-CN1604235004_1920x1080.jpg'
    }
  }), (0, _everDevTest.jsx)("cursor", null)), (0, _everDevTest.jsx)("block", {
    type: "table",
    key: "table-key",
    data: {
      colsWidth: [100, 100]
    }
  }, (0, _everDevTest.jsx)("block", {
    type: "table-row"
  }, (0, _everDevTest.jsx)("block", {
    type: "table-cell"
  }, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "A")), (0, _everDevTest.jsx)("block", {
    type: "table-cell"
  }, (0, _everDevTest.jsx)("block", {
    type: "paragraph"
  }, "B"))))))
}];
const plugins = createBiPlugins({
  draggable: {
    enabled: true
  },
  leftToolbar: {
    menu: [{
      key: 'draggable'
    }]
  }
}).array;
describe('bi/draggable/dropInline.model', () => {
  describe('drag inline', () => {
    dragBlockCases.forEach(testCase => {
      test(`行内元素拖拽-${testCase.name}`, async () => {
        const value = testCase.in;

        const controller = _everCangjie.Controller.create({
          value,
          plugins
        });

        const draggableData = {
          dragFragment: {
            type: _everPluginDraggable.DRAG_TYPE.inline,
            fragment: {
              key: testCase.dragKey
            }
          }
        }; // @ts-ignore

        controller.command('draggableDropFragment', draggableData);
        const actual = controller.value.toJSON();
        const expected = controller.setValue(testCase.out).value.toJSON();
        expect(actual).toEqual(expected);
      });
    });
  });
});
//# sourceMappingURL=dropInline.model.test.js.map