{"version":3,"sources":["../../../../src/__tests__/draggable/forbidden.ui.test.tsx"],"names":["defaultValue","App","props","val","value","setValue","React","useState","createBiPlugins","draggable","ImTagPlugin","HeadingPlugin","leftToolbar","handleChange","change","enabled","forbiddenElements","paragraph","menu","key","renderApp","results","container","document","body","querySelector","fireEvent","mouseMove","describe","afterEach","jest","clearAllMocks","test","queryByTestId","expect","not","toBeInTheDocument"],"mappings":";;;;;;AACA;;AACA;;AAMA;;AAKA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AArBA;AAuBA,MAAMA,YAAY,GAChB,qCACE,wCACE;AAAO,EAAA,IAAI,EAAC;AAAZ,aACQ,qCADR,YADF,CADF,CADF;;WAqDM,sBAAC,gBAAD,O;;AArCN,MAAMC,GAAuB,GAAIC,KAAD,IAAW;AACzC,QAAM;AAAEC,IAAAA,GAAG,GAAGH;AAAR,MAAyBE,KAA/B;AACA,QAAM,CAACE,KAAD,EAAQC,QAAR,IAAoBC,KAAK,CAACC,QAAN,CAAeJ,GAAf,CAA1B;AACA,QAAMK,eAAe,GAAG,wCAA0B;AAChDC,IAAAA,SAAS,EAATA,kBADgD;AAEhDC,IAAAA,WAAW,EAAXA,cAFgD;AAGhDC,IAAAA,aAAa,EAAbA,gBAHgD;AAIhDC,IAAAA,WAAW,EAAXA;AAJgD,GAA1B,CAAxB;;AAOA,QAAMC,YAAY,GAAIC,MAAD,IAAoB;AACvC,qBAAI,MAAM;AACRT,MAAAA,QAAQ,CAACS,MAAM,CAACV,KAAR,CAAR;AACD,KAFD;AAGD,GAJD;;AAMA,SACE,sBAAC,iBAAD;AACE,IAAA,KAAK,EAAEA,KADT;AAEE,IAAA,OAAO,EAAEI,eAAe,CAAC;AACvBC,MAAAA,SAAS,EAAE;AACTM,QAAAA,OAAO,EAAE,IADA;AAETC,QAAAA,iBAAiB,EAAE;AACjBC,UAAAA,SAAS,EAAE;AADM;AAFV,OADY;AAOvBL,MAAAA,WAAW,EAAE;AACXM,QAAAA,IAAI,EAAE,CACJ;AACEC,UAAAA,GAAG,EAAE;AADP,SADI;AADK;AAPU,KAAD,CAF1B;AAiBE,IAAA,QAAQ,EAAEN,YAjBZ;AAkBE,IAAA,SAAS;AAlBX,UADF;AAwBD,CAxCD;;AA0CA,eAAeO,SAAf,CAAyBjB,GAAzB,EAAsC;AACpC,QAAMkB,OAAO,GAAG,MAAM,+BAAa,sBAAC,GAAD;AAAK,IAAA,GAAG,EAAElB;AAAV,IAAb,EAAgC;AACpDmB,IAAAA,SAAS,EAAEC,QAAQ,CAACC;AADgC,GAAhC,CAAtB;AAGA,QAAM;AAAEF,IAAAA;AAAF,MAAgBD,OAAtB;AACA,QAAMJ,SAAS,GAAGK,SAAS,CAACG,aAAV,CAAwB,yBAAxB,CAAlB;;AAEAC,yBAAUC,SAAV,CAAoBV,SAApB;;AAEA,SAAO,EAAE,GAAGI,OAAL;AAAcJ,IAAAA;AAAd,GAAP;AACD;;YAUK,qCACE,wCACE;AAAO,EAAA,IAAI,EAAC;AAAZ,QACG,qCADH,CADF,CADF,C;;AARNW,QAAQ,CAAC,wBAAD,EAA2B,MAAM;AACvCC,EAAAA,SAAS,CAAC,MAAM;AACd;AACAC,IAAAA,IAAI,CAACC,aAAL;AACD,GAHQ,CAAT;AAKAC,EAAAA,IAAI,CAAC,sCAAD,EAAyC,YAAY;AACvD,UAAM5B,KAAK,QAAX;AAUA,UAAM;AAAE6B,MAAAA;AAAF,QAAoB,MAAMb,SAAS,CAAChB,KAAD,CAAzC;AACA,UAAM,8BAAY,GAAZ,CAAN;AACA8B,IAAAA,MAAM,CAACD,aAAa,CAAC,aAAD,CAAd,CAAN,CAAqCE,GAArC,CAAyCC,iBAAzC;AACD,GAdG,CAAJ;AAeD,CArBO,CAAR","sourcesContent":["/** @jsx jsx */\nimport * as React from 'react';\nimport {\n  fireEvent,\n  jsx,\n  renderEditor,\n  waitForTime,\n} from '@ali/4ever-dev-test';\nimport { cleanup, act } from '@testing-library/react';\nimport {\n  Value,\n  Change,\n} from '@ali/4ever-cangjie';\nimport '@testing-library/jest-dom/extend-expect';\n\nimport Provider from '../../provider';\nimport Content from '../../content';\nimport draggable from '../../plugins/draggable';\nimport leftToolbar from '../../plugins/leftToolbar';\nimport ImTagPlugin from '../../plugins/imTag';\nimport HeadingPlugin from '../../plugins/heading';\nimport createCustomizedBiPlugins from '../../createCustomizedBiPlugins';\n\nconst defaultValue = ((\n  <value>\n    <document>\n      <block type=\"paragraph\">\n        Hello <cursor />\n        Cangjie\n      </block>\n    </document>\n  </value>\n) as unknown) as Value;\n\n\ninterface AppProps {\n  val?: Value;\n}\n\nconst App: React.FC<AppProps> = (props) => {\n  const { val = defaultValue } = props;\n  const [value, setValue] = React.useState(val);\n  const createBiPlugins = createCustomizedBiPlugins({\n    draggable,\n    ImTagPlugin,\n    HeadingPlugin,\n    leftToolbar,\n  });\n\n  const handleChange = (change: Change) => {\n    act(() => {\n      setValue(change.value);\n    });\n  };\n\n  return (\n    <Provider\n      value={value}\n      plugins={createBiPlugins({\n        draggable: {\n          enabled: true,\n          forbiddenElements: {\n            paragraph: true,\n          },\n        },\n        leftToolbar: {\n          menu: [\n            {\n              key: 'draggable',\n            },\n          ],\n        },\n      })}\n      onChange={handleChange}\n      autoFocus\n    >\n      <Content />\n    </Provider>\n  );\n};\n\nasync function renderApp(val?: Value) {\n  const results = await renderEditor(<App val={val} />, {\n    container: document.body,\n  });\n  const { container } = results;\n  const paragraph = container.querySelector('[data-type=\"paragraph\"]');\n\n  fireEvent.mouseMove(paragraph);\n\n  return { ...results, paragraph };\n}\n\ndescribe('Bi/draggable/forbidden', () => {\n  afterEach(() => {\n    cleanup();\n    jest.clearAllMocks();\n  });\n\n  test('hide dragHander in forbiddenElements', async () => {\n    const value = ((\n      <value>\n        <document>\n          <block type=\"paragraph\">\n            A<cursor />\n          </block>\n        </document>\n      </value>\n    ) as unknown) as Value;\n\n    const { queryByTestId } = await renderApp(value);\n    await waitForTime(100);\n    expect(queryByTestId('drag-hander')).not.toBeInTheDocument();\n  });\n});\n"],"file":"forbidden.ui.test.js"}