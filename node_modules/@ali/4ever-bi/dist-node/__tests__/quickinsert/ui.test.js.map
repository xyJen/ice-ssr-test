{"version":3,"sources":["../../../../src/__tests__/quickinsert/ui.test.tsx"],"names":["renderLinkIcon","jest","fn","renderLinkPanel","close","editor","renderMentionIcon","renderMentionPanel","renderDisabledInsertIcon","renderDisabledInsertPanel","Bomb","Error","createLinkPlugin","onAction","action","controller","next","type","payload","QUICK_INSERT_SET","plugin","command","Commands","insertText","quickInsert","renderIcon","renderPanel","createDisabledInsertPlugin","createMentionPlugin","configs","onMenuClick","run","createErrorPlugin","createBiPlugins","link","disabledInsert","mention","error","Editor","props","quickInsertConfig","defaultValue","withToolbar","value","setValue","React","useState","plugins","useMemo","config","triggers","groups","title","key","items","locale","buttonTitle","quickInsertTitle","handleChange","useCallback","changed","toolButtons","name","setTimeout","describe","beforeAll","spyOn","console","mockImplementation","afterAll","mockRestore","beforeEach","document","body","innerHTML","clearAllMocks","afterEach","test","queryByText","Mo","textToValue","fireEvent","cangjieInput","data","keyDown","skip","expect","not","toBeInTheDocument","click","disabled","queryByTestId","disbled","queryAllByTestId","toHaveLength","toBeCalledTimes","toBeCalledWith","actived","objectContaining","text","closeButton","errorIcon","content","textContent"],"mappings":"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","sourcesContent":["/* eslint-disable no-console */\n/* eslint-disable import/no-extraneous-dependencies */\nimport * as React from 'react';\nimport '@testing-library/jest-dom/extend-expect';\nimport {\n  waitForElement,\n  cleanup,\n  waitForElementToBeRemoved,\n  wait,\n} from '@testing-library/react';\nimport { Value, Controller, Commands } from '@ali/4ever-cangjie';\nimport {\n  renderEditor,\n  getHotkeyEvent,\n  fireEvent,\n} from '@ali/4ever-dev-test';\nimport Mo from '../serializer';\nimport { createCustomizedBiPlugins, Toolbar } from '../..';\nimport {\n  QuickInsertPluginConfig,\n  QuickInsertConfig,\n} from '../../plugins/quickInsert/types';\nimport quickInsert from '../../plugins/quickInsert';\nimport mention from '../../plugins/mention';\nimport {\n  QUICK_INSERT_SET,\n  insertQuickInsert,\n} from '../../plugins/quickInsert/actions';\nimport Provider from '../../provider';\nimport Content from '../../content';\n\ninterface EditorProps {\n  quickInsertConfig?: Partial<QuickInsertPluginConfig>;\n  defaultValue: Value;\n  withToolbar?: boolean;\n}\n\ninterface Plugin {\n  onAction?: (action, controller: Controller, next: () => void) => void;\n  quickInsert: QuickInsertConfig;\n}\n\nconst renderLinkIcon = jest.fn(() => <span>链接图标</span>);\nconst renderLinkPanel = jest.fn(({ close, editor }) => {\n  return (\n    <div>\n      <span>链接面板</span>\n      <button type=\"button\" onClick={() => close(editor)}>\n        关闭\n      </button>\n    </div>\n  );\n});\n\nconst renderMentionIcon = jest.fn(() => <span>mention图标</span>);\nconst renderMentionPanel = jest.fn(() => <span>mention面板</span>);\n\nconst renderDisabledInsertIcon = jest.fn(() => <span>被禁用的插入图标</span>);\nconst renderDisabledInsertPanel = jest.fn(() => <span>被禁用的插入面板</span>);\n\nconst Bomb: React.FunctionComponent = () => {\n  throw new Error('Crashed!');\n};\n\nfunction createLinkPlugin(): Plugin {\n  return {\n    onAction: (action, controller, next) => {\n      const { type, payload } = action;\n      if (type === QUICK_INSERT_SET && payload.plugin === 'link') {\n        controller.command(Commands.insertText, ':');\n      }\n      return next();\n    },\n    quickInsert: {\n      renderIcon: renderLinkIcon,\n      renderPanel: renderLinkPanel,\n    },\n  };\n}\n\nfunction createDisabledInsertPlugin(): Plugin {\n  return {\n    quickInsert: {\n      renderIcon: renderDisabledInsertIcon,\n      renderPanel: renderDisabledInsertPanel,\n    },\n  };\n}\n\nfunction createMentionPlugin(configs): Plugin {\n  return {\n    ...mention(configs),\n    onAction: (action, controller, next) => {\n      const { type, payload } = action;\n      if (type === QUICK_INSERT_SET && payload.plugin === 'mention') {\n        controller.command(Commands.insertText, '@');\n      }\n      next();\n    },\n    quickInsert: {\n      onMenuClick: (controller) => controller.run('onAction', insertQuickInsert('mention')),\n      renderIcon: renderMentionIcon,\n      renderPanel: renderMentionPanel,\n    },\n  };\n}\n\nfunction createErrorPlugin(): Plugin {\n  return {\n    quickInsert: {\n      renderIcon: () => <span>异常插入</span>,\n      renderPanel: () => {\n        return <Bomb />;\n      },\n    },\n  };\n}\n\nconst createBiPlugins = createCustomizedBiPlugins({\n  link: createLinkPlugin,\n  disabledInsert: createDisabledInsertPlugin,\n  mention: createMentionPlugin,\n  error: createErrorPlugin,\n  quickInsert,\n});\n\nconst Editor: React.FunctionComponent<EditorProps> = (props) => {\n  const { quickInsertConfig = {}, defaultValue, withToolbar = true } = props;\n  const [value, setValue] = React.useState(defaultValue);\n  const plugins = React.useMemo(() => {\n    const config: QuickInsertPluginConfig = {\n      triggers: {\n        ':': 'link',\n      },\n      groups: [{ title: '默认', key: 'default', items: ['link'] }],\n      locale: {\n        buttonTitle: '快捷插入',\n      },\n      ...quickInsertConfig,\n    };\n\n    return createBiPlugins({\n      quickInsert: config,\n      disabledInsert: {\n        locale: {\n          quickInsertTitle: 'disabled',\n        },\n      },\n      link: {\n        locale: {\n          quickInsertTitle: 'link',\n        },\n      },\n      error: {\n        locale: {\n          quickInsertTitle: 'error',\n        },\n      },\n      mention: {\n        locale: {\n          quickInsertTitle: 'mention',\n        },\n      },\n    });\n  }, [quickInsertConfig]);\n\n  const handleChange = React.useCallback((changed) => {\n    setValue(changed.value);\n  }, []);\n\n  return (\n    <Provider plugins={plugins} value={value} onChange={handleChange}>\n      {withToolbar && (\n        <Toolbar\n          autoFolding={false}\n          singleLayout={[{ toolButtons: [{ name: 'quickInsert' }] }]}\n        />\n      )}\n      <Content tabIndex={0} />\n    </Provider>\n  );\n};\n\njest.setTimeout(3000);\n\ndescribe('Bi/quickInsert/ui', () => {\n  beforeAll(() => {\n    // 防止被 componentDidCatch catch 的 error 被控制台输出\n    jest.spyOn(console, 'error');\n    // @ts-ignore\n    console.error.mockImplementation(() => {});\n  });\n\n  afterAll(() => {\n    // @ts-ignore\n    console.error.mockRestore();\n  });\n\n  beforeEach(() => {\n    document.body.innerHTML = '';\n    jest.clearAllMocks();\n  });\n\n  afterEach(() => {\n    cleanup();\n  });\n\n  test('支持按键呼出快捷插入', async () => {\n    const { queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} />,\n    );\n    fireEvent.cangjieInput(editor, { data: ':' });\n\n    await waitForElement(() => queryByText(/链接图标/));\n    await waitForElement(() => queryByText(/链接面板/));\n  });\n\n  test('支持按下 ESC 关闭快捷插入', async () => {\n    const { queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} />,\n    );\n\n    fireEvent.cangjieInput(editor, { data: ':' });\n\n    await waitForElement(() => queryByText(/链接图标/));\n\n    fireEvent.keyDown(editor, getHotkeyEvent('esc'));\n\n    await waitForElementToBeRemoved(() => queryByText(/链接图标/));\n  });\n\n  test('支持在文本中段可以呼出快捷插入', async () => {\n    const { queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} />,\n    );\n\n    fireEvent.cangjieInput(editor, { data: 'prefix' });\n    fireEvent.cangjieInput(editor, { data: ':' });\n\n    await waitForElement(() => queryByText(/链接图标/));\n  });\n\n  test('在快捷插入起始位置退格时，关闭快捷输入', async () => {\n    const { queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} />,\n    );\n\n    fireEvent.cangjieInput(editor, { data: 'prefix' });\n    fireEvent.cangjieInput(editor, { data: ':' });\n\n    await waitForElement(() => queryByText(/链接图标/));\n\n    fireEvent.keyDown(editor, getHotkeyEvent('backspace'));\n\n    await waitForElementToBeRemoved(() => queryByText(/链接图标/));\n  });\n\n  test('在段落起始位置退格，能关闭快捷输入', async () => {\n    const { queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} />,\n    );\n\n    fireEvent.cangjieInput(editor, { data: ':' });\n\n    await waitForElement(() => queryByText(/链接图标/));\n    fireEvent.keyDown(editor, getHotkeyEvent('backspace'));\n\n    await waitForElementToBeRemoved(() => queryByText(/链接图标/));\n  });\n\n  test.skip('支持为不同的插入配置不同的呼出键位', async () => {\n    const config = {\n      triggers: {\n        ':': 'link',\n        '@': 'mention',\n      },\n      groups: [{ title: '默认', key: 'default', items: ['link', 'mention'] }],\n    };\n\n    const { queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} quickInsertConfig={config} />,\n    );\n\n    fireEvent.cangjieInput(editor, {\n      data: ':',\n    });\n\n    await waitForElement(() => queryByText(/链接面板/));\n\n    fireEvent.keyDown(editor, getHotkeyEvent('esc'));\n\n    await waitForElementToBeRemoved(() => queryByText(/链接面板/));\n\n    fireEvent.cangjieInput(editor, {\n      data: '@',\n    });\n\n    await waitForElement(() => queryByText(/mention面板/));\n  });\n\n  test('预设的插入分组为空时，不响应呼出', async () => {\n    const config = {\n      groups: [],\n    };\n\n    const { queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} quickInsertConfig={config} />,\n    );\n\n    fireEvent.cangjieInput(editor, {\n      data: ':',\n    });\n\n    await waitForElement(() => queryByText(/^:$/));\n    expect(queryByText(/链接图标/)).not.toBeInTheDocument();\n  });\n\n  test('支持分组与分组切换', async () => {\n    const config = {\n      triggers: {\n        ':': 'link',\n        '@': 'mention',\n      },\n      groups: [{ title: '默认', key: 'default', items: ['link', 'mention'] }],\n    };\n\n    const { queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} quickInsertConfig={config} />,\n    );\n\n    fireEvent.cangjieInput(editor, {\n      data: ':',\n    });\n\n    await waitForElement(() => queryByText(/链接图标/));\n    fireEvent.click(queryByText(/mention图标/)!);\n    await waitForElement(() => queryByText(/mention面板/));\n  });\n\n  test('禁用某个插入时，若呼出该插入，则渲染禁用面板', async () => {\n    const config = {\n      triggers: {\n        '@': 'mention',\n        ':': 'disabledInsert',\n      },\n      groups: [\n        {\n          title: '默认',\n          key: 'default',\n          items: [{ key: 'disabledInsert', disabled: () => true }, 'mention'],\n        },\n      ],\n    };\n\n    const { queryByTestId, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('x')} quickInsertConfig={config} />,\n    );\n\n    fireEvent.cangjieInput(editor, {\n      data: ':',\n    });\n\n    await waitForElement(() => queryByTestId('quick-insert-forbidden'));\n  });\n\n  test('禁用某个插入时，此时呼出其他插入，则被禁用插入不可点击', async () => {\n    const config = {\n      triggers: {\n        ':': 'link',\n        '@': 'disabledInsert',\n      },\n      groups: [\n        {\n          title: '默认',\n          key: 'default',\n          items: [{ key: 'disabledInsert', disbled: () => true }, 'link'],\n        },\n      ],\n    };\n\n    const { queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} quickInsertConfig={config} />,\n    );\n\n    fireEvent.cangjieInput(editor, {\n      data: ':',\n    });\n\n    await waitForElement(() => queryByText(/链接图标/));\n    expect(queryByText(/链接面板/)).toBeInTheDocument();\n\n    fireEvent.click(queryByText(/被禁用的插入图标/)!);\n    expect(queryByText(/被禁用的插入面板/)).not.toBeInTheDocument();\n  });\n\n  test('忽略无效的插入项目', async () => {\n    const config = {\n      triggers: {\n        '@': 'mention',\n        ':': 'link',\n        '/': 'undefined',\n      },\n      groups: [\n        {\n          title: '默认分组',\n          key: 'default',\n          items: ['wrong', 'mention', 'link'],\n        },\n      ],\n    };\n\n    const { queryAllByTestId, queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} quickInsertConfig={config} />,\n    );\n\n    fireEvent.cangjieInput(editor, {\n      data: ':',\n    });\n\n    await waitForElement(() => queryByText(/链接图标/));\n\n    expect(queryAllByTestId('group-item')).toHaveLength(2);\n\n    fireEvent.keyDown(editor, getHotkeyEvent('esc'));\n\n    await waitForElementToBeRemoved(() => queryByText(/链接面板/));\n\n    fireEvent.cangjieInput(editor, {\n      data: '/',\n    });\n\n    await wait();\n\n    await waitForElement(() => queryByText(/^:\\/$/));\n    expect(queryByText(/链接面板/)).not.toBeInTheDocument();\n  });\n\n  test('支持自定义 icon 渲染', async () => {\n    const config = {\n      groups: [\n        {\n          title: '默认',\n          key: 'default',\n          items: [{ key: 'disabledInsert', disabled: () => true }, 'link'],\n        },\n      ],\n    };\n\n    const { queryByText, editor } = await renderEditor(\n      <Editor\n        defaultValue={Mo.textToValue('')}\n        quickInsertConfig={config}\n        withToolbar={false}\n      />,\n    );\n\n    fireEvent.cangjieInput(editor, {\n      data: ':',\n    });\n\n    await waitForElement(() => queryByText(/链接图标/));\n\n    expect(renderLinkIcon).toBeCalledTimes(1);\n    expect(renderLinkIcon).toBeCalledWith({ disabled: false, actived: true });\n\n    expect(renderDisabledInsertIcon).toBeCalledTimes(1);\n    expect(renderDisabledInsertIcon).toBeCalledWith({\n      disabled: true,\n      actived: false,\n    });\n  });\n\n  // @TODO 雁以 功能正常，暂不修复\n  test.skip('支持自定义 panel 渲染', async () => {\n    const { queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} />,\n    );\n\n    fireEvent.cangjieInput(editor, {\n      data: ':',\n    });\n\n    await waitForElement(() => queryByText(/链接图标/));\n    expect(renderLinkPanel).toBeCalledWith(\n      expect.objectContaining({\n        text: ':',\n      }),\n    );\n  });\n\n  test('支持手动关闭插入面板', async () => {\n    const { queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} />,\n    );\n\n    fireEvent.cangjieInput(editor, {\n      data: ':',\n    });\n\n    const closeButton = await waitForElement(() => queryByText(/关闭/));\n    fireEvent.click(closeButton!);\n\n    await waitForElementToBeRemoved(() => queryByText(/链接面板/));\n  });\n\n  test('插入面板渲染异常时，展示异常消息', async () => {\n    const config = {\n      groups: [{ title: '默认', key: 'default', items: ['link', 'error'] }],\n    };\n\n    const { queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} quickInsertConfig={config} />,\n    );\n\n    fireEvent.cangjieInput(editor, {\n      data: ':',\n    });\n\n    const errorIcon = await waitForElement(() => queryByText(/异常插入/));\n    fireEvent.click(errorIcon!);\n    await waitForElement(() => queryByText(/Crashed/));\n  });\n\n  test.skip('若已经呼出快捷输入，再尝试以同一个 trigger 呼出，则重新展开快捷输入', async () => {\n    const config = {\n      triggers: {\n        ':': 'link',\n        '@': 'mention',\n      },\n      groups: [{ title: '默认', key: 'default', items: ['link', 'mention'] }],\n    };\n\n    const { queryByText, editor, content } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} quickInsertConfig={config} />,\n    );\n\n    fireEvent.cangjieInput(editor, { data: ':' });\n\n    await waitForElement(() => queryByText(/链接图标/));\n    fireEvent.cangjieInput(editor, { data: ':' });\n    await waitForElement(() => content.textContent === '::');\n  });\n\n  test.skip('若已经呼出快捷输入，再尝试以不同的 trigger 呼出，则忽略该 trigger', async () => {\n    const config = {\n      triggers: {\n        ':': 'link',\n        '@': 'mention',\n      },\n      groups: [{ title: '默认', key: 'default', items: ['link', 'mention'] }],\n    };\n\n    const { queryByText, editor } = await renderEditor(\n      <Editor defaultValue={Mo.textToValue('')} quickInsertConfig={config} />,\n    );\n\n    fireEvent.cangjieInput(editor, { data: ':' });\n\n    await waitForElement(() => queryByText(/链接图标/));\n    fireEvent.cangjieInput(editor, { data: '@' });\n    await waitForElement(() => queryByText(/:@/));\n    expect(queryByText(/mention面板/)).not.toBeInTheDocument();\n  });\n});\n"],"file":"ui.test.js"}