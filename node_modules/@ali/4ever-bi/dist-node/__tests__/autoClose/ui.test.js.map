{"version":3,"sources":["../../../../src/__tests__/autoClose/ui.test.tsx"],"names":["couplePairMap","getSymbolCouple","symbol","englishQuotes","englishBrackets","chineseQuotes","chineseBrackets","describe","value","forEach","lSymbol","rSymbol","it","editor","content","fireEvent","cangjieInput","data","textContent","expected","keyDown","repeat"],"mappings":";;;;AACA;;AACA;;AACA;;AAKA;;AACA;;AATA;AAWA,MAAMA,aAAa,GAAG;AACpB,QAAM,IADc;AAEpB,OAAK,GAFe;AAGpB,OAAK,GAHe;AAIpB,OAAK,GAJe;AAKpB,OAAK,GALe;AAMpB,OAAK,GANe;AAOpB,OAAK,GAPe;AAQpB,OAAK,GARe;AASpB,OAAK,GATe;AAUpB,OAAK;AAVe,CAAtB;;AAaA,SAASC,eAAT,CAAyBC,MAAzB,EAAiC;AAC/B,SAAOF,aAAa,CAACE,MAAD,CAApB;AACD;;AAED,MAAMC,aAAa,GAAG,CAAC,IAAD,EAAO,GAAP,EAAY,GAAZ,CAAtB;AACA,MAAMC,eAAe,GAAG,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAAxB;AACA,MAAMC,aAAa,GAAG,CAAC,GAAD,EAAM,GAAN,CAAtB;AACA,MAAMC,eAAe,GAAG,CAAC,GAAD,EAAM,GAAN,CAAxB;;WAKM,qCACE,wCACE;AAAO,EAAA,IAAI,EAAC;AAAZ,GACE,qCADF,WACiB,oCADjB,CADF,CADF,C;;YA4DA,qCACE,wCACE;AAAO,EAAA,IAAI,EAAC;AAAZ,GACE,qCADF,CADF,CADF,C;;aAmDoC,qC;;aAoBF,qC;;AAtIxCC,QAAQ,CAAC,iBAAD,EAAoB,MAAM;AAChCA,EAAAA,QAAQ,CAAC,OAAD,EAAU,MAAM;AACtB,UAAMC,KAAK,OAAX;;AADsB,gBAc6B,sBAAC,eAAD;AAAQ,MAAA,YAAY,EAAEA;AAAtB,MAd7B;;AAAA,gBAuB6B,sBAAC,eAAD;AAAQ,MAAA,YAAY,EAAEA;AAAtB,MAvB7B;;AAWtB,KAAC,GAAGJ,eAAJ,EAAqB,GAAGE,eAAxB,EAAyCG,OAAzC,CAAkDC,OAAD,IAAa;AAC5D,YAAMC,OAAO,GAAGV,eAAe,CAACS,OAAD,CAA/B;AACAE,MAAAA,EAAE,CAAE,OAAMF,OAAQ,SAAhB,EAA0B,YAAY;AACtC,cAAM;AAAEG,UAAAA,MAAF;AAAUC,UAAAA;AAAV,YAAsB,MAAM,qCAAlC;;AACAC,+BAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,UAAAA,IAAI,EAAEP;AAAR,SAA/B;;AACA,cAAM,2BAAe,MAAMI,OAAO,EAAEI,WAAT,KAA0B,GAAER,OAAQ,QAAOC,OAAQ,EAAxE,CAAN;;AACAI,+BAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,UAAAA,IAAI,EAAEP;AAAR,SAA/B;;AACA,cAAM,2BAAe,MACnBI,OAAO,EAAEI,WAAT,KAA0B,GAAER,OAAQ,GAAEA,OAAQ,QAAOC,OAAQ,GAAEA,OAAQ,EADnE,CAAN;AAGD,OARC,CAAF;AASAC,MAAAA,EAAE,CAAE,KAAID,OAAQ,QAAd,EAAuB,YAAY;AACnC,cAAM;AAAEE,UAAAA,MAAF;AAAUC,UAAAA;AAAV,YAAsB,MAAM,qCAAlC;;AACAC,+BAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,UAAAA,IAAI,EAAEN;AAAR,SAA/B;;AACA,cAAM,2BAAe,MAAMG,OAAO,EAAEI,WAAT,KAAyBP,OAA9C,CAAN;AACD,OAJC,CAAF;AAKD,KAhBD;;AAXsB,gBAgC6B,sBAAC,eAAD;AAAQ,MAAA,YAAY,EAAEH;AAAtB,MAhC7B;;AAAA,gBAyC6B,sBAAC,eAAD;AAAQ,MAAA,YAAY,EAAEA;AAAtB,MAzC7B;;AA6BtBH,IAAAA,aAAa,CAACI,OAAd,CAAuBC,OAAD,IAAa;AACjC,YAAMC,OAAO,GAAGV,eAAe,CAACS,OAAD,CAA/B;AACAE,MAAAA,EAAE,CAAE,KAAIF,OAAQ,QAAd,EAAuB,YAAY;AACnC,cAAM;AAAEG,UAAAA,MAAF;AAAUC,UAAAA;AAAV,YAAsB,MAAM,qCAAlC;;AACAC,+BAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,UAAAA,IAAI,EAAEP;AAAR,SAA/B;;AACA,cAAM,2BAAe,MAAMI,OAAO,EAAEI,WAAT,KAA0B,GAAER,OAAQ,QAAOC,OAAQ,EAAxE,CAAN;;AACAI,+BAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,UAAAA,IAAI,EAAEN;AAAR,SAA/B;;AACA,cAAM,2BAAe,MACnBG,OAAO,EAAEI,WAAT,KAA0B,GAAER,OAAQ,GAAEA,OAAQ,QAAOC,OAAQ,GAAEA,OAAQ,EADnE,CAAN;AAGD,OARC,CAAF;AASAC,MAAAA,EAAE,CAAE,KAAID,OAAQ,QAAd,EAAuB,YAAY;AACnC,cAAM;AAAEE,UAAAA,MAAF;AAAUC,UAAAA;AAAV,YAAsB,MAAM,qCAAlC;;AACAC,+BAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,UAAAA,IAAI,EAAEN;AAAR,SAA/B;;AACA,cAAM,2BAAe,MAAMG,OAAO,EAAEI,WAAT,KAA0B,GAAER,OAAQ,QAAOC,OAAQ,EAAxE,CAAN;;AACAI,+BAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,UAAAA,IAAI,EAAEP;AAAR,SAA/B;;AACA,cAAM,2BAAe,MACnBI,OAAO,EAAEI,WAAT,KAA0B,GAAER,OAAQ,GAAEA,OAAQ,QAAOC,OAAQ,GAAEA,OAAQ,EADnE,CAAN;AAGD,OARC,CAAF;AASD,KApBD;;AA7BsB,gBAqD6B,sBAAC,eAAD;AAAQ,MAAA,YAAY,EAAEH;AAAtB,MArD7B;;AAmDtBL,IAAAA,aAAa,CAACM,OAAd,CAAuBP,MAAD,IAAY;AAChCU,MAAAA,EAAE,CAAE,KAAIV,MAAO,QAAb,EAAsB,YAAY;AAClC,cAAM;AAAEW,UAAAA,MAAF;AAAUC,UAAAA;AAAV,YAAsB,MAAM,qCAAlC;;AACAC,+BAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,UAAAA,IAAI,EAAEf;AAAR,SAA/B;;AACA,cAAM,2BAAe,MAAMY,OAAO,EAAEI,WAAT,KAA0B,GAAEhB,MAAO,QAAOA,MAAO,EAAtE,CAAN;AACD,OAJC,CAAF;AAKD,KAND;AAOD,GA1DO,CAAR;AA4DAK,EAAAA,QAAQ,CAAC,MAAD,EAAS,MAAM;AACrB,UAAMC,KAAK,QAAX;;AADqB,gBAegC,sBAAC,eAAD;AAAQ,MAAA,YAAY,EAAEA;AAAtB,MAfhC;;AAWrBD,IAAAA,QAAQ,CAAC,eAAD,EAAkB,MAAM;AAC9B,OAAC,GAAGH,eAAJ,EAAqB,GAAGE,eAAxB,EAAyCG,OAAzC,CAAkDC,OAAD,IAAa;AAC5D,cAAMC,OAAO,GAAGV,eAAe,CAACS,OAAD,CAA/B;AACAE,QAAAA,EAAE,CAAE,SAAQF,OAAQ,sBAAqBC,OAAQ,UAA/C,EAA0D,YAAY;AACtE,gBAAM;AAAEE,YAAAA,MAAF;AAAUC,YAAAA;AAAV,cAAsB,MAAM,qCAAlC;;AACAC,iCAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,YAAAA,IAAI,EAAEP;AAAR,WAA/B;;AACA,gBAAM,2BAAe,MAAMI,OAAO,EAAEI,WAAT,KAA0B,GAAER,OAAQ,GAAEC,OAAQ,EAAnE,CAAN;;AACAI,iCAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,YAAAA,IAAI,EAAEP;AAAR,WAA/B;;AAEA,gBAAMS,QAAQ,GAAI,GAAET,OAAQ,GAAEA,OAAQ,GAAEC,OAAQ,GAAEA,OAAQ,EAA1D;AACA,gBAAM,2BAAe,MAAMG,OAAO,EAAEI,WAAT,KAAyBC,QAA9C,CAAN;;AACAJ,iCAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,YAAAA,IAAI,EAAEN;AAAR,WAA/B;;AACA,gBAAM,2BAAe,MAAMG,OAAO,EAAEI,WAAT,KAAyBC,QAA9C,CAAN;;AACAJ,iCAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,YAAAA,IAAI,EAAEN;AAAR,WAA/B;;AACA,gBAAM,2BAAe,MAAMG,OAAO,EAAEI,WAAT,KAAyBC,QAA9C,CAAN;AACD,SAZC,CAAF;AAaD,OAfD;AAgBD,KAjBO,CAAR;;AAXqB,gBAiCgC,sBAAC,eAAD;AAAQ,MAAA,YAAY,EAAEX;AAAtB,MAjChC;;AA8BrBD,IAAAA,QAAQ,CAAC,cAAD,EAAiB,MAAM;AAC7BJ,MAAAA,aAAa,CAACM,OAAd,CAAuBP,MAAD,IAAY;AAChCU,QAAAA,EAAE,CAAE,SAAQV,MAAO,iBAAjB,EAAmC,YAAY;AAC/C,gBAAM;AAAEW,YAAAA,MAAF;AAAUC,YAAAA;AAAV,cAAsB,MAAM,qCAAlC;;AACAC,iCAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,YAAAA,IAAI,EAAEf;AAAR,WAA/B;;AACA,gBAAM,2BAAe,MAAMY,OAAO,EAAEI,WAAT,KAA0B,GAAEhB,MAAO,GAAEA,MAAO,EAAjE,CAAN;;AACAa,iCAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,YAAAA,IAAI,EAAEf;AAAR,WAA/B;;AACA,gBAAM,2BAAe,MAAMY,OAAO,EAAEI,WAAT,KAA0B,GAAEhB,MAAO,GAAEA,MAAO,EAAjE,CAAN;;AACAa,iCAAUC,YAAV,CAAuBH,MAAvB,EAA+B;AAAEI,YAAAA,IAAI,EAAEf;AAAR,WAA/B;;AACA,gBAAM,2BAAe,MAAMY,OAAO,EAAEI,WAAT,KAA0B,GAAEhB,MAAO,GAAEA,MAAO,GAAEA,MAAO,EAA1E,CAAN;AACD,SARC,CAAF;AASD,OAVD;AAWD,KAZO,CAAR;AAaD,GA3CO,CAAR;AA6CAK,EAAAA,QAAQ,CAAC,OAAD,EAAU,MAAM;AACtB,KAAC,GAAGH,eAAJ,EAAqB,GAAGE,eAAxB,EAAyC,GAAGD,aAA5C,EAA2DI,OAA3D,CAAoEC,OAAD,IAAa;AAC9EE,MAAAA,EAAE,CAAE,OAAMF,OAAQ,GAAhB,EAAoB,YAAY;AAChC,cAAMC,OAAO,GAAGV,eAAe,CAACS,OAAD,CAA/B;AACA,cAAMF,KAAK,GACT,qCACE,wCACE;AAAO,UAAA,IAAI,EAAC;AAAZ,WACEG,OADF,EACWD,OADX,EACoBA,OADpB,UACuCC,OADvC,EACgDA,OADhD,EACyDD,OADzD,CADF,CADF,CADF;AASA,cAAM;AAAEG,UAAAA,MAAF;AAAUC,UAAAA;AAAV,YAAsB,MAAM,+BAAa,sBAAC,eAAD;AAAQ,UAAA,YAAY,EAAEN;AAAtB,UAAb,CAAlC;;AACAO,+BAAUK,OAAV,CAAkBP,MAAlB,EAA0B,4BAAe,WAAf,CAA1B;;AACA,cAAM,2BAAe,MAAMC,OAAO,EAAEI,WAAT,KAA0B,GAAEP,OAAQ,GAAED,OAAQ,GAAEC,OAAQ,GAAEA,OAAQ,GAAED,OAAQ,EAAjG,CAAN;;AACAK,+BAAUK,OAAV,CAAkBP,MAAlB,EAA0B,4BAAe,WAAf,CAA1B;;AACA,cAAM,2BAAe,MAAMC,OAAO,EAAEI,WAAT,KAA0B,GAAEP,OAAQ,GAAEA,OAAQ,GAAEA,OAAQ,GAAED,OAAQ,EAAvF,CAAN;;AACAK,+BAAUK,OAAV,CAAkBP,MAAlB,EAA0B,4BAAe,WAAf,CAA1B;;AACA,cAAM,2BAAe,MAAMC,OAAO,EAAEI,WAAT,KAA0B,GAAEP,OAAQ,GAAEA,OAAQ,GAAED,OAAQ,EAA7E,CAAN;AACD,OAlBC,CAAF;AAmBD,KApBD;AAqBAP,IAAAA,aAAa,CAACM,OAAd,CAAuBP,MAAD,IAAY;AAAA,mBAG5B,qCACE,wCACE;AAAO,QAAA,IAAI,EAAC;AAAZ,SACGA,MADH,EACWA,MADX,EACmBA,MADnB,UACqCA,MADrC,EAC6CA,MAD7C,CADF,CADF,CAH4B;;AAChCU,MAAAA,EAAE,CAAE,OAAMV,MAAO,GAAf,EAAmB,YAAY;AAC/B,cAAMM,KAAK,SAAX;AASA,cAAM;AAAEK,UAAAA,MAAF;AAAUC,UAAAA;AAAV,YAAsB,MAAM,+BAAa,sBAAC,eAAD;AAAQ,UAAA,YAAY,EAAEN;AAAtB,UAAb,CAAlC;;AACAO,+BAAUK,OAAV,CAAkBP,MAAlB,EAA0B,4BAAe,WAAf,CAA1B;;AACA,cAAM,2BAAe,MAAMC,OAAO,EAAEI,WAAT,KAAyBhB,MAAM,CAACmB,MAAP,CAAc,CAAd,CAA9C,CAAN;;AACAN,+BAAUK,OAAV,CAAkBP,MAAlB,EAA0B,4BAAe,WAAf,CAA1B;;AACA,cAAM,2BAAe,MAAMC,OAAO,EAAEI,WAAT,KAAyBhB,MAAM,CAACmB,MAAP,CAAc,CAAd,CAA9C,CAAN;;AACAN,+BAAUK,OAAV,CAAkBP,MAAlB,EAA0B,4BAAe,WAAf,CAA1B;;AACA,cAAM,2BAAe,MAAMC,OAAO,EAAEI,WAAT,KAAyBhB,MAAM,CAACmB,MAAP,CAAc,CAAd,CAA9C,CAAN;AACD,OAjBC,CAAF;AAkBD,KAnBD;AAoBD,GA1CO,CAAR;AA2CD,CArJO,CAAR","sourcesContent":["/** @jsx jsx */\nimport '@testing-library/jest-dom/extend-expect';\nimport { waitForElement } from '@testing-library/react';\nimport {\n  renderEditor,\n  fireEvent,\n  jsx,\n} from '@ali/4ever-dev-test';\nimport Editor from '../editor';\nimport { getHotKeyEvent } from '../helper';\n\nconst couplePairMap = {\n  '\\'': '\\'',\n  '\"': '\"',\n  '`': '`',\n  '{': '}',\n  '[': ']',\n  '(': ')',\n  '【': '】',\n  '（': '）',\n  '“': '”',\n  '‘': '’',\n};\n\nfunction getSymbolCouple(symbol) {\n  return couplePairMap[symbol];\n}\n\nconst englishQuotes = ['\\'', '\"', '`'];\nconst englishBrackets = ['{', '[', '('];\nconst chineseQuotes = ['‘', '“'];\nconst chineseBrackets = ['【', '（'];\n\ndescribe('Bi/autoClose/ui', () => {\n  describe('选区不为空', () => {\n    const value = (\n      <value>\n        <document>\n          <block type=\"paragraph\">\n            <anchor />Hello<focus />\n          </block>\n        </document>\n      </value>\n    );\n\n    [...englishBrackets, ...chineseBrackets].forEach((lSymbol) => {\n      const rSymbol = getSymbolCouple(lSymbol);\n      it(`连续键入${lSymbol}将包裹选中文本`, async () => {\n        const { editor, content } = await renderEditor(<Editor defaultValue={value} />);\n        fireEvent.cangjieInput(editor, { data: lSymbol });\n        await waitForElement(() => content?.textContent === `${lSymbol}Hello${rSymbol}`);\n        fireEvent.cangjieInput(editor, { data: lSymbol });\n        await waitForElement(() =>\n          content?.textContent === `${lSymbol}${lSymbol}Hello${rSymbol}${rSymbol}`\n        );\n      });\n      it(`键入${rSymbol}覆盖选中文本`, async () => {\n        const { editor, content } = await renderEditor(<Editor defaultValue={value} />);\n        fireEvent.cangjieInput(editor, { data: rSymbol });\n        await waitForElement(() => content?.textContent === rSymbol);\n      });\n    });\n\n    chineseQuotes.forEach((lSymbol) => {\n      const rSymbol = getSymbolCouple(lSymbol);\n      it(`键入${lSymbol}包裹选中文本`, async () => {\n        const { editor, content } = await renderEditor(<Editor defaultValue={value} />);\n        fireEvent.cangjieInput(editor, { data: lSymbol });\n        await waitForElement(() => content?.textContent === `${lSymbol}Hello${rSymbol}`);\n        fireEvent.cangjieInput(editor, { data: rSymbol });\n        await waitForElement(() =>\n          content?.textContent === `${lSymbol}${lSymbol}Hello${rSymbol}${rSymbol}`\n        );\n      });\n      it(`键入${rSymbol}包裹选中文本`, async () => {\n        const { editor, content } = await renderEditor(<Editor defaultValue={value} />);\n        fireEvent.cangjieInput(editor, { data: rSymbol });\n        await waitForElement(() => content?.textContent === `${lSymbol}Hello${rSymbol}`);\n        fireEvent.cangjieInput(editor, { data: lSymbol });\n        await waitForElement(() =>\n          content?.textContent === `${lSymbol}${lSymbol}Hello${rSymbol}${rSymbol}`\n        );\n      });\n    });\n\n    englishQuotes.forEach((symbol) => {\n      it(`键入${symbol}包裹选中文本`, async () => {\n        const { editor, content } = await renderEditor(<Editor defaultValue={value} />);\n        fireEvent.cangjieInput(editor, { data: symbol });\n        await waitForElement(() => content?.textContent === `${symbol}Hello${symbol}`);\n      });\n    });\n  });\n\n  describe('选区为空', () => {\n    const value = (\n      <value>\n        <document>\n          <block type=\"paragraph\">\n            <cursor />\n          </block>\n        </document>\n      </value>\n    );\n\n    describe('中英文括号的自动补全和键出', () => {\n      [...englishBrackets, ...chineseBrackets].forEach((lSymbol) => {\n        const rSymbol = getSymbolCouple(lSymbol);\n        it(`连续两次键入${lSymbol}将自动补全右边的符号，接着连续两次键入${rSymbol}将逐步键出符号对`, async () => {\n          const { editor, content } = await renderEditor(<Editor defaultValue={value} />);\n          fireEvent.cangjieInput(editor, { data: lSymbol });\n          await waitForElement(() => content?.textContent === `${lSymbol}${rSymbol}`);\n          fireEvent.cangjieInput(editor, { data: lSymbol });\n\n          const expected = `${lSymbol}${lSymbol}${rSymbol}${rSymbol}`;\n          await waitForElement(() => content?.textContent === expected);\n          fireEvent.cangjieInput(editor, { data: rSymbol });\n          await waitForElement(() => content?.textContent === expected);\n          fireEvent.cangjieInput(editor, { data: rSymbol });\n          await waitForElement(() => content?.textContent === expected);\n        });\n      });\n    });\n\n    describe('英文引号的自动补全和键出', () => {\n      englishQuotes.forEach((symbol) => {\n        it(`连续三次键入${symbol},依次自动补全，键出，正常键入`, async () => {\n          const { editor, content } = await renderEditor(<Editor defaultValue={value} />);\n          fireEvent.cangjieInput(editor, { data: symbol });\n          await waitForElement(() => content?.textContent === `${symbol}${symbol}`);\n          fireEvent.cangjieInput(editor, { data: symbol });\n          await waitForElement(() => content?.textContent === `${symbol}${symbol}`);\n          fireEvent.cangjieInput(editor, { data: symbol });\n          await waitForElement(() => content?.textContent === `${symbol}${symbol}${symbol}`);\n        });\n      });\n    });\n  });\n\n  describe('删除符号对', () => {\n    [...englishBrackets, ...chineseBrackets, ...chineseQuotes].forEach((lSymbol) => {\n      it(`连续删除${lSymbol}对`, async () => {\n        const rSymbol = getSymbolCouple(lSymbol);\n        const value = (\n          <value>\n            <document>\n              <block type=\"paragraph\">\n               {rSymbol}{lSymbol}{lSymbol}<cursor />{rSymbol}{rSymbol}{lSymbol}\n              </block>\n            </document>\n          </value>\n        );\n        const { editor, content } = await renderEditor(<Editor defaultValue={value} />);\n        fireEvent.keyDown(editor, getHotKeyEvent('Backspace'));\n        await waitForElement(() => content?.textContent === `${rSymbol}${lSymbol}${rSymbol}${rSymbol}${lSymbol}`);\n        fireEvent.keyDown(editor, getHotKeyEvent('Backspace'));\n        await waitForElement(() => content?.textContent === `${rSymbol}${rSymbol}${rSymbol}${lSymbol}`);\n        fireEvent.keyDown(editor, getHotKeyEvent('Backspace'));\n        await waitForElement(() => content?.textContent === `${rSymbol}${rSymbol}${lSymbol}`);\n      });\n    });\n    englishQuotes.forEach((symbol) => {\n      it(`连续删除${symbol}对`, async () => {\n        const value = (\n          <value>\n            <document>\n              <block type=\"paragraph\">\n                {symbol}{symbol}{symbol}<cursor />{symbol}{symbol}\n              </block>\n            </document>\n          </value>\n        );\n        const { editor, content } = await renderEditor(<Editor defaultValue={value} />);\n        fireEvent.keyDown(editor, getHotKeyEvent('Backspace'));\n        await waitForElement(() => content?.textContent === symbol.repeat(4));\n        fireEvent.keyDown(editor, getHotKeyEvent('Backspace'));\n        await waitForElement(() => content?.textContent === symbol.repeat(3));\n        fireEvent.keyDown(editor, getHotKeyEvent('Backspace'));\n        await waitForElement(() => content?.textContent === symbol.repeat(2));\n      });\n    });\n  });\n});\n"],"file":"ui.test.js"}