{"version":3,"sources":["../../../../src/__tests__/hr/behaviour.test.tsx"],"names":["plugins","array","hrPayload","type","sz","color","width","describe","test","value","controller","Controller","create","run","hrPlugin","actions","insertHr","document","expect","getBlocksByType","length","toBe","colsWidth","point","Point","createFromParams","selection","RangeSelection","anchor","focus","command","Commands","select","filterDescendants","n","hrBlock","data","toEqual","id","anything"],"mappings":"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","sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\n/** @jsx jsx */\nimport {\n  Commands,\n  Controller,\n  Point,\n  RangeSelection,\n  Value,\n} from '@ali/4ever-cangjie';\nimport { jsx } from '@ali/4ever-dev-test';\nimport createBiPlugins from '../../createBiPlugins';\nimport hrPlugin from '../../plugins/hr';\n\nconst plugins = createBiPlugins().array;\n\nconst hrPayload = {\n  type: \"single\",\n  sz: 4,\n  color: \"black\",\n  width: \"100%\",\n}\n\ndescribe('Bi/hr/behaviour', () => {\n  describe('选择', () => {\n    test('在正文全选，可以选中分割线', async () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"paragraph\">\n              Start Paragraph\n              <cursor />\n            </block>\n          </document>\n        </value>\n      ) as unknown) as Value;\n\n      const controller = Controller.create({\n        value,\n        plugins,\n      });\n      controller.run('onAction', hrPlugin.actions.insertHr({}));\n      const { document } = controller.value;\n      expect(document.getBlocksByType('hr').length).toBe(1);\n    });\n  });\n\n  describe('插入', () => {\n    test('在非段落的 block 内插入分割线，不会删除该 block', async () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"table\" key=\"table\" data={{\n                colsWidth: [100]\n              }}>\n                <block type=\"table-row\">\n                  <block type=\"table-cell\">\n                    <block key=\"test-a\" type=\"paragraph\">\n                      A\n                    </block>\n                  </block>\n                </block>\n            </block>\n          </document>\n        </value>\n      ) as unknown) as Value;\n\n      const controller = Controller.create({\n        value,\n        plugins,\n      });\n      const point = Point.createFromParams('table', 'before');\n      const selection = RangeSelection.create({\n        anchor: point,\n        focus: point,\n      });\n      controller.command(Commands.select, selection);\n      controller.run('onAction', hrPlugin.actions.insertHr({}));\n      const { document } = controller.value;\n      expect(document.filterDescendants(n => n.type === 'table').length).toBe(1);\n      expect(document.getBlocksByType('hr').length).toBe(1);\n    });\n  });\n\n  describe('hr节点数据', () => {\n    test(\"验证制定数据\", () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"paragraph\">\n              Start Paragraph\n              <cursor />\n            </block>\n            <block type=\"hr\" />\n          </document>\n        </value>\n      ) as unknown) as Value;\n      const controller = Controller.create({\n        value,\n        plugins,\n      });\n      controller.run('onAction', hrPlugin.actions.insertHr(hrPayload));\n      const { document } = controller.value;\n      const hrBlock = document.getBlocksByType('hr')[0];\n      expect(hrBlock.data).toEqual({\n        id: expect.anything(),\n        ...hrPayload,\n      });\n    });\n  });\n});\n"],"file":"behaviour.test.js"}