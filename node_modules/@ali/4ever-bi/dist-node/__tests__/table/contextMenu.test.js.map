{"version":3,"sources":["../../../../src/__tests__/table/contextMenu.test.tsx"],"names":["createTableAndShowContextMenu","value","content","expect","getElementsByTagName","length","toBe","fireEvent","contextMenu","describe","title","doDelete","controller","firstRow","document","nodes","command","Commands","removeNodeByKey","key","table","firstRaw","lastRaw","lastCellOfFirstRow","lastCellOfLastRow","forEach","it","colsWidth","controllerRef","jest","fn","mock","calls","tableSelection","startRowIndex","startColIndex","endRowIndex","endColIndex","getNode","td","querySelector","not","toThrow","click","screen","getByTestId","textContent","findByTestId"],"mappings":"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","sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\n/** @jsx jsx */\nimport '@testing-library/jest-dom/extend-expect';\nimport {\n  wait,\n  screen,\n} from '@testing-library/react';\nimport { renderEditor, jsx, fireEvent } from '@ali/4ever-dev-test';\nimport { Controller, Commands, Block, Value } from '@ali/4ever-cangjie';\nimport { last } from 'lodash-es';\nimport Editor from '../editor';\nimport { ITableSelection } from '@ali/4ever-plugin-table';\n\n\nasync function createTableAndShowContextMenu(value: Value) {\n  const { content } = await renderEditor(<Editor defaultValue={value} />);\n\n  expect(content.getElementsByTagName('table').length).toBe(1);\n\n  fireEvent.contextMenu(content.getElementsByTagName('td')[0]);\n  return content;\n}\n\ndescribe('table contextMenu', () => {\n  [{\n    title: '选区内行被删除，导致选区超出表格实际区域，右键不报错',\n    doDelete: (controller: Controller) => {\n      const firstRow = controller.value.document.nodes[0].nodes[0];\n      return controller.command(Commands.removeNodeByKey, firstRow.key);\n    },\n  }, {\n    title: '选区内列被删除，导致选区超出表格实际区域，右键不报错',\n    doDelete: (controller: Controller) => {\n      const table = controller.value.document.nodes[0];\n      const firstRaw = table.nodes[0] as Block;\n      const lastRaw = last(table.nodes) as Block;\n      const lastCellOfFirstRow = last(firstRaw.nodes)!;\n      const lastCellOfLastRow = last(lastRaw.nodes)!;\n      return controller\n        .command(Commands.removeNodeByKey, lastCellOfFirstRow.key)\n        .command(Commands.removeNodeByKey, lastCellOfLastRow.key);\n    },\n  }].forEach(({ title, doDelete }) => {\n    it(title, async () => {\n      const value = (\n        <value>\n          <document>\n            <block type=\"table\" key=\"table-key\" data={{ colsWidth: [100, 100] }}>\n              <block type=\"table-row\">\n                <block type=\"table-cell\">A</block>\n                <block type=\"table-cell\">B</block>\n              </block>\n              <block type=\"table-row\">\n                <block type=\"table-cell\">C</block>\n                <block type=\"table-cell\">D</block>\n              </block>\n            </block>\n          </document>\n        </value>\n      ) as unknown as Value;\n\n      const controllerRef = jest.fn();\n\n      const { content } = await renderEditor(<Editor defaultValue={value} controllerRef={controllerRef} />);\n\n      const controller = last(controllerRef.mock.calls)[0] as Controller;\n\n      const tableSelection: ITableSelection = {\n        key: 'table-key',\n        startRowIndex: 0,\n        startColIndex: 0,\n        endRowIndex: 1,\n        endColIndex: 1,\n      };\n\n      const table = controller.value.document.getNode('table-key');\n      controller.command('selectTableSelection', table as Block, tableSelection);\n\n      // 删除\n      doDelete(controller);\n\n      // flush\n      await wait();\n\n      const td = content.querySelector('td');\n\n      expect(() => fireEvent.contextMenu(td!)).not.toThrow();\n    });\n  });\n\n  describe('插入列', () => {\n    it('左侧插入一列', async () => {\n      const value = (\n        <value>\n          <document>\n            <block type=\"table\" key=\"table-key\" data={{ colsWidth: [150] }}>\n              <block type=\"table-row\">\n                <block type=\"table-cell\">A</block>\n              </block>\n            </block>\n          </document>\n        </value>\n      ) as unknown as Value;\n\n      const content = await createTableAndShowContextMenu(value);\n      await wait();\n      fireEvent.click(screen.getByTestId('menu-item-insert-col-left'));\n\n      await wait();\n\n      expect(content.getElementsByTagName('td').length).toBe(2);\n      expect(content.getElementsByTagName('td')[0].textContent).toBe('\\uFEFF');\n      expect(content.getElementsByTagName('td')[1].textContent).toBe('A');\n    });\n\n    it('右侧插入一列', async () => {\n      const value = (\n        <value>\n          <document>\n            <block type=\"table\" key=\"table-key\" data={{ colsWidth: [150] }}>\n              <block type=\"table-row\">\n                <block type=\"table-cell\">A</block>\n              </block>\n            </block>\n          </document>\n        </value>\n      ) as unknown as Value;\n\n      const content = await createTableAndShowContextMenu(value);\n      await wait();\n      fireEvent.click(screen.getByTestId('menu-item-insert-col-right'));\n\n      await wait();\n\n      expect(content.getElementsByTagName('td').length).toBe(2);\n      expect(content.getElementsByTagName('td')[0].textContent).toBe('A');\n      expect(content.getElementsByTagName('td')[1].textContent).toBe('\\uFEFF');\n    });\n  });\n\n  describe('插入行', () => {\n    it('上方插入一行', async () => {\n      const value = (\n        <value>\n          <document>\n            <block type=\"table\" key=\"table-key\" data={{ colsWidth: [150] }}>\n              <block type=\"table-row\">\n                <block type=\"table-cell\">A</block>\n              </block>\n            </block>\n          </document>\n        </value>\n      ) as unknown as Value;\n\n      const content = await createTableAndShowContextMenu(value);\n      await wait();\n      fireEvent.click(screen.getByTestId('menu-item-insert-row-above'));\n\n      await wait();\n\n      expect(content.getElementsByTagName('td').length).toBe(2);\n      expect(content.getElementsByTagName('td')[0].textContent).toBe('\\uFEFF');\n      expect(content.getElementsByTagName('td')[1].textContent).toBe('A');\n    });\n\n    it('下方插入一行', async () => {\n      const value = (\n        <value>\n          <document>\n            <block type=\"table\" key=\"table-key\" data={{ colsWidth: [150] }}>\n              <block type=\"table-row\">\n                <block type=\"table-cell\">A</block>\n              </block>\n            </block>\n          </document>\n        </value>\n      ) as unknown as Value;\n\n      const content = await createTableAndShowContextMenu(value);\n      await wait();\n      fireEvent.click(screen.getByTestId('menu-item-insert-row-below'));\n\n      await wait();\n\n      expect(content.getElementsByTagName('td').length).toBe(2);\n      expect(content.getElementsByTagName('td')[0].textContent).toBe('A');\n      expect(content.getElementsByTagName('td')[1].textContent).toBe('\\uFEFF');\n    });\n  });\n\n  describe('删除列', () => {\n    it('删除选中一列', async () => {\n      const value = (\n        <value>\n          <document>\n            <block type=\"table\" key=\"table-key\" data={{ colsWidth: [150, 150] }}>\n              <block type=\"table-row\">\n                <block type=\"table-cell\">\n                  <block type=\"paragraph\">\n                    A\n                  </block>\n                </block>\n                <block type=\"table-cell\">\n                  <block type=\"paragraph\">\n                    B\n                  </block>\n                </block>\n              </block>\n            </block>\n          </document>\n        </value>\n      ) as unknown as Value;\n\n      const content = await createTableAndShowContextMenu(value);\n      await wait();\n      fireEvent.click(screen.getByTestId('menu-item-delete-cols'));\n\n      await wait();\n\n      expect(content.getElementsByTagName('td').length).toBe(1);\n      expect(content.getElementsByTagName('td')[0].textContent).toBe('B');\n    });\n\n    it('删除最后一列，同时删除表格', async () => {\n      const value = (\n        <value>\n          <document>\n            <block type=\"paragraph\" />\n            <block type=\"table\" key=\"table-key\" data={{ colsWidth: [150] }}>\n              <block type=\"table-row\">\n                <block type=\"table-cell\">\n                  <block type=\"paragraph\">\n                    <cursor />A\n                  </block>\n                </block>\n              </block>\n            </block>\n          </document>\n        </value>\n      ) as unknown as Value;\n\n      const content = await createTableAndShowContextMenu(value);\n      await wait();\n      fireEvent.click(screen.getByTestId('menu-item-delete-cols'));\n\n      await wait();\n\n      expect(content.getElementsByTagName('td').length).toBe(0);\n    });\n  });\n\n  describe('删除行', () => {\n    it('删除选中一行', async () => {\n      const value = (\n        <value>\n          <document>\n            <block type=\"paragraph\" />\n            <block type=\"table\" key=\"table-key\" data={{ colsWidth: [150] }}>\n              <block type=\"table-row\">\n                <block type=\"table-cell\">\n                  <block type=\"paragraph\">\n                    <cursor />A\n                  </block>\n                </block>\n              </block>\n              <block type=\"table-row\">\n                <block type=\"table-cell\">\n                  <block type=\"paragraph\">\n                    B\n                  </block>\n                </block>\n              </block>\n            </block>\n          </document>\n        </value>\n      ) as unknown as Value;\n\n      const content = await createTableAndShowContextMenu(value);\n      await wait();\n      fireEvent.click(screen.getByTestId('menu-item-delete-rows'));\n\n      await wait();\n\n      expect(content.getElementsByTagName('td').length).toBe(1);\n      expect(content.getElementsByTagName('td')[0].textContent).toBe('B');\n    });\n\n    it('删除最后一行，同时删除表格', async () => {\n      const value = (\n        <value>\n          <document>\n            <block type=\"paragraph\" />\n            <block type=\"table\" key=\"table-key\" data={{ colsWidth: [150] }}>\n              <block type=\"table-row\">\n                <block type=\"table-cell\">\n                  <block type=\"paragraph\">\n                    <cursor />A\n                  </block>\n                </block>\n              </block>\n            </block>\n          </document>\n        </value>\n      ) as unknown as Value;\n\n      const content = await createTableAndShowContextMenu(value);\n      await wait();\n      fireEvent.click(screen.getByTestId('menu-item-delete-rows'));\n\n      await wait();\n\n      expect(content.getElementsByTagName('table').length).toBe(0);\n    });\n  });\n\n  it('删除表格', async () => {\n    const value = (\n      <value>\n        <document>\n          <block type=\"paragraph\" />\n          <block type=\"table\" key=\"table-key\" data={{ colsWidth: [150] }}>\n            <block type=\"table-row\">\n              <block type=\"table-cell\">\n                <block type=\"paragraph\">\n                  <cursor />A\n                </block>\n              </block>\n              <block type=\"table-cell\">\n                <block type=\"paragraph\">\n                  <cursor />B\n                </block>\n              </block>\n            </block>\n          </block>\n        </document>\n      </value>\n    ) as unknown as Value;\n\n    const content = await createTableAndShowContextMenu(value);\n    await screen.findByTestId('menu-item-delete-table');\n    fireEvent.click(screen.getByTestId('menu-item-delete-table'));\n\n    await wait();\n\n    expect(content.getElementsByTagName('table').length).toBe(0);\n  });\n});\n"],"file":"contextMenu.test.js"}