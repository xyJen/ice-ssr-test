{"version":3,"sources":["../../../../src/__tests__/table/selection-input.test.ts"],"names":["describe","it","tableSelection","startRowIndex","startColIndex","endRowIndex","endColIndex","controller","run","type","data","resultTableSelection","query","expect","toEqual","newSelection","value","selection","newSelectionKey","isCollapsed","anchor","key","selectionpath","document","getPath","cell","getNodeByPath","text"],"mappings":";;AAAA;;AAEA;;AACA;;AAEAA,QAAQ,CAAC,yBAAD,EAA4B,MAAM;AACxCC,EAAAA,EAAE,CAAC,wDAAD,EAA2D,YAAY;AACvE,UAAMC,cAAc,GAAG;AACrBC,MAAAA,aAAa,EAAE,CADM;AAErBC,MAAAA,aAAa,EAAE,CAFM;AAGrBC,MAAAA,WAAW,EAAE,CAHQ;AAIrBC,MAAAA,WAAW,EAAE;AAJQ,KAAvB;AAMA,UAAM;AAAEC,MAAAA;AAAF,QAAiB,MAAM,oCAAsB,CACjD,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CADiD,EAEjD,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CAFiD,EAGjD,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CAHiD,CAAtB,EAI1BL,cAJ0B,CAA7B;AAMAK,IAAAA,UAAU,CAACC,GAAX,CAAe,gBAAf,EAAiC,oCAAkB;AACjDC,MAAAA,IAAI,EAAE,YAD2C;AAEjDC,MAAAA,IAAI,EAAE;AAF2C,KAAlB,CAAjC;AAKA,UAAM,kBAAN,CAlBuE,CAmBvE;;AACA,UAAMC,oBAAoB,GAAGJ,UAAU,CAACK,KAAX,CAAiB,gBAAjB,CAA7B;AACAC,IAAAA,MAAM,CAACF,oBAAD,CAAN,CAA6BG,OAA7B,CAAqC,IAArC;AAEA,UAAMC,YAAY,GAAGR,UAAU,CAACS,KAAX,CAAiBC,SAAtC;AACA,UAAMC,eAAe,GAAGH,YAAY,CAACI,WAAb,IAA4BJ,YAAY,CAACK,MAAb,CAAoBC,GAAxE;AACA,UAAMC,aAAa,GAAGf,UAAU,CAACS,KAAX,CAAiBO,QAAjB,CAA0BC,OAA1B,CAAkCN,eAAlC,CAAtB,CAzBuE,CA0BvE;;AACAL,IAAAA,MAAM,CAACS,aAAD,CAAN,CAAsBR,OAAtB,CAA8B,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CAA9B;AAEA,UAAMW,IAAI,GAAGlB,UAAU,CAACS,KAAX,CAAiBO,QAAjB,CAA0BG,aAA1B,CAAwCJ,aAAxC,CAAb;AACAT,IAAAA,MAAM,CAACY,IAAI,CAACE,IAAN,CAAN,CAAkBb,OAAlB,CAA0B,GAA1B;AACD,GA/BC,CAAF;AAgCD,CAjCO,CAAR","sourcesContent":["import { CangjieInputEvent } from '@ali/4ever-cangjie';\nimport { fireEvent, getHotkeyEvent } from '@ali/4ever-dev-test';\nimport { wait } from '@testing-library/react';\nimport { createEditorWithTable } from './helpers';\n\ndescribe('table selection & input', () => {\n  it('TableSelection 状态输入文字时，光标落在 TableSelection 左上角并清空当前单元格', async () => {\n    const tableSelection = {\n      startRowIndex: 1,\n      startColIndex: 1,\n      endRowIndex: 2,\n      endColIndex: 2,\n    };\n    const { controller } = await createEditorWithTable([\n      ['00', '01', '02'],\n      ['10', '11', '12'],\n      ['20', '21', '22'],\n    ], tableSelection);\n\n    controller.run('onCangjieInput', CangjieInputEvent({\n      type: 'insertText',\n      data: 'A',\n    }));\n\n    await wait();\n    // 期望 tableSlection 被清空\n    const resultTableSelection = controller.query('tableSelection');\n    expect(resultTableSelection).toEqual(null);\n\n    const newSelection = controller.value.selection;\n    const newSelectionKey = newSelection.isCollapsed && newSelection.anchor.key;\n    const selectionpath = controller.value.document.getPath(newSelectionKey);\n    // 期望光标落在第二个单元格内\n    expect(selectionpath).toEqual([0, 1, 1, 0, 0]);\n\n    const cell = controller.value.document.getNodeByPath(selectionpath);\n    expect(cell.text).toEqual('A');\n  });\n});\n"],"file":"selection-input.test.js"}