{"version":3,"sources":["../../../../../src/__tests__/table/commands/emptyTableSelections.test.tsx"],"names":["describe","it","value","controllerRef","jest","fn","controller","mock","calls","t","document","getNode","table","resultController","command","actualTbSelection","query","expect","toEqual","newSelection","selection","newSelectionKey","isCollapsed","anchor","key","selectionpath","getPath"],"mappings":";;;;AAEA;;AAEA;;AACA;;AACA;;AANA;WAWM,qCACE,wCACE;AAAO,EAAA,IAAI,EAAC,OAAZ;AAAoB,EAAA,GAAG,EAAC;AAAxB,GACE;AAAO,EAAA,IAAI,EAAC;AAAZ,GACE;AAAO,EAAA,IAAI,EAAC;AAAZ,GACE;AAAO,EAAA,IAAI,EAAC;AAAZ,GACE,wCADF,CADF,CADF,EAME;AAAO,EAAA,IAAI,EAAC;AAAZ,GACE;AAAO,EAAA,IAAI,EAAC;AAAZ,GACE,qCADF,EAEE,wCAFF,CADF,CANF,EAYE;AAAO,EAAA,IAAI,EAAC;AAAZ,GACE;AAAO,EAAA,IAAI,EAAC;AAAZ,GACE,wCADF,EAEE,oCAFF,CADF,CAZF,CADF,CADF,CADF,C;;AAHNA,QAAQ,CAAC,iCAAD,EAAoC,MAAM;AAChDC,EAAAA,EAAE,CAAC,gBAAD,EAAmB,YAAY;AAC/B,UAAMC,KAAK,OAAX;AA4BA,UAAMC,aAAa,GAAGC,IAAI,CAACC,EAAL,EAAtB;AACA,UAAM,+BAAa,sBAAC,eAAD;AAAQ,MAAA,YAAY,EAAEH,KAAtB;AAA6B,MAAA,aAAa,EAAEC;AAA5C,MAAb,CAAN;AACA,UAAMG,UAAU,GAAG,kBAAKH,aAAa,CAACI,IAAd,CAAmBC,KAAxB,EAA+B,CAA/B,CAAnB;AACA,UAAMC,CAAC,GAAGH,UAAU,CAACJ,KAAX,CAAiBQ,QAAjB,CAA0BC,OAA1B,CAAkC,OAAlC,CAAV;AACA,4CAAkBL,UAAlB,EAA8BG,CAA9B,EAAiC,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAAjC;AACA,UAAMG,KAAK,GAAGN,UAAU,CAACJ,KAAX,CAAiBQ,QAAjB,CAA0BC,OAA1B,CAAkC,OAAlC,CAAd;AACA,UAAME,gBAAgB,GAAGP,UAAU,CAACQ,OAAX,CAAmB,qBAAnB,EAA0CF,KAA1C,CAAzB,CAnC+B,CAqC/B;;AACA,UAAMG,iBAAiB,GAAGT,UAAU,CAACU,KAAX,CAAiB,gBAAjB,CAA1B;AACAC,IAAAA,MAAM,CAACF,iBAAD,CAAN,CAA0BG,OAA1B,CAAkC,IAAlC;AAEA,UAAMC,YAAY,GAAGN,gBAAgB,CAACX,KAAjB,CAAuBkB,SAA5C;AACA,UAAMC,eAAe,GAAGF,YAAY,CAACG,WAAb,IAA4BH,YAAY,CAACI,MAAb,CAAoBC,GAAxE;AACA,UAAMC,aAAa,GAAGZ,gBAAgB,CAACX,KAAjB,CAAuBQ,QAAvB,CAAgCgB,OAAhC,CAAwCL,eAAxC,CAAtB,CA3C+B,CA4C/B;;AACAJ,IAAAA,MAAM,CAACQ,aAAD,CAAN,CAAsBP,OAAtB,CAA8B,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CAA9B;AACD,GA9CC,CAAF;AA+CD,CAhDO,CAAR","sourcesContent":["/** @jsx jsx */\nimport { Controller } from '@ali/4ever-cangjie';\nimport { renderEditor, jsx } from '@ali/4ever-dev-test';\nimport { Table } from '@ali/4ever-mo';\nimport { last } from 'lodash-es';\nimport { setTableColsWidth } from '@ali/4ever-plugin-table';\nimport Editor from '../../editor';\n\ndescribe('table/utils/emptyTableSelection', () => {\n  it('清空表格选区后，光标位置正常', async () => {\n    const value = ((\n      <value>\n        <document>\n          <block type=\"table\" key=\"table\">\n            <block type=\"table-row\">\n              <block type=\"table-cell\">\n                <block type=\"paragraph\">\n                  <text>A</text>\n                </block>\n              </block>\n              <block type=\"table-cell\">\n                <block type=\"paragraph\">\n                  <anchor />\n                  <text>B</text>\n                </block>\n              </block>\n              <block type=\"table-cell\">\n                <block type=\"paragraph\">\n                  <text>C</text>\n                  <focus />\n                </block>\n              </block>\n            </block>\n          </block>\n        </document>\n      </value>\n    ) as unknown) as Value;\n\n    const controllerRef = jest.fn();\n    await renderEditor(<Editor defaultValue={value} controllerRef={controllerRef} />);\n    const controller = last(controllerRef.mock.calls)[0] as Controller;\n    const t = controller.value.document.getNode('table') as Table;\n    setTableColsWidth(controller, t, [100, 100, 100]);\n    const table = controller.value.document.getNode('table') as Table;\n    const resultController = controller.command('emptyTableSelection', table);\n\n    // 期望 tableSlection 被清空\n    const actualTbSelection = controller.query('tableSelection');\n    expect(actualTbSelection).toEqual(null);\n\n    const newSelection = resultController.value.selection;\n    const newSelectionKey = newSelection.isCollapsed && newSelection.anchor.key;\n    const selectionpath = resultController.value.document.getPath(newSelectionKey);\n    // 期望光标落在第二个单元格内\n    expect(selectionpath).toEqual([0, 0, 1, 0, 0]);\n  });\n});\n"],"file":"emptyTableSelections.test.js"}