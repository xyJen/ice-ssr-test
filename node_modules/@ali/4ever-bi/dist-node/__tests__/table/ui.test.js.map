{"version":3,"sources":["../../../../src/__tests__/table/ui.test.tsx"],"names":["jest","useFakeTimers","expectShowDragPlaceholder","isShow","type","expect","document","querySelectorAll","toHaveLength","describe","originGetBoundingClientRect","beforeAll","window","HTMLElement","prototype","getBoundingClientRect","width","parseFloat","style","height","top","marginTop","left","marginLeft","right","x","y","afterAll","it","table","tbSelection","startRowIndex","endRowIndex","startColIndex","endColIndex","content","toolbarItem","querySelector","fireEvent","mouseOver","mouseDown","runOnlyPendingTimers","mouseUp","controller","toolbarItems","shiftKey","tableSelection","query","toEqual","objectContaining","resultTableSelection","mouseMove","value","colsWidth","not","toBeNull","controllerRef","fn","mock","calls","description","forEach"],"mappings":"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","sourcesContent":["/** @jsx jsx */\nimport '@testing-library/jest-dom/extend-expect';\nimport { last } from 'lodash-es';\nimport {\n  fireEvent,\n  jsx,\n  renderEditor,\n  waitForTime,\n} from '@ali/4ever-dev-test';\nimport { Commands, Controller, Value } from '@ali/4ever-cangjie';\nimport { waitFor } from '@testing-library/react';\nimport { createEditorWithTable } from './helpers';\nimport { ITableSelection } from '@ali/4ever-plugin-table';\nimport BiEditor from '../editor';\n\njest.useFakeTimers();\n\nfunction expectShowDragPlaceholder(\n  isShow = true,\n  type: 'row' | 'col',\n) {\n  expect(\n    document.querySelectorAll(\n      `[data-testid=\"table-${type}-drag-placeholder\"][data-visible=\"${isShow}\"]`\n    ),\n  ).toHaveLength(1);\n}\n\ndescribe('table/table/ui', () => {\n  let originGetBoundingClientRect = null;\n\n  beforeAll(() => {\n    originGetBoundingClientRect = window.HTMLElement.prototype.getBoundingClientRect;\n    // @ts-ignore\n    window.HTMLElement.prototype.getBoundingClientRect = function () {\n      return {\n        width: parseFloat(this.style.width) || 33,\n        height: parseFloat(this.style.height) || 33,\n        top: parseFloat(this.style.marginTop) || 0,\n        left: parseFloat(this.style.marginLeft) || 0,\n        right: parseFloat(this.style.marginLeft) || 0,\n        x: 0,\n        y: 0,\n      };\n    };\n  });\n\n  afterAll(() => {\n    window.HTMLElement.prototype.getBoundingClientRect = originGetBoundingClientRect;\n  });\n\n  it('长按选中列工具栏，出现拖拽占位图', async () => {\n    const table = [\n      ['A', 'B'],\n      ['C', 'D'],\n    ];\n    const tbSelection: ITableSelection = {\n      startRowIndex: 0,\n      endRowIndex: 1,\n      startColIndex: 0,\n      endColIndex: 0,\n    };\n    const { content } = await createEditorWithTable(table, tbSelection);\n    const toolbarItem = content.querySelector('[data-testid=\"table-col-toolbar-item\"]');\n    fireEvent.mouseOver(toolbarItem);\n    fireEvent.mouseDown(toolbarItem);\n    jest.runOnlyPendingTimers();\n    expectShowDragPlaceholder(true, 'col');\n    fireEvent.mouseUp(toolbarItem);\n    expectShowDragPlaceholder(false, 'col');\n  });\n\n  it('多选列：shift + click 可选中多列', async () => {\n    const table = [\n      ['A', 'B', 'A'],\n      ['C', 'D', 'C'],\n    ];\n    const { content, controller } = await createEditorWithTable(table);\n    const toolbarItems = content.querySelectorAll('[data-testid=\"table-col-toolbar-item\"]');\n    fireEvent.mouseDown(toolbarItems[0]);\n    fireEvent.mouseDown(toolbarItems[1], { shiftKey: true });\n    const tableSelection = controller.query('tableSelection');\n    expect(tableSelection).toEqual(expect.objectContaining({\n      startRowIndex: 0,\n      endRowIndex: 1,\n      startColIndex: 0,\n      endColIndex: 1,\n    }));\n  });\n\n  it('多选列：选中多列后，shift + click 可继续选中多列', async () => {\n    const table = [\n      ['A', 'B', 'A'],\n      ['C', 'D', 'C'],\n    ];\n    const { content, controller } = await createEditorWithTable(table);\n    const toolbarItems = content.querySelectorAll('[data-testid=\"table-col-toolbar-item\"]');\n    fireEvent.mouseDown(toolbarItems[1]);\n    fireEvent.mouseDown(toolbarItems[2], { shiftKey: true });\n    fireEvent.mouseUp(toolbarItems[2], { shiftKey: true });\n    const tableSelection = controller.query('tableSelection');\n    expect(tableSelection).toEqual(expect.objectContaining({\n      startRowIndex: 0,\n      endRowIndex: 1,\n      startColIndex: 1,\n      endColIndex: 2,\n    }));\n    await waitFor(() => {\n      fireEvent.mouseDown(toolbarItems[0], { shiftKey: true });\n      const resultTableSelection = controller.query('tableSelection');\n      expect(resultTableSelection).toEqual(expect.objectContaining({\n        startRowIndex: 0,\n        endRowIndex: 1,\n        startColIndex: 0,\n        endColIndex: 1,\n      }));\n    });\n  });\n\n  it('多选行：选中多行后，shift + click 可继续选中多行', async () => {\n    const table = [\n      ['A', 'B'],\n      ['C', 'D'],\n      ['C', 'D'],\n    ];\n    const tbSelection: ITableSelection = {\n      startRowIndex: 1,\n      endRowIndex: 1,\n      startColIndex: 0,\n      endColIndex: 1,\n    };\n    const { content, controller } = await createEditorWithTable(table, tbSelection);\n    const toolbarItem = content.querySelector('[data-testid=\"table-row-toolbar-item\"]');\n    fireEvent.mouseDown(toolbarItem, { shiftKey: true });\n    const resultTableSelection = controller.query('tableSelection');\n    expect(resultTableSelection).toEqual(expect.objectContaining({\n      startRowIndex: 0,\n      endRowIndex: 1,\n      startColIndex: 0,\n      endColIndex: 1,\n    }));\n  });\n\n  it('长按选中行工具栏，出现拖拽占位图', async () => {\n    const table = [\n      ['A', 'B'],\n      ['C', 'D'],\n    ];\n    const tbSelection: ITableSelection = {\n      startRowIndex: 0,\n      endRowIndex: 0,\n      startColIndex: 0,\n      endColIndex: 1,\n    };\n    const { content } = await createEditorWithTable(table, tbSelection);\n    const toolbarItem = content.querySelector('[data-testid=\"table-row-toolbar-item\"]');\n    fireEvent.mouseMove(toolbarItem);\n    fireEvent.mouseDown(toolbarItem);\n    jest.runOnlyPendingTimers();\n    expectShowDragPlaceholder(true, 'row');\n    fireEvent.mouseUp(toolbarItem);\n    expectShowDragPlaceholder(false, 'row');\n  });\n\n  describe('table 数据合法性校验', () => {\n    it('数据合法时，能正常渲染 table', async () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"table\"  data={{ colsWidth: [100] }}>\n              <block type=\"table-row\">\n                <block type=\"table-cell\">\n                  <block type=\"paragraph\">\n                    DingDoc\n                  </block>\n                </block>\n              </block>\n            </block>\n          </document>\n        </value>\n      ) as unknown) as Value;\n      const { content } = await renderEditor(\n        <BiEditor defaultValue={value} />,\n      );\n      await waitFor(() => {\n        const table = content.querySelector('table');\n        expect(table).not.toBeNull();\n      });\n    });\n\n    it('colsWidth 不存在时', async () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"table\">\n              <block type=\"table-row\">\n                <block type=\"table-cell\">\n                  <block type=\"paragraph\">\n                    DingDoc\n                  </block>\n                </block>\n              </block>\n            </block>\n          </document>\n        </value>\n      ) as unknown) as Value;\n      const { content } = await renderEditor(\n        <BiEditor defaultValue={value} />,\n      );\n      await waitFor(() => {\n        const table = content.querySelector('table');\n        expect(table).toBeNull();\n      });\n    });\n\n    it('colsWidth 为空数组，不渲染', async () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"table\" data={{ colsWidth: [] }}>\n              <block type=\"table-row\">\n                <block type=\"table-cell\">\n                  <block type=\"paragraph\">\n                    DingDoc\n                  </block>\n                </block>\n              </block>\n            </block>\n          </document>\n        </value>\n      ) as unknown) as Value;\n      const { content } = await renderEditor(\n        <BiEditor defaultValue={value} />,\n      );\n      await waitFor(() => {\n        const table = content.querySelector('table');\n        expect(table).toBeNull();\n      });\n    });\n\n    it('子节点是 text 时', async () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"table\" key=\"table-key\" data={{ colsWidth: [100, 100] }}>\n            </block>\n          </document>\n        </value>\n      ) as unknown) as Value;\n      const controllerRef = jest.fn();\n      const { content } = await renderEditor(\n        <BiEditor defaultValue={value} controllerRef={controllerRef} />,\n      );\n      const controller = last(controllerRef.mock.calls)[0] as Controller;\n      await waitFor(() => {\n        const table = content.querySelector('table');\n        expect(table).toBeNull();\n      });\n    });\n\n    [\n      {\n        description: 'tableCell 节点不在 table 内，不报错',\n        value: (\n          <value>\n            <document>\n              <block type=\"paragraph\">\n                <block type=\"table-row\">\n                  <block type=\"table-cell\">\n                    <block type=\"paragraph\">\n                      test\n                    </block>\n                  </block>\n                </block>\n              </block>\n            </document>\n          </value>\n        ),\n      },\n      {\n        description: 'tableCell 节点不在 tableRow 内，不报错',\n        value: (\n          <value>\n            <document>\n              <block type=\"paragraph\">\n                <block type=\"table-cell\">\n                  <block type=\"paragraph\">\n                    test\n                  </block>\n                </block>\n              </block>\n            </document>\n          </value>\n        ),\n      },\n      {\n        description: 'tableRow 节点不在 table 内，不报错',\n        value: (\n          <value>\n            <document>\n              <block type=\"paragraph\">\n                <block type=\"table-row\">\n                  <block type=\"paragraph\">\n                    test\n                  </block>\n                </block>\n              </block>\n            </document>\n          </value>\n        ),\n      },\n    ].forEach(({ description, value }) => {\n      it(description, async () => {\n        await renderEditor(<BiEditor defaultValue={value} />);\n      });\n    });\n  });\n});\n"],"file":"ui.test.js"}