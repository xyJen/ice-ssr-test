"use strict";

var _everCangjie = require("@ali/4ever-cangjie");

var _react = require("@testing-library/react");

var _helpers = require("./helpers");

describe('table selection & input', () => {
  it('TableSelection 状态输入文字时，光标落在 TableSelection 左上角并清空当前单元格', async () => {
    const tableSelection = {
      startRowIndex: 1,
      startColIndex: 1,
      endRowIndex: 2,
      endColIndex: 2
    };
    const {
      controller
    } = await (0, _helpers.createEditorWithTable)([['00', '01', '02'], ['10', '11', '12'], ['20', '21', '22']], tableSelection);
    controller.run('onCangjieInput', (0, _everCangjie.CangjieInputEvent)({
      type: 'insertText',
      data: 'A'
    }));
    await (0, _react.wait)(); // 期望 tableSlection 被清空

    const resultTableSelection = controller.query('tableSelection');
    expect(resultTableSelection).toEqual(null);
    const newSelection = controller.value.selection;
    const newSelectionKey = newSelection.isCollapsed && newSelection.anchor.key;
    const selectionpath = controller.value.document.getPath(newSelectionKey); // 期望光标落在第二个单元格内

    expect(selectionpath).toEqual([0, 1, 1, 0, 0]);
    const cell = controller.value.document.getNodeByPath(selectionpath);
    expect(cell.text).toEqual('A');
  });
});
//# sourceMappingURL=selection-input.test.js.map