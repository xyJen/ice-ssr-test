{"version":3,"sources":["../../../../src/__tests__/history/ui.test.tsx"],"names":["createValue","text","value","describe","it","editor","content","fireEvent","keyDown","expect","textContent","toBe","cangjieInput","data"],"mappings":"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","sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\n/** @jsx jsx */\nimport {\n  wait,\n} from '@testing-library/react';\nimport { renderEditor, getHotkeyEvent, jsx, fireEvent } from '@ali/4ever-dev-test';\nimport { Value } from '@ali/4ever-cangjie';\nimport Editor from '../editor';\n\nfunction createValue(text: string) {\n  const value = (\n    <value>\n      <document>\n        <block type=\"paragraph\">\n          {text}\n          <cursor />\n        </block>\n      </document>\n    </value>\n  ) as unknown as Value;\n  return value;\n}\n\ndescribe('Bi/history/ui', () => {\n  describe('undo', () => {\n    it('当 undo 栈为空时，不进行处理', async () => {\n      const { editor, content } = await renderEditor(<Editor defaultValue={createValue('Hello')} />);\n\n      fireEvent.keyDown(editor, getHotkeyEvent('ctrl+z'));\n      fireEvent.keyDown(editor, getHotkeyEvent('ctrl+z'));\n\n      // flush\n      await wait();\n\n      expect(content.textContent).toBe('Hello');\n    });\n\n    it('跳过光标相关操作，其余行为则与 slate 默认行为一致', async () => {\n      const { editor, content } = await renderEditor(<Editor defaultValue={createValue('Hello')} />);\n\n      fireEvent.cangjieInput(editor, { data: 'World' });\n\n      // flush\n      await wait();\n\n      fireEvent.keyDown(editor, getHotkeyEvent('left'));\n      fireEvent.keyDown(editor, getHotkeyEvent('left'));\n      fireEvent.keyDown(editor, getHotkeyEvent('left'));\n      fireEvent.keyDown(editor, getHotkeyEvent('right'));\n      fireEvent.keyDown(editor, getHotkeyEvent('right'));\n\n      fireEvent.keyDown(editor, getHotkeyEvent('ctrl+z'));\n\n      // flush\n      await wait();\n\n      expect(content.textContent).toBe('Hello');\n    });\n  });\n\n  describe('redo', () => {\n    it('当 redo 栈为空时，不进行处理', async () => {\n      const { editor, content } = await renderEditor(<Editor defaultValue={createValue('Hello')} />);\n\n      fireEvent.keyDown(editor, getHotkeyEvent('ctrl+y'));\n      fireEvent.keyDown(editor, getHotkeyEvent('ctrl+y'));\n\n      // flush\n      await wait();\n\n      expect(content.textContent).toBe('Hello');\n    });\n\n    it('跳过光标相关操作，其余行为则与 slate 默认行为一致', async () => {\n      const { editor, content } = await renderEditor(<Editor defaultValue={createValue('Hello')} />);\n\n      fireEvent.cangjieInput(editor, { data: 'World' });\n\n      // flush\n      await wait();\n\n      fireEvent.keyDown(editor, getHotkeyEvent('ctrl+z'));\n\n      fireEvent.keyDown(editor, getHotkeyEvent('left'));\n      fireEvent.keyDown(editor, getHotkeyEvent('left'));\n      fireEvent.keyDown(editor, getHotkeyEvent('left'));\n      fireEvent.keyDown(editor, getHotkeyEvent('right'));\n      fireEvent.keyDown(editor, getHotkeyEvent('right'));\n\n      fireEvent.keyDown(editor, getHotkeyEvent('ctrl+y'));\n\n      // flush\n      await wait();\n\n      expect(content.textContent).toBe('HelloWorld');\n    });\n  });\n});\n"],"file":"ui.test.js"}