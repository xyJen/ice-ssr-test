{"version":3,"sources":["../../../../../src/__tests__/calendarCard/shanhui/ui.test.tsx"],"names":["createBiPlugins","biPlugins","CalendarCardPlugin","Editor","props","defaultValue","calendarConfig","value","setValue","React","useState","plugins","useMemo","calendarCard","handleChange","useCallback","changed","calendarData","calendarId","comment","totalCount","place","startTime","endTime","timezone","time","subject","organizer","uid","topReceivers","name","type","avatarMediaId","redirectUrl","attachments","fileName","createCalendarConfig","config","mode","CalendarType","SHANHUI","locale","refresh","refreshTips","receiverCount","viewCalendardetails","noresponse","received","refused","pending","getContainerWidthInPC","jumpToCalendar","link","eventType","openProfile","jumpToAttachment","url","onRefreshSuccess","Promise","resolve","setTimeout","status","data","describe","beforeAll","jest","spyOn","console","error","mockImplementation","afterAll","mockRestore","afterEach","test","cardType","height","metadata","queryAllByTestId","receiverName","textContent","expect","includes","toBe","isInitialized","queryByText","message","tips","skip","retry_time","findByText","handleState","queryByTestId","container","gotoIcon","fireEvent","mouseDown","refreshIcon","querySelector","receiver","isUpdate","isPlaceholder","renderCreateCalendarBtn","btn","result","initCalendar","click"],"mappings":";;;;;;AAEA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAVA;;AACA;AAgBA,MAAMA,eAAe,GAAG,iCAA0B,EAChD,GAAGC,SAD6C;AAEhDC,EAAAA,kBAAkB,EAAlBA;AAFgD,CAA1B,CAAxB;;WAoBM,sBAAC,gBAAD,O;;AAfN,MAAMC,MAA6B,GAAIC,KAAD,IAAW;AAC/C,QAAM;AAAEC,IAAAA,YAAF;AAAgBC,IAAAA;AAAhB,MAAmCF,KAAzC;AACA,QAAM,CAACG,KAAD,EAAQC,QAAR,IAAoBC,KAAK,CAACC,QAAN,CAAeL,YAAf,CAA1B;AACA,QAAMM,OAAO,GAAGF,KAAK,CAACG,OAAN,CAAc,MAAM;AAClC,WAAOZ,eAAe,CAAC;AACrBa,MAAAA,YAAY,EAAEP;AADO,KAAD,CAAtB;AAGD,GAJe,EAIb,EAJa,CAAhB;AAMA,QAAMQ,YAAY,GAAGL,KAAK,CAACM,WAAN,CAAmBC,OAAD,IAAa;AAClDR,IAAAA,QAAQ,CAACQ,OAAO,CAACT,KAAT,CAAR;AACD,GAFoB,EAElB,EAFkB,CAArB;AAIA,SACE,sBAAC,iBAAD;AAAU,IAAA,KAAK,EAAEA,KAAjB;AAAwB,IAAA,QAAQ,EAAEO,YAAlC;AAAgD,IAAA,OAAO,EAAEH,OAAzD;AAAkE,IAAA,SAAS;AAA3E,UADF;AAKD,CAlBD;;AAoBA,MAAMM,YAAY,GAAG;AACnBC,EAAAA,UAAU,EAAE,UADO;AAEnBC,EAAAA,OAAO,EAAE,0YAFU;AAGnBC,EAAAA,UAAU,EAAE,EAHO;AAInBC,EAAAA,KAAK,EAAE,QAJY;AAKnBC,EAAAA,SAAS,EAAE,aALQ;AAMnBC,EAAAA,OAAO,EAAE,aANU;AAOnBC,EAAAA,QAAQ,EAAE,eAPS;AAQnBC,EAAAA,IAAI,EAAE,6BARa;AASnBC,EAAAA,OAAO,EAAE,sLATU;AAUnBC,EAAAA,SAAS,EAAE,CAAC;AAAEC,IAAAA,GAAG,EAAE;AAAP,GAAD,CAVQ;AAWnBC,EAAAA,YAAY,EAAE,CACZ;AACEC,IAAAA,IAAI,EAAE,GADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GADY,EAMZ;AACEA,IAAAA,GAAG,EAAE,OADP;AAEEE,IAAAA,IAAI,EAAE,IAFR;AAGEE,IAAAA,aAAa,EAAE,oFAHjB;AAIED,IAAAA,IAAI,EAAE;AAJR,GANY,EAYZ;AACED,IAAAA,IAAI,EAAE,IADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GAZY,EAiBZ;AACEE,IAAAA,IAAI,EAAE,qCADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GAjBY,EAsBZ;AACEE,IAAAA,IAAI,EAAE,MADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GAtBY,EA2BZ;AACEE,IAAAA,IAAI,EAAE,aADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GA3BY,EAgCZ;AACEE,IAAAA,IAAI,EAAE,OADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GAhCY,EAqCZ;AACEE,IAAAA,IAAI,EAAE,KADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GArCY,EA0CZ;AACEE,IAAAA,IAAI,EAAE,aADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GA1CY,EA+CZ;AACEE,IAAAA,IAAI,EAAE,IADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GA/CY,EAoDZ;AACEE,IAAAA,IAAI,EAAE,aADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GApDY,EAyDZ;AACEE,IAAAA,IAAI,EAAE,OADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GAzDY,EA8DZ;AACEE,IAAAA,IAAI,EAAE,aADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GA9DY,EAkET;AACDE,IAAAA,IAAI,EAAE,OADL;AAEDC,IAAAA,IAAI,EAAE,CAFL;AAGDH,IAAAA,GAAG,EAAE;AAHJ,GAlES,EAuEZ;AACEE,IAAAA,IAAI,EAAE,KADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GAvEY,EA4EZ;AACEE,IAAAA,IAAI,EAAE,aADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GA5EY,EAiFZ;AACEE,IAAAA,IAAI,EAAE,IADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GAjFY,EAsFZ;AACEE,IAAAA,IAAI,EAAE,aADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GAtFY,EA2FZ;AACEE,IAAAA,IAAI,EAAE,OADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GA3FY,EAgGZ;AACEE,IAAAA,IAAI,EAAE,aADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GAhGY,EAqGZ;AACEE,IAAAA,IAAI,EAAE,IADR;AAEEC,IAAAA,IAAI,EAAE,CAFR;AAGEH,IAAAA,GAAG,EAAE;AAHP,GArGY,CAXK;AAsHnBK,EAAAA,WAAW,EAAE,0UAtHM;AAuHnBC,EAAAA,WAAW,EAAE,CACX;AACEH,IAAAA,IAAI,EAAE,CADR;AAEEI,IAAAA,QAAQ,EAAE;AAFZ,GADW,EAKX;AACEJ,IAAAA,IAAI,EAAE,CADR;AAEEI,IAAAA,QAAQ,EAAE;AAFZ,GALW,EASX;AACEJ,IAAAA,IAAI,EAAE,CADR;AAEEI,IAAAA,QAAQ,EAAE;AAFZ,GATW,EAYR;AACDJ,IAAAA,IAAI,EAAE,CADL;AAEDI,IAAAA,QAAQ,EAAE;AAFT,GAZQ;AAvHM,CAArB;;AA0IA,MAAMC,oBAAoB,GAAIC,MAAD,IAAiB;AAC5C,SAAO;AACLC,IAAAA,IAAI,EAAEC,oBAAaC,OADd;AAELC,IAAAA,MAAM,EAAE;AACNC,MAAAA,OAAO,EAAE,IADH;AAENC,MAAAA,WAAW,EAAE,SAFP;AAGNC,MAAAA,aAAa,EAAE,aAHT;AAINC,MAAAA,mBAAmB,EAAE,QAJf;AAKNC,MAAAA,UAAU,EAAE,KALN;AAMNC,MAAAA,QAAQ,EAAE,KANJ;AAONC,MAAAA,OAAO,EAAE,KAPH;AAQNC,MAAAA,OAAO,EAAE,IARH;AASNtB,MAAAA,SAAS,EAAE;AATL,KAFH;AAaLuB,IAAAA,qBAAqB,EAAE,MAAM;AAC3B,aAAO,GAAP;AACD,KAfI;AAgBLC,IAAAA,cAAc,EAAE,CAACC,IAAD,EAAgBC,SAAhB,KAAuC,CAEtD,CAlBI;AAmBLC,IAAAA,WAAW,EAAG1B,GAAD,IAAiB,CAE7B,CArBI;AAsBL2B,IAAAA,gBAAgB,EAAE,CAACC,GAAD,EAAcH,SAAd,KAAqC,CAEtD,CAxBI;AAyBLI,IAAAA,gBAAgB,EAAE,MAAM,CAEvB,CA3BI;AA4BLf,IAAAA,OAAO,EAAE,CAACxB,UAAD,EAAqBmC,SAArB,KAA4C;AACnD,aAAO,IAAIK,OAAJ,CAAYC,OAAO,IAAI;AAE5BC,QAAAA,UAAU,CAAC,MAAM;AACfD,UAAAA,OAAO,CAAC;AACNE,YAAAA,MAAM,EAAE,SADF;AAENC,YAAAA,IAAI,EAAE7C;AAFA,WAAD,CAAP;AAID,SALS,EAKP,GALO,CAAV;AAMD,OARM,CAAP;AASD,KAtCI;AAuCL,OAAGoB;AAvCE,GAAP;AAyCD,CA1CD;;YA8O4C,6E;;AAjM5C0B,QAAQ,CAAC,YAAD,EAAe,MAAM;AAC3BC,EAAAA,SAAS,CAAC,MAAM;AACd;AACAC,IAAAA,IAAI,CAACC,KAAL,CAAWC,OAAX,EAAoB,OAApB,EAFc,CAGd;;AACAA,IAAAA,OAAO,CAACC,KAAR,CAAcC,kBAAd,CAAiC,MAAM,CAAG,CAA1C;AACD,GALQ,CAAT;AAOAC,EAAAA,QAAQ,CAAC,MAAM;AACb;AACAH,IAAAA,OAAO,CAACC,KAAR,CAAcG,WAAd;AACD,GAHO,CAAR;AAKAC,EAAAA,SAAS,CAAC,MAAM;AACd;AACD,GAFQ,CAAT;AAIAT,EAAAA,QAAQ,CAAC,oBAAD,EAAuB,MAAM;AACnCU,IAAAA,IAAI,CAAC,MAAD,EAAS,YAAY;AACvB,YAAMlE,KAAK,GACT,qCACE,wCACE;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,IAAI,EAAE;AAAEmE,UAAAA,QAAQ,EAAE,UAAZ;AAAwBC,UAAAA,MAAM,EAAE,GAAhC;AAAqCC,UAAAA,QAAQ,EAAE3D;AAA/C;AAAzB,QADF,CADF,CADF;AAQA,YAAM;AAAE4D,QAAAA;AAAF,UAAuB,MAAM,+BACjC,sBAAC,MAAD;AAAQ,QAAA,YAAY,EAAEtE,KAAtB;AAA6B,QAAA,cAAc,EAAE6B,oBAAoB,CAAC,EAAD;AAAjE,QADiC,CAAnC;AAGA,YAAM0C,YAAY,GAAGD,gBAAgB,CAAC,mBAAD,CAAhB,CAAsC,CAAtC,EAAyCE,WAA9D;AACAC,MAAAA,MAAM,CAACF,YAAY,CAACG,QAAb,CAAsBhE,YAAY,CAACY,YAAb,CAA0B,CAA1B,EAA6BC,IAAnD,CAAD,CAAN,CAAiEoD,IAAjE,CAAsE,IAAtE;AACD,KAdG,CAAJ;AAgBAT,IAAAA,IAAI,CAAC,gBAAD,EAAmB,YAAY;AACjC,YAAMlE,KAAK,GACT,qCACE,wCACE;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,IAAI,EAAE;AAAEmE,UAAAA,QAAQ,EAAE,UAAZ;AAAwBC,UAAAA,MAAM,EAAE,GAAhC;AAAqCC,UAAAA,QAAQ,EAAE,EAAE,GAAG3D,YAAL;AAAmBkE,YAAAA,aAAa,EAAE;AAAlC;AAA/C;AAAzB,QADF,CADF,CADF;AAQA,YAAM;AAAEC,QAAAA;AAAF,UAAkB,MAAM,+BAC5B,sBAAC,MAAD;AAAQ,QAAA,YAAY,EAAE7E,KAAtB;AAA6B,QAAA,cAAc,EAAE6B,oBAAoB,CAAC;AAChEM,UAAAA,OAAO,EAAE,CAACxB,UAAD,EAAqBmC,SAArB,KAA4C;AACnD,mBAAO,IAAIK,OAAJ,CAAYC,OAAO,IAAI;AAC5BC,cAAAA,UAAU,CAAC,MAAM;AACfD,gBAAAA,OAAO,CAAC;AACNE,kBAAAA,MAAM,EAAE,OADF;AAENwB,kBAAAA,OAAO,EAAE,YAFH;AAGNvB,kBAAAA,IAAI,EAAE;AAHA,iBAAD,CAAP;AAKD,eANS,EAMP,GANO,CAAV;AAOD,aARM,CAAP;AASD;AAX+D,SAAD;AAAjE,QAD4B,CAA9B;AAeA,YAAMwB,IAAI,GAAG,MAAMF,WAAW,CAAC,YAAD,CAA9B;AACAJ,MAAAA,MAAM,CAAC,CAAC,CAACM,IAAH,CAAN,CAAeJ,IAAf,CAAoB,KAApB;AACD,KA1BG,CAAJ;AA4BAT,IAAAA,IAAI,CAACc,IAAL,CAAU,kBAAV,EAA8B,YAAY;AACxC,YAAMhF,KAAK,GACT,qCACE,wCACE;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,IAAI,EAAE;AAAEmE,UAAAA,QAAQ,EAAE,UAAZ;AAAwBC,UAAAA,MAAM,EAAE,GAAhC;AAAqCC,UAAAA,QAAQ,EAAE;AAAE1D,YAAAA,UAAU,EAAE;AAAd;AAA/C;AAAzB,QADF,CADF,CADF;AAQA,UAAIsE,UAAU,GAAG,CAAjB;AACA,YAAM;AAAEC,QAAAA;AAAF,UAAiB,MAAM,+BAC3B,sBAAC,MAAD;AAAQ,QAAA,YAAY,EAAElF,KAAtB;AAA6B,QAAA,cAAc,EAAE6B,oBAAoB,CAAC;AAChEM,UAAAA,OAAO,EAAE,CAACxB,UAAD,EAAqBmC,SAArB,KAA4C;AACnDmC,YAAAA,UAAU,IAAI,CAAd;AACA,mBAAO,IAAI9B,OAAJ,CAAYC,OAAO,IAAI;AAC5BC,cAAAA,UAAU,CAAC,MAAM;AACfD,gBAAAA,OAAO,CAAC;AACNE,kBAAAA,MAAM,EAAE,OADF;AAENwB,kBAAAA,OAAO,EAAE,YAFH;AAGNvB,kBAAAA,IAAI,EAAE;AAHA,iBAAD,CAAP;AAKD,eANS,EAMP,EANO,CAAV;AAOD,aARM,CAAP;AASD;AAZ+D,SAAD;AAAjE,QAD2B,CAA7B;AAgBA,YAAMwB,IAAI,GAAG,MAAMG,UAAU,CAAC,YAAD,CAA7B;AACAT,MAAAA,MAAM,CAAC,CAAC,CAACM,IAAH,CAAN,CAAeJ,IAAf,CAAoB,IAApB,EA3BwC,CA4BxC;;AACAF,MAAAA,MAAM,CAACQ,UAAD,CAAN,CAAmBN,IAAnB,CAAwB,CAAxB;AACD,KA9BD;AAgCAT,IAAAA,IAAI,CAAC,MAAD,EAAS,YAAY;AACvB,YAAMlE,KAAK,GACT,qCACE,wCACE;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,IAAI,EAAE;AAAEmE,UAAAA,QAAQ,EAAE,UAAZ;AAAwBC,UAAAA,MAAM,EAAE,GAAhC;AAAqCC,UAAAA,QAAQ,EAAE3D;AAA/C;AAAzB,QADF,CADF,CADF;AAOA,YAAMyE,WAAgC,GAAG,EAAzC;AACA,YAAM;AAAEC,QAAAA,aAAF;AAAiBd,QAAAA,gBAAjB;AAAmCe,QAAAA;AAAnC,UAAiD,MAAM,+BAC3D,sBAAC,MAAD;AACE,QAAA,YAAY,EAAErF,KADhB;AAEE,QAAA,cAAc,EAAE6B,oBAAoB,CAAC;AACnCc,UAAAA,qBAAqB,EAAE,MAAM;AAC3B,mBAAO,GAAP;AACD,WAHkC;AAInCC,UAAAA,cAAc,EAAE,CAACC,IAAD,EAAgBC,SAAhB,KAAuC;AACrDqC,YAAAA,WAAW,CAACvC,cAAZ,GAA6B;AAAEC,cAAAA,IAAF;AAAQC,cAAAA;AAAR,aAA7B;AACD,WANkC;AAOnCC,UAAAA,WAAW,EAAG1B,GAAD,IAAiB;AAC5B8D,YAAAA,WAAW,CAACpC,WAAZ,GAA0B1B,GAA1B;AACD,WATkC;AAUnC6B,UAAAA,gBAAgB,EAAE,MAAM;AACtBiC,YAAAA,WAAW,CAACjC,gBAAZ,GAA+B,IAA/B;AACD,WAZkC;AAanCf,UAAAA,OAAO,EAAE,CAACxB,UAAD,EAAqBmC,SAArB,KAA4C;AACnDqC,YAAAA,WAAW,CAAChD,OAAZ,GAAsB;AAAExB,cAAAA,UAAF;AAAcmC,cAAAA;AAAd,aAAtB;AACA,mBAAO,IAAIK,OAAJ,CAAYC,OAAO,IAAI;AAC5BC,cAAAA,UAAU,CAAC,MAAM;AACfD,gBAAAA,OAAO,CAAC;AACNE,kBAAAA,MAAM,EAAE,SADF;AAENC,kBAAAA,IAAI,EAAE7C;AAFA,iBAAD,CAAP;AAID,eALS,EAKP,GALO,CAAV;AAMD,aAPM,CAAP;AAQD;AAvBkC,SAAD;AAFtC,QAD2D,CAA7D,CATuB,CAsCvB;;AACA+D,MAAAA,MAAM,CAACU,WAAW,CAAChD,OAAZ,CAAoBxB,UAArB,CAAN,CAAuCgE,IAAvC,CAA4CjE,YAAY,CAACC,UAAzD;AACA8D,MAAAA,MAAM,CAAC,CAACU,WAAW,CAAChD,OAAZ,CAAoBW,SAAtB,CAAN,CAAuC6B,IAAvC,CAA4C,IAA5C,EAxCuB,CAyCvB;;AACA,YAAMW,QAAQ,GAAGF,aAAa,CAAC,WAAD,CAA9B;;AACAG,6BAAUC,SAAV,CAAoBF,QAApB;;AACAb,MAAAA,MAAM,CAACU,WAAW,CAACvC,cAAZ,CAA2BE,SAA5B,CAAN,CAA6C6B,IAA7C,CAAkD,MAAlD,EA5CuB,CA6CvB;;AACA,YAAMc,WAAW,GAAGJ,SAAS,CAACK,aAAV,CAAwB,uBAAxB,CAApB;;AACAH,6BAAUC,SAAV,CAAoBC,WAApB;;AACAhB,MAAAA,MAAM,CAACU,WAAW,CAAChD,OAAZ,CAAoBW,SAArB,CAAN,CAAsC6B,IAAtC,CAA2C,OAA3C,EAhDuB,CAiDvB;;AACA,YAAMgB,QAAQ,GAAGrB,gBAAgB,CAAC,mBAAD,CAAhB,CAAsC,CAAtC,CAAjB;;AACAiB,6BAAUC,SAAV,CAAoBG,QAApB;;AACAlB,MAAAA,MAAM,CAACU,WAAW,CAACpC,WAAb,CAAN,CAAgC4B,IAAhC,CAAqCjE,YAAY,CAACY,YAAb,CAA0B,CAA1B,EAA6BD,GAAlE;AACD,KArDG,CAAJ;AAuDA6C,IAAAA,IAAI,CAAC,uBAAD,EAA0B,YAAY;AACxC,YAAMlE,KAAK,GACT,qCACE,wCACE;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,IAAI,EAAE;AAAEmE,UAAAA,QAAQ,EAAE,UAAZ;AAAwBC,UAAAA,MAAM,EAAE,GAAhC;AAAqCC,UAAAA,QAAQ,EAAE,EAAE,GAAG3D,YAAL;AAAmBkE,YAAAA,aAAa,EAAE,IAAlC;AAAwCzD,YAAAA,OAAO,EAAE;AAAjD;AAA/C;AAAzB,QADF,CADF,CADF;AAOA,YAAM;AAAE+D,QAAAA,UAAF;AAAcE,QAAAA,aAAd;AAA6BP,QAAAA;AAA7B,UAA6C,MAAM,+BACvD,sBAAC,MAAD;AACE,QAAA,YAAY,EAAE7E,KADhB;AAEE,QAAA,cAAc,EAAE6B,oBAAoB,CAAC;AACnCM,UAAAA,OAAO,EAAE,CAACxB,UAAD,EAAqBmC,SAArB,KAA4C;AACnD,mBAAO,IAAIK,OAAJ,CAAYC,OAAO,IAAI;AAC5BA,cAAAA,OAAO,CAAC;AACNE,gBAAAA,MAAM,EAAE,SADF;AAENC,gBAAAA,IAAI,EAAE,EAAE,GAAG7C,YAAL;AAAmBkE,kBAAAA,aAAa,EAAE,IAAlC;AAAwCzD,kBAAAA,OAAO,EAAE;AAAjD;AAFA,eAAD,CAAP;AAID,aALM,CAAP;AAMD;AARkC,SAAD;AAFtC,QADuD,CAAzD;AAcA,YAAMyE,QAAQ,GAAG,MAAMf,WAAW,CAAC,SAAD,CAAlC;AACAJ,MAAAA,MAAM,CAAC,CAAC,CAACmB,QAAH,CAAN,CAAmBjB,IAAnB,CAAwB,KAAxB,EAvBwC,CAwBxC;;AACA,YAAMc,WAAW,GAAGL,aAAa,CAAC,cAAD,CAAjC;;AACAG,6BAAUC,SAAV,CAAoBC,WAApB;AACD,KA3BG,CAAJ;AA4BD,GAhKO,CAAR;AAkKAjC,EAAAA,QAAQ,CAAC,gCAAD,EAAmC,MAAM;AAC/CU,IAAAA,IAAI,CAAC,kBAAD,EAAqB,YAAY;AACnC,YAAMlE,KAAK,GACT,qCACE,wCACE;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,IAAI,EAAE;AAAEmE,UAAAA,QAAQ,EAAE,UAAZ;AAAwBC,UAAAA,MAAM,EAAE,GAAhC;AAAqCC,UAAAA,QAAQ,EAAE;AAAEwB,YAAAA,aAAa,EAAE;AAAjB;AAA/C;AAAzB,QADF,CADF,CADF;AAQA,YAAM;AAAEhB,QAAAA;AAAF,UAAkB,MAAM,+BAC5B,sBAAC,MAAD;AACE,QAAA,YAAY,EAAE7E,KADhB;AAEE,QAAA,cAAc,EAAE6B,oBAAoB,CAAC;AACnCiE,UAAAA,uBAAuB,EAAE;AADU,SAAD;AAFtC,QAD4B,CAA9B;AAOA,YAAMC,GAAG,GAAGlB,WAAW,CAAC,QAAD,CAAvB;AACAJ,MAAAA,MAAM,CAAC,CAAC,CAACsB,GAAH,CAAN,CAAcpB,IAAd,CAAmB,IAAnB;AACD,KAlBG,CAAJ;AAoBAT,IAAAA,IAAI,CAAC,UAAD,EAAa,YAAY;AAC3B,YAAMlE,KAAK,GACT,qCACE,wCACE;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,IAAI,EAAE;AAAEmE,UAAAA,QAAQ,EAAE,UAAZ;AAAwBC,UAAAA,MAAM,EAAE,GAAhC;AAAqCC,UAAAA,QAAQ,EAAE;AAAEwB,YAAAA,aAAa,EAAE;AAAjB;AAA/C;AAAzB,QADF,CADF,CADF;AAQA,UAAIG,MAAM,GAAG,IAAb;AAEA,YAAM;AAAEnB,QAAAA;AAAF,UAAkB,MAAM,+BAC5B,sBAAC,MAAD;AACE,QAAA,YAAY,EAAE7E,KADhB;AAEE,QAAA,cAAc,EAAE6B,oBAAoB,CAAC;AACnCiE,UAAAA,uBAAuB,EAAE,CAAC;AAAEG,YAAAA;AAAF,WAAD,KAAuB;AAC9C,YAAA,OAAO,EAAE,MAAM;AACbD,cAAAA,MAAM,GAAGC,YAAY,CAAC;AACpB,8BAAc,UADM;AAEpB,6BAAa,aAFO;AAGpB,2BAAW,aAHS;AAIpB,4BAAY,eAJQ;AAKpB,2BAAW,eALS;AAMpB,yBAAS;AANW,eAAD,CAArB;AAQD;AAV6C;AADb,SAAD;AAFtC,QAD4B,CAA9B;AAkBA,YAAMF,GAAG,GAAG,MAAMlB,WAAW,CAAC,QAAD,CAA7B;;AACAU,6BAAUW,KAAV,CAAgBH,GAAhB;;AACAtB,MAAAA,MAAM,CAAC,CAAC,CAACuB,MAAH,CAAN,CAAiBrB,IAAjB,CAAsB,IAAtB,EA/B2B,CAgC3B;;AACA,YAAMqB,MAAN,CAjC2B,CAkC3B;;AACA,YAAMlF,KAAK,GAAG+D,WAAW,CAAC,eAAD,CAAzB;AACAJ,MAAAA,MAAM,CAAC,CAAC,CAAC3D,KAAH,CAAN,CAAgB6D,IAAhB,CAAqB,IAArB;AACD,KArCG,CAAJ;AAsCD,GA3DO,CAAR;AA4DD,CA/OO,CAAR","sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\n/** @jsx jsx */\nimport * as React from 'react';\nimport { Value } from '@ali/4ever-cangjie';\nimport { createCustomizedBiPlugins, CalendarCardPlugin, plugins as biPlugins } from '../../..';\nimport { cleanup } from '@testing-library/react';\nimport '@testing-library/jest-dom/extend-expect';\nimport { CalendarType } from '../../../plugins/calendarCard/types'\nimport Provider from '../../../provider';\nimport Content from '../../../content';\nimport { renderEditor, fireEvent, jsx } from '@ali/4ever-dev-test';\n\ninterface EditorProps {\n  defaultValue: Value;\n  calendarConfig: any;\n}\n\nconst createBiPlugins = createCustomizedBiPlugins({\n  ...biPlugins,\n  CalendarCardPlugin,\n} as any);\n\nconst Editor: React.FC<EditorProps> = (props) => {\n  const { defaultValue, calendarConfig } = props;\n  const [value, setValue] = React.useState(defaultValue);\n  const plugins = React.useMemo(() => {\n    return createBiPlugins({\n      calendarCard: calendarConfig,\n    });\n  }, []);\n\n  const handleChange = React.useCallback((changed) => {\n    setValue(changed.value);\n  }, []);\n\n  return (\n    <Provider value={value} onChange={handleChange} plugins={plugins} autoFocus>\n      <Content />\n    </Provider>\n  );\n};\n\nconst calendarData = {\n  calendarId: '18700362',\n  comment: '超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注超长备注',\n  totalCount: 14,\n  place: '10-3-3',\n  startTime: 1598281200000,\n  endTime: 1598284800000,\n  timezone: 'Asia/Shanghai',\n  time: '08月24日 23:00 - 08月25日 00:00',\n  subject: '超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题超长标题',\n  organizer: [{ uid: 3452016 }],\n  topReceivers: [\n    {\n      name: '陌',\n      type: 1,\n      uid: 3146067,\n    },\n    {\n      uid: 3452016,\n      name: '童岭',\n      avatarMediaId: 'https://static.dingtalk.com/media/lADPBbCc1h2tUUPNA8DNA74_958_960.jpg_60x60q90.jpg',\n      type: 1,\n    },\n    {\n      name: '董旭',\n      type: 1,\n      uid: 3166262,\n    },\n    {\n      name: '张卫刚卫刚卫刚卫刚卫刚卫刚卫刚卫刚卫刚卫刚卫刚卫刚卫刚卫刚卫刚卫刚卫刚',\n      type: 1,\n      uid: 3452113,\n    },\n    {\n      name: '1598',\n      type: 1,\n      uid: 3452114,\n    },\n    {\n      name: '170****2451',\n      type: 1,\n      uid: 3451114,\n    },\n    {\n      name: 'Benjy',\n      type: 1,\n      uid: 2855028,\n    },\n    {\n      name: '张卫刚',\n      type: 1,\n      uid: 3452184,\n    },\n    {\n      name: '150****2598',\n      type: 1,\n      uid: 3452115,\n    },\n    {\n      name: '董旭',\n      type: 1,\n      uid: 3166266,\n    },\n    {\n      name: '170****2451',\n      type: 1,\n      uid: 3451117,\n    },\n    {\n      name: 'Benjy',\n      type: 1,\n      uid: 2855039,\n    },\n    {\n      name: '150****2598',\n      type: 1,\n      uid: 3452414,\n    }, {\n      name: 'Benjy',\n      type: 1,\n      uid: 2855028,\n    },\n    {\n      name: '张卫刚',\n      type: 1,\n      uid: 3452184,\n    },\n    {\n      name: '150****2598',\n      type: 1,\n      uid: 3452115,\n    },\n    {\n      name: '董旭',\n      type: 1,\n      uid: 3166266,\n    },\n    {\n      name: '170****2451',\n      type: 1,\n      uid: 3451117,\n    },\n    {\n      name: 'Benjy',\n      type: 1,\n      uid: 2855039,\n    },\n    {\n      name: '150****2598',\n      type: 1,\n      uid: 3452414,\n    },\n    {\n      name: '董旭',\n      type: 1,\n      uid: 3166562,\n    },\n  ],\n  redirectUrl: 'dingtalk://dingtalkclient/action/open_mini_app?miniAppId=2018112162280005&ddMode=push&mainTask=true&keepAlive=false&newCalendar=1&page=pages%2Fdetail%2Findex%3FuniqueId%3DM2JMK2NUUlYzODVTdEpmeXFLYThhZz09&fallback_url=dingtalk%3A%2F%2Fdingtalkclient%2Fpage%2Fcalendar_detail%3Fid%3D0%26uniqueId%3DM2JMK2NUUlYzODVTdEpmeXFLYThhZz09',\n  attachments: [\n    {\n      type: 7,\n      fileName: '市政府工作会议纪要.docx',\n    },\n    {\n      type: 1,\n      fileName: '市政府工作会议纪要2.docx',\n    },\n    {\n      type: 2,\n      fileName: '市政府工作会议纪要3.docx',\n    }, {\n      type: 3,\n      fileName: '市政府工作会议纪要4.docx',\n    },\n  ],\n};\n\nconst createCalendarConfig = (config: any) => {\n  return {\n    mode: CalendarType.SHANHUI,\n    locale: {\n      refresh: '刷新',\n      refreshTips: '日程卡片有更新',\n      receiverCount: '等{count}人参会',\n      viewCalendardetails: '查看日程详情',\n      noresponse: '未响应',\n      received: '已接收',\n      refused: '已拒绝',\n      pending: '待定',\n      organizer: '组织人',\n    },\n    getContainerWidthInPC: () => {\n      return 440;\n    },\n    jumpToCalendar: (link?: string, eventType?: string) => {\n      console.log('跳转到日程的链接为：', link, eventType);\n    },\n    openProfile: (uid: number) => {\n      console.log('打开Profile参数为：', uid);\n    },\n    jumpToAttachment: (url: string, eventType?: string) => {\n      console.log('打开附件的地址为：', url, eventType);\n    },\n    onRefreshSuccess: () => {\n      console.log('刷新成功！', 3);\n    },\n    refresh: (calendarId: string, eventType?: string) => {\n      return new Promise(resolve => {\n        console.log('获取日程信息...', eventType);\n        setTimeout(() => {\n          resolve({\n            status: 'success',\n            data: calendarData,\n          });\n        }, 150);\n      });\n    },\n    ...config,\n  };\n};\n\n\ndescribe('Bi/card/ui', () => {\n  beforeAll(() => {\n    // 防止被 componentDidCatch catch 的 error 被控制台输出\n    jest.spyOn(console, 'error');\n    // @ts-ignore\n    console.error.mockImplementation(() => { });\n  });\n\n  afterAll(() => {\n    // @ts-ignore\n    console.error.mockRestore();\n  });\n\n  afterEach(() => {\n    cleanup();\n  });\n\n  describe('Bi/CalendarCard/UI', () => {\n    test('正常渲染', async () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"card\" data={{ cardType: 'calendar', height: 350, metadata: calendarData }} />\n          </document>\n        </value>\n      ) as unknown) as Value;\n\n      const { queryAllByTestId } = await renderEditor(\n        <Editor defaultValue={value} calendarConfig={createCalendarConfig({})} />,\n      );\n      const receiverName = queryAllByTestId('calendar-receiver')[0].textContent;\n      expect(receiverName.includes(calendarData.topReceivers[0].name)).toBe(true);\n    });\n\n    test('卡片请求报错时弹出 Tips', async () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"card\" data={{ cardType: 'calendar', height: 350, metadata: { ...calendarData, isInitialized: true } }} />\n          </document>\n        </value>\n      ) as unknown) as Value;\n\n      const { queryByText } = await renderEditor(\n        <Editor defaultValue={value} calendarConfig={createCalendarConfig({\n          refresh: (calendarId: string, eventType?: string) => {\n            return new Promise(resolve => {\n              setTimeout(() => {\n                resolve({\n                  status: 'error',\n                  message: '日程卡片获取信息失败',\n                  data: {},\n                });\n              }, 150);\n            });\n          },\n        })} />,\n      );\n      const tips = await queryByText('日程卡片获取信息失败');\n      expect(!!tips).toBe(false);\n    });\n\n    test.skip('卡片初始化请求报错时不会重复请求', async () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"card\" data={{ cardType: 'calendar', height: 350, metadata: { calendarId: '18700362' } }} />\n          </document>\n        </value>\n      ) as unknown) as Value;\n\n      let retry_time = 0;\n      const { findByText } = await renderEditor(\n        <Editor defaultValue={value} calendarConfig={createCalendarConfig({\n          refresh: (calendarId: string, eventType?: string) => {\n            retry_time += 1;\n            return new Promise(resolve => {\n              setTimeout(() => {\n                resolve({\n                  status: 'error',\n                  message: '日程卡片获取信息失败',\n                  data: {},\n                });\n              }, 10);\n            });\n          },\n        })} />,\n      );\n      const tips = await findByText('日程卡片获取信息失败');\n      expect(!!tips).toBe(true);\n      // 确保请求出错后不会进行二次请求\n      expect(retry_time).toBe(1);\n    });\n\n    test('点击交互', async () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"card\" data={{ cardType: 'calendar', height: 350, metadata: calendarData }} />\n          </document>\n        </value>\n      ) as unknown) as Value;\n      const handleState: Record<string, any> = {};\n      const { queryByTestId, queryAllByTestId, container } = await renderEditor(\n        <Editor\n          defaultValue={value}\n          calendarConfig={createCalendarConfig({\n            getContainerWidthInPC: () => {\n              return 640;\n            },\n            jumpToCalendar: (link?: string, eventType?: string) => {\n              handleState.jumpToCalendar = { link, eventType };\n            },\n            openProfile: (uid: number) => {\n              handleState.openProfile = uid;\n            },\n            onRefreshSuccess: () => {\n              handleState.onRefreshSuccess = true;\n            },\n            refresh: (calendarId: string, eventType?: string) => {\n              handleState.refresh = { calendarId, eventType };\n              return new Promise(resolve => {\n                setTimeout(() => {\n                  resolve({\n                    status: 'success',\n                    data: calendarData,\n                  });\n                }, 150);\n              });\n            },\n          })} />,\n      );\n      // 首次打开自动刷新数据\n      expect(handleState.refresh.calendarId).toBe(calendarData.calendarId);\n      expect(!handleState.refresh.eventType).toBe(true);\n      // 点击goto\n      const gotoIcon = queryByTestId('Icon_goto');\n      fireEvent.mouseDown(gotoIcon);\n      expect(handleState.jumpToCalendar.eventType).toBe('icon');\n      // 点击刷新\n      const refreshIcon = container.querySelector('.weicon-LoadingNormal');\n      fireEvent.mouseDown(refreshIcon);\n      expect(handleState.refresh.eventType).toBe('click');\n      // 点击应邀人\n      const receiver = queryAllByTestId('calendar-receiver')[0];\n      fireEvent.mouseDown(receiver);\n      expect(handleState.openProfile).toBe(calendarData.topReceivers[0].uid);\n    });\n\n    test('已有日程数据，点击刷新 icon 写入数据', async () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"card\" data={{ cardType: 'calendar', height: 350, metadata: { ...calendarData, isInitialized: true, subject: '测试日程' } }} />\n          </document>\n        </value>\n      ) as unknown) as Value;\n      const { findByText, queryByTestId, queryByText } = await renderEditor(\n        <Editor\n          defaultValue={value}\n          calendarConfig={createCalendarConfig({\n            refresh: (calendarId: string, eventType?: string) => {\n              return new Promise(resolve => {\n                resolve({\n                  status: 'success',\n                  data: { ...calendarData, isInitialized: true, subject: '更新后的日程标题' },\n                });\n              });\n            },\n          })} />,\n      );\n      const isUpdate = await queryByText('日程卡片有更新');\n      expect(!!isUpdate).toBe(false);\n      // 点击刷新按钮\n      const refreshIcon = queryByTestId('Icon_refresh');\n      fireEvent.mouseDown(refreshIcon);\n    });\n  });\n\n  describe('Bi/CalendarCard/UI/Placeholder', () => {\n    test('正常渲染 Placeholder', async () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"card\" data={{ cardType: 'calendar', height: 350, metadata: { isPlaceholder: true } }} />\n          </document>\n        </value>\n      ) as unknown) as Value;\n\n      const { queryByText } = await renderEditor(\n        <Editor\n          defaultValue={value}\n          calendarConfig={createCalendarConfig({\n            renderCreateCalendarBtn: () => (<button>点击创建日程</button>)\n          })} />,\n      );\n      const btn = queryByText('点击创建日程');\n      expect(!!btn).toBe(true);\n    });\n\n    test('点击按钮创建日程', async () => {\n      const value = ((\n        <value>\n          <document>\n            <block type=\"card\" data={{ cardType: 'calendar', height: 350, metadata: { isPlaceholder: true } }} />\n          </document>\n        </value>\n      ) as unknown) as Value;\n\n      let result = null;\n\n      const { queryByText } = await renderEditor(\n        <Editor\n          defaultValue={value}\n          calendarConfig={createCalendarConfig({\n            renderCreateCalendarBtn: ({ initCalendar }) => (<button\n              onClick={() => {\n                result = initCalendar({\n                  \"calendarId\": \"18700362\",\n                  \"startTime\": 1598281200000,\n                  \"endTime\": 1598284800000,\n                  \"timezone\": \"Asia/Shanghai\",\n                  \"subject\": \"placeholder日程\",\n                  \"place\": \"placeholder地点\",\n                });\n              }}\n            >点击创建日程</button>)\n          })} />,\n      );\n      const btn = await queryByText('点击创建日程');\n      fireEvent.click(btn);\n      expect(!!result).toBe(true);\n      // 确保日程已经渲染完成\n      await result;\n      // 确保日程渲染正确\n      const place = queryByText('placeholder地点');\n      expect(!!place).toBe(true);\n    });\n  });\n});\n"],"file":"ui.test.js"}