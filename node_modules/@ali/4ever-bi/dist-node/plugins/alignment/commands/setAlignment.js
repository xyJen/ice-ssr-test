"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = setAlignment;

var _everCangjie = require("@ali/4ever-cangjie");

var _everUtils = require("@ali/4ever-utils");

var _utils = require("../utils");

/* eslint-disable max-len */
function setAlignment(controller, align, key) {
  const {
    value
  } = controller;
  let blocks;

  if (key) {
    const curBlock = value.document.getClosestBlock(key);
    blocks = curBlock ? [curBlock] : [];
  } else {
    blocks = (0, _everUtils.getBlocksFromEditor)(controller);
  }

  blocks.forEach(block => {
    const currentAlignment = (0, _everUtils.getClosestParagraph)(value, block);

    if (currentAlignment) {
      const prevAlignment = currentAlignment.data.jc ? {
        jc: currentAlignment.data.jc
      } : {};
      const newAlignment = {
        jc: align
      };

      if ((0, _everUtils.isEqualWithDefault)(prevAlignment, newAlignment, _utils.DEFAULT_ALIGNMENT)) {
        return;
      }

      controller.command(_everCangjie.Commands.setNodeByKey, currentAlignment.key, {
        data: { ...currentAlignment.data,
          jc: align
        }
      });
    }
  });
  return controller;
}
//# sourceMappingURL=setAlignment.js.map