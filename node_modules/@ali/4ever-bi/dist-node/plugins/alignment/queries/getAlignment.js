"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getAlignment;

var _everMo = require("@ali/4ever-mo");

var _everUtils = require("@ali/4ever-utils");

const DEFAULT_ALIGNMENT = 'left';

function getAlignmentOfBlock(block) {
  const alignment = block ? block.data.jc || DEFAULT_ALIGNMENT : DEFAULT_ALIGNMENT;
  return alignment === 'distribute' ? 'justify' : alignment;
}

function getAlignment(controller, node) {
  let paragraphs;

  if (node) {
    const curBlock = controller.value.document.getClosestBlock(node.key);
    paragraphs = curBlock ? [curBlock] : [];
  } else {
    const blocks = (0, _everUtils.getBlocksFromEditor)(controller);
    paragraphs = blocks.filter(block => _everMo.Paragraph.isParagraph(block) || _everMo.Heading.isHeading(block));
  }

  if (paragraphs.length === 1) {
    return getAlignmentOfBlock(paragraphs[0]);
  }

  let commonAlignment;
  paragraphs.some(paragraph => {
    const currentAlignment = getAlignmentOfBlock(paragraph);

    if (commonAlignment && currentAlignment !== commonAlignment) {
      commonAlignment = undefined;
      return true;
    }

    commonAlignment = currentAlignment;
    return false;
  });
  return commonAlignment;
}
//# sourceMappingURL=getAlignment.js.map