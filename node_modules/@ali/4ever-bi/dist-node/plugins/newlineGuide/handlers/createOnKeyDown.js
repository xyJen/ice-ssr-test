"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = createOnKeyUp;

var _everCangjie = require("@ali/4ever-cangjie");

var _isHotkey = require("is-hotkey");

var _newlineGuide = require("../model/newlineGuide");

const isMoveHotKey = event => ['up', 'down', 'left', 'right', 'enter'].map(key => (0, _isHotkey.isKeyHotkey)(key)).some(isEvent => isEvent(event));
/**
 * onKeyDown 仅仅用于在下拉菜单弹出的时候拦截方向键事件
 */


function createOnKeyUp(config) {
  const newlineGuideEnabled = config.newlineGuide?.enabled;
  return (event, controller, next) => {
    if (!newlineGuideEnabled || _everCangjie.environment.IS_MOBILE) return next();
    const {
      triggered,
      showMenu
    } = _newlineGuide.NewlineGuideData.get(controller) || {}; // 这里由于trigger状态发生了变化，所以需要区分展开下拉框和

    if (triggered && showMenu && isMoveHotKey(event)) {
      return event.preventDefault();
    }

    return next();
  };
}
//# sourceMappingURL=createOnKeyDown.js.map