{"version":3,"sources":["../../../../../src/plugins/newlineGuide/handlers/createOnKeyDown.ts"],"names":["isMoveHotKey","event","map","key","some","isEvent","createOnKeyUp","config","newlineGuideEnabled","newlineGuide","enabled","controller","next","environment","IS_MOBILE","triggered","showMenu","NewlineGuideData","get","preventDefault"],"mappings":";;;;;;;AAAA;;AAEA;;AACA;;AAGA,MAAMA,YAAY,GAAIC,KAAD,IAAgC,CAAC,IAAD,EAAO,MAAP,EAAe,MAAf,EAAuB,OAAvB,EAAgC,OAAhC,EAClDC,GADkD,CAC7CC,GAAD,IAAS,2BAAYA,GAAZ,CADqC,EAElDC,IAFkD,CAE5CC,OAAD,IAAaA,OAAO,CAACJ,KAAD,CAFyB,CAArD;AAIA;AACA;AACA;;;AACe,SAASK,aAAT,CAAuBC,MAAvB,EAA+C;AAC5D,QAAMC,mBAAmB,GAAGD,MAAM,CAACE,YAAP,EAAqBC,OAAjD;AACA,SAAO,CAACT,KAAD,EAA6BU,UAA7B,EAAqDC,IAArD,KAAwE;AAC7E,QAAI,CAACJ,mBAAD,IAAwBK,yBAAYC,SAAxC,EAAmD,OAAOF,IAAI,EAAX;AAEnD,UAAM;AAAEG,MAAAA,SAAF;AAAaC,MAAAA;AAAb,QAA0BC,+BAAiBC,GAAjB,CAAqBP,UAArB,KAAoC,EAApE,CAH6E,CAI7E;;AACA,QAAII,SAAS,IAAIC,QAAb,IAAyBhB,YAAY,CAACC,KAAD,CAAzC,EAAkD;AAChD,aAAOA,KAAK,CAACkB,cAAN,EAAP;AACD;;AACD,WAAOP,IAAI,EAAX;AACD,GATD;AAUD","sourcesContent":["import { Controller, environment } from '@ali/4ever-cangjie';\nimport React from 'react';\nimport { isKeyHotkey } from 'is-hotkey';\nimport { NewlineGuideData } from '../model/newlineGuide';\nimport { BiPluginConfig } from '../../../types';\n\nconst isMoveHotKey = (event: React.KeyboardEvent) => ['up', 'down', 'left', 'right', 'enter']\n  .map((key) => isKeyHotkey(key))\n  .some((isEvent) => isEvent(event));\n\n/**\n * onKeyDown 仅仅用于在下拉菜单弹出的时候拦截方向键事件\n */\nexport default function createOnKeyUp(config: BiPluginConfig) {\n  const newlineGuideEnabled = config.newlineGuide?.enabled;\n  return (event: React.KeyboardEvent, controller: Controller, next: Function) => {\n    if (!newlineGuideEnabled || environment.IS_MOBILE) return next();\n\n    const { triggered, showMenu } = NewlineGuideData.get(controller) || {};\n    // 这里由于trigger状态发生了变化，所以需要区分展开下拉框和\n    if (triggered && showMenu && isMoveHotKey(event)) {\n      return event.preventDefault();\n    }\n    return next();\n  };\n}\n"],"file":"createOnKeyDown.js"}