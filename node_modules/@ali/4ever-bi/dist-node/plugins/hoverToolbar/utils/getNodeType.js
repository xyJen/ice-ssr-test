"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getNodeType;

var _everCangjie = require("@ali/4ever-cangjie");

var _everUtils = require("@ali/4ever-utils");

var _everMo = require("@ali/4ever-mo");

var _lodash = require("lodash");

const typeMap = {
  'colorBlocks': 'callout'
};

function getBlockType(block, controller) {
  let type = block.type;

  if (_everMo.TableCell.isTableCell(block)) {
    const {
      document
    } = controller.value;
    const tableRow = document.getParent(block.key);
    const table = tableRow ? document.getParent(tableRow.key) : null;

    if (_everMo.Table.isTable(table) && table.data.sr) {
      return 'columns';
    }
  }

  if ((0, _everUtils.isListNode)(block)) {
    return 'list';
  }

  if (block.type === 'card') {
    type = block.data?.cardType || 'card';
  } else if (block.type === 'container') {
    type = block.data.subType || 'container';
  }

  return typeMap[type] || type;
}

function getInlineType(inline) {
  if (inline.type === 'image' && inline.data?.extraData?.isSignature) {
    return 'signature';
  }

  if (inline.type === 'image' && (0, _lodash.isEmpty)(inline.data)) {
    return 'imagePlaceholder';
  }

  return inline.type;
}

function getNodeType(node, controller) {
  if (_everCangjie.Block.isBlock(node)) {
    return getBlockType(node, controller);
  }

  if (_everCangjie.Inline.isInline(node)) {
    return getInlineType(node);
  }

  return '';
}
//# sourceMappingURL=getNodeType.js.map