"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = createOnCangjiePaste;

var _lodash = require("lodash");

var _types = require("../types");

function createOnCangjiePaste(config) {
  const {
    calendarCard: calendarCardConfig = {}
  } = config;
  const {
    mode
  } = calendarCardConfig;
  return async function onCangjiePaste(event, controller, next) {
    const clipboardData = controller.query('getClipboardData', event);
    const fragment = clipboardData?.getFragment();
    if (!fragment) return next();
    const isShanhui = mode === _types.CalendarType.SHANHUI;
    const calendarNodes = fragment.nodes.filter(block => block.data.cardType === 'calendar');

    if ((0, _lodash.isEmpty)(calendarNodes)) {
      return next();
    }

    const newFragment = fragment.set('nodes', fragment.nodes.map(block => {
      if (block.data.cardType === 'calendar') {
        return block.set('data', { ...block.data,
          height: isShanhui ? 75 : 102
        });
      }

      return block;
    }));
    controller.command("insertFragmentByClipboard", newFragment);
  };
}
//# sourceMappingURL=createOnCangjiePaste.js.map