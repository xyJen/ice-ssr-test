"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _react = _interopRequireWildcard(require("react"));

var _weDesign = require("@ali/we-design");

var _everBamboo = require("@ali/4ever-bamboo");

const _createElement = /*#__PURE__*/_react.default.createElement;
const ERROR_TIPS_TIMEOUT = 5000;
const {
  RefreshTipsTextWrapper
} = _everBamboo.CalendarCardPlugin;

const useRefreshResult = () => {
  const [result, setResult] = (0, _react.useState)(null);
  const tipsNode = (0, _react.useMemo)(() => {
    if (!result) return null;
    const {
      status,
      message
    } = result;
    if (status === 'success') return null;
    return /*#__PURE__*/_createElement(_react.default.Fragment, null, /*#__PURE__*/_createElement(_weDesign.RoundcloseThickNormal, {
      style: {
        color: _weDesign.theme.errorColor,
        marginRight: '3px'
      }
    }), /*#__PURE__*/_createElement(RefreshTipsTextWrapper, null, message));
  }, [result]);
  const timeoutRef = (0, _react.useRef)();
  const setRefreshResult = (0, _react.useCallback)(res => {
    setResult(res); // 5s 后错误 tips 消失

    timeoutRef.current = window.setTimeout(() => {
      setResult(null);
      timeoutRef.current = null;
    }, ERROR_TIPS_TIMEOUT);
  }, [setResult]);
  (0, _react.useEffect)(() => {
    return () => {
      if (timeoutRef.current) clearTimeout(timeoutRef.current);
    };
  }, []);
  return {
    refreshTipsNode: tipsNode,
    setRefreshResult
  };
};

var _default = useRefreshResult;
exports.default = _default;
//# sourceMappingURL=useRefreshResult.js.map