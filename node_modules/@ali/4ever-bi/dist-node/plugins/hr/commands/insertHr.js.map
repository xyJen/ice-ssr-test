{"version":3,"sources":["../../../../../src/plugins/hr/commands/insertHr.ts"],"names":["controller","payload","value","focusBlock","type","color","sz","hrColor","DEFAULT_HR_COLOR","command","Commands","insertBlock","data","width","id","removeNodeByKey","key"],"mappings":";;;;;;;;;AAAA;;AAEA;;AACA;;AACA;;AACA;;eAEe,CAACA,UAAD,EAAyBC,OAAe,GAAG,EAA3C,KAAkD;AAC/D,QAAM;AAAEC,IAAAA;AAAF,MAAYF,UAAlB;AACA,QAAM;AAAEG,IAAAA;AAAF,MAAiBD,KAAvB;;AACA,MAAIC,UAAU,EAAEC,IAAZ,KAAqB,IAAzB,EAA+B;AAC7B,WAAO,uBAASJ,UAAT,EAAqBG,UAArB,EAAiCF,OAAjC,CAAP;AACD;;AAED,QAAM;AAAEI,IAAAA,KAAF;AAASD,IAAAA,IAAT;AAAeE,IAAAA;AAAf,MAAsBL,OAA5B;AACA,QAAMM,OAAO,GAAGF,KAAK,IAAIG,2BAAzB;AACAR,EAAAA,UAAU,CACPS,OADH,CACWC,sBAASC,WADpB,EACiC;AAC7BP,IAAAA,IAAI,EAAE,IADuB;AAE7BQ,IAAAA,IAAI,EAAE;AACJP,MAAAA,KAAK,EAAEE,OADH;AAEJH,MAAAA,IAFI;AAGJS,MAAAA,KAAK,EAAE,MAHH;AAGW;AACfP,MAAAA,EAAE,EAAEA,EAAE,IAAI,CAJN;AAIS;AACbQ,MAAAA,EAAE,EAAE;AALA;AAFuB,GADjC,EAWGL,OAXH,CAWWC,sBAASC,WAXpB,EAWiC,WAXjC,EAT+D,CAqB/D;;AACA,MAAI,kCAAsBR,UAAtB,CAAJ,EAAuC;AACrCH,IAAAA,UAAU,CAACS,OAAX,CAAmBC,sBAASK,eAA5B,EAA6CZ,UAAU,CAACa,GAAxD;AACD;;AAED,SAAOhB,UAAP;AACD,C","sourcesContent":["import { Controller, Commands } from '@ali/4ever-cangjie';\nimport { HrData } from '@ali/4ever-mo';\nimport { generateKey} from '@ali/4ever-utils';\nimport updateHr from './updateHr';\nimport { DEFAULT_HR_COLOR } from '../constants';\nimport { shouldDeleteParagraph } from '../utils';\n\nexport default (controller: Controller, payload: HrData = {}) => {\n  const { value } = controller;\n  const { focusBlock } = value;\n  if (focusBlock?.type === 'hr') {\n    return updateHr(controller, focusBlock, payload);\n  }\n\n  const { color, type, sz } = payload;\n  const hrColor = color ?? DEFAULT_HR_COLOR;\n  controller\n    .command(Commands.insertBlock, {\n      type: 'hr',\n      data: {\n        color: hrColor,\n        type,\n        width: '100%', // 默认占满一行\n        sz: sz || 2, // size 默认为 2\n        id: generateKey(),\n      },\n    })\n    .command(Commands.insertBlock, 'paragraph');\n  // 插入前是空行则删除\n  if (shouldDeleteParagraph(focusBlock)) {\n    controller.command(Commands.removeNodeByKey, focusBlock.key);\n  }\n\n  return controller;\n};\n"],"file":"insertHr.js"}