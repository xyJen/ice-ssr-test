{"version":3,"sources":["../../../../../src/plugins/headingGroupNew/handlers/createGenerateGroup.ts"],"names":["Heading1","Heading2","Heading3","Heading","createGenerateGroup","config","generateGroup","element","controller","next","document","value","parent","getParent","key","last","nodes","length","Document","isDocument","isHeading1","type","data","symbol","isHeading2","isHeading3"],"mappings":";;;;;;;AAAA;;AACA;;AAGA,MAAM;AAAEA,EAAAA,QAAF;AAAYC,EAAAA,QAAZ;AAAsBC,EAAAA;AAAtB,IAAmCC,eAAzC;;AAEA,SAASC,mBAAT,CAA6BC,MAA7B,EAAkF;AAEhF,SAAO,SAASC,aAAT,CAAuBC,OAAvB,EAAgCC,UAAhC,EAA4CC,IAA5C,EAAkD;AACvD,UAAM;AAAEC,MAAAA;AAAF,QAAeF,UAAU,CAACG,KAAhC;AACA,UAAMC,MAAM,GAAGF,QAAQ,CAACG,SAAT,CAAmBN,OAAO,CAACO,GAA3B,CAAf;AACA,UAAMC,IAAI,GAAGH,MAAM,EAAEI,KAAR,CAAcJ,MAAM,CAACI,KAAP,CAAaC,MAAb,GAAsB,CAApC,CAAb,CAHuD,CAKvD;;AACA,QAAI,CAACC,sBAASC,UAAT,CAAoBP,MAApB,CAAD,IAAgCG,IAAI,KAAKR,OAA7C,EAAsD;AACpD,aAAOE,IAAI,EAAX;AACD;;AAED,QAAIT,QAAQ,CAACoB,UAAT,CAAoBb,OAApB,CAAJ,EAAkC;AAChC,aAAO;AAAEc,QAAAA,IAAI,EAAE,gBAAR;AAA0BC,QAAAA,IAAI,EAAE;AAAEC,UAAAA,MAAM,EAAE;AAAV;AAAhC,OAAP;AACD,KAFD,MAEO,IAAItB,QAAQ,CAACuB,UAAT,CAAoBjB,OAApB,CAAJ,EAAkC;AACvC,aAAO;AAAEc,QAAAA,IAAI,EAAE,gBAAR;AAA0BC,QAAAA,IAAI,EAAE;AAAEC,UAAAA,MAAM,EAAE;AAAV;AAAhC,OAAP;AACD,KAFM,MAEA,IAAIrB,QAAQ,CAACuB,UAAT,CAAoBlB,OAApB,CAAJ,EAAkC;AACvC,aAAO;AAAEc,QAAAA,IAAI,EAAE,gBAAR;AAA0BC,QAAAA,IAAI,EAAE;AAAEC,UAAAA,MAAM,EAAE;AAAV;AAAhC,OAAP;AACD;;AAED,WAAOd,IAAI,EAAX;AACD,GAnBD;AAoBD;;eAEcL,mB","sourcesContent":["import { Document, Plugin, Block } from '@ali/4ever-cangjie';\nimport { Heading } from '@ali/4ever-mo';\nimport { HeadingGroupConfig } from '../types';\n\nconst { Heading1, Heading2, Heading3 } = Heading;\n\nfunction createGenerateGroup(config: HeadingGroupConfig): Plugin['generateGroup'] {\n\n  return function generateGroup(element, controller, next) {\n    const { document } = controller.value;\n    const parent = document.getParent(element.key);\n    const last = parent?.nodes[parent.nodes.length - 1];\n\n    // 如果不是一级节点，或者是文档末尾，则不分组\n    if (!Document.isDocument(parent) || last === element) {\n      return next();\n    }\n\n    if (Heading1.isHeading1(element)) {\n      return { type: 'heading1-group', data: { symbol: '#' } };\n    } else if (Heading2.isHeading2(element)) {\n      return { type: 'heading2-group', data: { symbol: '##' } };\n    } else if (Heading3.isHeading3(element)) {\n      return { type: 'heading3-group', data: { symbol: '###' } };\n    }\n\n    return next();\n  };\n}\n\nexport default createGenerateGroup;\n"],"file":"createGenerateGroup.js"}