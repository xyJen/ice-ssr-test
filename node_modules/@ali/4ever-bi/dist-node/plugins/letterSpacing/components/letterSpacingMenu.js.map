{"version":3,"sources":["../../../../../src/plugins/letterSpacing/components/letterSpacingMenu.tsx"],"names":["MIN","MAX","STEP","canSetMark","controller","isCollapsedAtEdge","isExpanded","value","selection","startBlock","startInline","Link","isLink","Paragraph","isParagraph","Heading","isHeading","LetterSpacingMenu","props","menuItem","title","rest","isDisabled","letterSpacing","query","handleMinusClick","spacing","run","handlePlusClick","commonButtonStyle","PluginRoles","letterSpacingMinus","letterSpacingPlus"],"mappings":";;;;;;;;;;;;;AAAA;;AAEA;;AACA;;AACA;;AAEA;;AACA;;uBAN4B,a;AAY5B,MAAMA,GAAG,GAAG,CAAC,EAAb;AACA,MAAMC,GAAG,GAAG,EAAZ;AACA,MAAMC,IAAI,GAAG,GAAb;;AAEA,SAASC,UAAT,CAAoBC,UAApB,EAA4C;AAC1C,QAAM;AAAEC,IAAAA,iBAAF;AAAqBC,IAAAA;AAArB,MAAoCF,UAAU,CAACG,KAAX,CAAiBC,SAA3D;AACA,MAAIH,iBAAiB,IAAIC,UAAzB,EAAqC,OAAO,IAAP;AAErC,QAAM;AAAEG,IAAAA,UAAF;AAAcC,IAAAA;AAAd,MAA8BN,UAAU,CAACG,KAA/C;;AAEA,MAAIG,WAAW,IAAI,CAACC,aAAKC,MAAL,CAAYF,WAAZ,CAApB,EAA8C;AAC5C;AACA,WAAO,KAAP;AACD;;AACD,MAAIG,kBAAUC,WAAV,CAAsBL,UAAtB,KAAqCM,gBAAQC,SAAR,CAAkBP,UAAlB,CAAzC,EAAwE;AACtE;AACA,WAAO,IAAP;AACD;;AAED,SAAO,KAAP;AACD;;wBAyBe,eAAC,yBAAD,O;;yBAQA,eAAC,wBAAD,O;;AA/BD,SAASQ,iBAAT,CAA2BC,KAA3B,EAAsD;AACnE,QAAM;AAAEC,IAAAA,QAAF;AAAYf,IAAAA;AAAZ,MAA2Bc,KAAjC;AACA,QAAM;AAAEE,IAAAA,KAAF;AAAS,OAAGC;AAAZ,MAAqBF,QAA3B;AAEA,QAAMG,UAAU,GAAG,CAACnB,UAAU,CAACC,UAAD,CAA9B;AACA,QAAMmB,aAAa,GAAGnB,UAAU,CAACoB,KAAX,CAAiB,kBAAjB,CAAtB;;AAEA,QAAMC,gBAAgB,GAAG,MAAM;AAC7B,UAAMC,OAAO,GAAGH,aAAa,GAAGrB,IAAhC;AACA,QAAIwB,OAAO,GAAG1B,GAAd,EAAmB;AACnBI,IAAAA,UAAU,CAACuB,GAAX,CAAe,UAAf,EAA2B,+BAAiBD,OAAjB,CAA3B;AACD,GAJD;;AAMA,QAAME,eAAe,GAAG,MAAM;AAC5B,UAAMF,OAAO,GAAGH,aAAa,GAAGrB,IAAhC;AACA,QAAIwB,OAAO,GAAGzB,GAAd,EAAmB;AACnBG,IAAAA,UAAU,CAACuB,GAAX,CAAe,UAAf,EAA2B,+BAAiBD,OAAjB,CAA3B;AACD,GAJD;;AAMA,sBACE,eAAC,iBAAD,6BAAaL,IAAb;AAAmB,IAAA,KAAK,EAAED,KAA1B;AAAiC,IAAA,QAAQ,EAAEE;AAA3C,mBACE,eAAC,iBAAD,qBACE,eAAC,gBAAD;AACE,IAAA,IAAI,MADN;AAEE,IAAA,KAAK,EAAEO,wBAFT;AAGE,IAAA,QAAQ,EAAE,KAHZ;AAIE,IAAA,OAAO,EAAEJ,gBAJX;AAKE,IAAA,IAAI,EAAEK,wBAAYC;AALpB,IADF,eAQE,eAAC,mBAAD,QAAeR,aAAf,OARF,eASE,eAAC,gBAAD;AACE,IAAA,IAAI,OADN;AAEE,IAAA,KAAK,EAAEM,wBAFT;AAGE,IAAA,QAAQ,EAAE,KAHZ;AAIE,IAAA,OAAO,EAAED,eAJX;AAKE,IAAA,IAAI,EAAEE,wBAAYE;AALpB,IATF,CADF,CADF;AAqBD","sourcesContent":["import * as React from 'react';\nimport { Controller } from '@ali/4ever-cangjie';\nimport { Link, Paragraph, Heading } from '@ali/4ever-mo';\nimport { SubMenu, Button, PlusBetaNormal, MinusBetaNormal } from '@ali/we-design';\nimport { PluginRoles } from '@ali/4ever-bamboo';\nimport { MenuItemInnerProps } from '@ali/4ever-component';\nimport { setLetterSpacing } from '../actions';\nimport {\n  SpacingSet,\n  SpacingValue,\n  commonButtonStyle,\n} from './style';\n\nconst MIN = -10;\nconst MAX = 10;\nconst STEP = 0.5;\n\nfunction canSetMark(controller: Controller) {\n  const { isCollapsedAtEdge, isExpanded } = controller.value.selection;\n  if (isCollapsedAtEdge || isExpanded) return true;\n\n  const { startBlock, startInline } = controller.value;\n\n  if (startInline && !Link.isLink(startInline)) {\n    // 仅支持 link\n    return false;\n  }\n  if (Paragraph.isParagraph(startBlock) || Heading.isHeading(startBlock)) {\n    // 仅支持文字段落\n    return true;\n  }\n\n  return false;\n}\n\nexport default function LetterSpacingMenu(props: MenuItemInnerProps) {\n  const { menuItem, controller } = props;\n  const { title, ...rest } = menuItem;\n\n  const isDisabled = !canSetMark(controller);\n  const letterSpacing = controller.query('getLetterSpacing') as number;\n\n  const handleMinusClick = () => {\n    const spacing = letterSpacing - STEP;\n    if (spacing < MIN) return;\n    controller.run('onAction', setLetterSpacing(spacing));\n  };\n\n  const handlePlusClick = () => {\n    const spacing = letterSpacing + STEP;\n    if (spacing > MAX) return;\n    controller.run('onAction', setLetterSpacing(spacing));\n  };\n\n  return (\n    <SubMenu {...rest} title={title} disabled={isDisabled}>\n      <SpacingSet>\n        <Button\n          icon={<MinusBetaNormal />}\n          style={commonButtonStyle}\n          bordered={false}\n          onClick={handleMinusClick}\n          role={PluginRoles.letterSpacingMinus}\n        />\n        <SpacingValue>{letterSpacing}pt</SpacingValue>\n        <Button\n          icon={<PlusBetaNormal />}\n          style={commonButtonStyle}\n          bordered={false}\n          onClick={handlePlusClick}\n          role={PluginRoles.letterSpacingPlus}\n        />\n      </SpacingSet>\n    </SubMenu>\n  );\n}\n"],"file":"letterSpacingMenu.js"}