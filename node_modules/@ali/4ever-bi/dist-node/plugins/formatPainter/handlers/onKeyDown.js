"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = onKeyDown;

var _isHotkey = require("is-hotkey");

var _everComponent = require("@ali/4ever-component");

var _onCopyFormat = _interopRequireDefault(require("./onCopyFormat"));

var _onPasteFormat = _interopRequireDefault(require("./onPasteFormat"));

var _actions = require("../actions");

const isCopyFormatHotKey = (0, _isHotkey.isKeyHotkey)('mod+shift+c');
const isPasteFormatHotKey = (0, _isHotkey.isKeyHotkey)('mod+shift+v');
const isEscape = (0, _isHotkey.isKeyHotkey)('escape');

function onKeyDown(docStyleReference) {
  return (event, controller, next) => {
    if (isCopyFormatHotKey(event)) {
      return (0, _onCopyFormat.default)(event, controller, (0, _everComponent.getDocDefaultSz)(docStyleReference?.docStyle));
    }

    if (isPasteFormatHotKey(event)) {
      return (0, _onPasteFormat.default)(event, controller, next);
    }

    if (isEscape(event)) {
      const {
        formatClipboard
      } = controller.value.data;
      const isActive = formatClipboard && formatClipboard.trigger === 'toolbar';

      if (isActive) {
        controller.run('onAction', (0, _actions.clearFormatClipboard)());
      }
    }

    return next();
  };
}
//# sourceMappingURL=onKeyDown.js.map