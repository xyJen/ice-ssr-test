{"version":3,"sources":["../../../../../src/plugins/formatPainter/handlers/onKeyDown.ts"],"names":["isCopyFormatHotKey","isPasteFormatHotKey","isEscape","onKeyDown","docStyleReference","event","controller","next","docStyle","formatClipboard","value","data","isActive","trigger","run"],"mappings":";;;;;;;;;AACA;;AAEA;;AACA;;AACA;;AACA;;AAEA,MAAMA,kBAAkB,GAAG,2BAAY,aAAZ,CAA3B;AACA,MAAMC,mBAAmB,GAAG,2BAAY,aAAZ,CAA5B;AACA,MAAMC,QAAQ,GAAG,2BAAY,QAAZ,CAAjB;;AAMe,SAASC,SAAT,CAAmBC,iBAAnB,EAA0D;AACvE,SAAO,CAACC,KAAD,EAA6BC,UAA7B,EAAqDC,IAArD,KAA0E;AAC/E,QAAIP,kBAAkB,CAACK,KAAD,CAAtB,EAA+B;AAC7B,aAAO,2BAAaA,KAAb,EAAoBC,UAApB,EAAgC,oCAAgBF,iBAAiB,EAAEI,QAAnC,CAAhC,CAAP;AACD;;AAED,QAAIP,mBAAmB,CAACI,KAAD,CAAvB,EAAgC;AAC9B,aAAO,4BAAcA,KAAd,EAAqBC,UAArB,EAAiCC,IAAjC,CAAP;AACD;;AAED,QAAIL,QAAQ,CAACG,KAAD,CAAZ,EAAqB;AACnB,YAAM;AAAEI,QAAAA;AAAF,UAAsBH,UAAU,CAACI,KAAX,CAAiBC,IAA7C;AACA,YAAMC,QAAQ,GAAGH,eAAe,IAAIA,eAAe,CAACI,OAAhB,KAA4B,SAAhE;;AACA,UAAID,QAAJ,EAAc;AACZN,QAAAA,UAAU,CAACQ,GAAX,CAAe,UAAf,EAA2B,oCAA3B;AACD;AACF;;AAED,WAAOP,IAAI,EAAX;AACD,GAlBD;AAmBD","sourcesContent":["import React from 'react';\nimport { isKeyHotkey } from 'is-hotkey';\nimport { DocStyle, Controller } from '@ali/4ever-cangjie';\nimport { getDocDefaultSz } from '@ali/4ever-component';\nimport onCopyFormat from './onCopyFormat';\nimport onPasteFormat from './onPasteFormat';\nimport { clearFormatClipboard } from '../actions';\n\nconst isCopyFormatHotKey = isKeyHotkey('mod+shift+c');\nconst isPasteFormatHotKey = isKeyHotkey('mod+shift+v');\nconst isEscape = isKeyHotkey('escape');\n\nexport interface DocStyleReference {\n  docStyle?: DocStyle;\n}\n\nexport default function onKeyDown(docStyleReference?: DocStyleReference) {\n  return (event: React.KeyboardEvent, controller: Controller, next: () => void) => {\n    if (isCopyFormatHotKey(event)) {\n      return onCopyFormat(event, controller, getDocDefaultSz(docStyleReference?.docStyle));\n    }\n\n    if (isPasteFormatHotKey(event)) {\n      return onPasteFormat(event, controller, next);\n    }\n\n    if (isEscape(event)) {\n      const { formatClipboard } = controller.value.data;\n      const isActive = formatClipboard && formatClipboard.trigger === 'toolbar';\n      if (isActive) {\n        controller.run('onAction', clearFormatClipboard());\n      }\n    }\n\n    return next();\n  };\n}\n"],"file":"onKeyDown.js"}