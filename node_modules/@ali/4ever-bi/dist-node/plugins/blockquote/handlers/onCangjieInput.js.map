{"version":3,"sources":["../../../../../src/plugins/blockquote/handlers/onCangjieInput.ts"],"names":["validDelimiters","onCangjieInput","event","controller","next","startBlock","selection","document","value","detail","data","char","text","slice","convertToTextPoints","start","offset","includes","type","list","blockquote","preventDefault","command","Commands","moveFocusToStartOfNode","del","dispatch","mdType"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AAEA,MAAMA,eAAe,GAAG,CAAC,GAAD,EAAM,GAAN,CAAxB;;AAEe,SAASC,cAAT,CACbC,KADa,EAEbC,UAFa,EAGbC,IAHa,EAIb;AACA,QAAM;AAAEC,IAAAA,UAAF;AAAcC,IAAAA,SAAd;AAAyBC,IAAAA;AAAzB,MAAsCJ,UAAU,CAACK,KAAvD;AACA,MAAIN,KAAK,CAACO,MAAN,CAAaC,IAAb,KAAsB,GAAtB,IAA6B,CAACL,UAAlC,EAA8C,OAAOD,IAAI,EAAX;AAE9C,QAAMO,IAAI,GAAGN,UAAU,CAACO,IAAX,CAAgBC,KAAhB,CACX,CADW,EAEXP,SAAS,CAACQ,mBAAV,CAA8BP,QAA9B,EAAwCQ,KAAxC,CAA8CC,MAFnC,CAAb;;AAIA,MACEhB,eAAe,CAACiB,QAAhB,CAAyBN,IAAzB,KACAN,UAAU,CAACa,IAAX,KAAoB,WADpB,IAEA,CAACb,UAAU,CAACK,IAAX,CAAgBS,IAFjB,IAGA,CAACd,UAAU,CAACK,IAAX,CAAgBU,UAHjB,IAIA,CAAC,mCAAqBjB,UAArB,CALH,EAME;AACAD,IAAAA,KAAK,CAACmB,cAAN;AACAlB,IAAAA,UAAU,CACPmB,OADH,CACWC,sBAASC,sBADpB,EAC4CnB,UAD5C,EAEGiB,OAFH,CAEWC,sBAASE,GAFpB;AAIA,WAAO,0BAAYtB,UAAZ,EACJuB,QADI,CACK,6BADL,EACoC;AAAEC,MAAAA,MAAM,EAAE;AAAV,KADpC,CAAP;AAED;;AACD,SAAOvB,IAAI,EAAX;AACD","sourcesContent":["import { CangjieInputEvent, Controller, Commands } from '@ali/4ever-cangjie';\nimport toggleQuote from '../commands/toggleQuote';\nimport isBlockquoteDisabled from '../utils/isBlockquoteDisabled';\n\nconst validDelimiters = ['>', 'ã€‹'];\n\nexport default function onCangjieInput(\n  event: CangjieInputEvent,\n  controller: Controller,\n  next: () => void,\n) {\n  const { startBlock, selection, document } = controller.value;\n  if (event.detail.data !== ' ' || !startBlock) return next();\n\n  const char = startBlock.text.slice(\n    0,\n    selection.convertToTextPoints(document).start.offset,\n  );\n  if (\n    validDelimiters.includes(char) &&\n    startBlock.type === 'paragraph' &&\n    !startBlock.data.list &&\n    !startBlock.data.blockquote &&\n    !isBlockquoteDisabled(controller)\n  ) {\n    event.preventDefault();\n    controller\n      .command(Commands.moveFocusToStartOfNode, startBlock)\n      .command(Commands.del);\n\n    return toggleQuote(controller)\n      .dispatch('createTriggerMarkdownAction', { mdType: 'blockquote' });\n  }\n  return next();\n}\n"],"file":"onCangjieInput.js"}