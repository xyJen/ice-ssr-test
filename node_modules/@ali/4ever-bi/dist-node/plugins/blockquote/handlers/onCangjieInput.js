"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = onCangjieInput;

var _everCangjie = require("@ali/4ever-cangjie");

var _toggleQuote = _interopRequireDefault(require("../commands/toggleQuote"));

var _isBlockquoteDisabled = _interopRequireDefault(require("../utils/isBlockquoteDisabled"));

const validDelimiters = ['>', 'ã€‹'];

function onCangjieInput(event, controller, next) {
  const {
    startBlock,
    selection,
    document
  } = controller.value;
  if (event.detail.data !== ' ' || !startBlock) return next();
  const char = startBlock.text.slice(0, selection.convertToTextPoints(document).start.offset);

  if (validDelimiters.includes(char) && startBlock.type === 'paragraph' && !startBlock.data.list && !startBlock.data.blockquote && !(0, _isBlockquoteDisabled.default)(controller)) {
    event.preventDefault();
    controller.command(_everCangjie.Commands.moveFocusToStartOfNode, startBlock).command(_everCangjie.Commands.del);
    return (0, _toggleQuote.default)(controller).dispatch('createTriggerMarkdownAction', {
      mdType: 'blockquote'
    });
  }

  return next();
}
//# sourceMappingURL=onCangjieInput.js.map