{"version":3,"sources":["../../../../../src/plugins/link/mobile/index.ts"],"names":["commands","insertLink","createLinkPlugin","config","linkConfig","protocolAllowList","locale","link","serializer","clipboard","plugin","copyLink","openLink","renderNode","contextMenu","actions","onAction","onCangjiePaste","queries","models","klass","type","disableTextRecognize","decorateNode","LinkPlugin","createDecorateNode","renderMark"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AAEA;;AACA;;AACA;;AAEA,MAAMA,QAAQ,GAAG;AACfC,EAAAA,UAAU,EAAVA;AADe,CAAjB;;AAIA,SAASC,gBAAT,CAA0BC,MAA1B,EAAkD;AAChD,QAAMC,UAA4B,GAAG;AACnCC,IAAAA,iBAAiB,EAAE,CAAC,OAAD,EAAU,QAAV,EAAoB,WAApB,EAAiC,SAAjC,CADgB;AAEnCC,IAAAA,MAAM,EAAEA,eAAOC,IAAP,CAAYD,MAFe;AAGnC,QAAIH,MAAM,CAACI,IAAP,IAAe,EAAnB;AAHmC,GAArC;AAMA,QAAMC,UAAU,GAAGL,MAAM,CAACM,SAAP,EAAkBD,UAArC;AAEA,QAAME,MAAgB,GAAG,EACvB,GAAG,+BAAU,EAAV,CADoB;AAEvBV,IAAAA,QAAQ,EAAE,EACR,GAAGA,QADK;AAERW,MAAAA,QAAQ,EAAE,6BAAeH,UAAf,CAFF;AAGRI,MAAAA,QAAQ,EAAE,6BAAeR,UAAU,CAACC,iBAA1B,EAA8CD,UAAU,CAACQ,QAAzD;AAHF,KAFa;AAOvBC,IAAAA,UAAU,EAAE,+BAAiBT,UAAjB,CAPW;AAQvBU,IAAAA,WAAW,EAAE,0BAAkBV,UAAlB,CARU;AASvBW,IAAAA,OATuB;AAUvB;AACAC,IAAAA,QAAQ,EAARA,iBAXuB;AAYvBC,IAAAA,cAAc,EAAE,mCAAqBd,MAArB,EAA6BC,UAA7B,CAZO;AAavBc,IAAAA,OAAO,EAAPA,gBAbuB;AAcvBC,IAAAA,MAAM,EAAE;AACNC,MAAAA,KAAK,EAAE,QADD;AAENC,MAAAA,IAAI,EAAE;AAFA;AAde,GAAzB,CATgD,CA6BhD;;AACA,MAAI,CAACjB,UAAU,CAACkB,oBAAhB,EAAsC;AACpC;AACAZ,IAAAA,MAAM,CAACa,YAAP,GAAsBC,uBAAWC,kBAAX,CAA8BrB,UAAU,CAACC,iBAAX,IAAgC,EAA9D,CAAtB;AACAK,IAAAA,MAAM,CAACgB,UAAP,GAAoB,+BAAiBtB,UAAjB,CAApB;AACD;;AAED,SAAOM,MAAP;AACD;;AAEDR,gBAAgB,CAACa,OAAjB,GAA2BA,OAA3B;AACAb,gBAAgB,CAACF,QAAjB,GAA4BA,QAA5B;AACAE,gBAAgB,CAACgB,OAAjB,GAA2BA,gBAA3B;eAEehB,gB","sourcesContent":["import { LinkPlugin } from '@ali/4ever-bamboo';\nimport createRenderNode from './createRenderNode';\nimport createRenderMark from './createRenderMark';\nimport createContextMenu from './contextMenu';\nimport createCopyLink from '../commands/createCopyLink';\nimport createOpenLink from '../commands/createOpenLink';\nimport * as actions from '../actions';\nimport createOnCangjiePaste from '../handlers/createOnCangjiePaste';\nimport insertLink from './insertLink';\nimport { LinkPluginConfig } from '../types';\nimport locale from '../../../locales/zh_CN';\nimport { BiPluginConfig, BiPlugin } from '../../../types';\nimport onAction from '../handlers/onAction';\nimport { queries } from './queries';\nimport { moFactory } from '@ali/4ever-plugin-link';\n\nconst commands = {\n  insertLink,\n};\n\nfunction createLinkPlugin(config: BiPluginConfig) {\n  const linkConfig: LinkPluginConfig = {\n    protocolAllowList: ['http:', 'https:', 'dingtalk:', 'taobao:'],\n    locale: locale.link.locale,\n    ...(config.link || {}),\n  };\n\n  const serializer = config.clipboard?.serializer;\n\n  const plugin: BiPlugin = {\n    ...moFactory({}),\n    commands: {\n      ...commands,\n      copyLink: createCopyLink(serializer),\n      openLink: createOpenLink(linkConfig.protocolAllowList!, linkConfig.openLink),\n    },\n    renderNode: createRenderNode(linkConfig),\n    contextMenu: createContextMenu(linkConfig),\n    actions,\n    // @ts-ignore\n    onAction,\n    onCangjiePaste: createOnCangjiePaste(config, linkConfig),\n    queries,\n    models: {\n      klass: 'inline',\n      type: 'link',\n    },\n  };\n\n  // 支持 purelink 识别的情况下，添加 decorateNode 和 renderMark\n  if (!linkConfig.disableTextRecognize) {\n    // @ts-ignore\n    plugin.decorateNode = LinkPlugin.createDecorateNode(linkConfig.protocolAllowList || []);\n    plugin.renderMark = createRenderMark(linkConfig);\n  }\n\n  return plugin;\n}\n\ncreateLinkPlugin.actions = actions;\ncreateLinkPlugin.commands = commands;\ncreateLinkPlugin.queries = queries;\n\nexport default createLinkPlugin;\n"],"file":"index.js"}