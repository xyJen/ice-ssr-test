"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = deleteExtraBlankLine;

var _everCangjie = require("@ali/4ever-cangjie");

function isEmptyNode(node) {
  return node.nodes.length === 0 || node.nodes.length === 1 && _everCangjie.Text.isEmptyText(node.nodes[0]);
}

function deleteExtraBlankLine(controller, currentKey) {
  const {
    document
  } = controller.value;
  const nextBlock = document.getNextBlock(currentKey); // 当前节点的下一个 block 是文档最后一个 block，或者 下一个 block 有内容。不处理

  if (!nextBlock || !isEmptyNode(nextBlock)) {
    return controller;
  }

  const nextNextBlock = document.getNextBlock(currentKey);

  if (!nextNextBlock) {
    // 说明 nextBlock 是文档最后一个 block，不应该删除
    return controller;
  }

  return controller.command(_everCangjie.Commands.removeNodeByKey, nextBlock.key);
}
//# sourceMappingURL=deleteExtraBlankLine.js.map