{"version":3,"sources":["../../../../../../src/plugins/link/linkCard/commands/updateLinkCard.ts"],"names":["updateLinkCard","controller","node","data","text","href","cardInfo","getLinkInfo","nodeText","length","needFetchLinkInfo","Boolean"],"mappings":";;;;;;;AAEA;;AAGe,SAASA,cAAT,CACbC,UADa,EAEbC,IAFa,EAGbC,IAHa,EASb;AAEA,QAAM;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,IAAR;AAAcC,IAAAA,QAAd;AAAwBC,IAAAA;AAAxB,MAAwCJ,IAA9C,CAFA,CAIA;;AACA,QAAMK,QAAQ,GAAGJ,IAAI,CAACK,MAAL,GAAcL,IAAd,GAAqBC,IAAtC,CALA,CAOA;;AACA,QAAMK,iBAAiB,GAAG,CAACC,OAAO,CAACL,QAAD,CAAlC,CARA,CAUA;;AACA,MAAII,iBAAJ,EAAuB;AACrB,sCAAcR,IAAd,EAAoBD,UAApB,EAAgCI,IAAhC,EAAsCG,QAAtC,EAAgDD,WAAhD;AACD;;AACD,SAAON,UAAP;AACD;;AAAA","sourcesContent":["import { Controller } from '@ali/4ever-cangjie';\nimport { BlockLinkCard, ILinkCardInfo, LinkPluginConfig } from '../../types';\nimport { fetchLinkData } from '../utils/fetchLinkData';\n\n\nexport default function updateLinkCard(\n  controller: Controller,\n  node: BlockLinkCard,\n  data: {\n    text: string,\n    href: string,\n    cardInfo?: ILinkCardInfo,\n    getLinkInfo?: LinkPluginConfig['getLinkInfo']\n  }\n) {\n\n  const { text, href, cardInfo, getLinkInfo } = data;\n\n  // 将 text link 转换为 block link card\n  const nodeText = text.length ? text : href;\n\n  // 如果已经有 cardInfo，则不需要拉取链接信息\n  const needFetchLinkInfo = !Boolean(cardInfo);\n\n  // 如果更新了卡片信息\n  if (needFetchLinkInfo) {\n    fetchLinkData(node, controller, href, nodeText, getLinkInfo);\n  }\n  return controller;\n};\n\n"],"file":"updateLinkCard.js"}