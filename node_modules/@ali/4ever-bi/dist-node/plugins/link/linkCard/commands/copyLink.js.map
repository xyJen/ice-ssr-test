{"version":3,"sources":["../../../../../../src/plugins/link/linkCard/commands/copyLink.ts"],"names":["MIME_TYPES","constants","copyLink","controller","node","serializer","href","data","metadata","fragment","Document","create","nodes","value","Value","document","clip","write","FRAGMENT","transferUtils","encodeFragment","HTML","TEXT","valueToText"],"mappings":";;;;;;;AAAA;;AACA;;AAGA,MAAM;AAAEA,EAAAA;AAAF,IAAiBC,sBAAvB;;AAEe,SAASC,QAAT,CACbC,UADa,EAEbC,IAFa,EAGbC,UAHa,EAIb;AACA,QAAM;AAAEC,IAAAA;AAAF,MAAWF,IAAI,CAACG,IAAL,CAAUC,QAA3B;;AAEA,QAAMC,QAAQ,GAAGC,sBAASC,MAAT,CAAgB;AAAEC,IAAAA,KAAK,EAAE,CAACR,IAAD;AAAT,GAAhB,CAAjB;;AACA,QAAMS,KAAK,GAAGC,mBAAMH,MAAN,CAAa;AAAEI,IAAAA,QAAQ,EAAEN;AAAZ,GAAb,CAAd;;AACA,QAAMO,IAAI,GAAG,kDAAb;AACAA,EAAAA,IAAI,CAACC,KAAL,CAAW;AACT,KAACjB,UAAU,CAACkB,QAAZ,GAAuBC,2BAAcC,cAAd,CAA6BX,QAA7B,CADd;AAET,KAACT,UAAU,CAACqB,IAAZ,GAAmB,2CAAiBhB,UAAjB,EAA6BQ,KAA7B,CAFV;AAGT,KAACb,UAAU,CAACsB,IAAZ,GAAmBhB,IAAI,IAAID,UAAU,CAACkB,WAAX,CAAuBV,KAAvB;AAHlB,GAAX;AAMA,SAAOV,UAAP;AACD","sourcesContent":["import { Controller, transferUtils, Value, constants, Commands, Document, Mo as Serializer } from '@ali/4ever-cangjie';\nimport { getHtmlFromValue, createClipboardManager } from '@ali/4ever-plugin-clipboard';\nimport { BlockLinkCard } from '../../types';\n\nconst { MIME_TYPES } = constants;\n\nexport default function copyLink(\n  controller: Controller,\n  node: BlockLinkCard,\n  serializer: Serializer,\n) {\n  const { href } = node.data.metadata!;\n\n  const fragment = Document.create({ nodes: [node] });\n  const value = Value.create({ document: fragment });\n  const clip = createClipboardManager();\n  clip.write({\n    [MIME_TYPES.FRAGMENT]: transferUtils.encodeFragment(fragment),\n    [MIME_TYPES.HTML]: getHtmlFromValue(serializer, value),\n    [MIME_TYPES.TEXT]: href || serializer.valueToText(value),\n  });\n\n  return controller;\n}\n"],"file":"copyLink.js"}