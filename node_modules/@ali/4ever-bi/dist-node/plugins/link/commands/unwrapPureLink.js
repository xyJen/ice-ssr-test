"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = unwrapPureLink;

var _everCangjie = require("@ali/4ever-cangjie");

function unwrapPureLink(controller, node, offset, href) {
  const {
    selection
  } = controller.value;
  const range = selection.moveToStartOfNode(node, controller).moveForward(offset).moveFocusForward(href.length);
  const moveTo = range.moveToFocus();
  controller.command(_everCangjie.Commands.addMarkAtRange, range, _everCangjie.Mark.create({
    type: 'unlink'
  })).command(_everCangjie.Commands.select, moveTo); // 如果 pure link 后面没有内容，为了避免输入新的 pure link 无法被高亮
  // 需要手动插入一个空白符

  if (range.focus.isAtEndOfNode(node)) {
    controller.command(_everCangjie.Commands.insertText, ' ', []);
  } else {
    controller.command(_everCangjie.Commands.moveForward);
  }

  return controller;
}
//# sourceMappingURL=unwrapPureLink.js.map