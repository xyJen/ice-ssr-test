{"version":3,"sources":["../../../../../src/plugins/link/commands/createCopyLink.ts"],"names":["MIME_TYPES","constants","createCopyLink","serializer","copyLink","controller","node","href","data","fragment","value","Value","create","document","clip","write","FRAGMENT","transferUtils","encodeFragment","HTML","TEXT","valueToText"],"mappings":";;;;;;;AAAA;;AACA;;AAEA;;AAEA,MAAM;AAAEA,EAAAA;AAAF,IAAiBC,sBAAvB;;AAEe,SAASC,cAAT,CACbC,UADa,EAEb;AACA,SAAO,SAASC,QAAT,CACLC,UADK,EAELC,IAFK,EAGL;AACA,UAAM;AAAEC,MAAAA;AAAF,QAAWD,IAAI,CAACE,IAAtB;AACAL,IAAAA,UAAU,GAAGA,UAAU,IAAIE,UAAU,CAACF,UAAtC;AAEA,UAAMM,QAAQ,GAAG,iDAAsB,CAACH,IAAD,CAAtB,CAAjB;;AAEA,UAAMI,KAAK,GAAGC,mBAAMC,MAAN,CAAa;AAAEC,MAAAA,QAAQ,EAAEJ;AAAZ,KAAb,CAAd;;AACA,UAAMK,IAAI,GAAG,kDAAb;AACAA,IAAAA,IAAI,CAACC,KAAL,CAAW;AACT,OAACf,UAAU,CAACgB,QAAZ,GAAuBC,2BAAcC,cAAd,CAA6BT,QAA7B,CADd;AAET,OAACT,UAAU,CAACmB,IAAZ,GAAmB,2CAAiBhB,UAAjB,EAA6BO,KAA7B,CAFV;AAGT,OAACV,UAAU,CAACoB,IAAZ,GAAmBb,IAAI,IAAIJ,UAAU,CAACkB,WAAX,CAAuBX,KAAvB;AAHlB,KAAX;AAMA,WAAOL,UAAP;AACD,GAlBD;AAmBD","sourcesContent":["import { Controller, transferUtils, Value, constants, Mo as Serializer } from '@ali/4ever-cangjie';\nimport { getHtmlFromValue, createClipboardManager } from '@ali/4ever-plugin-clipboard';\nimport { LinkNode } from '../types';\nimport { createFragmentbyNodes }  from '../utils/createFragmentbyNode';\n\nconst { MIME_TYPES } = constants;\n\nexport default function createCopyLink(\n  serializer?: Serializer,\n) {\n  return function copyLink(\n    controller: Controller,\n    node: LinkNode,\n  ) {\n    const { href } = node.data;\n    serializer = serializer || controller.serializer;\n\n    const fragment = createFragmentbyNodes([node]);\n\n    const value = Value.create({ document: fragment });\n    const clip = createClipboardManager();\n    clip.write({\n      [MIME_TYPES.FRAGMENT]: transferUtils.encodeFragment(fragment),\n      [MIME_TYPES.HTML]: getHtmlFromValue(serializer, value),\n      [MIME_TYPES.TEXT]: href || serializer.valueToText(value),\n    });\n\n    return controller;\n  }\n}\n"],"file":"createCopyLink.js"}