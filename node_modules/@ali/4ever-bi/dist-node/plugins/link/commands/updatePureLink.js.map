{"version":3,"sources":["../../../../../src/plugins/link/commands/updatePureLink.ts"],"names":["updatePureLink","controller","node","offset","text","href","srcHref","nodeText","length","point","TextPoint","create","key","selection","Selection","anchor","focus","command","Commands","select","insertInline","type","data","nodes","Text"],"mappings":";;;;;;;;;AAAA;;AACA;;AAEe,SAASA,cAAT,CACbC,UADa,EAEbC,IAFa,EAGbC,MAHa,EAIbC,IAJa,EAKbC,IALa,EAMbC,OANa,EAOb;AACA;AACA,MAAIA,OAAO,KAAKD,IAAZ,IAAoBD,IAAxB,EAA8B;AAC5B,UAAMG,QAAQ,GAAGH,IAAI,CAACI,MAAL,GAAcJ,IAAd,GAAqBC,IAAtC;;AACA,UAAMI,KAAK,GAAGC,uBAAUC,MAAV,CAAiB;AAC7BC,MAAAA,GAAG,EAAEV,IAAI,CAACU,GADmB;AAE7BT,MAAAA,MAAM,EAAEA;AAFqB,KAAjB,CAAd;;AAIA,UAAMU,SAAS,GAAGC,uBAAUH,MAAV,CAAiB;AACjCI,MAAAA,MAAM,EAAEN,KADyB;AAEjCO,MAAAA,KAAK,EAAEP;AAF0B,KAAjB,CAAlB;;AAKA,WAAO,6BAAeR,UAAf,EAA2BC,IAA3B,EAAiCC,MAAjC,EAAyCG,OAAzC,EACJW,OADI,CACIC,sBAASC,MADb,EACqBN,SADrB,EAEJI,OAFI,CAEIC,sBAASE,YAFb,EAE2B;AAC9BC,MAAAA,IAAI,EAAE,MADwB;AAE9BC,MAAAA,IAAI,EAAE;AAAEjB,QAAAA;AAAF,OAFwB;AAG9BkB,MAAAA,KAAK,EAAE,CAACC,kBAAKb,MAAL,CAAYJ,QAAZ,CAAD;AAHuB,KAF3B,CAAP;AAOD;;AACD,SAAON,UAAP;AACD","sourcesContent":["import { Controller, Node, Commands, Text, Selection, TextPoint } from '@ali/4ever-cangjie';\nimport removePureLink from './removePureLink';\n\nexport default function updatePureLink(\n  controller: Controller,\n  node: Node,\n  offset: number,\n  text: string,\n  href: string,\n  srcHref: string,\n) {\n  // 存在文本或者链接变化时，将 pure link 转换为 text link\n  if (srcHref !== href || text) {\n    const nodeText = text.length ? text : href;\n    const point = TextPoint.create({\n      key: node.key,\n      offset: offset,\n    });\n    const selection = Selection.create({\n      anchor: point,\n      focus: point,\n    })\n\n    return removePureLink(controller, node, offset, srcHref)\n      .command(Commands.select, selection)\n      .command(Commands.insertInline, {\n        type: 'link',\n        data: { href },\n        nodes: [Text.create(nodeText)],\n      });\n  }\n  return controller;\n}\n"],"file":"updatePureLink.js"}