"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = createCopyLink;

var _everCangjie = require("@ali/4ever-cangjie");

var _everPluginClipboard = require("@ali/4ever-plugin-clipboard");

var _createFragmentbyNode = require("../utils/createFragmentbyNode");

const {
  MIME_TYPES
} = _everCangjie.constants;

function createCopyLink(serializer) {
  return function copyLink(controller, node) {
    const {
      href
    } = node.data;
    serializer = serializer || controller.serializer;
    const fragment = (0, _createFragmentbyNode.createFragmentbyNodes)([node]);

    const value = _everCangjie.Value.create({
      document: fragment
    });

    const clip = (0, _everPluginClipboard.createClipboardManager)();
    clip.write({
      [MIME_TYPES.FRAGMENT]: _everCangjie.transferUtils.encodeFragment(fragment),
      [MIME_TYPES.HTML]: (0, _everPluginClipboard.getHtmlFromValue)(serializer, value),
      [MIME_TYPES.TEXT]: href || serializer.valueToText(value)
    });
    return controller;
  };
}
//# sourceMappingURL=createCopyLink.js.map