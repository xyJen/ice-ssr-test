"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getLinkCardState = void 0;

var _getCardInfo = _interopRequireDefault(require("./getCardInfo"));

/**
 * 在编辑形态下，如果 title、desc、imgURL 都为 undefined，则说明请求失败，需要显示 error
 * 如果存在 injection 数据，说明是 loading 状态
 * @param readonly
 * @param title
 * @param desc
 * @param imgURL
 */
const getLinkCardState = (readonly, node, injections) => {
  // 只读情况下只返回 normal
  if (readonly) {
    return 'normal';
  } // injection 有状态，返回 loading


  if (injections && injections.length > 0) {
    const injection = injections.find(i => i.key === node.key);

    if (injection) {
      if (injection.data.cardInfo) {
        return 'loading';
      }
    }
  }

  const cardInfo = (0, _getCardInfo.default)(node);
  const {
    title,
    desc,
    imgURL
  } = cardInfo || {}; // 数据都为 undefined 返回 error

  if (title === undefined && desc === undefined && imgURL === undefined) {
    return 'error';
  }

  return 'normal';
};

exports.getLinkCardState = getLinkCardState;
//# sourceMappingURL=getLinkCardState.js.map