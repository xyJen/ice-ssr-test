"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = isSelectionInLinkCard;

var _isLinkCard = require("./isLinkCard");

function isSelectionInLinkCard(value) {
  if (!value) {
    return false;
  }

  const {
    document,
    selection,
    injections
  } = value;

  if (!selection) {
    return false;
  }

  const start = selection.getStart(document);
  const startKey = start.key;

  if (!startKey) {
    return false;
  }

  const linkNode = document.getClosest(startKey, node => (0, _isLinkCard.isLinkCardNode)(node, injections));

  if (linkNode) {
    return true;
  } // 对于 purelink 展示位 loading 卡片的瞬时状态，判断 start 的 offset 是否在范围内


  if (start.isTextPoint()) {
    const textNode = document.getNode(startKey);

    if (textNode && textNode.isText() && (0, _isLinkCard.isLinkCardNode)(textNode, injections)) {
      const injection = injections.find(i => i.key === textNode.key);
      const range = injection?.data?.range;

      if (range) {
        const {
          startOffset,
          endOffset
        } = range;
        return start.offset > startOffset && start.offset < endOffset;
      }
    }
  }

  return false;
}
//# sourceMappingURL=isSelectionInLinkCard.js.map