{"version":3,"sources":["../../../../../src/plugins/link/utils/getPosition.tsx"],"names":["CARD_OFFSETY","offsetY","theme","link","height","getPositionTopRight","containerRect","triggerRect","portalRect","width","baseTop","bottom","top","baseRight","right","left","bottomSpace","leftSpace","triggerTop","getPositionTopLeft","baseLeft","rightSpace","triggerRight"],"mappings":";;;;;;;;;AAAA;;AACA;AACA,MAAMA,YAAY,GAAG,EAArB;AACO,MAAMC,OAAO,GAAG,EAAEC,kBAAMC,IAAN,CAAWC,MAAX,GAAoBJ,YAAtB,CAAhB;;;AAEA,SAASK,mBAAT,CAA6BC,aAA7B,EAAqDC,WAArD,EAA2EC,UAA3E,EAAgG;AACrG,QAAM;AAAEJ,IAAAA,MAAF;AAAUK,IAAAA;AAAV,MAAoBD,UAA1B;AAEA,QAAME,OAAO,GAAGH,WAAW,CAACI,MAAZ,GAAqBL,aAAa,CAACM,GAAnD;AACA,QAAMC,SAAS,GAAGN,WAAW,CAACO,KAAZ,GAAoBR,aAAa,CAACS,IAApD,CAJqG,CAKrG;AACA;AACA;AACA;;AACA,QAAMC,WAAW,GAAGV,aAAa,CAACF,MAAd,GAAuBM,OAA3C;AACA,QAAMO,SAAS,GAAGV,WAAW,CAACO,KAAZ,GAAoBR,aAAa,CAACS,IAApD;AAEA,QAAMG,UAAU,GAAGX,WAAW,CAACK,GAAZ,GAAkBN,aAAa,CAACM,GAAnD;AAEA,QAAMA,GAAG,GAAGI,WAAW,GAAGZ,MAAd,IAAwBc,UAAU,GAAGd,MAArC,GACRc,UAAU,GAAGd,MAAb,GAAsB,CADd,CACgB;AADhB,IAERM,OAAO,GAAGT,OAFd;AAGA,QAAMc,IAAI,GAAGR,WAAW,CAACO,KAAZ,GAAoBL,KAApB,GACTI,SAAS,GAAGI,SAAZ,GAAwB,CADf,GAETJ,SAAS,GAAGJ,KAFhB;AAIA,SAAO;AAAEM,IAAAA,IAAF;AAAQH,IAAAA;AAAR,GAAP;AACD;;AAEM,SAASO,kBAAT,CAA4Bb,aAA5B,EAAoDC,WAApD,EAA0EC,UAA1E,EAA+F;AACpG,QAAM;AAAEJ,IAAAA,MAAF;AAAUK,IAAAA;AAAV,MAAoBD,UAA1B;AAEA,QAAME,OAAO,GAAGH,WAAW,CAACI,MAAZ,GAAqBL,aAAa,CAACM,GAAnD;AACA,QAAMQ,QAAQ,GAAGb,WAAW,CAACQ,IAAZ,GAAmBT,aAAa,CAACS,IAAlD,CAJoG,CAKpG;AACA;AACA;AACA;;AACA,QAAMC,WAAW,GAAGV,aAAa,CAACF,MAAd,GAAuBM,OAA3C;AACA,QAAMW,UAAU,GAAGf,aAAa,CAACG,KAAd,GAAsBW,QAAzC;AAEA,QAAMF,UAAU,GAAGX,WAAW,CAACK,GAAZ,GAAkBN,aAAa,CAACM,GAAnD;AACA,QAAMU,YAAY,GAAGf,WAAW,CAACO,KAAZ,GAAoBR,aAAa,CAACS,IAAvD;AACA,QAAMH,GAAG,GAAGI,WAAW,GAAGZ,MAAd,IAAwBc,UAAU,GAAGd,MAArC,GACRc,UAAU,GAAGd,MAAb,GAAsB,CADd,CACgB;AADhB,IAERM,OAAO,GAAGT,OAFd;AAGA,QAAMc,IAAI,GAAGM,UAAU,GAAGZ,KAAb,IAAsBa,YAAY,GAAGb,KAArC,GACTW,QAAQ,GAAGX,KAAX,GAAmBY,UAAnB,GAAgC,CADvB,GAETD,QAFJ;AAIA,SAAO;AAAEL,IAAAA,IAAF;AAAQH,IAAAA;AAAR,GAAP;AACD","sourcesContent":["import { theme } from '@ali/4ever-bamboo';\n// 这里的魔数是卡片状态下呼出编辑框的 ui 高度设置: 距离工具栏浮层高度为 4px\nconst CARD_OFFSETY = 34;\nexport const offsetY = -(theme.link.height - CARD_OFFSETY);\n\nexport function getPositionTopRight(containerRect: DOMRect, triggerRect: DOMRect, portalRect: DOMRect) {\n  const { height, width } = portalRect;\n\n  const baseTop = triggerRect.bottom - containerRect.top;\n  const baseRight = triggerRect.right - containerRect.left;\n  // 计算底部剩余空间，若剩余空间能够容纳 portal，则向下展示 portal\n  // 如果下方剩余空间无法容纳 portal，还需要判断上方空间能否容纳\n  // 若上方也无法容纳(triggerTop < height)，则仍然放到下方\n  // 左右则优先放右对齐，不够之后向右偏移\n  const bottomSpace = containerRect.height - baseTop;\n  const leftSpace = triggerRect.right - containerRect.left;\n\n  const triggerTop = triggerRect.top - containerRect.top;\n\n  const top = bottomSpace < height && triggerTop > height\n    ? triggerTop - height - 4 // 放到上方\n    : baseTop + offsetY;\n  const left = triggerRect.right < width\n    ? baseRight - leftSpace + 4\n    : baseRight - width;\n\n  return { left, top };\n}\n\nexport function getPositionTopLeft(containerRect: DOMRect, triggerRect: DOMRect, portalRect: DOMRect) {\n  const { height, width } = portalRect;\n\n  const baseTop = triggerRect.bottom - containerRect.top;\n  const baseLeft = triggerRect.left - containerRect.left;\n  // 计算底部剩余空间，若剩余空间能够容纳 portal，则向下展示 portal\n  // 如果下方剩余空间无法容纳 portal，还需要判断上方空间能否容纳\n  // 若上方也无法容纳(triggerRect.top < height)，则仍然放到下方\n  // 左右则优先做对齐，不够之后向左偏移\n  const bottomSpace = containerRect.height - baseTop;\n  const rightSpace = containerRect.width - baseLeft;\n\n  const triggerTop = triggerRect.top - containerRect.top;\n  const triggerRight = triggerRect.right - containerRect.left;\n  const top = bottomSpace < height && triggerTop > height\n    ? triggerTop - height - 4 // 放到上方\n    : baseTop + offsetY;\n  const left = rightSpace < width && triggerRight > width\n    ? baseLeft - width + rightSpace - 4\n    : baseLeft;\n\n  return { left, top };\n}\n"],"file":"getPosition.js"}