{"version":3,"sources":["../../../../../src/plugins/sticker/commands/insertSticker.ts"],"names":["insertSticker","controller","payload","marks","code","node","command","Commands","insertInline","Inline","create","type","STICKER_NODE_TYPE","data","nodes","Text","addMarks","moveToStartOfNextText","focus"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAGe,SAASA,aAAT,CACbC,UADa,EAEbC,OAFa,EAGb;AACA,QAAMC,KAAK,GAAG,6BAAiBF,UAAjB,CAAd;AACA,QAAM;AAAEG,IAAAA,IAAF;AAAQC,IAAAA;AAAR,MAAiBH,OAAvB;AACAD,EAAAA,UAAU,CAACK,OAAX,CACEC,sBAASC,YADX,EAEEC,oBAAOC,MAAP,CAAc;AACZC,IAAAA,IAAI,EAAEC,4BADM;AAEZC,IAAAA,IAAI,EAAE;AAAET,MAAAA;AAAF,KAFM;AAGZU,IAAAA,KAAK,EAAE,CAACC,kBAAKL,MAAL,CAAY,EAAZ,EAAgBM,QAAhB,CAAyB,CAAzB,EAA4B,CAA5B,EAA+Bb,KAA/B,CAAD;AAHK,GAAd,CAFF;AAQA,MAAI,CAACE,IAAL,EAAW,OAAOJ,UAAP,CAXX,CAYA;;AACA,SAAOA,UAAU,CACdK,OADI,CACIC,sBAASU,qBADb,EAEJX,OAFI,CAEIC,sBAASW,KAFb,CAAP;AAGD","sourcesContent":["import { Controller, Commands, Inline, Text } from '@ali/4ever-cangjie';\nimport { STICKER_NODE_TYPE } from '../constants';\nimport { getMarksAtAnchor } from '../utils';\nimport { InsertStickerProps } from '../types';\n\nexport default function insertSticker(\n  controller: Controller,\n  payload: InsertStickerProps,\n) {\n  const marks = getMarksAtAnchor(controller);\n  const { code, node } = payload;\n  controller.command(\n    Commands.insertInline,\n    Inline.create({\n      type: STICKER_NODE_TYPE,\n      data: { code },\n      nodes: [Text.create('').addMarks(0, 0, marks)],\n    }),\n  );\n  if (!node) return controller;\n  // 通过面板连续添加表情，需要移除表情的选中状态\n  return controller\n    .command(Commands.moveToStartOfNextText)\n    .command(Commands.focus);\n}\n"],"file":"insertSticker.js"}