{"version":3,"sources":["../../../../../src/plugins/sticker/utils/getMatchedEmojiQuery.ts"],"names":["getMatchedEmojiQuery","text","shouldTrailDelimiter","pattern","matchArray","match","RegExp","matchStr","endWithColon","endsWith","queryStartPosition","length","queryEndPosition","query","slice","offsetWithDelimiter","start","end"],"mappings":";;;;;;;AAIe,SAASA,oBAAT,CACbC,IADa,EAEbC,oBAFa,EAGK;AAClB,MAAI,CAACD,IAAL,EAAW,OAAO,IAAP,CADO,CAElB;AACA;;AACA,QAAME,OAAO,GAAGD,oBAAoB,GAC/B,mBAD+B,GAE/B,oBAFL;AAGA,QAAME,UAAU,GAAGH,IAAI,CAACI,KAAL,CAAWC,MAAM,CAACH,OAAD,CAAjB,CAAnB;;AACA,MAAIC,UAAJ,EAAgB;AACd,UAAMG,QAAQ,GAAGH,UAAU,CAAC,CAAD,CAA3B;AACA,UAAMI,YAAY,GAAGD,QAAQ,CAACE,QAAT,CAAkB,GAAlB,CAArB;AACA,UAAMC,kBAAkB,GAAGT,IAAI,CAACU,MAAL,GAAcJ,QAAQ,CAACI,MAAvB,GAAgC,CAA3D;AACA,UAAMC,gBAAgB,GAAGJ,YAAY,GAAGP,IAAI,CAACU,MAAL,GAAc,CAAjB,GAAqBV,IAAI,CAACU,MAA/D;AACA,WAAO;AACLE,MAAAA,KAAK,EAAEZ,IAAI,CAACa,KAAL,CAAWJ,kBAAX,EAA+BE,gBAA/B,CADF;AAELG,MAAAA,mBAAmB,EAAE;AACnBC,QAAAA,KAAK,EAAEf,IAAI,CAACU,MAAL,GAAcJ,QAAQ,CAACI,MADX;AAEnBM,QAAAA,GAAG,EAAEhB,IAAI,CAACU;AAFS;AAFhB,KAAP;AAOD;;AACD,SAAO,IAAP;AACD","sourcesContent":["interface QueryInfo {\n  query: string;\n  offsetWithDelimiter: { start: number; end: number };\n}\nexport default function getMatchedEmojiQuery(\n  text: string,\n  shouldTrailDelimiter: boolean,\n): QueryInfo | null {\n  if (!text) return null;\n  // 仅允许小写字母a-z和下划线\n  // 必须以:开头,可能以:结尾\n  const pattern = shouldTrailDelimiter\n    ? `\\\\:[a-z0-9+-_]+:$`\n    : `\\\\:[a-z0-9+-_]+:?$`;\n  const matchArray = text.match(RegExp(pattern));\n  if (matchArray) {\n    const matchStr = matchArray[0];\n    const endWithColon = matchStr.endsWith(':');\n    const queryStartPosition = text.length - matchStr.length + 1;\n    const queryEndPosition = endWithColon ? text.length - 1 : text.length;\n    return {\n      query: text.slice(queryStartPosition, queryEndPosition),\n      offsetWithDelimiter: {\n        start: text.length - matchStr.length,\n        end: text.length,\n      },\n    };\n  }\n  return null;\n}\n"],"file":"getMatchedEmojiQuery.js"}