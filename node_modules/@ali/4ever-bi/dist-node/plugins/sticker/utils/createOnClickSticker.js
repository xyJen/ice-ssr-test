"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _everMo = require("@ali/4ever-mo");

var _actions = require("../actions");

/**
 * @description 创建插入表情函数
 * @param {controller}
 * @param {sticker}
 * */
function createOnClickSticker({
  controller,
  sticker
}) {
  return function ({
    event,
    code
  }) {
    event.preventDefault();
    event.stopPropagation();
    const {
      document,
      selection
    } = controller.value;
    const stickerInfo = sticker.getInfoByCode(code);
    if (!stickerInfo) return;
    const {
      width,
      height
    } = stickerInfo;
    const point = document.getNode(selection.anchor.key);
    const currentNode = point && document.getParent(point.key);
    const payload = {
      code,
      width,
      height,
      node: currentNode || {}
    };

    if (_everMo.Sticker.isSticker(currentNode)) {
      return controller.run('onAction', (0, _actions.setSticker)(payload));
    }

    return controller.run('onAction', (0, _actions.insertSticker)(payload));
  };
}

var _default = createOnClickSticker;
exports.default = _default;
//# sourceMappingURL=createOnClickSticker.js.map