{"version":3,"sources":["../../../../../src/plugins/sticker/utils/createOnClickSticker.ts"],"names":["createOnClickSticker","controller","sticker","event","code","preventDefault","stopPropagation","document","selection","value","stickerInfo","getInfoByCode","width","height","point","getNode","anchor","key","currentNode","getParent","payload","node","Sticker","isSticker","run"],"mappings":";;;;;;;AAEA;;AACA;;AAOA;AACA;AACA;AACA;AACA;AACA,SAASA,oBAAT,CAA8B;AAC5BC,EAAAA,UAD4B;AAE5BC,EAAAA;AAF4B,CAA9B,EAG+B;AAC7B,SAAO,UAAU;AAAEC,IAAAA,KAAF;AAASC,IAAAA;AAAT,GAAV,EAA2B;AAChCD,IAAAA,KAAK,CAACE,cAAN;AACAF,IAAAA,KAAK,CAACG,eAAN;AACA,UAAM;AAAEC,MAAAA,QAAF;AAAYC,MAAAA;AAAZ,QAA0BP,UAAU,CAACQ,KAA3C;AACA,UAAMC,WAAW,GAAGR,OAAO,CAACS,aAAR,CAAsBP,IAAtB,CAApB;AACA,QAAI,CAACM,WAAL,EAAkB;AAClB,UAAM;AAAEE,MAAAA,KAAF;AAASC,MAAAA;AAAT,QAAoBH,WAA1B;AACA,UAAMI,KAAK,GAAGP,QAAQ,CAACQ,OAAT,CAAiBP,SAAS,CAACQ,MAAV,CAAiBC,GAAlC,CAAd;AACA,UAAMC,WAAW,GAAGJ,KAAK,IAAIP,QAAQ,CAACY,SAAT,CAAmBL,KAAK,CAACG,GAAzB,CAA7B;AACA,UAAMG,OAAO,GAAG;AACdhB,MAAAA,IADc;AAEdQ,MAAAA,KAFc;AAGdC,MAAAA,MAHc;AAIdQ,MAAAA,IAAI,EAAGH,WAAW,IAAI;AAJR,KAAhB;;AAMA,QAAII,gBAAQC,SAAR,CAAkBL,WAAlB,CAAJ,EAAoC;AAClC,aAAOjB,UAAU,CAACuB,GAAX,CACL,UADK,EAEL,yBAAWJ,OAAX,CAFK,CAAP;AAID;;AACD,WAAOnB,UAAU,CAACuB,GAAX,CAAe,UAAf,EAA2B,4BAAcJ,OAAd,CAA3B,CAAP;AACD,GAtBD;AAuBD;;eAEcpB,oB","sourcesContent":["import { Controller } from '@ali/4ever-cangjie';\nimport { StickerPlugin } from '@ali/4ever-bamboo';\nimport { Sticker } from '@ali/4ever-mo';\nimport { insertSticker, setSticker } from '../actions';\n\ninterface ICreateOnClickStickerProps {\n  controller: Controller;\n  sticker: StickerPlugin.Sticker;\n}\n\n/**\n * @description 创建插入表情函数\n * @param {controller}\n * @param {sticker}\n * */\nfunction createOnClickSticker({\n  controller,\n  sticker,\n}: ICreateOnClickStickerProps) {\n  return function ({ event, code }) {\n    event.preventDefault();\n    event.stopPropagation();\n    const { document, selection } = controller.value;\n    const stickerInfo = sticker.getInfoByCode(code);\n    if (!stickerInfo) return;\n    const { width, height } = stickerInfo;\n    const point = document.getNode(selection.anchor.key);\n    const currentNode = point && document.getParent(point.key);\n    const payload = {\n      code,\n      width,\n      height,\n      node: (currentNode || {}) as Sticker,\n    };\n    if (Sticker.isSticker(currentNode)) {\n      return controller.run(\n        'onAction',\n        setSticker(payload),\n      );\n    }\n    return controller.run('onAction', insertSticker(payload));\n  };\n}\n\nexport default createOnClickSticker;\n"],"file":"createOnClickSticker.js"}