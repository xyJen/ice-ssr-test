"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = createOnCangjieCopy;

var _everCangjie = require("@ali/4ever-cangjie");

var _everLogger = _interopRequireDefault(require("@ali/4ever-logger"));

var _filterFragment = _interopRequireDefault(require("../util/filterFragment"));

const {
  MIME_TYPES
} = _everCangjie.constants;

function createOnCangjieCopy() {
  return function onCangjieCopyOrCut(event, _, next) {
    if (!event.clipboardData) {
      return next();
    }

    try {
      const encodedFragment = event.clipboardData.getData(MIME_TYPES.FRAGMENT);

      const fragment = _everCangjie.transferUtils.decodeFragment(encodedFragment);

      const newFragment = (0, _filterFragment.default)(fragment);
      event.clipboardData.setData(MIME_TYPES.FRAGMENT, _everCangjie.transferUtils.encodeFragment(newFragment));
    } catch (error) {
      _everLogger.default.error(error);
    }

    return next();
  };
}
//# sourceMappingURL=createOnCangjieCopy.js.map