{"version":3,"sources":["../../../../src/plugins/quickInsert/index.tsx"],"names":["createQuickInsertPlugin","configs","plugins","pluginConfig","triggers","groups","getLifeCycle","locale","biLocale","quickInsert","getItem","item","key","console","warn","renderIcon","renderPanel","onMenuClick","title","quickInsertTitle","props","disabled","stubFalse","map","group","items","filter","insertMap","reduce","forEach","onCangjieInput","onKeyDown","onSelect","onCommand","renderEditable","renderMark","onAction","queries","isSelectionInQuickInsert","getQuickInsertDecoration","getQuickInsertKeyword","getQuickInsertPanelPosition","commands","insertPlugin","models","klass","type","actions"],"mappings":"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","sourcesContent":["import { stubFalse } from 'lodash-es';\nimport biLocale from '../../locales/zh_CN';\nimport {\n  QuickInsertPluginConfig,\n  GroupItem,\n  InsertItem,\n  QuickInsertConfig,\n} from './types';\nimport * as actions from './actions';\nimport createRenderMark from './createRenderMark';\nimport createRenderEditable from './createRenderEditable';\nimport onKeyDown from './handlers/onKeyDown';\nimport onSelect from './handlers/onSelect';\nimport onCommand from './handlers/onCommand';\nimport onAction from './handlers/onAction';\nimport createOnCangjieInput from './handlers/createOnCangjieInput';\nimport isSelectionInQuickInsert from './queries/isSelectionInQuickInsert';\nimport getQuickInsertDecoration from './queries/getQuickInsertDecoration';\nimport getQuickInsertKeyword from './queries/getQuickInsertKeyword';\nimport getQuickInsertPanelPosition from './queries/getPanelPosition';\nimport insertPlugin from './commands/insert';\nimport { BiPluginConfig } from '../../types';\n\nfunction createQuickInsertPlugin(\n  configs: BiPluginConfig,\n  plugins: {\n    [key: string]: {\n      quickInsert?: QuickInsertConfig;\n    };\n  },\n) {\n  const pluginConfig: QuickInsertPluginConfig = {\n    triggers: {},\n    groups: [],\n    getLifeCycle: () => {},\n    locale: biLocale.quickInsert.locale,\n    ...configs.quickInsert,\n  };\n\n  function getItem(item: GroupItem): InsertItem | null {\n    const key = typeof item === 'string' ? item : item.key;\n    if (!configs[key] || !plugins[key] || !plugins[key].quickInsert) {\n      // eslint-disable-next-line no-console\n      console.warn(`can not find [${item}]'s \\`quickInsert\\` configuration`);\n      return null;\n    }\n    const { locale } = configs[key] || {};\n    const { quickInsert } = plugins[key];\n\n    const { renderIcon, renderPanel, onMenuClick } = quickInsert!;\n    return {\n      key,\n      title: locale.quickInsertTitle || key,\n      renderIcon,\n      renderPanel: (props) => renderPanel({ ...props, locale }),\n      onMenuClick,\n      disabled:\n        typeof item === 'string' ? stubFalse : item.disabled || stubFalse,\n    };\n  }\n\n  const groups = pluginConfig.groups.map((group) => ({\n    ...group,\n    items: (group.items || [])\n      .map(getItem)\n      .filter((item) => !!item) as InsertItem[],\n  }));\n\n  const insertMap = groups.reduce<Record<string, InsertItem>>((map, group) => {\n    group.items.forEach((item) => {\n      // eslint-disable-next-line no-param-reassign\n      map[item.key] = item;\n    });\n    return map;\n  }, {});\n\n  return {\n    onCangjieInput: createOnCangjieInput(pluginConfig, insertMap),\n    onKeyDown,\n    onSelect,\n    onCommand,\n    renderEditable: createRenderEditable(groups, insertMap, pluginConfig),\n    renderMark: createRenderMark(),\n    onAction,\n    queries: {\n      isSelectionInQuickInsert,\n      getQuickInsertDecoration,\n      getQuickInsertKeyword,\n      getQuickInsertPanelPosition,\n    },\n    commands: {\n      insertPlugin,\n    },\n    models: [{\n      klass: 'inline',\n      type: 'mention',\n    }],\n  };\n}\n\ncreateQuickInsertPlugin.actions = actions;\n\nexport default createQuickInsertPlugin;\n"],"file":"index.js"}