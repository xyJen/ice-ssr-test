{"version":3,"sources":["../../../../../src/plugins/lineheight/commands/setLineHeight.ts"],"names":["controller","lineHeight","lineRule","selectedBlocks","length","forEach","node","spacing","data","oldLineHeight","line","newLineHeight","Paragraph","isParagraph","Heading","isHeading","command","Commands","setNodeByKey","key"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;eAEe,CAACA,UAAD,EAAyBC,UAAzB,EAA6CC,QAA7C,KAAmE;AAChF,QAAMC,cAAc,GAAG,oCAAoBH,UAApB,CAAvB;;AACA,MAAI,CAACG,cAAc,CAACC,MAApB,EAA4B;AAC1B,WAAOJ,UAAP;AACD;;AAEDG,EAAAA,cAAc,CAACE,OAAf,CAAwBC,IAAD,IAAU;AAC/B;AACA;AACA,UAAM;AAAEC,MAAAA,OAAO,GAAG;AAAZ,QAAmBD,IAAI,CAACE,IAA9B;AAEA,UAAMC,aAAa,GAAG;AACpBC,MAAAA,IAAI,EAAEH,OAAO,CAACG,IAAR,IAAgB,CADF;AAEpBR,MAAAA,QAAQ,EAAEK,OAAO,CAACL,QAAR,IAAoB;AAFV,KAAtB;AAIA,UAAMS,aAAa,GAAG;AACpBD,MAAAA,IAAI,EAAET,UAAU,IAAI,CADA;AAEpBC,MAAAA,QAAQ,EAAEA,QAAQ,IAAI;AAFF,KAAtB;;AAIA,QAAI,mCAAmBS,aAAnB,EAAkCF,aAAlC,CAAJ,EAAsD;AACpD;AACD;;AAED,QAAIG,kBAAUC,WAAV,CAAsBP,IAAtB,KAA+BQ,gBAAQC,SAAR,CAAkBT,IAAlB,CAAnC,EAA4D;AAC1DN,MAAAA,UAAU,CAACgB,OAAX,CAAmBC,sBAASC,YAA5B,EAA0CZ,IAAI,CAACa,GAA/C,EAAoD;AAClDX,QAAAA,IAAI,EAAE,EACJ,GAAGF,IAAI,CAACE,IADJ;AAEJD,UAAAA,OAAO,EAAE,EACP,GAAGA,OADI;AAEP,eAAGI;AAFI;AAFL;AAD4C,OAApD;AASD;AACF,GA5BD;AA6BA,SAAOX,UAAP;AACD,C","sourcesContent":["import { Controller, Commands } from '@ali/4ever-cangjie';\nimport { Paragraph, Heading } from '@ali/4ever-mo';\nimport { isEqualWithDefault, getBlocksFromEditor } from '@ali/4ever-utils';\n\nexport default (controller: Controller, lineHeight: number, lineRule?: string) => {\n  const selectedBlocks = getBlocksFromEditor(controller);\n  if (!selectedBlocks.length) {\n    return controller;\n  }\n\n  selectedBlocks.forEach((node) => {\n    // TODO 其他需要支持行高的 block 需要配置这里\n    // 要保留spacing的其他设置，比如段落间距\n    const { spacing = {} } = node.data;\n\n    const oldLineHeight = {\n      line: spacing.line || 1,\n      lineRule: spacing.lineRule || 'auto',\n    };\n    const newLineHeight = {\n      line: lineHeight || 1,\n      lineRule: lineRule || 'auto',\n    };\n    if (isEqualWithDefault(newLineHeight, oldLineHeight)) {\n      return;\n    }\n\n    if (Paragraph.isParagraph(node) || Heading.isHeading(node)) {\n      controller.command(Commands.setNodeByKey, node.key, {\n        data: {\n          ...node.data,\n          spacing: {\n            ...spacing,\n            ...newLineHeight,\n          },\n        },\n      });\n    }\n  });\n  return controller;\n};\n"],"file":"setLineHeight.js"}