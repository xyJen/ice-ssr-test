"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _everCangjie = require("@ali/4ever-cangjie");

var _everMo = require("@ali/4ever-mo");

var _everUtils = require("@ali/4ever-utils");

var _default = (controller, lineHeight, lineRule) => {
  const selectedBlocks = (0, _everUtils.getBlocksFromEditor)(controller);

  if (!selectedBlocks.length) {
    return controller;
  }

  selectedBlocks.forEach(node => {
    // TODO 其他需要支持行高的 block 需要配置这里
    // 要保留spacing的其他设置，比如段落间距
    const {
      spacing = {}
    } = node.data;
    const oldLineHeight = {
      line: spacing.line || 1,
      lineRule: spacing.lineRule || 'auto'
    };
    const newLineHeight = {
      line: lineHeight || 1,
      lineRule: lineRule || 'auto'
    };

    if ((0, _everUtils.isEqualWithDefault)(newLineHeight, oldLineHeight)) {
      return;
    }

    if (_everMo.Paragraph.isParagraph(node) || _everMo.Heading.isHeading(node)) {
      controller.command(_everCangjie.Commands.setNodeByKey, node.key, {
        data: { ...node.data,
          spacing: { ...spacing,
            ...newLineHeight
          }
        }
      });
    }
  });
  return controller;
};

exports.default = _default;
//# sourceMappingURL=setLineHeight.js.map