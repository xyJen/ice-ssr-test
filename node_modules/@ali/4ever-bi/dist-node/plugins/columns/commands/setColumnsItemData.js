"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = setColumnsItemData;

var _everCangjie = require("@ali/4ever-cangjie");

var _everMo = require("@ali/4ever-mo");

function setColumnsItemData(controller, key, data) {
  const node = controller.value.document.getNode(key);

  if (!_everMo.TableCell.isTableCell(node)) {
    return controller;
  }

  if (typeof data?.color === 'string') {
    const {
      selection: range,
      document
    } = controller.value;

    const selection = _everCangjie.Selection.create(range.moveToRangeOfNode(node, controller).convertToTextPoints(document));

    controller.command(_everCangjie.Commands.select, selection);
    controller.dispatch('setColor', data?.color);
    controller.command(_everCangjie.Commands.moveToStart);
  }

  const dataParams = data || {};
  const newData = { ...node.data,
    ...dataParams
  };
  return controller.command(_everCangjie.Commands.setNodeByKey, key, {
    data: newData
  });
}
//# sourceMappingURL=setColumnsItemData.js.map