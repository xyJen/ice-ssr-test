{"version":3,"sources":["../../../../../src/plugins/columns/commands/setColumnsItemData.ts"],"names":["setColumnsItemData","controller","key","data","node","value","document","getNode","TableCell","isTableCell","color","selection","range","Selection","create","moveToRangeOfNode","convertToTextPoints","command","Commands","select","dispatch","moveToStart","dataParams","newData","setNodeByKey"],"mappings":";;;;;;;AAAA;;AACA;;AAEe,SAASA,kBAAT,CACbC,UADa,EAEbC,GAFa,EAGbC,IAHa,EAIb;AACA,QAAMC,IAAI,GAAGH,UAAU,CAACI,KAAX,CAAiBC,QAAjB,CAA0BC,OAA1B,CAAkCL,GAAlC,CAAb;;AACA,MAAI,CAACM,kBAAUC,WAAV,CAAsBL,IAAtB,CAAL,EAAkC;AAChC,WAAOH,UAAP;AACD;;AACD,MAAI,OAAOE,IAAI,EAAEO,KAAb,KAAuB,QAA3B,EAAqC;AACnC,UAAM;AAAEC,MAAAA,SAAS,EAAEC,KAAb;AAAoBN,MAAAA;AAApB,QAAiCL,UAAU,CAACI,KAAlD;;AACA,UAAMM,SAAS,GAAGE,uBAAUC,MAAV,CAChBF,KAAK,CAACG,iBAAN,CAAwBX,IAAxB,EAA8BH,UAA9B,EAA0Ce,mBAA1C,CAA8DV,QAA9D,CADgB,CAAlB;;AAGAL,IAAAA,UAAU,CAACgB,OAAX,CAAmBC,sBAASC,MAA5B,EAAoCR,SAApC;AACAV,IAAAA,UAAU,CAACmB,QAAX,CAAoB,UAApB,EAAgCjB,IAAI,EAAEO,KAAtC;AACAT,IAAAA,UAAU,CAACgB,OAAX,CAAmBC,sBAASG,WAA5B;AACD;;AACD,QAAMC,UAAU,GAAGnB,IAAI,IAAI,EAA3B;AACA,QAAMoB,OAAO,GAAG,EACd,GAAGnB,IAAI,CAACD,IADM;AAEd,OAAGmB;AAFW,GAAhB;AAKA,SAAOrB,UAAU,CAACgB,OAAX,CAAmBC,sBAASM,YAA5B,EAA0CtB,GAA1C,EAA+C;AACpDC,IAAAA,IAAI,EAAEoB;AAD8C,GAA/C,CAAP;AAGD","sourcesContent":["import { Controller, Commands, Selection } from '@ali/4ever-cangjie';\nimport { TableCell } from '@ali/4ever-mo';\n\nexport default function setColumnsItemData(\n  controller: Controller,\n  key: string,\n  data?: any,\n) {\n  const node = controller.value.document.getNode(key);\n  if (!TableCell.isTableCell(node)) {\n    return controller;\n  }\n  if (typeof data?.color === 'string') {\n    const { selection: range, document } = controller.value;\n    const selection = Selection.create(\n      range.moveToRangeOfNode(node, controller).convertToTextPoints(document),\n    );\n    controller.command(Commands.select, selection);\n    controller.dispatch('setColor', data?.color);\n    controller.command(Commands.moveToStart);\n  }\n  const dataParams = data || {};\n  const newData = {\n    ...node.data,\n    ...dataParams,\n  };\n\n  return controller.command(Commands.setNodeByKey, key, {\n    data: newData,\n  });\n}\n"],"file":"setColumnsItemData.js"}