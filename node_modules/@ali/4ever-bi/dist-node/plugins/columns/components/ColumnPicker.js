"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _react = _interopRequireWildcard(require("react"));

var _isHotkey = require("is-hotkey");

var _styled = require("./styled");

const _createElement = /*#__PURE__*/_react.default.createElement;
const isArrowRightHotKey = (0, _isHotkey.isKeyHotkey)('right');
const isArrowLeftHotKey = (0, _isHotkey.isKeyHotkey)('left');
const MAX_COLUMN_COUNT = 5;

const ColumnsPicker = props => {
  const {
    activeCount,
    columnText,
    onChange
  } = props;
  const columnItems = (0, _react.useMemo)(() => {
    const items = [];

    for (let i = 0; i < MAX_COLUMN_COUNT; i++) {
      const props = {
        className: i <= activeCount - 1 ? 'active' : '',
        onMouseEnter: () => onChange(i + 1)
      };
      items.push( /*#__PURE__*/_createElement(_styled.ColumnItem, (0, _extends2.default)({}, props, {
        key: i,
        "data-role": `columns${i + 1}`
      })));
    }

    return items;
  }, [activeCount]);
  (0, _react.useEffect)(() => {
    const handleKeyDown = event => {
      if (isArrowRightHotKey(event)) {
        onChange(count => Math.min(count + 1, MAX_COLUMN_COUNT));
      } else if (isArrowLeftHotKey(event)) {
        onChange(count => Math.max(count - 1, 1)); // 防止回退到上一级 menu 菜单

        event.stopPropagation();
      }
    };

    document.addEventListener('keydown', handleKeyDown, true);
    return () => {
      document.removeEventListener('keydown', handleKeyDown, true);
    };
  }, []);
  return /*#__PURE__*/_createElement(_react.default.Fragment, null, /*#__PURE__*/_createElement(_styled.ColumnTitle, null, activeCount, " ", columnText), /*#__PURE__*/_createElement(_styled.ColumnsPickerWrapper, null, columnItems));
};

var _default = ColumnsPicker;
exports.default = _default;
//# sourceMappingURL=ColumnPicker.js.map