{"version":3,"sources":["../../../../../src/plugins/subject/components/insertBar.tsx"],"names":["plus","popIn","keyframes","IconBox","styled","span","ShadowBox","HorizontalLine","HorizontalBox","div","InsertBarBox","tooltipStyle","background","border","fontFamily","fontSize","color","letterSpacing","padding","InsertBar","props","style","className","node","direction","controller","config","locale","insertTopicTip","handleClick","React","useCallback","subjectId","run","properties","id","name","selection","value","blockProps","Paragraph","TYPE","trigger","highlight","displayName"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;uBAN4B,a;;AAQ5B,MAAMA,IAAI,gBACR;AAAK,EAAA,KAAK,EAAC,MAAX;AAAkB,EAAA,MAAM,EAAC,MAAzB;AAAgC,EAAA,OAAO,EAAC,WAAxC;AAAoD,EAAA,OAAO,EAAC,KAA5D;AAAkE,EAAA,KAAK,EAAC,4BAAxE;AAAqG,EAAA,UAAU,EAAC;AAAhH,gBACE;AAAG,EAAA,EAAE,EAAC,QAAN;AAAe,EAAA,MAAM,EAAC,MAAtB;AAA6B,EAAA,WAAW,EAAC,GAAzC;AAA6C,EAAA,IAAI,EAAC,MAAlD;AAAyD,EAAA,QAAQ,EAAC;AAAlE,gBACE;AAAG,EAAA,EAAE,EAAC,YAAN;AAAmB,EAAA,SAAS,EAAC;AAA7B,gBACE;AAAG,EAAA,EAAE,EAAC,YAAN;AAAmB,EAAA,SAAS,EAAC;AAA7B,gBACE;AAAM,EAAA,CAAC,EAAC,2IAAR;AAAoJ,EAAA,EAAE,EAAC,aAAvJ;AAAqK,EAAA,IAAI,EAAC;AAA1K,EADF,eAEE;AAAM,EAAA,CAAC,EAAC,gVAAR;AAAyV,EAAA,EAAE,EAAC,WAA5V;AAAwW,EAAA,IAAI,EAAC,cAA7W;AAA4X,EAAA,QAAQ,EAAC;AAArY,EAFF,eAGE;AAAM,EAAA,EAAE,EAAC,GAAT;AAAa,EAAA,EAAE,EAAC,GAAhB;AAAoB,EAAA,EAAE,EAAC,IAAvB;AAA4B,EAAA,EAAE,EAAC,GAA/B;AAAmC,EAAA,EAAE,EAAC,QAAtC;AAA+C,EAAA,MAAM,EAAC,SAAtD;AAAgE,EAAA,aAAa,EAAC,OAA9E;AAAsF,EAAA,cAAc,EAAC,OAArG;AAA6G,EAAA,eAAe,EAAC;AAA7H,EAHF,eAIE;AAAM,EAAA,EAAE,EAAC,GAAT;AAAa,EAAA,EAAE,EAAC,GAAhB;AAAoB,EAAA,EAAE,EAAC,GAAvB;AAA2B,EAAA,EAAE,EAAC,IAA9B;AAAmC,EAAA,EAAE,EAAC,QAAtC;AAA+C,EAAA,MAAM,EAAC,SAAtD;AAAgE,EAAA,aAAa,EAAC,OAA9E;AAAsF,EAAA,cAAc,EAAC,OAArG;AAA6G,EAAA,eAAe,EAAC;AAA7H,EAJF,CADF,CADF,CADF,CADF;;AAeA,MAAMC,KAAK,oBAAGC,2BAAH,mFAAX;;AAYA,MAAMC,OAAO,gBAAGC,0BAAOC,IAAV,sJAAb;;AAcA,MAAMC,SAAS,gBAAGF,0BAAOC,IAAV,kGAAf;;AAUA,MAAME,cAAc,gBAAGH,0BAAOC,IAAV,0HAApB;;AAYA,MAAMG,aAAa,gBAAGJ,0BAAOK,GAAV,0SAYfN,OAZe,EAeTI,cAfS,EAmBbD,SAnBa,EAmBKC,cAnBL,CAAnB;;AA8BA,MAAMG,YAAY,gBAAGN,0BAAOK,GAAV,sDAAlB;;AAOA,MAAME,YAAiC,GAAG;AACxCC,EAAAA,UAAU,EAAE,wBAD4B;AAExCC,EAAAA,MAAM,EAAE,qCAFgC;AAGxCC,EAAAA,UAAU,EAAE,WAH4B;AAIxCC,EAAAA,QAAQ,EAAE,EAJ8B;AAKxCC,EAAAA,KAAK,EAAE,SALiC;AAMxCC,EAAAA,aAAa,EAAE,CANyB;AAOxCC,EAAAA,OAAO,EAAE;AAP+B,CAA1C;;wBAwE+C,eAAC,SAAD,O;;yBAEvC,eAAC,cAAD,O;;AAvDR,MAAMC,SAAmC,GAAIC,KAAD,IAAW;AACrD,QAAM;AACJC,IAAAA,KADI;AAEJC,IAAAA,SAFI;AAGJC,IAAAA,IAHI;AAIJC,IAAAA,SAAS,GAAG,OAJR;AAKJC,IAAAA,UALI;AAMJC,IAAAA;AANI,MAOFN,KAPJ;AASA,QAAM;AAAEO,IAAAA,MAAM,GAAG;AAAX,MAAkBD,MAAxB;AACA,QAAM;AAAEE,IAAAA;AAAF,MAAqBD,MAA3B;AAEA,QAAME,WAAW,GAAGC,KAAK,CAACC,WAAN,CAAkB,MAAM;AAC1C,UAAMC,SAAS,GAAG,sBAAlB,CAD0C,CAG1C;;AACAP,IAAAA,UAAU,CAACQ,GAAX,CAAe,UAAf,EAA2B,4BAAc;AACvCV,MAAAA,IADuC;AAEvCC,MAAAA,SAFuC;AAGvCU,MAAAA,UAAU,EAAE;AACVC,QAAAA,EAAE,EAAEH,SADM;AAEV;AACAI,QAAAA,IAAI,EAAE;AAHI;AAH2B,KAAd,CAA3B;AASA,UAAM;AAAEC,MAAAA;AAAF,QAAgBZ,UAAU,CAACa,KAAjC,CAb0C,CAe1C;;AACAb,IAAAA,UAAU,CAACQ,GAAX,CAAe,UAAf,EAA2B,0BAAY;AACrCM,MAAAA,UAAU,EAAEC,kBAAUC;AADe,KAAZ,CAA3B,EAhB0C,CAoB1C;;AACAhB,IAAAA,UAAU,CAACQ,GAAX,CAAe,iBAAf,EAAkC,qCAAmB;AACnDI,MAAAA,SADmD;AAEnDK,MAAAA,OAAO,EAAE;AAF0C,KAAnB,CAAlC,EArB0C,CA0B1C;;AACAjB,IAAAA,UAAU,CAACQ,GAAX,CAAe,UAAf,EAA2B,+BAAiB;AAC1CD,MAAAA,SAD0C;AAE1CW,MAAAA,SAAS,EAAE;AAF+B,KAAjB,CAA3B;AAID,GA/BmB,EA+BjB,CAAClB,UAAD,EAAaD,SAAb,EAAwBD,IAAxB,CA/BiB,CAApB;AAiCA,sBACE,eAAC,YAAD;AACE,IAAA,KAAK,EAAEF,KADT;AAEE,IAAA,SAAS,EAAEC;AAFb,kBAIE,eAAC,aAAD,qBACE,eAAC,iBAAD;AAAS,IAAA,KAAK,EAAEM,cAAhB;AAAgC,IAAA,YAAY,EAAEjB,YAA9C;AAA4D,IAAA,SAAS,EAAC;AAAtE,kBACE,eAAC,OAAD;AAAS,IAAA,OAAO,EAAEkB;AAAlB,KAAgC7B,IAAhC,OADF,CADF,QAJF,CADF;AAaD,CA3DD;;AA6DAmB,SAAS,CAACyB,WAAV,GAAwB,WAAxB;eAEezB,S","sourcesContent":["import * as React from 'react';\nimport styled, { keyframes } from 'styled-components';\nimport { Tooltip } from '@ali/we-design';\nimport { Paragraph } from '@ali/4ever-mo';\nimport { Block, CangjieSelectEvent, Controller } from '@ali/4ever-cangjie';\nimport { SubjectConfig } from '../types';\nimport { highlightSubject, insertBlock, insertSubject } from '../actions';\nimport { uniqueId } from '../utils';\n\nconst plus = (\n  <svg width=\"24px\" height=\"18px\" viewBox=\"0 0 24 18\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlnsXlink=\"http://www.w3.org/1999/xlink\">\n    <g id=\"Page-1\" stroke=\"none\" strokeWidth=\"1\" fill=\"none\" fillRule=\"evenodd\">\n      <g id=\"Frame-2084\" transform=\"translate(-53.000000, -321.000000)\">\n        <g id=\"Group-2070\" transform=\"translate(53.000000, 321.000000)\">\n          <path d=\"M9,18 C13.9705627,18 18,13.9705627 18,9 C18,4.02943725 13.9705627,0 9,0 C4.02943725,0 0,4.02943725 0,9 C0,13.9705627 4.02943725,18 9,18 Z\" id=\"Ellipse-128\" fill=\"currentColor\" />\n          <path d=\"M19.9995422,6.99996066 C21.3328756,7.99996066 22.6662089,8.49996074 23.9995422,8.4999609 L23.9995422,9.4999609 C22.9995422,9.4999609 21.4995422,10.0000305 19.9995422,11.0000305 C18.9995422,11.6666972 17.6662089,12.8839067 15.9995422,14.651659 L15.9995422,3.34402466 C17.3328756,4.78131533 18.6662089,5.99996066 19.9995422,6.99996066 Z\" id=\"Polygon-4\" fill=\"currentColor\" fillRule=\"nonzero\" />\n          <line x1=\"4\" y1=\"9\" x2=\"14\" y2=\"9\" id=\"Vector\" stroke=\"#FFFFFF\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeDasharray=\"0,0\" />\n          <line x1=\"9\" y1=\"4\" x2=\"9\" y2=\"14\" id=\"Vector\" stroke=\"#FFFFFF\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeDasharray=\"0,0\" />\n        </g>\n      </g>\n    </g>\n  </svg>\n);\n\nconst popIn = keyframes`\n  0% {\n    transform: scale(0.4);\n  }\n  80% {\n    transform: scale(1.1);\n  }\n  100% {\n    transform: scale(1);\n  }\n`;\n\nconst IconBox = styled.span`\n  position: absolute;\n  display: inline-block;\n  margin: auto;\n  left: -8px;\n  top: 0;\n  bottom: 0;\n  height: 18px;\n  width: 24px;\n  z-index: 1;\n  cursor: pointer;\n  transition: all 0.2s;\n`;\n\nconst ShadowBox = styled.span`\n  position: absolute;\n  width: 18px;\n  height: 18px;\n  left: 0;\n  top: 0;\n  border-radius: 9px;\n  transition: all 0.2s;\n`;\n\nconst HorizontalLine = styled.span`\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin: auto;\n  height: 2px;\n  background-color: #39A3FF;\n  transition: all 0.2s;\n`;\n\nconst HorizontalBox = styled.div`\n  position: absolute;\n  width: 100%;\n  height: 32px;\n  margin: auto;\n  top: 0;\n  bottom: 0;\n  opacity: 0;\n  transition: all 0.2s;\n  color: #39A3FF;\n  cursor: default;\n\n  ${IconBox}:hover {\n    color: #0089FF;\n\n    & ~ ${HorizontalLine} {\n      background-color: #0089FF;\n    }\n\n    ${ShadowBox}, & ~ ${HorizontalLine} {\n      box-shadow: 0px 1px 4px 0px rgba(0, 137, 255, 0.5);\n    }\n  }\n  \n  &:hover {\n    opacity: 1;\n    transition-delay: 0.2s;\n  }\n`;\n\nconst InsertBarBox = styled.div`\n  position: absolute;\n  width: 100%;\n  height: 40px;\n  left: 0;\n`;\n\nconst tooltipStyle: React.CSSProperties = {\n  background: 'rgba(30, 30, 30, 0.94)',\n  border: '1px solid rgba(126, 134, 142, 0.16)',\n  fontFamily: 'Helvetica',\n  fontSize: 12,\n  color: '#EEF2F8',\n  letterSpacing: 0,\n  padding: 8,\n};\n\nexport interface InsertBarProps {\n  style?: React.CSSProperties;\n  className?: string;\n  direction?: 'before' | 'after';\n  node: Block;\n  controller: Controller;\n  config: SubjectConfig;\n}\n\nconst InsertBar: React.FC<InsertBarProps> = (props) => {\n  const {\n    style,\n    className,\n    node,\n    direction = 'after',\n    controller,\n    config,\n  } = props;\n\n  const { locale = {} } = config;\n  const { insertTopicTip } = locale;\n\n  const handleClick = React.useCallback(() => {\n    const subjectId = uniqueId();\n\n    // 插入议题节点\n    controller.run('onAction', insertSubject({\n      node,\n      direction,\n      properties: {\n        id: subjectId,\n        // 目前限定只能插入议题\n        name: 'topic',\n      },\n    }));\n    const { selection } = controller.value;\n\n    // 插入空段落\n    controller.run('onAction', insertBlock({\n      blockProps: Paragraph.TYPE,\n    }));\n\n    // 将光标移动至插入议题时的状态（移动至议题标题处）\n    controller.run('onCangjieSelect', CangjieSelectEvent({\n      selection,\n      trigger: 'insertSubject',\n    }));\n\n    // 高亮议题区块\n    controller.run('onAction', highlightSubject({\n      subjectId,\n      highlight: true,\n    }));\n  }, [controller, direction, node]);\n\n  return (\n    <InsertBarBox\n      style={style}\n      className={className}\n    >\n      <HorizontalBox>\n        <Tooltip title={insertTopicTip} overlayStyle={tooltipStyle} placement=\"top\">\n          <IconBox onClick={handleClick}>{plus}<ShadowBox /></IconBox>\n        </Tooltip>\n        <HorizontalLine />\n      </HorizontalBox>\n    </InsertBarBox>\n  );\n};\n\nInsertBar.displayName = 'InsertBar';\n\nexport default InsertBar;\n"],"file":"insertBar.js"}