{"version":3,"sources":["../../../../../src/plugins/subject/components/content.tsx"],"names":["Content","HeadingGroupPlugin","components","SubjectPlugin","Placeholder","InlinePlaceholder","InnerTextWrapper","InnerCardWrapper","SubjectPlaceholderWrapper","SubjectContent","props","node","children","config","controller","rest","subjectPr","data","name","locale","renderInsertAttachmentComponent","review","reviewConfig","renderReviewPlaceholder","ReviewPlaceholder","reviewTextPlaceholder","topicContentPlaceholder","topicContentPlaceholderMobile","reviewTextPlaceholderMobile","conclusionContentPlaceholder","node1","nodes","displayPlaceholder1","item","length","renderFileChoosePlaceholder","hasReviewTaskList","find","list","isTaskList","focusToLine","React","useCallback","command","Commands","moveToStartOfNode","renderAttachmentPlaceholder","placeholder","useMemo","environment","IS_MOBILE","slice","displayName"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { environment, Block, Controller, Commands } from '@ali/4ever-cangjie';\nimport { Heading1Data } from '@ali/4ever-mo';\nimport { HeadingGroupPlugin, SubjectPlugin } from '@ali/4ever-bamboo';\nimport { SubjectConfig } from '../types';\nimport { isEmptyNode, isNormalParagraph } from '../utils';\n\nconst { Content } = HeadingGroupPlugin;\nconst { components } = SubjectPlugin;\nconst {\n  Placeholder,\n  InlinePlaceholder,\n  InnerTextWrapper,\n  InnerCardWrapper,\n  SubjectPlaceholderWrapper,\n} = components;\n\nexport interface SubjectContentProps extends HeadingGroupPlugin.ContentProps {\n  node: Block<Heading1Data>;\n  children: React.ReactNode[];\n  config: SubjectConfig;\n  controller: Controller;\n}\n\nconst SubjectContent: React.FC<SubjectContentProps> = (props) => {\n  const {\n    node,\n    children,\n    config,\n    controller,\n    ...rest\n  } = props;\n\n  const { subjectPr = {} } = node.data;\n  const { name } = subjectPr;\n  const { locale = {}, renderInsertAttachmentComponent } = config;\n  const { review: reviewConfig } = config;\n  const { renderReviewPlaceholder: ReviewPlaceholder } = reviewConfig || {};\n\n  const {\n    reviewTextPlaceholder,\n    topicContentPlaceholder,\n    topicContentPlaceholderMobile,\n    reviewTextPlaceholderMobile,\n    conclusionContentPlaceholder,\n  } = locale;\n\n  const node1 = node.nodes[1] as Block;\n\n  const displayPlaceholder1 = (item: Block) => {\n    if (name === 'review' || name === 'topic' || name === 'conclusion') {\n      return isNormalParagraph(item) && isEmptyNode(item) && node.nodes.length === 2;\n    }\n    return false;\n  };\n\n  const renderFileChoosePlaceholder = () => {\n    const hasReviewTaskList = !!node.nodes.find((node) => (node as Block)?.data?.list?.isTaskList);\n    // 没有taskList\n    if (!hasReviewTaskList && ReviewPlaceholder) {\n      return <ReviewPlaceholder node={node} />;\n    }\n    return null;\n  };\n\n  const focusToLine = React.useCallback(() => {\n    controller.command(Commands.moveToStartOfNode, node1);\n  }, [controller, node1]);\n\n  const renderAttachmentPlaceholder = () => {\n    if (renderInsertAttachmentComponent) {\n      return renderInsertAttachmentComponent({\n        focusToLine,\n      });\n    }\n    return null;\n  };\n\n  const placeholder = React.useMemo(() => {\n    if (name === 'review') {\n      if (environment.IS_MOBILE) {\n        return <InlinePlaceholder data-placeholder>{reviewTextPlaceholderMobile}</InlinePlaceholder>;\n      }\n      return (\n        <SubjectPlaceholderWrapper data-placeholder>\n          <InnerTextWrapper>\n            {reviewTextPlaceholder}\n          </InnerTextWrapper>\n          <InnerCardWrapper>\n            {renderFileChoosePlaceholder()}\n          </InnerCardWrapper>\n        </SubjectPlaceholderWrapper>\n      );\n    }\n\n    // 议题内容 placeholder\n    if (name === 'topic') {\n      if (environment.IS_MOBILE) {\n        return <InlinePlaceholder data-placeholder>{topicContentPlaceholderMobile}</InlinePlaceholder>;\n      }\n      return (\n        <SubjectPlaceholderWrapper data-placeholder>\n          <InnerTextWrapper>\n            {topicContentPlaceholder}\n          </InnerTextWrapper>\n          <InnerCardWrapper className=\"attachment\">\n            {renderAttachmentPlaceholder()}\n          </InnerCardWrapper>\n        </SubjectPlaceholderWrapper>\n      );\n    }\n\n    // 会议小结内容 placeholder\n    if (name === 'conclusion') {\n      return <InlinePlaceholder data-placeholder>{conclusionContentPlaceholder}</InlinePlaceholder>;\n    }\n\n    return null;\n  }, [conclusionContentPlaceholder, name, reviewTextPlaceholder, topicContentPlaceholder, topicContentPlaceholderMobile, renderFileChoosePlaceholder]);\n\n  if (children.length === 0) {\n    return null;\n  }\n\n  return (\n    <Content {...rest}>\n      {node1 && (\n        <Placeholder\n          controller={controller}\n          node={node1}\n          display={displayPlaceholder1}\n          placeholder={placeholder}\n        >\n          {children[0]}\n        </Placeholder>\n      )}\n      {children.slice(1)}\n    </Content>\n  );\n};\n\nSubjectContent.displayName = 'SubjectContent';\n\nexport default SubjectContent;\n"],"file":"content.js"}