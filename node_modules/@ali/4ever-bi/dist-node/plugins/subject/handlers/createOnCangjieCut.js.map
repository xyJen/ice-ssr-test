{"version":3,"sources":["../../../../../src/plugins/subject/handlers/createOnCangjieCut.ts"],"names":["MIME_TYPES","constants","createOnCangjieCut","onCangjieCut","event","controller","next","document","data","value","SELECTED_SUBJECT_KEY","selectedKey","block","getNode","clipboardData","fragment","query","getSubjectFragment","setData","FRAGMENT","transferUtils","encodeFragment","command","deleteSubject","unselectSubject"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAGA,MAAM;AAAEA,EAAAA;AAAF,IAAiBC,sBAAvB;;AAEA,SAASC,kBAAT,GAAsD;AACpD,SAAO,SAASC,YAAT,CAAsBC,KAAtB,EAA6BC,UAA7B,EAAyCC,IAAzC,EAA+C;AACpD,QAAI,qCAAuBD,UAAvB,CAAJ,EAAwC;AACtC,YAAM;AAAEE,QAAAA,QAAF;AAAYC,QAAAA;AAAZ,UAAqBH,UAAU,CAACI,KAAtC;AACA,YAAM;AAAE,SAACC,+BAAD,GAAwBC;AAA1B,UAA0CH,IAAhD;AACA,YAAMI,KAAK,GAAGL,QAAQ,CAACM,OAAT,CAAiBF,WAAjB,CAAd;;AACA,UAAI,6BAAiBC,KAAjB,KAA2BR,KAAK,CAACU,aAArC,EAAoD;AAClD,cAAMC,QAAQ,GAAGV,UAAU,CAACW,KAAX,CAAiBC,2BAAjB,EAAqCL,KAArC,CAAjB;AACAR,QAAAA,KAAK,CAACU,aAAN,CAAoBI,OAApB,CAA4BlB,UAAU,CAACmB,QAAvC,EAAiDC,2BAAcC,cAAd,CAA6BN,QAA7B,CAAjD;AACAV,QAAAA,UAAU,CAACiB,OAAX,CAAmBC,uBAAnB,EAAkCX,KAAlC,EAAoDU,OAApD,CAA4DE,yBAA5D;AACD;AACF;;AACD,WAAOlB,IAAI,EAAX;AACD,GAZD;AAaD;;eAEcJ,kB","sourcesContent":["import { Plugin, transferUtils, constants } from '@ali/4ever-cangjie';\nimport { deleteSubject, unselectSubject } from '../commands';\nimport { SELECTED_SUBJECT_KEY } from '../constants';\nimport { hasSubjectBeenSelected } from '../helpers';\nimport { getSubjectFragment } from '../queries';\nimport { isSubjectHeading } from '../utils';\nimport type { Subject } from '../utils';\n\nconst { MIME_TYPES } = constants;\n\nfunction createOnCangjieCut(): Plugin['onCangjieCut'] {\n  return function onCangjieCut(event, controller, next) {\n    if (hasSubjectBeenSelected(controller)) {\n      const { document, data } = controller.value;\n      const { [SELECTED_SUBJECT_KEY]: selectedKey } = data;\n      const block = document.getNode(selectedKey);\n      if (isSubjectHeading(block) && event.clipboardData) {\n        const fragment = controller.query(getSubjectFragment, block as Subject);\n        event.clipboardData.setData(MIME_TYPES.FRAGMENT, transferUtils.encodeFragment(fragment));\n        controller.command(deleteSubject, block as Subject).command(unselectSubject);\n      }\n    }\n    return next();\n  };\n}\n\nexport default createOnCangjieCut;\n"],"file":"createOnCangjieCut.js"}