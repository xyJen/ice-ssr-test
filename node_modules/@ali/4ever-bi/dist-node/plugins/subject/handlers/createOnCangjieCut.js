"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _everCangjie = require("@ali/4ever-cangjie");

var _commands = require("../commands");

var _constants = require("../constants");

var _helpers = require("../helpers");

var _queries = require("../queries");

var _utils = require("../utils");

const {
  MIME_TYPES
} = _everCangjie.constants;

function createOnCangjieCut() {
  return function onCangjieCut(event, controller, next) {
    if ((0, _helpers.hasSubjectBeenSelected)(controller)) {
      const {
        document,
        data
      } = controller.value;
      const {
        [_constants.SELECTED_SUBJECT_KEY]: selectedKey
      } = data;
      const block = document.getNode(selectedKey);

      if ((0, _utils.isSubjectHeading)(block) && event.clipboardData) {
        const fragment = controller.query(_queries.getSubjectFragment, block);
        event.clipboardData.setData(MIME_TYPES.FRAGMENT, _everCangjie.transferUtils.encodeFragment(fragment));
        controller.command(_commands.deleteSubject, block).command(_commands.unselectSubject);
      }
    }

    return next();
  };
}

var _default = createOnCangjieCut;
exports.default = _default;
//# sourceMappingURL=createOnCangjieCut.js.map