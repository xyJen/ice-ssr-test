{"version":3,"sources":["../../../../../src/plugins/subject/handlers/createOnQuery.ts"],"names":["createOnQuery","onQuery","event","controller","next","type","args","node","document","value","startBlock","SzUtil","toPt"],"mappings":";;;;;;;AACA;;AACA;;AACA;;AAEA,SAASA,aAAT,GAA4C;AAC1C,SAAO,SAASC,OAAT,CAAiBC,KAAjB,EAAwBC,UAAxB,EAAoCC,IAApC,EAA0C;AAC/C,UAAM;AAAEC,MAAAA,IAAF;AAAQC,MAAAA;AAAR,QAAiBJ,KAAvB,CAD+C,CAG/C;;AACA,QAAIG,IAAI,KAAK,WAAb,EAA0B;AACxB,YAAM;AAAEE,QAAAA;AAAF,UAAWD,IAAI,CAAC,CAAD,CAArB;AACA,YAAM;AAAEE,QAAAA;AAAF,UAAeL,UAAU,CAACM,KAAhC;AACA,aAAO,CAAC,CAACF,IAAF,IAAUH,IAAI,EAAd,IAAoB,CAAC,oCAAsBG,IAAtB,EAA4BC,QAA5B,CAA5B;AACD,KAR8C,CAU/C;;;AACA,QAAIH,IAAI,KAAK,SAAb,EAAwB;AACtB,YAAM;AAAEK,QAAAA;AAAF,UAAiBP,UAAU,CAACM,KAAlC;;AACA,UAAI,6BAAiBC,UAAjB,CAAJ,EAAkC;AAChC,eAAOC,mBAAOC,IAAP,CAAY,EAAZ,EAAgB,IAAhB,CAAP;AACD;AACF,KAhB8C,CAkB/C;;;AACA,QAAIP,IAAI,KAAK,iBAAT,IAA8B,qCAAuBF,UAAvB,CAAlC,EAAsE;AACpE,aAAO,IAAP;AACD;;AAED,WAAOC,IAAI,EAAX;AACD,GAxBD;AAyBD;;eAEcJ,a","sourcesContent":["import { Plugin } from '@ali/4ever-cangjie';\nimport { SzUtil } from '@ali/4ever-bamboo';\nimport { hasSubjectBeenSelected, isDisableNewLineGuide } from '../helpers';\nimport { isSubjectHeading } from '../utils';\n\nfunction createOnQuery(): Plugin['onQuery'] {\n  return function onQuery(event, controller, next) {\n    const { type, args } = event;\n\n    // 有 placeholder 展示则不显示 newLineGuide\n    if (type === 'isNewLine') {\n      const { node } = args[0];\n      const { document } = controller.value;\n      return !!node && next() && !isDisableNewLineGuide(node, document);\n    }\n\n    // 议题处读取 size 则默认 20px by @狗毛\n    if (type === 'getSize') {\n      const { startBlock } = controller.value;\n      if (isSubjectHeading(startBlock)) {\n        return SzUtil.toPt(20, 'px');\n      }\n    }\n\n    // 若议题组完全选中，则隐藏光标\n    if (type === 'isHideSelection' && hasSubjectBeenSelected(controller)) {\n      return true;\n    }\n\n    return next();\n  };\n}\n\nexport default createOnQuery;\n"],"file":"createOnQuery.js"}