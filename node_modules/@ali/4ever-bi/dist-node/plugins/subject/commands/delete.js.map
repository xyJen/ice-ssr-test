{"version":3,"sources":["../../../../../src/plugins/subject/commands/delete.ts"],"names":["deleteSubject","controller","subject","selection","document","value","endBlock","query","getSubjectEndBlock","prevBlock","getPreviousBlock","key","sel","moveAnchorToEndOfNode","moveAnchorToStartOfNode","moveFocusToEndOfNode","command","Commands","select","del"],"mappings":";;;;;;;AAAA;;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACO,SAASA,aAAT,CAAuBC,UAAvB,EAA+CC,OAA/C,EAAiE;AACtE,QAAM;AAAEC,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAA0BH,UAAU,CAACI,KAA3C;AACA,QAAMC,QAAQ,GAAGL,UAAU,CAACM,KAAX,CAAiBC,2BAAjB,EAAqCN,OAArC,CAAjB;;AAEA,MAAI,CAACI,QAAL,EAAe;AACb,WAAOL,UAAP;AACD;;AAED,QAAMQ,SAAS,GAAGL,QAAQ,CAACM,gBAAT,CAA0BR,OAAO,CAACS,GAAlC,CAAlB,CARsE,CAUtE;;AACA,MAAIC,GAAG,GAAGH,SAAS,GACfN,SAAS,CAACU,qBAAV,CAAgCJ,SAAhC,EAA2CR,UAA3C,CADe,GAEfE,SAAS,CAACW,uBAAV,CAAkCZ,OAAlC,EAA2CD,UAA3C,CAFJ,CAXsE,CAetE;;AACAW,EAAAA,GAAG,GAAGA,GAAG,CAACG,oBAAJ,CAAyBT,QAAzB,EAAmCL,UAAnC,CAAN;AAEA,SAAOA,UAAU,CAACe,OAAX,CAAmBC,sBAASC,MAA5B,EAAoCN,GAApC,EAAyCI,OAAzC,CAAiDC,sBAASE,GAA1D,CAAP;AACD","sourcesContent":["import { Commands, Controller } from '@ali/4ever-cangjie';\nimport { getSubjectEndBlock } from '../queries';\nimport { Subject } from '../utils';\n\n/**\n * 删除 Subject 组\n * @param controller\n * @param subject\n * @returns\n */\nexport function deleteSubject(controller: Controller, subject: Subject) {\n  const { selection, document } = controller.value;\n  const endBlock = controller.query(getSubjectEndBlock, subject);\n\n  if (!endBlock) {\n    return controller;\n  }\n\n  const prevBlock = document.getPreviousBlock(subject.key);\n\n  // 若存在上一个兄弟节点，则选中上一个节点的末尾\n  let sel = prevBlock\n    ? selection.moveAnchorToEndOfNode(prevBlock, controller)\n    : selection.moveAnchorToStartOfNode(subject, controller);\n\n  // 选中议题 end 节点的末尾\n  sel = sel.moveFocusToEndOfNode(endBlock, controller);\n\n  return controller.command(Commands.select, sel).command(Commands.del);\n}\n"],"file":"delete.js"}