{"version":3,"sources":["../../../../../src/plugins/subject/commands/select.ts"],"names":["selectSubject","controller","key","data","value","setData","SELECTED_SUBJECT_KEY","unselectSubject","newData","selectSubjectRange","block","endBlock","query","getSubjectEndBlock","command","Commands","moveAnchorToStartOfNode","moveFocusToEndOfNode"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AAGO,SAASA,aAAT,CAAuBC,UAAvB,EAA+CC,GAA/C,EAA4D;AACjE,QAAM;AAAEC,IAAAA;AAAF,MAAWF,UAAU,CAACG,KAA5B;AACA,SAAOH,UAAU,CAACI,OAAX,CAAmB,EACxB,GAAGF,IADqB;AAExB,KAACG,+BAAD,GAAwBJ;AAFA,GAAnB,CAAP;AAID;;AAEM,SAASK,eAAT,CAAyBN,UAAzB,EAAiD;AACtD,QAAM;AAAEE,IAAAA;AAAF,MAAWF,UAAU,CAACG,KAA5B;;AACA,MAAIE,mCAAwBH,IAA5B,EAAkC;AAChC,UAAMK,OAAO,GAAG,EAAE,GAAGL;AAAL,KAAhB;AACA,WAAOK,OAAO,CAACF,+BAAD,CAAd;AACA,WAAOL,UAAU,CAACI,OAAX,CAAmBG,OAAnB,CAAP;AACD;;AACD,SAAOP,UAAP;AACD;;AAEM,SAASQ,kBAAT,CAA4BR,UAA5B,EAAoDS,KAApD,EAAoE;AACzE,QAAMC,QAAQ,GAAGV,UAAU,CAACW,KAAX,CAAiBC,2BAAjB,EAAqCH,KAArC,CAAjB;;AAEA,MAAIC,QAAJ,EAAc;AACZ,WAAOV,UAAU,CACda,OADI,CACIC,sBAASC,uBADb,EACsCN,KADtC,EAEJI,OAFI,CAEIC,sBAASE,oBAFb,EAEmCN,QAFnC,CAAP;AAGD;;AAED,SAAOV,UAAU,CACda,OADI,CACIC,sBAASC,uBADb,EACsCN,KADtC,EAEJI,OAFI,CAEIC,sBAASE,oBAFb,EAEmCP,KAFnC,CAAP;AAGD","sourcesContent":["import { Commands, Controller } from '@ali/4ever-cangjie';\nimport { SELECTED_SUBJECT_KEY } from '../constants';\nimport { getSubjectEndBlock } from '../queries';\nimport { Subject } from '../utils';\n\nexport function selectSubject(controller: Controller, key: string) {\n  const { data } = controller.value;\n  return controller.setData({\n    ...data,\n    [SELECTED_SUBJECT_KEY]: key,\n  });\n}\n\nexport function unselectSubject(controller: Controller) {\n  const { data } = controller.value;\n  if (SELECTED_SUBJECT_KEY in data) {\n    const newData = { ...data };\n    delete newData[SELECTED_SUBJECT_KEY];\n    return controller.setData(newData);\n  }\n  return controller;\n}\n\nexport function selectSubjectRange(controller: Controller, block: Subject) {\n  const endBlock = controller.query(getSubjectEndBlock, block);\n\n  if (endBlock) {\n    return controller\n      .command(Commands.moveAnchorToStartOfNode, block)\n      .command(Commands.moveFocusToEndOfNode, endBlock);\n  }\n\n  return controller\n    .command(Commands.moveAnchorToStartOfNode, block)\n    .command(Commands.moveFocusToEndOfNode, block);\n}\n"],"file":"select.js"}