{"version":3,"sources":["../../../../../src/plugins/subject/queries/getLeftToolbarOffset.ts"],"names":["getSubjectStartBlock","SubjectPlugin","queries","DRAGGABLE_WIDTH","blackList","node","controller","parent","value","document","getParent","key","ColorBlocks","isColorBlocks","getLeftToolbarOffset","data","subject","query","some","fn","x","y","undefined"],"mappings":";;;;;;;AACA;;AACA;;AAEA,MAAM;AAAEA,EAAAA;AAAF,IAA2BC,0BAAcC,OAA/C;AAEA,MAAMC,eAAe,GAAG,CAAC,EAAzB;AAEA,MAAMC,SAAS,GAAG,CAChB,CAACC,IAAD,EAAcC,UAAd,KAAyC;AACvC;AACA,QAAMC,MAAM,GAAGD,UAAU,CAACE,KAAX,CAAiBC,QAAjB,CAA0BC,SAA1B,CAAoCL,IAAI,CAACM,GAAzC,CAAf;AACA,SAAOC,oBAAYC,aAAZ,CAA0BN,MAA1B,CAAP;AACD,CALe,CAAlB;;AAQO,SAASO,oBAAT,CAA+BR,UAA/B,EAAuDS,IAAvD,EAA8E;AACnF,QAAM;AAAEV,IAAAA;AAAF,MAAWU,IAAI,IAAI,EAAzB;AACA,QAAMC,OAAO,GAAGV,UAAU,CAACW,KAAX,CAAiBjB,oBAAjB,EAAuCK,IAAvC,CAAhB,CAFmF,CAGnF;AACA;;AACA,MAAI,CAAC,CAACW,OAAF,IAAa,CAACZ,SAAS,CAACc,IAAV,CAAgBC,EAAD,IAAQA,EAAE,CAACd,IAAD,EAAOC,UAAP,CAAzB,CAAlB,EAAgE;AAC9D,WAAO;AACLc,MAAAA,CAAC,EAAEjB,eADE;AAELkB,MAAAA,CAAC,EAAE;AAFE,KAAP;AAID;;AACD,SAAOC,SAAP;AACD","sourcesContent":["import { Controller, Block } from '@ali/4ever-cangjie';\nimport { SubjectPlugin } from '@ali/4ever-bamboo';\nimport { ColorBlocks } from '@ali/4ever-mo';\n\nconst { getSubjectStartBlock } = SubjectPlugin.queries;\n\nconst DRAGGABLE_WIDTH = -20;\n\nconst blackList = [\n  (node: Block, controller: Controller) => {\n    // 在高亮块中\n    const parent = controller.value.document.getParent(node.key);\n    return ColorBlocks.isColorBlocks(parent);\n  },\n]\n\nexport function getLeftToolbarOffset (controller: Controller, data: { node: Block }) {\n  const { node } = data || {};\n  const subject = controller.query(getSubjectStartBlock, node);\n  // 如果节点在议题里，那么段落拖动按钮需要加一个 offset\n  // 黑名单包含的节点会单独定义 offset\n  if (!!subject && !blackList.some((fn) => fn(node, controller))) {\n    return {\n      x: DRAGGABLE_WIDTH,\n      y: 0,\n    }\n  }\n  return undefined;\n}\n"],"file":"getLeftToolbarOffset.js"}