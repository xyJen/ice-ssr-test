{"version":3,"sources":["../../../../../src/plugins/uuid/handlers/onAction.ts"],"names":["onAction","action","controller","next","type","SET_NODE_UUID","node","uuid","payload","Element","isElement","withoutSaving","command","Commands","setNodeByKey","key","data","refblockUUID"],"mappings":";;;;;;;AAAA;;AACA;;AAEe,SAASA,QAAT,CAAkBC,MAAlB,EAA0BC,UAA1B,EAAkDC,IAAlD,EAAwD;AACrE,QAAM;AAAEC,IAAAA;AAAF,MAAWH,MAAjB;;AAEA,MAAIG,IAAI,KAAKC,sBAAb,EAA4B;AAC1B,UAAM;AAAEC,MAAAA,IAAF;AAAQC,MAAAA;AAAR,QAAiBN,MAAM,CAACO,OAA9B;;AACA,QAAI,CAACC,qBAAQC,SAAR,CAAkBJ,IAAlB,CAAL,EAA8B;AAC5B;AACD;;AACD,WAAOJ,UAAU,CAACS,aAAX,CAAyB,MAAM;AACpCT,MAAAA,UAAU,CAACU,OAAX,CAAmBC,sBAASC,YAA5B,EAA0CR,IAAI,CAACS,GAA/C,EAAoD;AAClDX,QAAAA,IAAI,EAAEE,IAAI,CAACF,IADuC;AAElDY,QAAAA,IAAI,EAAE,EACJ,GAAGV,IAAI,CAACU,IADJ;AAEJT,UAAAA,IAAI,EAAED,IAAI,CAACU,IAAL,CAAUC,YAAV,GAAyBX,IAAI,CAACU,IAAL,CAAUC,YAAnC,GAAkDV;AAFpD;AAF4C,OAApD;AAOD,KARM,CAAP;AASD;;AAED,SAAOJ,IAAI,EAAX;AACD","sourcesContent":["import { Controller, Commands, Element } from '@ali/4ever-cangjie';\nimport { SET_NODE_UUID, ISetNodeUUIDPayload } from '../actions';\n\nexport default function onAction(action, controller: Controller, next) {\n  const { type } = action;\n\n  if (type === SET_NODE_UUID) {\n    const { node, uuid } = action.payload as ISetNodeUUIDPayload;\n    if (!Element.isElement(node)) {\n      return;\n    }\n    return controller.withoutSaving(() => {\n      controller.command(Commands.setNodeByKey, node.key, {\n        type: node.type,\n        data: {\n          ...node.data,\n          uuid: node.data.refblockUUID ? node.data.refblockUUID : uuid,\n        },\n      });\n    });\n  }\n\n  return next();\n}\n"],"file":"onAction.js"}