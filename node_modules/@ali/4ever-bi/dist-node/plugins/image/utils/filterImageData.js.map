{"version":3,"sources":["../../../../../src/plugins/image/utils/filterImageData.ts"],"names":["isValidSize","ImagePlugin","filterImageData","data","filterDataList","filteredData","key","indexOf","isSizeValid","width","height","rectClip","left","right","top","bottom"],"mappings":";;;;;;;AAAA;;AAGA,MAAM;AAAEA,EAAAA;AAAF,IAAkBC,uBAAxB;;AAEe,SAASC,eAAT,CAAyBC,IAAzB,EAA2CC,cAA3C,EAAyF;AACtG,QAAMC,YAAiC,GAAG,EAA1C;;AACA,OAAK,MAAMC,GAAX,IAAkBH,IAAlB,EAAwB;AACtB,QAAIC,cAAc,CAACG,OAAf,CAAuBD,GAAvB,IAA4D,CAAhE,EAAmE;AACjED,MAAAA,YAAY,CAACC,GAAD,CAAZ,GAAoBH,IAAI,CAACG,GAAD,CAAxB;AACD;AACF;;AACD,QAAME,WAAW,GAAGR,WAAW,CAACK,YAAY,CAACI,KAAd,EAAqBJ,YAAY,CAACK,MAAlC,CAA/B;;AACA,MAAIP,IAAI,CAACQ,QAAT,EAAmB;AACjB,QAAI,CAACN,YAAY,CAACM,QAAlB,EAA4B;AAC1B;AACA,UAAIH,WAAJ,EAAiB;AACdH,QAAAA,YAAY,CAACI,KAAd,IAAmC,CAACN,IAAI,CAACQ,QAAL,CAAcC,IAAd,IAAsB,CAAvB,KAA6BT,IAAI,CAACQ,QAAL,CAAcE,KAAd,IAAuB,CAApD,CAAnC;AACCR,QAAAA,YAAY,CAACK,MAAd,IAAoC,CAACP,IAAI,CAACQ,QAAL,CAAcG,GAAd,IAAqB,CAAtB,KAA4BX,IAAI,CAACQ,QAAL,CAAcI,MAAd,IAAwB,CAApD,CAApC;AACD,OALyB,CAM1B;;AACD,KAPD,MAOO;AACL;AACA,UAAI,CAACP,WAAL,EAAkB;AAChBH,QAAAA,YAAY,CAACM,QAAb,GAAwB,EAAxB;AACD,OAJI,CAKL;;AACD;AACF;;AACD,SAAON,YAAP;AACD","sourcesContent":["import { ImagePlugin } from '@ali/4ever-bamboo';\nimport { IImageData } from '../types';\n\nconst { isValidSize } = ImagePlugin;\n\nexport default function filterImageData(data: IImageData, filterDataList: ImagePlugin.FilterDataItem[]) {\n  const filteredData: Partial<IImageData> = {};\n  for (const key in data) {\n    if (filterDataList.indexOf(key as ImagePlugin.FilterDataItem) < 0) {\n      filteredData[key] = data[key];\n    }\n  }\n  const isSizeValid = isValidSize(filteredData.width, filteredData.height);\n  if (data.rectClip) {\n    if (!filteredData.rectClip) {\n      // rectClip 被过滤了, 且宽高是合法的，应该将宽高调整成剪裁之前，否则比例错误\n      if (isSizeValid) {\n        (filteredData.width as number) += ((data.rectClip.left || 0) + (data.rectClip.right || 0));\n        (filteredData.height as number) += ((data.rectClip.top || 0) + (data.rectClip.bottom || 0));\n      }\n      // rectClip 被过滤了, 但经过过滤后宽高是非法的，不做处理。\n    } else {\n      // rectClip 未被过滤，但是宽高不再合法，需要强制过滤 rectClip\n      if (!isSizeValid) {\n        filteredData.rectClip = {};\n      }\n      // rectClip 未被过滤，宽高合法，不需要处理\n    }\n  }\n  return filteredData;\n}"],"file":"filterImageData.js"}