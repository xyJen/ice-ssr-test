{"version":3,"sources":["../../../../../src/plugins/image/utils/calcImageSize.ts"],"names":["width","height","controller","container","value","natural","document","maxWidth","Math","max","isAutoFit"],"mappings":";;;;;;;AAAA;;eAEe,CAACA,KAAD,EAAQC,MAAR,EAAgBC,UAAhB,KAIV;AACH,QAAMC,SAAS,GAAG,yCAAyBD,UAAU,CAACE,KAApC,CAAlB;AACA,QAAMC,OAAO,GAAG;AACdL,IAAAA,KADc;AAEdC,IAAAA;AAFc,GAAhB;;AAIA,MAAI,CAACE,SAAL,EAAgB;AACd,WAAOE,OAAP;AACD;;AAED,QAAM;AAAEC,IAAAA;AAAF,MAAeJ,UAAU,CAACE,KAAhC;AACA,QAAMG,QAAQ,GAAGC,IAAI,CAACC,GAAL,CAAS,kCAAkBN,SAAlB,EAA6BG,QAA7B,KAA0C,CAAnD,EAAsD,CAAtD,CAAjB;;AACA,MAAIC,QAAQ,GAAGF,OAAO,CAACL,KAAvB,EAA8B;AAC5B,WAAO;AACLA,MAAAA,KAAK,EAAEO,QADF;AAELN,MAAAA,MAAM,EAAEM,QAAQ,GAAGF,OAAO,CAACL,KAAnB,GAA2BK,OAAO,CAACJ,MAFtC;AAGLS,MAAAA,SAAS,EAAE;AAHN,KAAP;AAKD;;AAED,SAAOL,OAAP;AACD,C","sourcesContent":["import { getClosestContainerBlock, getInnerFullWidth } from '@ali/4ever-utils';\n\nexport default (width, height, controller) : {\n  width: number;\n  height: number;\n  isAutoFit?: boolean;\n} => {\n  const container = getClosestContainerBlock(controller.value);\n  const natural = {\n    width,\n    height,\n  };\n  if (!container) {\n    return natural;\n  }\n\n  const { document } = controller.value;\n  const maxWidth = Math.max(getInnerFullWidth(container, document) || 0, 0);\n  if (maxWidth < natural.width) {\n    return {\n      width: maxWidth,\n      height: maxWidth / natural.width * natural.height,\n      isAutoFit: true,\n    };\n  }\n\n  return natural;\n};\n"],"file":"calcImageSize.js"}