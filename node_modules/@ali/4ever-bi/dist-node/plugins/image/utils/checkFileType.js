"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _everBamboo = require("@ali/4ever-bamboo");

const checkFileType = (file, buffer) => {
  const {
    ImageTypeEnum,
    getImageTypeFromBuffer
  } = _everBamboo.ImagePlugin;
  const partialBuffer = buffer.slice(0, 4);
  const imageType = getImageTypeFromBuffer(partialBuffer);
  const fileTypeRegExp = /\.([a-zA-Z0-9_]*)$/;
  const execRes = fileTypeRegExp.exec(file.name);
  const fileType = execRes && execRes[1] || '';

  if (imageType !== ImageTypeEnum.UNCERTAIN && fileType !== imageType) {
    const newFile = new File([file], `${file.name.replace(fileTypeRegExp, '')}.${imageType}`, {
      type: `image/${imageType}`
    });
    return {
      file: newFile,
      type: imageType
    };
  }

  return {
    file,
    type: fileType
  };
};

var _default = checkFileType;
exports.default = _default;
//# sourceMappingURL=checkFileType.js.map