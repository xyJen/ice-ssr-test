"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = filterImageData;

var _everBamboo = require("@ali/4ever-bamboo");

const {
  isValidSize
} = _everBamboo.ImagePlugin;

function filterImageData(data, filterDataList) {
  const filteredData = {};

  for (const key in data) {
    if (filterDataList.indexOf(key) < 0) {
      filteredData[key] = data[key];
    }
  }

  const isSizeValid = isValidSize(filteredData.width, filteredData.height);

  if (data.rectClip) {
    if (!filteredData.rectClip) {
      // rectClip 被过滤了, 且宽高是合法的，应该将宽高调整成剪裁之前，否则比例错误
      if (isSizeValid) {
        filteredData.width += (data.rectClip.left || 0) + (data.rectClip.right || 0);
        filteredData.height += (data.rectClip.top || 0) + (data.rectClip.bottom || 0);
      } // rectClip 被过滤了, 但经过过滤后宽高是非法的，不做处理。

    } else {
      // rectClip 未被过滤，但是宽高不再合法，需要强制过滤 rectClip
      if (!isSizeValid) {
        filteredData.rectClip = {};
      } // rectClip 未被过滤，宽高合法，不需要处理

    }
  }

  return filteredData;
}
//# sourceMappingURL=filterImageData.js.map