"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.dropImages = dropImages;
exports.filterTransferableImages = filterTransferableImages;

var _everCangjie = require("@ali/4ever-cangjie");

var _lodash = require("lodash");

/**
 * 删除某些特定 URL 的 img，这个问题主要用来处理 Word 拷贝图文的情况，图片的链接是本地文件，无法读取
 * @param fragment
 * @param dropImage
 */
function dropImages(fragment, shouldSkipImageURL) {
  const drops = fragment.filterDescendants(node => {
    return _everCangjie.Inline.isInline(node) && node.type === 'image' && !(0, _lodash.isEmpty)(node.data) && shouldSkipImageURL(node.data.src);
  });
  let result = fragment;
  drops.forEach(drop => {
    const path = result.getPath(drop.key);

    if (path) {
      result = result.removeNode(path);
    }
  });
  return result;
}
/**
 * 过滤出可以 transfer 的图片
 * @param fragment
 * @param filterTransfer
 */


function filterTransferableImages(fragment, shouldTransferImageURL) {
  const images = fragment.filterDescendants(node => {
    return _everCangjie.Inline.isInline(node) && node.type === 'image' && !!shouldTransferImageURL && shouldTransferImageURL(node.data.src);
  });
  return images;
}
//# sourceMappingURL=filterImages.js.map