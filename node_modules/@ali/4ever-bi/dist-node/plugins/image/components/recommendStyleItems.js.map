{"version":3,"sources":["../../../../../src/plugins/image/components/recommendStyleItems.tsx"],"names":["RecommendStyleMenuType","IMAGE_EXAMPLE_URL","EXAMPLE_WIDTH","EXAMPLE_HEIGHT","EXAMPLE_RATIO","IMAGE_STYLE_MENU_SMALL","IMAGE_STYLE_MENU_ITEM_SMALL","IMAGE_STYLE_ITEM_SELECTED","IMAGE_MARGIN_SMALL","IMAGE_MARGIN_NORMAL","ItemImage","styled","div","ItemImageWrapper","p","margin","ItemImageBorderWrapper","MenuWrapper","ItemImageStatusWrapper","RecommendItem","props","isActive","imageData","demoData","onClick","size","index","outline","radius","shadow","width","outlineWidth","loggerKey","SMALL","imageWrapperStyle","React","useMemo","border","ImagePlugin","getBorder","boxShadow","borderRadius","handleClick","useCallback","e","preventDefault","logger","sum","blockEvent","PluginRoles","imageRecommendStyleItem","RecommendStyleMenu","LARGE","data","items","getRecommendStyleItems","map","item","demo"],"mappings":"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","sourcesContent":["import React from 'react';\nimport styled from 'styled-components';\nimport classnames from 'classnames';\nimport { ImageData } from '@ali/4ever-mo';\nimport { ImagePlugin, PluginRoles } from '@ali/4ever-bamboo';\nimport logger from '@ali/4ever-logger';\nimport { isStyleActive } from '../utils/isStyleActive';\nimport { blockEvent }  from '@ali/4ever-utils';\nimport { getRecommendStyleItems } from '../config';\n\nexport enum RecommendStyleMenuType {\n  SMALL = 'small',\n  LARGE = 'large',\n}\n\nexport interface IRecommendStyleMenuProps {\n  size: RecommendStyleMenuType;\n  data: ImageData;\n  onClick: (data: Pick<ImageData, 'outline' | 'shadow' | 'radius'>) => void;\n}\n\nexport interface IRecommendItemProps {\n  isActive: boolean;\n  imageData: ImageData;\n  demoData: ImageData;\n  onClick: (data: ImageData) => void;\n  size: RecommendStyleMenuType;\n  index?: number;\n}\n\nconst IMAGE_EXAMPLE_URL = 'https://img.alicdn.com/imgextra/i3/O1CN016CBXo01OH1jCj0CB4_!!6000000001679-2-tps-224-160.png';\nconst EXAMPLE_WIDTH = 224;\nconst EXAMPLE_HEIGHT = 160;\nconst EXAMPLE_RATIO = EXAMPLE_HEIGHT / EXAMPLE_WIDTH;\nconst IMAGE_STYLE_MENU_SMALL = 'image-style-menu-small'\nconst IMAGE_STYLE_MENU_ITEM_SMALL = 'image-style-menu-item-small';\nconst IMAGE_STYLE_ITEM_SELECTED = 'image-style-item-selected';\nconst IMAGE_MARGIN_SMALL = 6;\nconst IMAGE_MARGIN_NORMAL = 8;\n\nconst ItemImage = styled.div`\n  background-image: url('${IMAGE_EXAMPLE_URL}'), linear-gradient(#FAFAFB, #F2F4F5);\n  height: 100%;\n  box-sizing: border-box;\n  background-size: cover;\n  cursor: pointer;\n`;\n\nconst ItemImageWrapper = styled.div<{margin: number}>`\n  position: absolute;\n  top: ${(p) => `${p.margin}px`};\n  right: ${(p) => `${p.margin}px`};\n  width: ${(p) => `calc(100% - ${p.margin * 2}px)`};\n  height: ${(p) => `calc(100% - ${p.margin * 2}px)`};\n`;\n\nconst ItemImageBorderWrapper = styled.div`\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n`;\n\nconst MenuWrapper = styled.div`\n  display: grid;\n  grid-template-columns: repeat(3, 80px);\n  grid-row-gap: 9px;\n  grid-column-gap: 3px;\n  justify-content: space-around;\n  &.${IMAGE_STYLE_MENU_SMALL} {\n    grid-template-columns: repeat(3, 1fr);\n    grid-row-gap: 6px;\n    justify-content: space-between;\n  }\n`;\n\nconst ItemImageStatusWrapper = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding-top: calc(calc(100% * ${EXAMPLE_RATIO}) + ${(1 - EXAMPLE_RATIO) * IMAGE_MARGIN_NORMAL * 2}px);\n  border-radius: 8px;\n  background: transparent;\n  transition: background 0.3s ease-in-out;\n  &:hover {\n    background: rgba(126, 134, 142, 0.12);\n  }\n  &.${IMAGE_STYLE_ITEM_SELECTED} {\n    background: rgba(0, 137, 255, 0.12);\n  }\n  &.${IMAGE_STYLE_MENU_ITEM_SMALL} {\n    padding-top: calc(calc(100% * ${EXAMPLE_RATIO}) + ${(1 - EXAMPLE_RATIO) * IMAGE_MARGIN_SMALL * 2}px);\n    border-radius: 5px;\n  }\n`;\n\nconst RecommendItem = (props: IRecommendItemProps) => {\n  const { isActive, imageData, demoData, onClick, size, index } = props;\n  const { outline = {}, radius, shadow } = demoData;\n  const { width: outlineWidth } = outline;\n\n  const loggerKey = `${size === RecommendStyleMenuType.SMALL ? 'image-inline-toolbar-' : 'image-sidebar-'}${index}`;\n\n  const imageWrapperStyle = React.useMemo(() => {\n    const border = ImagePlugin.getBorder(outline);\n    return {\n      border,\n      boxShadow: shadow,\n      borderRadius: radius || 0,\n    }\n  }, [outlineWidth, shadow, radius]);\n\n  const handleClick = React.useCallback((e: React.MouseEvent) => {\n    e.preventDefault();\n    onClick(imageData);\n    logger.sum(loggerKey);\n  }, [onClick, imageData, loggerKey]);\n  return (\n    <ItemImageStatusWrapper\n      className={classnames({\n        [IMAGE_STYLE_ITEM_SELECTED]: isActive,\n        [IMAGE_STYLE_MENU_ITEM_SMALL]: size === RecommendStyleMenuType.SMALL,\n      })}\n      data-testid={`image-style-option-${index}`}\n    >\n      <ItemImageWrapper margin={size === RecommendStyleMenuType.SMALL ? IMAGE_MARGIN_SMALL : IMAGE_MARGIN_NORMAL}>\n        <ItemImageBorderWrapper style={imageWrapperStyle}>\n          <ItemImage\n            onClick={handleClick}\n            onMouseDown={blockEvent}\n            data-testid={`image-recommend-style-${index}`}\n            data-role={`${PluginRoles.imageRecommendStyleItem}${index}`}\n          />\n        </ItemImageBorderWrapper>\n      </ItemImageWrapper>\n    </ItemImageStatusWrapper>\n  );\n}\n\nexport const RecommendStyleMenu = (props: IRecommendStyleMenuProps) => {\n  const { size = RecommendStyleMenuType.LARGE, data, onClick } = props;\n\n  const items = React.useMemo(getRecommendStyleItems, []);\n\n  return (\n    <MenuWrapper className={classnames({\n      [IMAGE_STYLE_MENU_SMALL]: size === RecommendStyleMenuType.SMALL,\n    })}>\n      {\n        items.map((item, index) => (\n          <RecommendItem\n            imageData={item.data}\n            demoData={item.demo}\n            isActive={isStyleActive(item.data, data || null)}\n            onClick={onClick}\n            size={size}\n            key={`image_recommend_style_item_${index}`}\n            index={index}\n          />\n        ))\n      }\n    </MenuWrapper>\n  );\n};"],"file":"recommendStyleItems.js"}