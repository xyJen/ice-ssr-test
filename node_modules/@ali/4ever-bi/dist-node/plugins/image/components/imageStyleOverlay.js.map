{"version":3,"sources":["../../../../../src/plugins/image/components/imageStyleOverlay.tsx"],"names":["OverlayWrapper","styled","div","Footer","ImageStyleOverlay","props","controller","getImageNode","locale","onClick","image","data","setData","React","useState","ImagePlugin","DEFAULT_STYLE","handleClean","useCallback","run","handleClick","newData","RecommendStyleMenuType","SMALL","PluginRoles","imageClearStyle","clearStyle"],"mappings":";;;;;;;;;AAAA;;AACA;;AAEA;;AAEA;;AACA;;AACA;;uBAN4B,a;;AAe5B,MAAMA,cAAc,gBAAGC,0BAAOC,GAAV,2CAApB;;AAKA,MAAMC,MAAM,gBAAGF,0BAAOC,GAAV,4JAAZ;;AAWO,MAAME,iBAAoD,GAAIC,KAAD,IAAW;AAC7E,QAAM;AAAEC,IAAAA,UAAF;AAAcC,IAAAA,YAAd;AAA4BC,IAAAA,MAA5B;AAAoCC,IAAAA;AAApC,MAAgDJ,KAAtD;AACA,QAAMK,KAAK,GAAGH,YAAY,EAA1B;;AACA,QAAM,CAACI,IAAD,EAAOC,OAAP,IAAkBC,eAAMC,QAAN,CAAeJ,KAAK,EAAEC,IAAP,IAAeI,wBAAYC,aAA1C,CAAxB;;AAEA,QAAMC,WAAW,GAAGJ,eAAMK,WAAN,CAAkB,MAAM;AAC1C,UAAMR,KAAK,GAAGH,YAAY,EAA1B;;AACA,QAAI,CAACG,KAAL,EAAY;AACV;AACD;;AACDJ,IAAAA,UAAU,CAACa,GAAX,CAAe,UAAf,EAA2B,0BAAYT,KAAZ,EAAmBK,wBAAYC,aAA/B,CAA3B;AACAJ,IAAAA,OAAO,CAACG,wBAAYC,aAAb,CAAP;AACAP,IAAAA,OAAO,IAAIA,OAAO,EAAlB;AACD,GARmB,EAQjB,CAACC,KAAD,EAAQJ,UAAR,EAAoBG,OAApB,CARiB,CAApB;;AAUA,QAAMW,WAAW,GAAIC,OAAD,IAAa;AAC/B,UAAMX,KAAK,GAAGH,YAAY,EAA1B;AACA,QAAI,CAACG,KAAL,EAAY;;AACZ,QAAI,kCAAcW,OAAd,EAAuBX,KAAK,CAACC,IAA7B,CAAJ,EAAwC;AACtCL,MAAAA,UAAU,CAACa,GAAX,CAAe,UAAf,EAA2B,0BAAYT,KAAZ,EAAmBK,wBAAYC,aAA/B,CAA3B;AACAJ,MAAAA,OAAO,CAACG,wBAAYC,aAAb,CAAP;AACD,KAHD,MAGO;AACLV,MAAAA,UAAU,CAACa,GAAX,CAAe,UAAf,EAA2B,0BAAYT,KAAZ,EAAmBW,OAAnB,CAA3B;AACAT,MAAAA,OAAO,CAACS,OAAD,CAAP;AACD;;AACDZ,IAAAA,OAAO,IAAIA,OAAO,EAAlB;AACD,GAXD;;AAaA,SAAOC,KAAK,gBACV,eAAC,cAAD;AAAgB,mBAAY;AAA5B,kBACE,eAAC,uCAAD;AACE,IAAA,OAAO,EAAEU,WADX;AAEE,IAAA,IAAI,EAAET,IAFR;AAGE,IAAA,IAAI,EAAEW,4CAAuBC;AAH/B,IADF,eAME,eAAC,MAAD;AACE,mBAAY,2BADd;AAEE,iBAAWC,wBAAYC,eAFzB;AAGE,IAAA,OAAO,EAAER;AAHX,KAKGT,MAAM,CAACkB,UALV,CANF,CADU,GAeR,IAfJ;AAgBD,CA5CM","sourcesContent":["import React from 'react';\nimport styled from 'styled-components';\nimport type { Inline, Controller } from '@ali/4ever-cangjie';\nimport { ImagePlugin, PluginRoles } from '@ali/4ever-bamboo';\nimport { Image } from '@ali/4ever-mo';\nimport { RecommendStyleMenuType, RecommendStyleMenu } from './recommendStyleItems';\nimport { updateImage } from '../actions';\nimport { isStyleActive } from '../utils/isStyleActive';\n\nexport interface IImageStyleOverlayProps {\n  getImageNode: () => Image | null;\n  controller: Controller;\n  locale: ImagePlugin.ILocale;\n  onClick: () => void;\n}\n\nconst OverlayWrapper = styled.div`\n  width: 186px;\n  padding: 10px 10px 0 10px;\n`;\n\nconst Footer = styled.div`\n  margin-top: 9px;\n  border-top: 1px solid rgba(126, 134, 142, 0.16);\n  font-size: 13px;\n  line-height: 32px;\n  text-align: center;\n  color: #0089FF;\n  height: 32px;\n  cursor: pointer;\n`;\n\nexport const ImageStyleOverlay: React.FC<IImageStyleOverlayProps> = (props) => {\n  const { controller, getImageNode, locale, onClick } = props;\n  const image = getImageNode();\n  const [data, setData] = React.useState(image?.data || ImagePlugin.DEFAULT_STYLE);\n\n  const handleClean = React.useCallback(() => {\n    const image = getImageNode();\n    if (!image) {\n      return;\n    }\n    controller.run('onAction', updateImage(image, ImagePlugin.DEFAULT_STYLE));\n    setData(ImagePlugin.DEFAULT_STYLE);\n    onClick && onClick();\n  }, [image, controller, onClick]);\n\n  const handleClick = (newData) => {\n    const image = getImageNode();\n    if (!image) return;\n    if (isStyleActive(newData, image.data)) {\n      controller.run('onAction', updateImage(image, ImagePlugin.DEFAULT_STYLE));\n      setData(ImagePlugin.DEFAULT_STYLE);\n    } else {\n      controller.run('onAction', updateImage(image, newData));\n      setData(newData);\n    }\n    onClick && onClick();\n  }\n\n  return image ? (\n    <OverlayWrapper data-testid=\"overlay-image-style-menu\">\n      <RecommendStyleMenu\n        onClick={handleClick}\n        data={data}\n        size={RecommendStyleMenuType.SMALL}\n      />\n      <Footer\n        data-testid=\"image-toolbar-clear-style\"\n        data-role={PluginRoles.imageClearStyle}\n        onClick={handleClean}\n      >\n        {locale.clearStyle}\n      </Footer>\n    </OverlayWrapper>\n  ) : null;\n}"],"file":"imageStyleOverlay.js"}