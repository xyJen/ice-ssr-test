{"version":3,"sources":["../../../../../src/plugins/image/handlers/onKeyDown.ts"],"names":["isEnter","isEscape","onKeyDown","event","controller","next","injections","focusInline","value","type","croppingImage","find","inj","key","data","isImageCropping","preventDefault"],"mappings":";;;;;;;;;AAEA;;AACA;;AAEA,MAAMA,OAAO,GAAG,2BAAY,OAAZ,CAAhB;AACA,MAAMC,QAAQ,GAAG,2BAAY,QAAZ,CAAjB;;AAEe,SAASC,SAAT,CAAmBC,KAAnB,EAA+CC,UAA/C,EAAuEC,IAAvE,EAA6E;AAC1F,QAAM;AAAEC,IAAAA,UAAF;AAAcC,IAAAA;AAAd,MAA8BH,UAAU,CAACI,KAA/C;;AAEA,MAAI,EAAED,WAAW,IAAIA,WAAW,CAACE,IAAZ,KAAqB,OAAtC,CAAJ,EAAoD;AAClD,WAAOJ,IAAI,EAAX;AACD;;AAED,MAAIL,OAAO,CAACG,KAAD,CAAP,IAAkBF,QAAQ,CAACE,KAAD,CAA9B,EAAuC;AACrC,UAAMO,aAAa,GAAGJ,UAAU,CAACK,IAAX,CAAgBC,GAAG,IAAIA,GAAG,CAACC,GAAJ,KAAYN,WAAW,CAACM,GAA/C,CAAtB;;AACA,QAAIH,aAAa,IAAIA,aAAa,CAACI,IAAd,CAAmBC,eAAxC,EAAyD;AACvD,iCAAaX,UAAb,EAAyBG,WAAzB,EAAsC;AACpCQ,QAAAA,eAAe,EAAE;AADmB,OAAtC;AAGAZ,MAAAA,KAAK,CAACa,cAAN;AACA,aAAOZ,UAAP;AACD;AACF;;AACD,SAAOC,IAAI,EAAX;AACD","sourcesContent":["\nimport { Controller } from '@ali/4ever-cangjie';\nimport { isKeyHotkey } from 'is-hotkey';\nimport setInjection from '../commands/setInjection';\n\nconst isEnter = isKeyHotkey('enter');\nconst isEscape = isKeyHotkey('escape');\n\nexport default function onKeyDown(event: React.KeyboardEvent, controller: Controller, next) {\n  const { injections, focusInline } = controller.value;\n\n  if (!(focusInline && focusInline.type === 'image')) {\n    return next();\n  }\n\n  if (isEnter(event) || isEscape(event)) {\n    const croppingImage = injections.find(inj => inj.key === focusInline.key);\n    if (croppingImage && croppingImage.data.isImageCropping) {\n      setInjection(controller, focusInline, {\n        isImageCropping: false,\n      });\n      event.preventDefault();\n      return controller;\n    }\n  }\n  return next();\n}\n"],"file":"onKeyDown.js"}