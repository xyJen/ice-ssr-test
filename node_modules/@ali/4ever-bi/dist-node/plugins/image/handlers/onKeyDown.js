"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = onKeyDown;

var _isHotkey = require("is-hotkey");

var _setInjection = _interopRequireDefault(require("../commands/setInjection"));

const isEnter = (0, _isHotkey.isKeyHotkey)('enter');
const isEscape = (0, _isHotkey.isKeyHotkey)('escape');

function onKeyDown(event, controller, next) {
  const {
    injections,
    focusInline
  } = controller.value;

  if (!(focusInline && focusInline.type === 'image')) {
    return next();
  }

  if (isEnter(event) || isEscape(event)) {
    const croppingImage = injections.find(inj => inj.key === focusInline.key);

    if (croppingImage && croppingImage.data.isImageCropping) {
      (0, _setInjection.default)(controller, focusInline, {
        isImageCropping: false
      });
      event.preventDefault();
      return controller;
    }
  }

  return next();
}
//# sourceMappingURL=onKeyDown.js.map