{"version":3,"sources":["../../../../src/plugins/headingGroup/index.ts"],"names":["actions","GroupFactory","DRAG_BUTTON_OFFSET","PI_MODE","createHeadingGroupPlugin","config","headingGroup","level","shouldOffsetTypes","i","push","groupType","renderNode","groupNodes","queries","getHeadingGroupLevel","isHeadingGroupAvailable","getLeftToolbarOffset","controller","data","node","isPi","query","includes","type","x","y","undefined"],"mappings":";;;;;;;;;;;AAAA;;AAEA;;AACA;;AACA;;AACA;;AAEA,MAAM;AAAEA,EAAAA;AAAF,IAAcC,wBAApB;AACA,MAAMC,kBAAkB,GAAG,CAAC,EAA5B;AACA,MAAMC,OAAO,GAAG,aAAhB;AAEA,MAAMC,wBAAwB,GAAG,+BAAcC,MAAD,IAA4B;AACxE,QAAM;AAAEC,IAAAA,YAAY,GAAG;AAAjB,MAAwBD,MAA9B;AACA,QAAM;AAAEE,IAAAA,KAAK,GAAG;AAAV,MAAgBD,YAAtB;AACA,QAAME,iBAA2B,GAAG,EAApC;;AACA,OAAK,IAAIC,CAAC,GAAGF,KAAb,EAAoBE,CAAC,GAAG,CAAxB,EAA2BA,CAAC,EAA5B,EAAgC;AAC9BD,IAAAA,iBAAiB,CAACE,IAAlB,CAAwB,WAAUD,CAAE,EAApC;AACD;;AAAA;AACD,SAAO;AACLE,IAAAA,SAAS,EAAE,cADN;AAELC,IAAAA,UAAU,EAAE,+BAAiBN,YAAjB,CAFP;AAGLO,IAAAA,UAAU,EAAE,+BAAiBP,YAAjB,CAHP;AAILQ,IAAAA,OAAO,EAAE;AACPC,MAAAA,oBAAoB,EAAE,MAAMR,KADrB;AAEPS,MAAAA,uBAAuB,EAAE,MAAM,IAFxB;AAGPC,MAAAA,oBAAoB,EAAE,CAACC,UAAD,EAAaC,IAAb,KAAsB;AAC1C,cAAM;AAAEC,UAAAA;AAAF,YAAWD,IAAjB;AACA,cAAME,IAAI,GAAGH,UAAU,CAACI,KAAX,CAAiB,eAAjB,MAAsCnB,OAAnD;;AACA,YAAI,CAACkB,IAAD,IAASb,iBAAiB,CAACe,QAAlB,CAA2BH,IAAI,CAACI,IAAhC,CAAb,EAAoD;AAClD,iBAAO;AACL;AACAC,YAAAA,CAAC,EAAEvB,kBAAkB,GAAG,CAFnB;AAGLwB,YAAAA,CAAC,EAAE;AAHE,WAAP;AAKD;;AACD,eAAOC,SAAP;AACD,OAdM;AAeP,SAAGb;AAfI;AAJJ,GAAP;AAsBD,CA7BgC,CAAjC,C,CA+BA;;AACAV,wBAAwB,CAACJ,OAAzB,GAAmCA,OAAnC,C,CACA;;AACAI,wBAAwB,CAACU,OAAzB,GAAmCA,OAAnC;eAEeV,wB","sourcesContent":["import { GroupFactory } from '@ali/4ever-bamboo';\nimport { BiPluginConfig } from '../../types';\nimport createGroupNodes from './handlers/createGroupNodes';\nimport createRenderNode from './handlers/createRenderNode';\nimport * as queries from './queries';\nimport { groupFactory } from '@ali/4ever-factory';\n\nconst { actions } = GroupFactory;\nconst DRAG_BUTTON_OFFSET = -20;\nconst PI_MODE = 'page_layout';\n\nconst createHeadingGroupPlugin = groupFactory((config: BiPluginConfig) => {\n  const { headingGroup = {} } = config;\n  const { level = 3 } = headingGroup;\n  const shouldOffsetTypes: string[] = [];\n  for (let i = level; i > 0; i--) {\n    shouldOffsetTypes.push(`heading-${i}`);\n  };\n  return {\n    groupType: 'headingGroup',\n    renderNode: createRenderNode(headingGroup),\n    groupNodes: createGroupNodes(headingGroup),\n    queries: {\n      getHeadingGroupLevel: () => level,\n      isHeadingGroupAvailable: () => true,\n      getLeftToolbarOffset: (controller, data) => {\n        const { node } = data;\n        const isPi = controller.query('getLayoutMode') === PI_MODE;\n        if (!isPi && shouldOffsetTypes.includes(node.type)) {\n          return {\n            // 这里加上4是因为左侧工具栏的offset为6，但是在标题场景下是2\n            x: DRAG_BUTTON_OFFSET + 4,\n            y: 0,\n          };\n        }\n        return undefined;\n      },\n      ...queries,\n    },\n  };\n});\n\n// @ts-ignore\ncreateHeadingGroupPlugin.actions = actions;\n// @ts-ignore\ncreateHeadingGroupPlugin.queries = queries;\n\nexport default createHeadingGroupPlugin;\n"],"file":"index.js"}