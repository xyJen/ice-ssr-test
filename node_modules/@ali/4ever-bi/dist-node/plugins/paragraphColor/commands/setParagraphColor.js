"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _everCangjie = require("@ali/4ever-cangjie");

var _everPluginList = require("@ali/4ever-plugin-list");

var _utils = require("../utils");

const setParagraphColor = (controller, payload) => {
  const {
    node: currentBlock,
    color
  } = payload;
  const blocks = (0, _utils.getCurrentBlocks)(controller, currentBlock.key);

  if (Array.isArray(blocks) && blocks.length > 0) {
    blocks.forEach(node => {
      const {
        data
      } = node;

      if (_everPluginList.List.isList(node)) {
        // 列表拦截 SET_COLOR 设置列表符号颜色高度依赖 controller.selection
        // 所以这里手动处理下列表符号的颜色
        const newData = (0, _utils.cloneData)(data);
        newData.list.symbolStyle.color = color;
        controller.command(_everCangjie.Commands.setNodeByKey, node.key, {
          data: newData
        });
      }
    });
    const range = (0, _utils.getRangeFromNodes)(controller, blocks);
    controller.dispatch('setColorAtRange', range, color);
  }

  return controller;
};

var _default = setParagraphColor;
exports.default = _default;
//# sourceMappingURL=setParagraphColor.js.map