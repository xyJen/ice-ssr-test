{"version":3,"sources":["../../../src/bi/index.tsx"],"names":["biFactory","config","manager","SnippetManager","enabled","snippets","key","commands","actions","isActions","queries","onAction","onConstruct","controller","next","cfgs","run","setConfigs","onCangjieSelect","event","getSnippet","trigger","setCurrentSnippet","onKeyDown","onKeyUp","renderEditable"],"mappings":";;;;;;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEO,MAAMA,SAAoB,GAAIC,MAAD,IAAY;AAC9C,QAAMC,OAAO,GAAG,IAAIC,uBAAJ,EAAhB;AACA,QAAMC,OAAO,GAAGH,MAAM,CAACI,QAAP,EAAiBD,OAAjC;;AAEA,MAAI,CAACA,OAAL,EAAc;AACZ,WAAO;AAAEE,MAAAA,GAAG,EAAHA;AAAF,KAAP;AACD;;AAED,SAAO;AACLA,IAAAA,GAAG,EAAHA,SADK;AAELC,IAAAA,QAAQ,EAARA,kBAFK;AAGLC,IAAAA,OAAO,EAAPA,gBAHK;AAILC,IAAAA,SAAS,EAATA,kBAJK;AAKLC,IAAAA,OAAO,EAAE,4BAAcR,OAAd,CALJ;AAMLS,IAAAA,QAAQ,EAARA,kBANK;AAOLC,IAAAA,WAAW,EAAE,CAACC,UAAD,EAAyBC,IAAzB,KAAkC;AAC7C,YAAMC,IAAI,GAAGF,UAAU,CAACG,GAAX,CAAe,kBAAf,CAAb;AACAd,MAAAA,OAAO,CAACe,UAAR,CAAmBF,IAAnB;AACA,aAAOD,IAAI,EAAX;AACD,KAXI;;AAYLI,IAAAA,eAAe,CAACC,KAAD,EAAQN,UAAR,EAAoBC,IAApB,EAA0B;AACvC;AACA,UAAIZ,OAAO,CAACkB,UAAR,GAAqBC,OAAzB,EAAkC;AAChCnB,QAAAA,OAAO,CAACoB,iBAAR;AACD;;AACD,aAAOR,IAAI,EAAX;AACD,KAlBI;;AAmBLS,IAAAA,SAAS,EAAE,gCAAgBrB,OAAhB,CAnBN;AAoBLsB,IAAAA,OAAO,EAAE,4BAActB,OAAd,CApBJ;AAqBLuB,IAAAA,cAAc,EAAE,gDAAqBxB,MAAM,CAACI,QAA5B,EAAsCH,OAAtC;AArBX,GAAP;AAuBD,CA/BM","sourcesContent":["import type { BiFactory, Controller } from '@ali/4ever-cangjie';\nimport { key } from './utils/meta';\nimport { commands } from './commands';\nimport { actions, isActions } from './actions';\nimport { onAction } from './handlers/onAction';\nimport { createRenderEditable } from './createRenderEditable';\nimport { createOnKeyUp } from './handlers/onKeyUp';\nimport { createOnKeyDown } from './handlers/onKeyDown';\nimport SnippetManager from './snippetManager';\nimport { createQueries } from './queries';\n\nexport const biFactory: BiFactory = (config) => {\n  const manager = new SnippetManager();\n  const enabled = config.snippets?.enabled;\n\n  if (!enabled) {\n    return { key };\n  }\n\n  return {\n    key,\n    commands,\n    actions,\n    isActions,\n    queries: createQueries(manager),\n    onAction,\n    onConstruct: (controller: Controller, next) => {\n      const cfgs = controller.run('getSnippetConfig');\n      manager.setConfigs(cfgs);\n      return next();\n    },\n    onCangjieSelect(event, controller, next) {\n      // 在 panel 打开状态下进行选区操作，panel 消失\n      if (manager.getSnippet().trigger) {\n        manager.setCurrentSnippet();\n      }\n      return next();\n    },\n    onKeyDown: createOnKeyDown(manager),\n    onKeyUp: createOnKeyUp(manager),\n    renderEditable: createRenderEditable(config.snippets, manager),\n  };\n};\n"],"file":"index.js"}