{"version":3,"sources":["../../../../src/bi/handlers/onKeyDown.ts"],"names":["isUpDownHotKey","isEnterHotKey","createOnKeyDown","manager","onKeyDown","event","_controller","next","getSnippet","trigger","isShowingPanel","preventDefault","setCurrentSnippet"],"mappings":";;;;;;;AACA;;AAIA,MAAMA,cAAc,GAAG,2BAAY,CAAC,IAAD,EAAO,MAAP,CAAZ,CAAvB;AACA,MAAMC,aAAa,GAAG,2BAAY,OAAZ,CAAtB;;AAEO,SAASC,eAAT,CAAyBC,OAAzB,EAAkD;AACvD,SAAO,SAASC,SAAT,CACLC,KADK,EAELC,WAFK,EAGLC,IAHK,EAIL;AACA,QAAI,CAACJ,OAAO,CAACK,UAAR,GAAqBC,OAA1B,EAAmC;AACjC,aAAOF,IAAI,EAAX;AACD;;AAED,QAAIP,cAAc,CAACK,KAAD,CAAd,IAAyBJ,aAAa,CAACI,KAAD,CAA1C,EAAmD;AACjD;AACA,UAAIF,OAAO,CAACO,cAAR,EAAJ,EAA8B;AAC5BL,QAAAA,KAAK,CAACM,cAAN;AACA;AACD,OALgD,CAMjD;;;AACAR,MAAAA,OAAO,CAACS,iBAAR;AACD;;AACD,WAAOL,IAAI,EAAX;AACD,GAnBD;AAoBD","sourcesContent":["import React from 'react';\nimport { isKeyHotkey } from 'is-hotkey';\nimport { Controller } from '@ali/4ever-cangjie';\nimport type SnippetManager from '../snippetManager';\n\nconst isUpDownHotKey = isKeyHotkey(['up', 'down'])\nconst isEnterHotKey = isKeyHotkey('enter');\n\nexport function createOnKeyDown(manager: SnippetManager) {\n  return function onKeyDown(\n    event: React.KeyboardEvent,\n    _controller: Controller,\n    next: Function,\n  ) {\n    if (!manager.getSnippet().trigger) {\n      return next();\n    }\n\n    if (isUpDownHotKey(event) || isEnterHotKey(event)) {\n      // 若已经设置了 trigger，且 panel 已显示出来，这时再输入的事件需要拦截\n      if (manager.isShowingPanel()) {\n        event.preventDefault();\n        return;\n      }\n      // 若已经设置了 trigger，但还未显示出来，这时再输入的需要走原有逻辑，且重置 snippet\n      manager.setCurrentSnippet();\n    }\n    return next();\n  }\n}"],"file":"onKeyDown.js"}