"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var shared_1 = require("../constants/platform/shared");
function getVersionFromWinName() {
    var frameName = '';
    var version = '';
    if (typeof name !== 'undefined') {
        frameName = name;
    }
    if (frameName) {
        try {
            var frameConf = JSON.parse(frameName);
            if (frameConf.hostVersion) {
                version = frameConf.hostVersion;
            }
        }
        catch (e) {
            // when parse error , continue next opration
        }
    }
    return version;
}
function getDingTalkVersion(ua, options) {
    var version = shared_1.DEFAULT_VERSION;
    var _a = options || {}, _b = _a.isMac, isMac = _b === void 0 ? false : _b, _c = _a.isWin, isWin = _c === void 0 ? false : _c;
    var isPC = isMac || isWin;
    if (ua) {
        var _versionInfo = ua.match(shared_1.mobileDTVersionReg);
        if (isPC) {
            // 桌面版
            _versionInfo = ua.match(shared_1.pcDTVersionReg);
        }
        version = _versionInfo && _versionInfo[1] || shared_1.DEFAULT_VERSION;
        if (isWin) {
            // 通过 window.name 获取版本信息
            var versionFromName = getVersionFromWinName();
            version = versionFromName || version;
        }
    }
    return version;
}
exports.default = getDingTalkVersion;
