{"version":3,"sources":["../../../../src/bi/commands/undoInput.ts"],"names":["undoInput","controller","previousDocument","value","document","query","canUndo","command"],"mappings":";;;;;;;;;AAAA;;AAEA;;AAEO,SAASA,SAAT,CAAmBC,UAAnB,EAA2C;AAChD,MAAIC,gBAAiC,GAAG,IAAxC;;AACA,KAAG;AACDA,IAAAA,gBAAgB,GAAGD,UAAU,CAACE,KAAX,CAAiBC,QAApC;;AACA,QAAIH,UAAU,CAACI,KAAX,CAAiBC,gBAAjB,CAAJ,EAA+B;AAC7BL,MAAAA,UAAU,CAACM,OAAX,CAAmB,MAAnB;AACD,KAFD,MAEO;AACL;AACD,KANA,CAOH;;AACC,GARD,QAQS,4BAAMN,UAAU,CAACE,KAAX,CAAiBC,QAAvB,EAAiCF,gBAAjC,CART;;AASA,SAAOD,UAAP;AACD","sourcesContent":["import equal from 'fast-deep-equal';\nimport { Controller, Document } from '@ali/4ever-cangjie';\nimport { canUndo } from '../queries/canUndo';\n\nexport function undoInput(controller: Controller) {\n  let previousDocument: Document | null = null;\n  do {\n    previousDocument = controller.value.document;\n    if (controller.query(canUndo)) {\n      controller.command('undo');\n    } else {\n      break;\n    }\n  // TODO: 使用自写的 is 替换 fast-deep-equal\n  } while (equal(controller.value.document, previousDocument));\n  return controller;\n}\n"],"file":"undoInput.js"}