{"version":3,"sources":["../../../../src/common/hooks/usePreviewCopy.ts"],"names":["useEffect","useCallback","ContextMenu","environment","isKeyHotkey","isCopyHotKey","usePreviewCopy","controller","readOnly","query","onKeydown","event","isExpanded","value","selection","IS_MOBILE","run","type","ACTION_COPY","document","addEventListener","removeEventListener"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,WAApB,QAAuC,OAAvC;AACA,SAAqBC,WAArB,EAAkCC,WAAlC,QAAqD,oBAArD;AACA,SAASC,WAAT,QAA4B,WAA5B;AAEA,IAAMC,YAAY,GAAGD,WAAW,CAAC,OAAD,CAAhC;AAEA;AACA;AACA;;AACA,eAAe,SAASE,cAAT,CAAwBC,UAAxB,EAAgD;AAC7D,MAAMC,QAAQ,GAAGD,UAAU,CAACC,QAAX,IAAuBD,UAAU,CAACE,KAAX,CAAiB,gBAAjB,CAAxC;AAEA,MAAMC,SAAS,GAAGT,WAAW,CAC3B,UAACU,KAAD,EAA0B;AAAA,QAChBC,UADgB,GACDL,UAAU,CAACM,KAAX,CAAiBC,SADhB,CAChBF,UADgB;;AAExB,QAAIT,WAAW,CAACY,SAAZ,IAAyBH,UAAzB,IAAuCP,YAAY,CAACM,KAAD,CAAvD,EAAgE;AAC9DJ,MAAAA,UAAU,CAACS,GAAX,CAAe,UAAf,EAA2B;AAAEC,QAAAA,IAAI,EAAEf,WAAW,CAACgB;AAApB,OAA3B;AACD;AACF,GAN0B,EAO3B,CAACX,UAAD,CAP2B,CAA7B;AAUAP,EAAAA,SAAS,CAAC,YAAM;AACdQ,IAAAA,QAAQ,IAAIW,QAAQ,CAACC,gBAAT,CAA0B,SAA1B,EAAqCV,SAArC,CAAZ;AACA,WAAO,YAAM;AACXF,MAAAA,QAAQ,IAAIW,QAAQ,CAACE,mBAAT,CAA6B,SAA7B,EAAwCX,SAAxC,CAAZ;AACD,KAFD;AAGD,GALQ,EAKN,CAACA,SAAD,EAAYF,QAAZ,CALM,CAAT;AAMD","sourcesContent":["import { useEffect, useCallback } from 'react';\nimport { Controller, ContextMenu, environment } from '@ali/4ever-cangjie';\nimport { isKeyHotkey } from 'is-hotkey';\n\nconst isCopyHotKey = isKeyHotkey('mod+c');\n\n/**\n * 处理只读页面（只读权限 + QuickPreview）无法快捷键复制\n */\nexport default function usePreviewCopy(controller: Controller) {\n  const readOnly = controller.readOnly || controller.query('isQuickPreview');\n\n  const onKeydown = useCallback(\n    (event: KeyboardEvent) => {\n      const { isExpanded } = controller.value.selection;\n      if (environment.IS_MOBILE && isExpanded && isCopyHotKey(event)) {\n        controller.run('onAction', { type: ContextMenu.ACTION_COPY });\n      }\n    },\n    [controller],\n  );\n\n  useEffect(() => {\n    readOnly && document.addEventListener('keydown', onKeydown);\n    return () => {\n      readOnly && document.removeEventListener('keydown', onKeydown);\n    };\n  }, [onKeydown, readOnly]);\n}\n"],"file":"usePreviewCopy.js"}