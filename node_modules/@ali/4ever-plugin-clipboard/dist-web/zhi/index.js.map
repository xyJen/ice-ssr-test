{"version":3,"sources":["../../../src/zhi/index.tsx"],"names":["createOnCangjieCopyOrCut","key","Debug","queries","createOnEditable","warn","log","console","bind","zhiFactory","configs","clipboard","onCangjieCopyOrCut","onCopy","event","controller","next","readOnly","canCopy","preventDefault","selection","value","isCollapsed","onCangjieCopy","renderEditable"],"mappings":"AACA,OAAOA,wBAAP;AACA,SAASC,GAAT;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT;AACA,OAAOC,gBAAP;AAEA,IAAMC,IAAI,GAAGH,KAAK,CAAC,uBAAD,CAAlB;AACAG,IAAI,CAACC,GAAL,GAAWC,OAAO,CAACF,IAAR,CAAaG,IAAb,CAAkBD,OAAlB,CAAX;AAEA,OAAO,IAAME,UAAsB,GAAG,SAAzBA,UAAyB,CAACC,OAAD,EAAa;AAAA,2BACtBA,OADsB,CACzCC,SADyC;AAAA,MACzCA,SADyC,mCAC7B,EAD6B;AAGjD,MAAMC,kBAAkB,GAAGZ,wBAAwB,CAACW,SAAD,CAAnD;AACA,SAAO;AACLV,IAAAA,GAAG,EAAHA,GADK;AAELE,IAAAA,OAAO,EAAPA,OAFK;AAGLU,IAAAA,MAHK,kBAGEC,KAHF,EAGSC,UAHT,EAGqBC,IAHrB,EAG2B;AAC9B,UAAI,CAACF,KAAL,EAAY;AACV;AACD;;AACD,UAAIC,UAAU,CAACE,QAAX,IAAuB,CAACF,UAAU,CAACG,OAAvC,EAAgD;AAC9CJ,QAAAA,KAAK,CAACK,cAAN;AACAd,QAAAA,IAAI,CAAC,6BAAD,CAAJ;AACA;AACD;;AAR6B,UAStBe,SATsB,GASRL,UAAU,CAACM,KATH,CAStBD,SATsB;;AAU9B,UAAI,CAACA,SAAL,EAAgB;AACd;AACD,OAZ6B,CAa9B;AACA;AACA;;;AACA,UAAIA,SAAS,CAACE,WAAd,EAA2B;AACzB;AACD;;AACDN,MAAAA,IAAI;AACL,KAvBI;AAwBLO,IAAAA,aAAa,EAAEX,kBAxBV;AAyBLY,IAAAA,cAAc,EAAEpB,gBAAgB;AAzB3B,GAAP;AA2BD,CA/BM","sourcesContent":["import type { ZhiFactory } from '@ali/4ever-cangjie';\nimport createOnCangjieCopyOrCut from '../common/handlers/createOnCangjieCopyOrCut';\nimport { key } from '../utils/meta';\nimport Debug from 'debug';\nimport { queries } from './queries';\nimport createOnEditable from './handlers/createOnEditable';\n\nconst warn = Debug('EDITOR:CANGJIE:PLUGIN');\nwarn.log = console.warn.bind(console);\n\nexport const zhiFactory: ZhiFactory = (configs) => {\n  const { clipboard = {} } = configs;\n\n  const onCangjieCopyOrCut = createOnCangjieCopyOrCut(clipboard);\n  return {\n    key,\n    queries,\n    onCopy(event, controller, next) {\n      if (!event) {\n        return;\n      }\n      if (controller.readOnly && !controller.canCopy) {\n        event.preventDefault();\n        warn('Copy command is prohibited.');\n        return;\n      }\n      const { selection } = controller.value;\n      if (!selection) {\n        return;\n      }\n      // 如果光标重叠，则不处理\n      // Zhi 的交互和 Bi 不一样，在一些 embed 元素中会有一些文字，如果处理了 collapsed 选区，则无法拷贝内部文字，这里\n      // 我们限制如果拷贝的是块级元素，则必须有 expand 选区\n      if (selection.isCollapsed) {\n        return;\n      }\n      next();\n    },\n    onCangjieCopy: onCangjieCopyOrCut,\n    renderEditable: createOnEditable(),\n  };\n};\n"],"file":"index.js"}