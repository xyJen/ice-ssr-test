import * as tester from "../../utils/tester";
import logger from '@ali/4ever-logger';
/**
 * 该插件只分析数据，不做业务处理
 * @param config
 */

export default function createOnPaste() {
  return function onPaste(event, controller, next) {
    var clipboardData = event.clipboardData; // 上报拷贝数据来源

    logger.sum('paste_action');

    if (tester.isDingDocs(clipboardData)) {
      logger.sum('paste_from_ding_docs');
    } else if (tester.isDingSheet(clipboardData)) {
      logger.sum('paste_from_ding_sheet');
    } else if (tester.isMicrosoftOffice(clipboardData)) {
      logger.sum('paste_from_ms_office');
    } else if (tester.hasImage(clipboardData)) {
      logger.sum('paste_from_img');
    } else if (tester.isGoogleDocs(clipboardData)) {
      logger.sum('paste_from_google_docs');
    } else if (tester.isShimoDocs(clipboardData)) {
      logger.sum('paste_from_shimo_docs');
    } else if (tester.isYuqueDocs(clipboardData)) {
      logger.sum('paste_from_yuque_docs');
    } else if (tester.isVsCode(clipboardData)) {
      logger.sum('paste_from_vs_code');
    } else if (tester.hasTextHtml(clipboardData)) {
      logger.sum('paste_from_text_html');
    } else {
      logger.sum('paste_from_text_plain');
    }

    return next();
  };
}
//# sourceMappingURL=createOnPaste.js.map