{"version":3,"sources":["../../../../src/common/hooks/usePreviewCopy.ts"],"names":["isCopyHotKey","usePreviewCopy","controller","readOnly","query","onKeydown","event","isExpanded","value","selection","environment","IS_MOBILE","run","type","ContextMenu","ACTION_COPY","document","addEventListener","removeEventListener"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAEA,MAAMA,YAAY,GAAG,2BAAY,OAAZ,CAArB;AAEA;AACA;AACA;;AACe,SAASC,cAAT,CAAwBC,UAAxB,EAAgD;AAC7D,QAAMC,QAAQ,GAAGD,UAAU,CAACC,QAAX,IAAuBD,UAAU,CAACE,KAAX,CAAiB,gBAAjB,CAAxC;AAEA,QAAMC,SAAS,GAAG,wBACfC,KAAD,IAA0B;AACxB,UAAM;AAAEC,MAAAA;AAAF,QAAiBL,UAAU,CAACM,KAAX,CAAiBC,SAAxC;;AACA,QAAIC,yBAAYC,SAAZ,IAAyBJ,UAAzB,IAAuCP,YAAY,CAACM,KAAD,CAAvD,EAAgE;AAC9DJ,MAAAA,UAAU,CAACU,GAAX,CAAe,UAAf,EAA2B;AAAEC,QAAAA,IAAI,EAAEC,yBAAYC;AAApB,OAA3B;AACD;AACF,GANe,EAOhB,CAACb,UAAD,CAPgB,CAAlB;AAUA,wBAAU,MAAM;AACdC,IAAAA,QAAQ,IAAIa,QAAQ,CAACC,gBAAT,CAA0B,SAA1B,EAAqCZ,SAArC,CAAZ;AACA,WAAO,MAAM;AACXF,MAAAA,QAAQ,IAAIa,QAAQ,CAACE,mBAAT,CAA6B,SAA7B,EAAwCb,SAAxC,CAAZ;AACD,KAFD;AAGD,GALD,EAKG,CAACA,SAAD,EAAYF,QAAZ,CALH;AAMD","sourcesContent":["import { useEffect, useCallback } from 'react';\nimport { Controller, ContextMenu, environment } from '@ali/4ever-cangjie';\nimport { isKeyHotkey } from 'is-hotkey';\n\nconst isCopyHotKey = isKeyHotkey('mod+c');\n\n/**\n * 处理只读页面（只读权限 + QuickPreview）无法快捷键复制\n */\nexport default function usePreviewCopy(controller: Controller) {\n  const readOnly = controller.readOnly || controller.query('isQuickPreview');\n\n  const onKeydown = useCallback(\n    (event: KeyboardEvent) => {\n      const { isExpanded } = controller.value.selection;\n      if (environment.IS_MOBILE && isExpanded && isCopyHotKey(event)) {\n        controller.run('onAction', { type: ContextMenu.ACTION_COPY });\n      }\n    },\n    [controller],\n  );\n\n  useEffect(() => {\n    readOnly && document.addEventListener('keydown', onKeydown);\n    return () => {\n      readOnly && document.removeEventListener('keydown', onKeydown);\n    };\n  }, [onKeydown, readOnly]);\n}\n"],"file":"usePreviewCopy.js"}