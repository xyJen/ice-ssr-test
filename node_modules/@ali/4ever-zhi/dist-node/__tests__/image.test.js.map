{"version":3,"sources":["../../../src/__tests__/image.test.tsx"],"names":["URL","renderUrlMap","url","data","width","describe","it","asl","image","container","expect","innerHTML","toMatchSnapshot","skip","imageBorder","handleZoomImage","jest","fn","querySelectorAll","toHaveLength","querySelector","src","toBe","fireEvent","click","toHaveBeenCalledWith"],"mappings":";;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;uBAH4B,a;AAK5B,MAAMA,GAAG,GAAG,4EAAZ;;AAEA,SAASC,YAAT,CAAsBC,GAAtB,EAA2BC,IAA3B,EAAiC;AAC/B,SAAQ,GAAED,GAAI,iCAAgCC,IAAI,CAACC,KAAM,EAAzD;AACD;;AAAA;AAEDC,QAAQ,CAAC,WAAD,EAAc,MAAM;AAC1BC,EAAAA,EAAE,CAAC,MAAD,EAAS,MAAM;AACf,UAAMC,GAAG,GAAG,CAAC,MAAD,EAASC,cAAT,CAAZ;AACA,UAAM;AAAEC,MAAAA;AAAF,QAAgB,kCAAO,eAAC,eAAD;AAAK,MAAA,OAAO,EAAEF;AAAd,MAAP,CAAtB;AAEAG,IAAAA,MAAM,CAACD,SAAS,CAACE,SAAX,CAAN,CAA4BC,eAA5B;AACD,GALC,CAAF,CAD0B,CAQ1B;;AACAN,EAAAA,EAAE,CAACO,IAAH,CAAQ,aAAR,EAAuB,MAAM;AAC3B,UAAMN,GAAG,GAAG,CAAC,MAAD,EAASO,oBAAT,CAAZ;AACA,UAAM;AAAEL,MAAAA;AAAF,QAAgB,kCAAO,eAAC,eAAD;AAAK,MAAA,OAAO,EAAEF;AAAd,MAAP,CAAtB;AACAG,IAAAA,MAAM,CAACD,SAAS,CAACE,SAAX,CAAN,CAA4BC,eAA5B;AACD,GAJD,EAT0B,CAe1B;AACA;;AACAN,EAAAA,EAAE,CAACO,IAAH,CAAQ,uBAAR,EAAiC,MAAM;AACrC,UAAMN,GAAG,GAAG,CAAC,MAAD,EAASC,cAAT,CAAZ;AACA,UAAMO,eAAe,GAAGC,IAAI,CAACC,EAAL,EAAxB;AACA,UAAM;AAAER,MAAAA;AAAF,QAAgB,kCAAO,eAAC,eAAD;AAAK,MAAA,OAAO,EAAEF,GAAd;AAAmB,MAAA,YAAY,EAAEQ,eAAjC;AAAkD,MAAA,iBAAiB,EAAEd;AAArE,MAAP,CAAtB;AACAS,IAAAA,MAAM,CAACD,SAAS,CAACS,gBAAV,CAA2B,KAA3B,CAAD,CAAN,CAA0CC,YAA1C,CAAuD,CAAvD;AACAT,IAAAA,MAAM,CAACD,SAAS,CAACW,aAAV,CAAwB,KAAxB,EAA+BC,GAAhC,CAAN,CAA2CC,IAA3C,CAAiD,GAAEtB,GAAI,oCAAvD;;AACAuB,sBAAUC,KAAV,CAAgBf,SAAS,CAACW,aAAV,CAAwB,KAAxB,CAAhB;;AACAV,IAAAA,MAAM,CAACK,eAAD,CAAN,CACGU,oBADH,CACwBzB,GADxB;AAED,GATD;AAWAM,EAAAA,EAAE,CAACO,IAAH,CAAQ,iBAAR,EAA2B,MAAM;AAC/B,UAAMN,GAAG,GAAG,CAAC,MAAD,EACV,CAAC,GAAD,EAAM,CAAC,KAAD,EAAQ;AAAEc,MAAAA,GAAG,EAAE;AAAP,KAAR,CAAN,CADU,CAAZ;AAGA,UAAM;AAAEZ,MAAAA;AAAF,QAAgB,kCAAO,eAAC,eAAD;AAAK,MAAA,OAAO,EAAEF;AAAd,MAAP,CAAtB;AACAG,IAAAA,MAAM,CAACD,SAAS,CAACS,gBAAV,CAA2B,KAA3B,CAAD,CAAN,CAA0CC,YAA1C,CAAuD,CAAvD;AACD,GAND;AAOD,CAnCO,CAAR","sourcesContent":["import * as React from 'react';\nimport { render, fireEvent } from '@testing-library/react';\nimport Zhi from './reader';\nimport image from './fixtures/image.json';\nimport imageBorder from './fixtures/imageBorder.json';\n\nconst URL = 'https://cn.bing.com/az/hprichbg/rb/TeslaCoil_EN-CN1604235004_1920x1080.jpg';\n\nfunction renderUrlMap(url, data) {\n  return `${url}?x-oss-process=image/resize,w_${data.width}`\n};\n\ndescribe('Zhi:image', () => {\n  it('正确渲染', () => {\n    const asl = ['root', image];\n    const { container } = render(<Zhi content={asl} />);\n\n    expect(container.innerHTML).toMatchSnapshot();\n  });\n\n  // 有报错未找到原因，先注释\n  it.skip('正确渲染 border', () => {\n    const asl = ['root', imageBorder];\n    const { container } = render(<Zhi content={asl} />);\n    expect(container.innerHTML).toMatchSnapshot();\n  });\n\n  // 由于图片有加载占位图，不会直接展示 img 标签\n  // 而 enzyme 异步请求图片一直超时，暂不处理\n  it.skip('点击图片触发 onZoomImage 事件', () => {\n    const asl = ['root', image];\n    const handleZoomImage = jest.fn();\n    const { container } = render(<Zhi content={asl} previewImage={handleZoomImage} transformImageURL={renderUrlMap} />);\n    expect(container.querySelectorAll('img')).toHaveLength(0);\n    expect(container.querySelector('img').src).toBe(`${URL}?x-oss-process=image/resize,w_1920`);\n    fireEvent.click(container.querySelector('img'));\n    expect(handleZoomImage)\n      .toHaveBeenCalledWith(URL);\n  });\n\n  it.skip('没有 src 属性则不渲染节点', () => {\n    const asl = ['root',\n      ['p', ['img', { src: null }]],\n    ];\n    const { container } = render(<Zhi content={asl} />);\n    expect(container.querySelectorAll('img')).toHaveLength(0);\n  });\n});\n"],"file":"image.test.js"}