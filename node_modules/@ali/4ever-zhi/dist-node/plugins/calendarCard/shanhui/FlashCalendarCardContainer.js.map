{"version":3,"sources":["../../../../../src/plugins/calendarCard/shanhui/FlashCalendarCardContainer.tsx"],"names":["TimeTextParagraph","PlaceTextParagraph","ReceiversParagraph","ContainerWrapper","BodyWrapper","TimePlaceholder","CalendarCardPlugin","clickTimeout","FlashCalendarCardContainer","props","locale","metadata","jumpToCalendar","openProfile","time","place","redirectUrl","isPlaceholder","jumpToCalendarFactory","eventType","event","preventDefault","stopPropagation","style","setStyle","color","height","width","border","clickTimeRef","handleMouseDown","current","Date","getTime","handleClick","undefined","JumpToCalendarEventType","RECEIVER"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AAOA;;uBAR4B,a;AAU5B,MAAM;AACJA,EAAAA,iBADI;AAEJC,EAAAA,kBAFI;AAGJC,EAAAA,kBAHI;AAIJC,EAAAA,gBAJI;AAKJC,EAAAA,WALI;AAMJC,EAAAA;AANI,IAOFC,8BAPJ,C,CASA;;AACA,MAAMC,YAAY,GAAG,GAArB;;AAkBe,SAASC,0BAAT,CAAoCC,KAApC,EAAmD;AAChE,QAAM;AAAEC,IAAAA,MAAF;AAAUC,IAAAA,QAAV;AAAoBC,IAAAA,cAApB;AAAoCC,IAAAA;AAApC,MAAoDJ,KAA1D;AACA,QAAM;AACJK,IAAAA,IADI;AAEJC,IAAAA,KAFI;AAGJC,IAAAA,WAHI;AAIJC,IAAAA;AAJI,MAKFN,QALJ;AAMA,QAAMO,qBAAqB,GAAG,wBAC5B,qBAASC,SAAD,IAAyC;AAC/C,WAAQC,KAAD,IAAsC;AAC3CA,MAAAA,KAAK,CAACC,cAAN;AACAD,MAAAA,KAAK,CAACE,eAAN;AACA,UAAI,CAACV,cAAL,EAAqB;AACrB,UAAIK,aAAJ,EAAmB;AACnBL,MAAAA,cAAc,CAACI,WAAD,EAAcG,SAAd,CAAd;AACD,KAND;AAOD,GARD,CAD4B,EAU5B,CAACP,cAAD,CAV4B,CAA9B;AAYA,QAAM,CAACW,KAAD,EAAQC,QAAR,IAAoB,qBAAwB,EAAxB,CAA1B;AACA,wBAAU,MAAM;AACdA,IAAAA,QAAQ,CAAC;AACPC,MAAAA,KAAK,EAAER,aAAa,GAAG,oBAAH,GAA0B,EADvC;AAEPS,MAAAA,MAAM,EAAE,MAFD;AAGPC,MAAAA,KAAK,EAAE,MAHA;AAIPC,MAAAA,MAAM,EAAE;AAJD,KAAD,CAAR;AAMD,GAPD,EAOG,CAACX,aAAD,CAPH;AAQA,QAAMY,YAAY,GAAG,oBAArB;AACA,QAAMC,eAAe,GAAG,wBAAaV,KAAD,IAAiC;AACnES,IAAAA,YAAY,CAACE,OAAb,GAAuB,IAAIC,IAAJ,GAAWC,OAAX,EAAvB;AACAb,IAAAA,KAAK,CAACE,eAAN;AACD,GAHuB,EAGrB,EAHqB,CAAxB;AAIA,QAAMY,WAAW,GAAG,wBAAad,KAAD,IAAiC;AAC/D,QACE,CAACS,YAAY,CAACE,OAAd,IACA,IAAIC,IAAJ,GAAWC,OAAX,KAAuBJ,YAAY,CAACE,OAApC,GAA8CxB,YAFhD,EAGE;AACAa,MAAAA,KAAK,CAACE,eAAN;AACD;;AACDO,IAAAA,YAAY,CAACE,OAAb,GAAuBI,SAAvB;AACD,GARmB,EAQjB,EARiB,CAApB;AAUA,sBACE,eAAC,gBAAD;AACE,IAAA,SAAS,EAAC,0BADZ;AAEE,IAAA,WAAW,EAAEL,eAFf;AAGE,IAAA,OAAO,EAAEI,WAHX;AAIE,IAAA,KAAK,EAAEX,KAJT;AAKE,IAAA,eAAe,EAAEN,aAAa,GAAG,SAAH,GAAe;AAL/C,kBAOE,eAAC,WAAD,qBACE,eAAC,iBAAD,QACGA,aAAa,gBAAG,eAAC,eAAD,QAAkBH,IAAlB,CAAH,GAA+CA,IAD/D,CADF,eAIE,eAAC,kBAAD,QAAqBC,KAArB,CAJF,eAKE,eAAC,kBAAD;AACE,IAAA,MAAM,EAAEL,MADV;AAEE,IAAA,QAAQ,EAAEC,QAFZ;AAGE,IAAA,WAAW,EAAEE,WAHf;AAIE,IAAA,cAAc,EAAEK,qBAAqB,CAACkB,8BAAwBC,QAAzB;AAJvC,IALF,CAPF,CADF;AAsBD","sourcesContent":["import { CalendarCardPlugin } from '@ali/4ever-bamboo';\nimport { memoize } from 'lodash-es';\nimport React, {\n  CSSProperties,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { JumpToCalendarEventType } from '../type';\n\nconst {\n  TimeTextParagraph,\n  PlaceTextParagraph,\n  ReceiversParagraph,\n  ContainerWrapper,\n  BodyWrapper,\n  TimePlaceholder,\n} = CalendarCardPlugin;\n\n// 当mousedown与click之间的间隔少于150ms时认为是点击点击而不是拖动选中\nconst clickTimeout = 150;\ninterface IProps {\n  locale?: {\n    refresh: string;\n    refreshTips: string; // 日程卡片有更新\n    receiverCount: string; // 等{count}人参会\n    viewCalendardetails: string; // 查看日程详情\n    noresponse: string; // 未响应\n    received: string; // 已接收\n    refused: string; // 已拒绝\n    pending: string; // 待定\n    organizer: string; // 组织人\n  };\n  metadata: CalendarCardPlugin.CalendarCardMetadataType;\n  jumpToCalendar?: (link?: string, eventType?: JumpToCalendarEventType) => void;\n  openProfile?: (uid: number) => void;\n}\n\nexport default function FlashCalendarCardContainer(props: IProps) {\n  const { locale, metadata, jumpToCalendar, openProfile } = props;\n  const {\n    time,\n    place,\n    redirectUrl,\n    isPlaceholder,\n  } = metadata;\n  const jumpToCalendarFactory = useCallback(\n    memoize((eventType?: JumpToCalendarEventType) => {\n      return (event: React.MouseEvent<Element>) => {\n        event.preventDefault();\n        event.stopPropagation();\n        if (!jumpToCalendar) return;\n        if (isPlaceholder) return;\n        jumpToCalendar(redirectUrl, eventType);\n      };\n    }),\n    [jumpToCalendar],\n  );\n  const [style, setStyle] = useState<CSSProperties>({});\n  useEffect(() => {\n    setStyle({\n      color: isPlaceholder ? 'rgba(17,31,44,0.4)' : '',\n      height: 'auto',\n      width: 'auto',\n      border: '1px solid rgba(17,31,44,0)',\n    });\n  }, [isPlaceholder]);\n  const clickTimeRef = useRef<number | undefined>();\n  const handleMouseDown = useCallback((event: React.SyntheticEvent) => {\n    clickTimeRef.current = new Date().getTime();\n    event.stopPropagation();\n  }, []);\n  const handleClick = useCallback((event: React.SyntheticEvent) => {\n    if (\n      !clickTimeRef.current ||\n      new Date().getTime() - clickTimeRef.current > clickTimeout\n    ) {\n      event.stopPropagation();\n    }\n    clickTimeRef.current = undefined;\n  }, []);\n\n  return (\n    <ContainerWrapper\n      className=\"flash-calendar-container\"\n      onMouseDown={handleMouseDown}\n      onClick={handleClick}\n      style={style}\n      backgroundColor={isPlaceholder ? '#F9FAFC' : '#F0F7FF'}\n    >\n      <BodyWrapper>\n        <TimeTextParagraph>\n          {isPlaceholder ? <TimePlaceholder>{time}</TimePlaceholder> : time}\n        </TimeTextParagraph>\n        <PlaceTextParagraph>{place}</PlaceTextParagraph>\n        <ReceiversParagraph\n          locale={locale}\n          metadata={metadata}\n          openProfile={openProfile}\n          jumpToCalendar={jumpToCalendarFactory(JumpToCalendarEventType.RECEIVER)}\n        />\n      </BodyWrapper>\n    </ContainerWrapper>\n  );\n}\n"],"file":"FlashCalendarCardContainer.js"}