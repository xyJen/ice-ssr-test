"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _everBamboo = require("@ali/4ever-bamboo");

var _fastDeepEqual = _interopRequireDefault(require("fast-deep-equal"));

const HeadingWrapper = props => {
  const {
    controller,
    onHeadingsChange,
    children
  } = props;
  const headingsRef = React.useRef([]); // query dataValue 是为了兼容 pi 的场景

  const dataValue = controller.query('getDataValue') || controller.value;
  React.useEffect((0, _everBamboo.throttleByIdleCallback)(() => {
    const headings = (0, _everBamboo.getHeadings)(dataValue);

    if (!(0, _fastDeepEqual.default)(headings, headingsRef.current) && typeof onHeadingsChange === 'function') {
      onHeadingsChange(headings);
    }

    headingsRef.current = headings;
  }), [dataValue]);
  return children;
};

HeadingWrapper.displayName = 'HeadingWrapper';
var _default = HeadingWrapper;
exports.default = _default;
//# sourceMappingURL=HeadingWrapper.js.map