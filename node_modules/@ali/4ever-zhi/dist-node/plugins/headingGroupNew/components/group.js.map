{"version":3,"sources":["../../../../../src/plugins/headingGroupNew/components/group.tsx"],"names":["Title","Content","actions","HeadingGroupPlugin","toggleFold","ContentBox","TitleBox","TitleContent","styled","div","GroupBox","Group","props","node","controller","attributes","config","children","disableFold","fold","handleFoldChange","React","useCallback","_fold","first","nodes","run","titleNode","contentNodes","Array","isArray","length","slice","type","displayName"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AAEA;;AACA;;uBAH4B,a;AAM5B,MAAM;AACJA,EAAAA,KADI;AAEJC,EAAAA,OAFI;AAGJC,EAAAA;AAHI,IAIFC,8BAJJ;AAMA,MAAM;AAAEC,EAAAA;AAAF,IAAiBF,OAAvB;AAEA,MAAMG,UAAU,gBAAG,+BAAOJ,OAAP,CAAH,MAAhB;AAEA,MAAMK,QAAQ,gBAAG,+BAAON,KAAP,CAAH,MAAd;;AAEA,MAAMO,YAAY,gBAAGC,0BAAOC,GAAV,MAAlB;;AAEA,MAAMC,QAAQ,gBAAGF,0BAAOC,GAAV,MAAd;;AASA,MAAME,KAA2B,GAAIC,KAAD,IAAW;AAC7C,QAAM;AACJC,IAAAA,IADI;AAEJC,IAAAA,UAFI;AAGJC,IAAAA,UAHI;AAIJC,IAAAA,MAJI;AAKJC,IAAAA;AALI,MAMFL,KANJ;AAQA,QAAM;AAAEM,IAAAA,WAAW,GAAG;AAAhB,MAA0BF,MAAhC;AACA,QAAMG,IAAI,GAAG,8BAAYN,IAAZ,EAAkB,MAAlB,KAA6B,KAA1C;AAEA,QAAMO,gBAAgB,GAAGC,KAAK,CAACC,WAAN,CAAmBC,KAAD,IAAoB;AAC7D,UAAMC,KAAK,GAAGX,IAAI,CAACY,KAAL,CAAW,CAAX,CAAd;AACAX,IAAAA,UAAU,CAACY,GAAX,CAAe,UAAf,EAA2BtB,UAAU,CAAC;AACpCS,MAAAA,IAAI,EAAEW,KAD8B;AAEpCL,MAAAA,IAAI,EAAEI;AAF8B,KAAD,CAArC;AAID,GANwB,EAMtB,CAACT,UAAD,EAAaD,IAAb,CANsB,CAAzB,CAZ6C,CAoB7C;;AACA,MAAIc,SAAJ;AACA,MAAIC,YAAJ;;AAEA,MAAIC,KAAK,CAACC,OAAN,CAAcb,QAAd,KAA2BA,QAAQ,CAACc,MAAT,IAAmB,CAAlD,EAAqD;AACnDJ,IAAAA,SAAS,GAAGV,QAAQ,CAAC,CAAD,CAApB;AACAW,IAAAA,YAAY,GAAGX,QAAQ,CAACe,KAAT,CAAe,CAAf,CAAf;AACD,GAHD,MAGO;AACL,wBAAO,qCAAGf,QAAH,CAAP;AACD;;AAED,sBACE,eAAC,QAAD,6BACMF,UADN;AAEE,iBAAU,eAFZ;AAGE,iBAAWF,IAAI,CAACoB,IAHlB;AAIE,yBAJF;AAKE;AALF,mBAOE,eAAC,QAAD;AACE,IAAA,QAAQ,EAAC,qBADX;AAEE,IAAA,IAAI,EAAEd,IAFR;AAGE,IAAA,QAAQ,EAAEC,gBAHZ;AAIE,IAAA,QAAQ,EAAEF;AAJZ,kBAME,eAAC,YAAD;AAAc,iBAAU;AAAxB,KACGS,SADH,CANF,CAPF,EAiBGC,YAAY,CAACG,MAAb,GAAsB,CAAtB,iBACC,eAAC,UAAD;AAAY,IAAA,QAAQ,EAAC,uBAArB;AAA6C,IAAA,IAAI,EAAE,CAACb,WAAD,IAAgBC;AAAnE,KACGS,YADH,CAlBJ,CADF;AAyBD,CAxDD;;AA0DAjB,KAAK,CAACuB,WAAN,GAAoB,OAApB;eAEevB,K","sourcesContent":["import * as React from 'react';\nimport { Block, Controller, useUserData } from '@ali/4ever-cangjie';\nimport { FoldableHeadingData } from '@ali/4ever-mo';\nimport { HeadingGroupPlugin } from '@ali/4ever-bamboo';\nimport styled from 'styled-components';\nimport { HeadingGroupConfig } from '../types';\n\nconst {\n  Title,\n  Content,\n  actions,\n} = HeadingGroupPlugin;\n\nconst { toggleFold } = actions;\n\nconst ContentBox = styled(Content)``;\n\nconst TitleBox = styled(Title)``;\n\nconst TitleContent = styled.div``;\n\nconst GroupBox = styled.div``;\n\nexport interface GroupProps {\n  controller: Controller;\n  attributes: Record<string, string>;\n  node: Block<FoldableHeadingData>;\n  config: HeadingGroupConfig;\n}\n\nconst Group: React.FC<GroupProps> = (props) => {\n  const {\n    node,\n    controller,\n    attributes,\n    config,\n    children,\n  } = props;\n\n  const { disableFold = false } = config;\n  const fold = useUserData(node, 'fold') || false;\n\n  const handleFoldChange = React.useCallback((_fold: boolean) => {\n    const first = node.nodes[0] as Block;\n    controller.run('onAction', toggleFold({\n      node: first,\n      fold: _fold,\n    }));\n  }, [controller, node]);\n\n  // 切割议题的标题和内容块\n  let titleNode: React.ReactNode;\n  let contentNodes: React.ReactNode[];\n\n  if (Array.isArray(children) && children.length >= 1) {\n    titleNode = children[0];\n    contentNodes = children.slice(1);\n  } else {\n    return <>{children}</>;\n  }\n\n  return (\n    <GroupBox\n      {...attributes}\n      data-name=\"heading-group\"\n      data-type={node.type}\n      data-foldable\n      data-cangjie-group-block\n    >\n      <TitleBox\n        dataName=\"heading-group-title\"\n        fold={fold}\n        onChange={handleFoldChange}\n        disabled={disableFold}\n      >\n        <TitleContent data-name=\"heading-group-title-content\">\n          {titleNode}\n        </TitleContent>\n      </TitleBox>\n      {contentNodes.length > 0 && (\n        <ContentBox dataName=\"heading-group-content\" fold={!disableFold && fold}>\n          {contentNodes}\n        </ContentBox>\n      )}\n    </GroupBox>\n  );\n};\n\nGroup.displayName = 'Group';\n\nexport default Group;\n"],"file":"group.js"}