{"version":3,"sources":["../../../../../src/plugins/headingGroupNew/components/group.tsx"],"names":["React","useUserData","HeadingGroupPlugin","styled","Title","Content","actions","toggleFold","ContentBox","TitleBox","TitleContent","div","GroupBox","Group","props","node","controller","attributes","config","children","disableFold","fold","handleFoldChange","useCallback","_fold","first","nodes","run","titleNode","contentNodes","Array","isArray","length","slice","type","displayName"],"mappings":";AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;qBAC4B,a;AAA5B,SAA4BC,WAA5B,QAA+C,oBAA/C;AAEA,SAASC,kBAAT,QAAmC,mBAAnC;AACA,OAAOC,MAAP,MAAmB,mBAAnB;IAIEC,K,GAGEF,kB,CAHFE,K;IACAC,O,GAEEH,kB,CAFFG,O;IACAC,O,GACEJ,kB,CADFI,O;IAGMC,U,GAAeD,O,CAAfC,U;AAER,IAAMC,UAAU,gBAAGL,MAAM,CAACE,OAAD,CAAT,MAAhB;AAEA,IAAMI,QAAQ,gBAAGN,MAAM,CAACC,KAAD,CAAT,MAAd;AAEA,IAAMM,YAAY,gBAAGP,MAAM,CAACQ,GAAV,MAAlB;AAEA,IAAMC,QAAQ,gBAAGT,MAAM,CAACQ,GAAV,MAAd;;AASA,IAAME,KAA2B,GAAG,SAA9BA,KAA8B,CAACC,KAAD,EAAW;AAAA,MAE3CC,IAF2C,GAOzCD,KAPyC,CAE3CC,IAF2C;AAAA,MAG3CC,UAH2C,GAOzCF,KAPyC,CAG3CE,UAH2C;AAAA,MAI3CC,UAJ2C,GAOzCH,KAPyC,CAI3CG,UAJ2C;AAAA,MAK3CC,MAL2C,GAOzCJ,KAPyC,CAK3CI,MAL2C;AAAA,MAM3CC,QAN2C,GAOzCL,KAPyC,CAM3CK,QAN2C;AAAA,4BASbD,MATa,CASrCE,WATqC;AAAA,MASrCA,WATqC,oCASvB,KATuB;AAU7C,MAAMC,IAAI,GAAGpB,WAAW,CAACc,IAAD,EAAO,MAAP,CAAX,IAA6B,KAA1C;AAEA,MAAMO,gBAAgB,GAAGtB,KAAK,CAACuB,WAAN,CAAkB,UAACC,KAAD,EAAoB;AAC7D,QAAMC,KAAK,GAAGV,IAAI,CAACW,KAAL,CAAW,CAAX,CAAd;AACAV,IAAAA,UAAU,CAACW,GAAX,CAAe,UAAf,EAA2BpB,UAAU,CAAC;AACpCQ,MAAAA,IAAI,EAAEU,KAD8B;AAEpCJ,MAAAA,IAAI,EAAEG;AAF8B,KAAD,CAArC;AAID,GANwB,EAMtB,CAACR,UAAD,EAAaD,IAAb,CANsB,CAAzB,CAZ6C,CAoB7C;;AACA,MAAIa,SAAJ;AACA,MAAIC,YAAJ;;AAEA,MAAIC,KAAK,CAACC,OAAN,CAAcZ,QAAd,KAA2BA,QAAQ,CAACa,MAAT,IAAmB,CAAlD,EAAqD;AACnDJ,IAAAA,SAAS,GAAGT,QAAQ,CAAC,CAAD,CAApB;AACAU,IAAAA,YAAY,GAAGV,QAAQ,CAACc,KAAT,CAAe,CAAf,CAAf;AACD,GAHD,MAGO;AACL,wBAAO,qCAAGd,QAAH,CAAP;AACD;;AAED,sBACE,eAAC,QAAD,eACMF,UADN;AAEE,iBAAU,eAFZ;AAGE,iBAAWF,IAAI,CAACmB,IAHlB;AAIE,yBAJF;AAKE;AALF,mBAOE,eAAC,QAAD;AACE,IAAA,QAAQ,EAAC,qBADX;AAEE,IAAA,IAAI,EAAEb,IAFR;AAGE,IAAA,QAAQ,EAAEC,gBAHZ;AAIE,IAAA,QAAQ,EAAEF;AAJZ,kBAME,eAAC,YAAD;AAAc,iBAAU;AAAxB,KACGQ,SADH,CANF,CAPF,EAiBGC,YAAY,CAACG,MAAb,GAAsB,CAAtB,iBACC,eAAC,UAAD;AAAY,IAAA,QAAQ,EAAC,uBAArB;AAA6C,IAAA,IAAI,EAAE,CAACZ,WAAD,IAAgBC;AAAnE,KACGQ,YADH,CAlBJ,CADF;AAyBD,CAxDD;;AA0DAhB,KAAK,CAACsB,WAAN,GAAoB,OAApB;AAEA,eAAetB,KAAf","sourcesContent":["import * as React from 'react';\nimport { Block, Controller, useUserData } from '@ali/4ever-cangjie';\nimport { FoldableHeadingData } from '@ali/4ever-mo';\nimport { HeadingGroupPlugin } from '@ali/4ever-bamboo';\nimport styled from 'styled-components';\nimport { HeadingGroupConfig } from '../types';\n\nconst {\n  Title,\n  Content,\n  actions,\n} = HeadingGroupPlugin;\n\nconst { toggleFold } = actions;\n\nconst ContentBox = styled(Content)``;\n\nconst TitleBox = styled(Title)``;\n\nconst TitleContent = styled.div``;\n\nconst GroupBox = styled.div``;\n\nexport interface GroupProps {\n  controller: Controller;\n  attributes: Record<string, string>;\n  node: Block<FoldableHeadingData>;\n  config: HeadingGroupConfig;\n}\n\nconst Group: React.FC<GroupProps> = (props) => {\n  const {\n    node,\n    controller,\n    attributes,\n    config,\n    children,\n  } = props;\n\n  const { disableFold = false } = config;\n  const fold = useUserData(node, 'fold') || false;\n\n  const handleFoldChange = React.useCallback((_fold: boolean) => {\n    const first = node.nodes[0] as Block;\n    controller.run('onAction', toggleFold({\n      node: first,\n      fold: _fold,\n    }));\n  }, [controller, node]);\n\n  // 切割议题的标题和内容块\n  let titleNode: React.ReactNode;\n  let contentNodes: React.ReactNode[];\n\n  if (Array.isArray(children) && children.length >= 1) {\n    titleNode = children[0];\n    contentNodes = children.slice(1);\n  } else {\n    return <>{children}</>;\n  }\n\n  return (\n    <GroupBox\n      {...attributes}\n      data-name=\"heading-group\"\n      data-type={node.type}\n      data-foldable\n      data-cangjie-group-block\n    >\n      <TitleBox\n        dataName=\"heading-group-title\"\n        fold={fold}\n        onChange={handleFoldChange}\n        disabled={disableFold}\n      >\n        <TitleContent data-name=\"heading-group-title-content\">\n          {titleNode}\n        </TitleContent>\n      </TitleBox>\n      {contentNodes.length > 0 && (\n        <ContentBox dataName=\"heading-group-content\" fold={!disableFold && fold}>\n          {contentNodes}\n        </ContentBox>\n      )}\n    </GroupBox>\n  );\n};\n\nGroup.displayName = 'Group';\n\nexport default Group;\n"],"file":"group.js"}