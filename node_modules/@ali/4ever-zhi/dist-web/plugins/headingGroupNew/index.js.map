{"version":3,"sources":["../../../../src/plugins/headingGroupNew/index.ts"],"names":["GroupFactory","HeadingGroupPlugin","BambooHeadingGroupPlugin","Heading","createRenderGroup","createGenerateGroup","createRenderMark","Heading1","Heading2","Heading3","config","headingGroup","level","renderGroup","generateGroup","renderMark","autoUnfold","inject","queries","getHeadingGroupLevel","isHeadingGroupAvailable","isElementInGroup","controller","element","group","isHeading1","isHeading2","type","isHeading3","actions"],"mappings":";AAAA,SAASA,YAAT,EAAuBC,kBAAkB,IAAIC,wBAA7C,QAA6E,mBAA7E;AACA,SAASC,OAAT,QAAwB,eAAxB;AAGA,OAAOC,iBAAP;AACA,OAAOC,mBAAP;IAEQC,gB,GAAqBN,Y,CAArBM,gB;IAGNC,Q,GAGEJ,O,CAHFI,Q;IACAC,Q,GAEEL,O,CAFFK,Q;IACAC,Q,GACEN,O,CADFM,Q;;AAGF,IAAMR,kBAAkB,GAAI,SAAtBA,kBAAsB,CAAAS,MAAM,EAAI;AAAA,6BACNA,MADM,CAC5BC,YAD4B;AAAA,MAC5BA,YAD4B,qCACb,EADa;AAAA,4BAEdA,YAFc,CAE5BC,KAF4B;AAAA,MAE5BA,KAF4B,oCAEpB,CAFoB;AAGpC,SAAO;AACLC,IAAAA,WAAW,EAAET,iBAAiB,CAACO,YAAD,CADzB;AAELG,IAAAA,aAAa,EAAET,mBAAmB,CAACM,YAAD,CAF7B;AAGLI,IAAAA,UAAU,EAAET,gBAAgB,CAAC;AAC3BU,MAAAA,UAAU,EAAEL,YAAY,CAACK,UADE;AAE3BC,MAAAA,MAAM,EAAE;AAFmB,KAAD,CAHvB;AAOLC,IAAAA,OAAO;AACLC,MAAAA,oBAAoB,EAAE;AAAA,eAAMP,KAAN;AAAA,OADjB;AAELQ,MAAAA,uBAAuB,EAAE;AAAA,eAAM,IAAN;AAAA,OAFpB;AAGLC,MAAAA,gBAAgB,EAAE,0BAChBC,UADgB,EAEhBC,OAFgB,EAGhBC,KAHgB,EAIb;AACH;AACA,YAAIjB,QAAQ,CAACkB,UAAT,CAAoBF,OAApB,CAAJ,EAAkC;AAChC,iBAAO,KAAP;AACD,SAFD,MAEO,IAAIf,QAAQ,CAACkB,UAAT,CAAoBH,OAApB,CAAJ,EAAkC;AACvC,cAAIC,KAAK,CAACG,IAAN,KAAe,gBAAnB,EAAqC;AACnC,mBAAO,IAAP;AACD;;AACD,iBAAO,KAAP;AACD,SALM,MAKA,IAAIlB,QAAQ,CAACmB,UAAT,CAAoBL,OAApB,CAAJ,EAAkC;AACvC,cAAIC,KAAK,CAACG,IAAN,KAAe,gBAAf,IAAmCH,KAAK,CAACG,IAAN,KAAe,gBAAtD,EAAwE;AACtE,mBAAO,IAAP;AACD;;AACD,iBAAO,KAAP;AACD;;AACD,eAAO,IAAP;AACD;AAvBI,OAwBFzB,wBAAwB,CAACgB,OAxBvB;AAPF,GAAP;AAkCD,CArCD,C,CAuCA;;;AACAjB,kBAAkB,CAAC4B,OAAnB,GAA6B3B,wBAAwB,CAAC2B,OAAtD,C,CAEA;;AACA5B,kBAAkB,CAACiB,OAAnB,GAA6BhB,wBAAwB,CAACgB,OAAtD;AAEA,eAAejB,kBAAf","sourcesContent":["import { GroupFactory, HeadingGroupPlugin as BambooHeadingGroupPlugin } from '@ali/4ever-bamboo';\nimport { Heading } from '@ali/4ever-mo';\nimport { Controller, Element, Group } from '@ali/4ever-cangjie';\nimport { zhiGroupFactory as groupFactory } from '@ali/4ever-factory';\nimport createRenderGroup from './handlers/createRenderGroup';\nimport createGenerateGroup from './handlers/createGenerateGroup';\n\nconst { createRenderMark } = GroupFactory;\n\nconst {\n  Heading1,\n  Heading2,\n  Heading3,\n} = Heading;\n\nconst HeadingGroupPlugin = (config => {\n  const { headingGroup = {} } = config;\n  const { level = 3 } = headingGroup;\n  return {\n    renderGroup: createRenderGroup(headingGroup),\n    generateGroup: createGenerateGroup(headingGroup),\n    renderMark: createRenderMark({\n      autoUnfold: headingGroup.autoUnfold,\n      inject: true,\n    }),\n    queries: {\n      getHeadingGroupLevel: () => level,\n      isHeadingGroupAvailable: () => true,\n      isElementInGroup: (\n        controller: Controller,\n        element: Element,\n        group: Group,\n      ) => {\n        // 分组 2 只能存在于分组 1 之中\n        if (Heading1.isHeading1(element)) {\n          return false;\n        } else if (Heading2.isHeading2(element)) {\n          if (group.type === 'heading1-group') {\n            return true;\n          }\n          return false;\n        } else if (Heading3.isHeading3(element)) {\n          if (group.type === 'heading1-group' || group.type === 'heading2-group') {\n            return true;\n          }\n          return false;\n        }\n        return true;\n      },\n      ...BambooHeadingGroupPlugin.queries,\n    },\n  };\n});\n\n// @ts-ignore\nHeadingGroupPlugin.actions = BambooHeadingGroupPlugin.actions;\n\n// @ts-ignore\nHeadingGroupPlugin.queries = BambooHeadingGroupPlugin.queries;\n\nexport default HeadingGroupPlugin;\n"],"file":"index.js"}