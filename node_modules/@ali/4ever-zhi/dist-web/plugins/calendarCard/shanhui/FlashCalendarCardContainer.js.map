{"version":3,"sources":["../../../../../src/plugins/calendarCard/shanhui/FlashCalendarCardContainer.tsx"],"names":["CalendarCardPlugin","memoize","React","useCallback","useEffect","useRef","useState","JumpToCalendarEventType","TimeTextParagraph","PlaceTextParagraph","ReceiversParagraph","ContainerWrapper","BodyWrapper","TimePlaceholder","clickTimeout","FlashCalendarCardContainer","props","locale","metadata","jumpToCalendar","openProfile","time","place","redirectUrl","isPlaceholder","jumpToCalendarFactory","eventType","event","preventDefault","stopPropagation","style","setStyle","color","height","width","border","clickTimeRef","handleMouseDown","current","Date","getTime","handleClick","undefined","RECEIVER"],"mappings":"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","sourcesContent":["import { CalendarCardPlugin } from '@ali/4ever-bamboo';\nimport { memoize } from 'lodash-es';\nimport React, {\n  CSSProperties,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { JumpToCalendarEventType } from '../type';\n\nconst {\n  TimeTextParagraph,\n  PlaceTextParagraph,\n  ReceiversParagraph,\n  ContainerWrapper,\n  BodyWrapper,\n  TimePlaceholder,\n} = CalendarCardPlugin;\n\n// 当mousedown与click之间的间隔少于150ms时认为是点击点击而不是拖动选中\nconst clickTimeout = 150;\ninterface IProps {\n  locale?: {\n    refresh: string;\n    refreshTips: string; // 日程卡片有更新\n    receiverCount: string; // 等{count}人参会\n    viewCalendardetails: string; // 查看日程详情\n    noresponse: string; // 未响应\n    received: string; // 已接收\n    refused: string; // 已拒绝\n    pending: string; // 待定\n    organizer: string; // 组织人\n  };\n  metadata: CalendarCardPlugin.CalendarCardMetadataType;\n  jumpToCalendar?: (link?: string, eventType?: JumpToCalendarEventType) => void;\n  openProfile?: (uid: number) => void;\n}\n\nexport default function FlashCalendarCardContainer(props: IProps) {\n  const { locale, metadata, jumpToCalendar, openProfile } = props;\n  const {\n    time,\n    place,\n    redirectUrl,\n    isPlaceholder,\n  } = metadata;\n  const jumpToCalendarFactory = useCallback(\n    memoize((eventType?: JumpToCalendarEventType) => {\n      return (event: React.MouseEvent<Element>) => {\n        event.preventDefault();\n        event.stopPropagation();\n        if (!jumpToCalendar) return;\n        if (isPlaceholder) return;\n        jumpToCalendar(redirectUrl, eventType);\n      };\n    }),\n    [jumpToCalendar],\n  );\n  const [style, setStyle] = useState<CSSProperties>({});\n  useEffect(() => {\n    setStyle({\n      color: isPlaceholder ? 'rgba(17,31,44,0.4)' : '',\n      height: 'auto',\n      width: 'auto',\n      border: '1px solid rgba(17,31,44,0)',\n    });\n  }, [isPlaceholder]);\n  const clickTimeRef = useRef<number | undefined>();\n  const handleMouseDown = useCallback((event: React.SyntheticEvent) => {\n    clickTimeRef.current = new Date().getTime();\n    event.stopPropagation();\n  }, []);\n  const handleClick = useCallback((event: React.SyntheticEvent) => {\n    if (\n      !clickTimeRef.current ||\n      new Date().getTime() - clickTimeRef.current > clickTimeout\n    ) {\n      event.stopPropagation();\n    }\n    clickTimeRef.current = undefined;\n  }, []);\n\n  return (\n    <ContainerWrapper\n      className=\"flash-calendar-container\"\n      onMouseDown={handleMouseDown}\n      onClick={handleClick}\n      style={style}\n      backgroundColor={isPlaceholder ? '#F9FAFC' : '#F0F7FF'}\n    >\n      <BodyWrapper>\n        <TimeTextParagraph>\n          {isPlaceholder ? <TimePlaceholder>{time}</TimePlaceholder> : time}\n        </TimeTextParagraph>\n        <PlaceTextParagraph>{place}</PlaceTextParagraph>\n        <ReceiversParagraph\n          locale={locale}\n          metadata={metadata}\n          openProfile={openProfile}\n          jumpToCalendar={jumpToCalendarFactory(JumpToCalendarEventType.RECEIVER)}\n        />\n      </BodyWrapper>\n    </ContainerWrapper>\n  );\n}\n"],"file":"FlashCalendarCardContainer.js"}