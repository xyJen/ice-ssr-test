{"version":3,"sources":["../../../../src/plugins/image/image.tsx"],"names":["React","useCallback","ImagePlugin","ImageWrapper","Image","props","imageRef","useRef","controller","node","imageConfig","src","data","previewImage","useState","isLoaded","setIsLoaded","handleZoomImage","event","isParentClickable","preventDefault","stopPropagation","handlers","useMemo","onClick","cursorStyle"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,WAAhB,QAAmC,OAAnC;qBAC4B,a;AAA5B,SAASC,WAAT,QAA4B,mBAA5B;AAEA,SAASC,YAAT;;AASA,IAAMC,KAA2B,GAAG,SAA9BA,KAA8B,CAACC,KAAD,EAAW;AAC7C,MAAMC,QAAQ,GAAGN,KAAK,CAACO,MAAN,CAA+B,IAA/B,CAAjB;AAD6C,MAG3CC,UAH2C,GAIzCH,KAJyC,CAG3CG,UAH2C;AAAA,MAG/BC,IAH+B,GAIzCJ,KAJyC,CAG/BI,IAH+B;AAAA,MAGzBC,WAHyB,GAIzCL,KAJyC,CAGzBK,WAHyB;AAAA,MAKrCC,GALqC,GAK7BF,IAAI,CAACG,IALwB,CAKrCD,GALqC;AAAA,MAMrCE,YANqC,GAMpBH,WANoB,CAMrCG,YANqC;;AAAA,wBAQbb,KAAK,CAACc,QAAN,CAAe,KAAf,CARa;AAAA,MAQtCC,QARsC;AAAA,MAQ5BC,WAR4B;;AAU7C,MAAMC,eAAe,GAAGhB,WAAW,CAAC,UAACiB,KAAD,EAA6B;AAC/D,QAAIhB,WAAW,CAACiB,iBAAZ,CAA8BX,UAA9B,EAA0CC,IAA1C,CAAJ,EAAqD;AACnD;AACD;;AACDS,IAAAA,KAAK,CAACE,cAAN;AACAF,IAAAA,KAAK,CAACG,eAAN;;AACA,QAAIR,YAAJ,EAAkB;AAChBA,MAAAA,YAAY,CAACF,GAAD,EAAMF,IAAN,CAAZ;AACD;AACF,GATkC,EAShC,CAACI,YAAD,EAAeF,GAAf,EAAoBF,IAApB,EAA0BD,UAA1B,CATgC,CAAnC;AAWA,MAAMc,QAAQ,GAAGtB,KAAK,CAACuB,OAAN,CAAc,YAAM;AACnC,WAAO;AACLC,MAAAA,OAAO,EAAEP;AADJ,KAAP;AAGD,GAJgB,EAId,CAACA,eAAD,CAJc,CAAjB;AAMA,MAAMQ,WAAW,GAAG,CAAC,CAACf,WAAW,CAACG,YAAd,IAA8BE,QAA9B,GAAyC,SAAzC,GAAqD,MAAzE;AAEA,sBACE,eAAC,YAAD;AAAc,IAAA,WAAW,EAAEU;AAA3B,kBACE,eAAC,WAAD,CAAa,GAAb;AACE,IAAA,GAAG,EAAEnB,QADP;AAEE,IAAA,IAAI,EAAEG,IAFR;AAGE,IAAA,UAAU,EAAED,UAHd;AAIE,IAAA,WAAW,EAAEE;AAJf,KAKMY,QALN;AAME,IAAA,MAAM,EAAE;AAAA,aAAMN,WAAW,CAAC,IAAD,CAAjB;AAAA;AANV,KADF,CADF;AAYD,CAzCD;;AA2CA,eAAeZ,KAAf","sourcesContent":["import React, { useCallback } from 'react';\nimport { ImagePlugin } from '@ali/4ever-bamboo';\nimport { Inline, Controller } from '@ali/4ever-cangjie';\nimport { ImageWrapper } from './styled';\n\nexport interface ImageProps {\n  src: string;\n  node: Inline;\n  controller: Controller;\n  imageConfig: ImagePlugin.ImagePluginConfig;\n}\n\nconst Image: React.FC<ImageProps> = (props) => {\n  const imageRef = React.useRef<HTMLImageElement>(null);\n  const {\n    controller, node, imageConfig,\n  } = props;\n  const { src } = node.data;\n  const { previewImage } = imageConfig;\n\n  const [isLoaded, setIsLoaded] = React.useState(false);\n\n  const handleZoomImage = useCallback((event: React.MouseEvent) => {\n    if (ImagePlugin.isParentClickable(controller, node)) {\n      return;\n    }\n    event.preventDefault();\n    event.stopPropagation();\n    if (previewImage) {\n      previewImage(src, node);\n    }\n  }, [previewImage, src, node, controller]);\n\n  const handlers = React.useMemo(() => {\n    return {\n      onClick: handleZoomImage,\n    };\n  }, [handleZoomImage]);\n\n  const cursorStyle = !!imageConfig.previewImage && isLoaded ? 'zoom-in' : 'auto';\n\n  return (\n    <ImageWrapper cursorStyle={cursorStyle}>\n      <ImagePlugin.Img\n        ref={imageRef}\n        node={node}\n        controller={controller}\n        imageConfig={imageConfig}\n        {...handlers}\n        onLoad={() => setIsLoaded(true)}\n      />\n    </ImageWrapper>\n  );\n};\n\nexport default Image;\n"],"file":"image.js"}