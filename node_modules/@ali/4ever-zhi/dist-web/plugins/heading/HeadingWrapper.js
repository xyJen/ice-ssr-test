import * as React from 'react';
import { getHeadings, throttleByIdleCallback } from '@ali/4ever-bamboo';
import equal from 'fast-deep-equal';

var HeadingWrapper = function HeadingWrapper(props) {
  var controller = props.controller,
      onHeadingsChange = props.onHeadingsChange,
      children = props.children;
  var headingsRef = React.useRef([]); // query dataValue 是为了兼容 pi 的场景

  var dataValue = controller.query('getDataValue') || controller.value;
  React.useEffect(throttleByIdleCallback(function () {
    var headings = getHeadings(dataValue);

    if (!equal(headings, headingsRef.current) && typeof onHeadingsChange === 'function') {
      onHeadingsChange(headings);
    }

    headingsRef.current = headings;
  }), [dataValue]);
  return children;
};

HeadingWrapper.displayName = 'HeadingWrapper';
export default HeadingWrapper;
//# sourceMappingURL=HeadingWrapper.js.map