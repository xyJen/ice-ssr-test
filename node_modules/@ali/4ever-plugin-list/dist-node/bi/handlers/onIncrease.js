"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _isHotkey = require("is-hotkey");

var _commands = require("../commands");

var _utils = require("../utils");

const isTabHotKey = (0, _isHotkey.isKeyHotkey)('tab');

var _default = (event, controller, offset, next) => {
  const {
    value
  } = controller;
  const {
    selection
  } = value;
  const currentItems = (0, _utils.getCurrentItem)(controller);
  if (!selection || !currentItems || !(0, _utils.getSelectionInListItem)(controller)) return next();

  if (isTabHotKey(event)) {
    const firstItem = currentItems[0];
    const isAtStartOfNode = firstItem && selection.anchor.isAtStartOfNode(firstItem);
    if (!isAtStartOfNode && selection.isCollapsed) return next();
  }

  if (selection.isCollapsed) {
    event && event.preventDefault();
    return (0, _commands.increaseItemDepth)(controller, offset);
  }
  /* 判断选中多行时再批量操作 */


  const blocks = value.document.getLeafBlocksAtRange(selection);

  if (!selection.isCollapsed && blocks.length > 0) {
    event && event.preventDefault();
    return (0, _commands.increaseItemDepth)(controller, offset);
  }

  return next();
};

exports.default = _default;
//# sourceMappingURL=onIncrease.js.map