{"version":3,"sources":["../../../../src/bi/commands/list2Paragraph.ts"],"names":["list2Paragraph","controller","listSelections","value","data","currentList","length","list","forEach","element","oldData","newData","level","left","Number","ind","INDENT_SIZE","command","Commands","setNodeByKey","key"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEe,SAASA,cAAT,CAAwBC,UAAxB,EAAgD;AAC7D,QAAM;AAAEC,IAAAA;AAAF,MAAqBD,UAAU,CAACE,KAAX,CAAiBC,IAA5C;AACA,QAAMC,WAAW,GAAGH,cAAc,EAAEI,MAAhB,GAChB,oCAAwBL,UAAxB,CADgB,GAEhB,2BAAeA,UAAf,CAFJ;AAGA,QAAMG,IAAI,GAAGC,WAAW,CAAC,CAAD,CAAX,EAAgBD,IAA7B;AACA,MAAI,CAACA,IAAD,IAAS,CAACA,IAAI,CAACG,IAAnB,EAAyB,OAAON,UAAP;AAEzBI,EAAAA,WAAW,CAACG,OAAZ,CAAqBC,OAAD,IAAa;AAC/B,QAAIA,OAAO,IAAIA,OAAO,CAACL,IAAvB,EAA6B;AAC3B,YAAMM,OAAO,GAAGD,OAAO,CAACL,IAAxB;AACA,YAAMO,OAAO,GAAG,kBAAKD,OAAL,EAAc,MAAd,CAAhB,CAF2B,CAI3B;;AACA,UAAIA,OAAO,CAACH,IAAZ,EAAkB;AAChB,cAAM;AAAEK,UAAAA;AAAF,YAAYF,OAAO,CAACH,IAA1B;;AACA,YAAIK,KAAK,IAAIA,KAAK,GAAG,CAArB,EAAwB;AACtB,gBAAMC,IAAI,GAAGC,MAAM,CAACJ,OAAO,CAACK,GAAR,EAAaF,IAAd,CAAN,IAA6B,CAA1C;AACAF,UAAAA,OAAO,CAACI,GAAR,GAAc,EACZ,GAAGJ,OAAO,CAACI,GADC;AAEZF,YAAAA,IAAI,EAAED,KAAK,GAAGI,sBAAR,GAAsBH;AAFhB,WAAd;AAID;AACF;;AACDZ,MAAAA,UAAU,CAACgB,OAAX,CAAmBC,sBAASC,YAA5B,EAA0CV,OAAO,CAACW,GAAlD,EAAuD;AAAEhB,QAAAA,IAAI,EAAEO;AAAR,OAAvD;AACD;AACF,GAlBD;AAoBA,SAAOV,UAAP;AACD","sourcesContent":["import { Controller, Commands } from '@ali/4ever-cangjie';\nimport { INDENT_SIZE } from '@ali/4ever-utils';\nimport { omit } from 'lodash-es';\nimport { getCurrentItem, getListItemsBySelection } from '../utils';\n\nexport default function list2Paragraph(controller: Controller) {\n  const { listSelections } = controller.value.data;\n  const currentList = listSelections?.length\n    ? getListItemsBySelection(controller)\n    : getCurrentItem(controller);\n  const data = currentList[0]?.data;\n  if (!data || !data.list) return controller;\n\n  currentList.forEach((element) => {\n    if (element && element.data) {\n      const oldData = element.data;\n      const newData = omit(oldData, 'list');\n\n      // 列表普通段落之间切换，保持缩进\n      if (oldData.list) {\n        const { level } = oldData.list;\n        if (level && level > 0) {\n          const left = Number(oldData.ind?.left) || 0;\n          newData.ind = {\n            ...newData.ind,\n            left: level * INDENT_SIZE + left,\n          };\n        }\n      }\n      controller.command(Commands.setNodeByKey, element.key, { data: newData });\n    }\n  });\n\n  return controller;\n}\n"],"file":"list2Paragraph.js"}