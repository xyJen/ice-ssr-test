"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = list2Paragraph;

var _everCangjie = require("@ali/4ever-cangjie");

var _everUtils = require("@ali/4ever-utils");

var _lodash = require("lodash");

var _utils = require("../utils");

function list2Paragraph(controller) {
  const {
    listSelections
  } = controller.value.data;
  const currentList = listSelections?.length ? (0, _utils.getListItemsBySelection)(controller) : (0, _utils.getCurrentItem)(controller);
  const data = currentList[0]?.data;
  if (!data || !data.list) return controller;
  currentList.forEach(element => {
    if (element && element.data) {
      const oldData = element.data;
      const newData = (0, _lodash.omit)(oldData, 'list'); // 列表普通段落之间切换，保持缩进

      if (oldData.list) {
        const {
          level
        } = oldData.list;

        if (level && level > 0) {
          const left = Number(oldData.ind?.left) || 0;
          newData.ind = { ...newData.ind,
            left: level * _everUtils.INDENT_SIZE + left
          };
        }
      }

      controller.command(_everCangjie.Commands.setNodeByKey, element.key, {
        data: newData
      });
    }
  });
  return controller;
}
//# sourceMappingURL=list2Paragraph.js.map