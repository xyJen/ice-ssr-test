"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = adjustSymbolSz;

var _everCangjie = require("@ali/4ever-cangjie");

var _everPluginSz = require("@ali/4ever-plugin-sz");

var _getWholeListItemSelected = _interopRequireDefault(require("./getWholeListItemSelected"));

var _mergeListData = _interopRequireDefault(require("./mergeListData"));

function adjustSymbolSz(controller, isIncreasingSz) {
  const {
    document,
    data
  } = controller.value;
  const wholeListItemSelected = (0, _getWholeListItemSelected.default)(controller.value);
  let {
    listSelections = []
  } = data;

  if (listSelections?.length === 0 && wholeListItemSelected.length > 0) {
    listSelections = wholeListItemSelected.map(block => block.key);
  }

  listSelections && listSelections.forEach(key => {
    const node = document.getNode(key);
    const listSymbolStyle = { ...node?.data?.list?.symbolStyle
    };
    const {
      sz = controller.query('getDefaultSz', key)
    } = listSymbolStyle;
    const direction = isIncreasingSz ? 'right' : 'left';
    const newSz = (0, _everPluginSz.findNextSz)(sz, direction);
    const newStyle = {
      sz: newSz
    };
    const newData = (0, _mergeListData.default)(node.data, {
      symbolStyle: { ...listSymbolStyle,
        ...newStyle
      }
    });
    controller.command(_everCangjie.Commands.setNodeByKey, node.key, newData);
  });
}
//# sourceMappingURL=adjustSymbolSz.js.map