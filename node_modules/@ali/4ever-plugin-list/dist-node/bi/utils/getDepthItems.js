"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _everCangjie = require("@ali/4ever-cangjie");

var _getCurrentItem = _interopRequireDefault(require("./getCurrentItem"));

var _default = controller => {
  const {
    value
  } = controller;
  const {
    document
  } = value;
  const depthItems = (0, _getCurrentItem.default)(controller);
  const firstItem = depthItems[0];

  if (firstItem && firstItem.data.list) {
    const {
      listId,
      isTaskList
    } = firstItem.data.list;
    const parents = document.getParent(firstItem.key);
    const nodes = (parents || document).nodes;
    const firstItemData = nodes.find(n => {
      if (!_everCangjie.Block.isBlock(n) || !n.data.list) {
        return false;
      }

      return n.data.list.listId === listId && n.data.list.level === 0;
    }); // 这里需要判断 firstItem 是否为列表中的第一项
    // 第一项指的是 level 为 0 的第一个，如果列表中没有一项的 level 为 0，则没有第一项

    const hasFirstStart = firstItemData?.key === firstItem.key;

    if (hasFirstStart) {
      const allListItems = nodes.filter(n => _everCangjie.Block.isBlock(n) && n.data.list?.listId === listId);
      return {
        hasFirstStart,
        depthItems: isTaskList ? depthItems : allListItems
      };
    }
  }

  return {
    depthItems,
    hasFirstStart: false
  };
};

exports.default = _default;
//# sourceMappingURL=getDepthItems.js.map