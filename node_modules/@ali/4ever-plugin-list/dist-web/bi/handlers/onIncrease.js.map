{"version":3,"sources":["../../../../src/bi/handlers/onIncrease.ts"],"names":["isKeyHotkey","increaseItemDepth","getCurrentItem","getSelectionInListItem","isTabHotKey","event","controller","offset","next","value","selection","currentItems","firstItem","isAtStartOfNode","anchor","isCollapsed","preventDefault","blocks","document","getLeafBlocksAtRange","length"],"mappings":"AAEA,SAASA,WAAT,QAA4B,WAA5B;AACA,SAASC,iBAAT;AACA,SAASC,cAAT,EAAyBC,sBAAzB;AAEA,IAAMC,WAAW,GAAGJ,WAAW,CAAC,KAAD,CAA/B;AAEA,gBAAe,UACbK,KADa,EAEbC,UAFa,EAGbC,MAHa,EAIbC,IAJa,EAKE;AAAA,MACPC,KADO,GACGH,UADH,CACPG,KADO;AAAA,MAEPC,SAFO,GAEOD,KAFP,CAEPC,SAFO;AAGf,MAAMC,YAAY,GAAGT,cAAc,CAACI,UAAD,CAAnC;AACA,MAAI,CAACI,SAAD,IAAc,CAACC,YAAf,IAA+B,CAACR,sBAAsB,CAACG,UAAD,CAA1D,EAAwE,OAAOE,IAAI,EAAX;;AACxE,MAAIJ,WAAW,CAACC,KAAD,CAAf,EAAwB;AACtB,QAAMO,SAAS,GAAGD,YAAY,CAAC,CAAD,CAA9B;AACA,QAAME,eAAe,GACnBD,SAAS,IAAIF,SAAS,CAACI,MAAV,CAAiBD,eAAjB,CAAiCD,SAAjC,CADf;AAEA,QAAI,CAACC,eAAD,IAAoBH,SAAS,CAACK,WAAlC,EAA+C,OAAOP,IAAI,EAAX;AAChD;;AACD,MAAIE,SAAS,CAACK,WAAd,EAA2B;AACzBV,IAAAA,KAAK,IAAIA,KAAK,CAACW,cAAN,EAAT;AACA,WAAOf,iBAAiB,CAACK,UAAD,EAAaC,MAAb,CAAxB;AACD;AACD;;;AACA,MAAMU,MAAM,GAAGR,KAAK,CAACS,QAAN,CAAeC,oBAAf,CAAoCT,SAApC,CAAf;;AACA,MAAI,CAACA,SAAS,CAACK,WAAX,IAA0BE,MAAM,CAACG,MAAP,GAAgB,CAA9C,EAAiD;AAC/Cf,IAAAA,KAAK,IAAIA,KAAK,CAACW,cAAN,EAAT;AACA,WAAOf,iBAAiB,CAACK,UAAD,EAAaC,MAAb,CAAxB;AACD;;AACD,SAAOC,IAAI,EAAX;AACD,CA3BD","sourcesContent":["import { KeyboardEvent } from 'react';\nimport { Controller } from '@ali/4ever-cangjie';\nimport { isKeyHotkey } from 'is-hotkey';\nimport { increaseItemDepth } from '../commands';\nimport { getCurrentItem, getSelectionInListItem } from '../utils';\n\nconst isTabHotKey = isKeyHotkey('tab');\n\nexport default (\n  event: KeyboardEvent,\n  controller: Controller,\n  offset: 1 | -1,\n  next: Function,\n): Controller => {\n  const { value } = controller;\n  const { selection } = value;\n  const currentItems = getCurrentItem(controller);\n  if (!selection || !currentItems || !getSelectionInListItem(controller)) return next();\n  if (isTabHotKey(event)) {\n    const firstItem = currentItems[0];\n    const isAtStartOfNode =\n      firstItem && selection.anchor.isAtStartOfNode(firstItem);\n    if (!isAtStartOfNode && selection.isCollapsed) return next();\n  }\n  if (selection.isCollapsed) {\n    event && event.preventDefault();\n    return increaseItemDepth(controller, offset);\n  }\n  /* 判断选中多行时再批量操作 */\n  const blocks = value.document.getLeafBlocksAtRange(selection);\n  if (!selection.isCollapsed && blocks.length > 0) {\n    event && event.preventDefault();\n    return increaseItemDepth(controller, offset);\n  }\n  return next();\n};\n"],"file":"onIncrease.js"}