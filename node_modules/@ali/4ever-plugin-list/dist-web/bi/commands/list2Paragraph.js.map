{"version":3,"sources":["../../../../src/bi/commands/list2Paragraph.ts"],"names":["Commands","INDENT_SIZE","omit","getCurrentItem","getListItemsBySelection","list2Paragraph","controller","listSelections","value","data","currentList","length","list","forEach","element","oldData","newData","level","left","Number","ind","command","setNodeByKey","key"],"mappings":";AAAA,SAAqBA,QAArB,QAAqC,oBAArC;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,SAASC,IAAT,QAAqB,WAArB;AACA,SAASC,cAAT,EAAyBC,uBAAzB;AAEA,eAAe,SAASC,cAAT,CAAwBC,UAAxB,EAAgD;AAAA;;AAAA,MACrDC,cADqD,GAClCD,UAAU,CAACE,KAAX,CAAiBC,IADiB,CACrDF,cADqD;AAE7D,MAAMG,WAAW,GAAGH,cAAc,QAAd,IAAAA,cAAc,CAAEI,MAAhB,GAChBP,uBAAuB,CAACE,UAAD,CADP,GAEhBH,cAAc,CAACG,UAAD,CAFlB;AAGA,MAAMG,IAAI,oBAAGC,WAAW,CAAC,CAAD,CAAd,qBAAG,cAAgBD,IAA7B;AACA,MAAI,CAACA,IAAD,IAAS,CAACA,IAAI,CAACG,IAAnB,EAAyB,OAAON,UAAP;AAEzBI,EAAAA,WAAW,CAACG,OAAZ,CAAoB,UAACC,OAAD,EAAa;AAC/B,QAAIA,OAAO,IAAIA,OAAO,CAACL,IAAvB,EAA6B;AAC3B,UAAMM,OAAO,GAAGD,OAAO,CAACL,IAAxB;AACA,UAAMO,OAAO,GAAGd,IAAI,CAACa,OAAD,EAAU,MAAV,CAApB,CAF2B,CAI3B;;AACA,UAAIA,OAAO,CAACH,IAAZ,EAAkB;AAAA,YACRK,KADQ,GACEF,OAAO,CAACH,IADV,CACRK,KADQ;;AAEhB,YAAIA,KAAK,IAAIA,KAAK,GAAG,CAArB,EAAwB;AAAA;;AACtB,cAAMC,IAAI,GAAGC,MAAM,iBAACJ,OAAO,CAACK,GAAT,qBAAC,aAAaF,IAAd,CAAN,IAA6B,CAA1C;AACAF,UAAAA,OAAO,CAACI,GAAR,gBACKJ,OAAO,CAACI,GADb;AAEEF,YAAAA,IAAI,EAAED,KAAK,GAAGhB,WAAR,GAAsBiB;AAF9B;AAID;AACF;;AACDZ,MAAAA,UAAU,CAACe,OAAX,CAAmBrB,QAAQ,CAACsB,YAA5B,EAA0CR,OAAO,CAACS,GAAlD,EAAuD;AAAEd,QAAAA,IAAI,EAAEO;AAAR,OAAvD;AACD;AACF,GAlBD;AAoBA,SAAOV,UAAP;AACD","sourcesContent":["import { Controller, Commands } from '@ali/4ever-cangjie';\nimport { INDENT_SIZE } from '@ali/4ever-utils';\nimport { omit } from 'lodash-es';\nimport { getCurrentItem, getListItemsBySelection } from '../utils';\n\nexport default function list2Paragraph(controller: Controller) {\n  const { listSelections } = controller.value.data;\n  const currentList = listSelections?.length\n    ? getListItemsBySelection(controller)\n    : getCurrentItem(controller);\n  const data = currentList[0]?.data;\n  if (!data || !data.list) return controller;\n\n  currentList.forEach((element) => {\n    if (element && element.data) {\n      const oldData = element.data;\n      const newData = omit(oldData, 'list');\n\n      // 列表普通段落之间切换，保持缩进\n      if (oldData.list) {\n        const { level } = oldData.list;\n        if (level && level > 0) {\n          const left = Number(oldData.ind?.left) || 0;\n          newData.ind = {\n            ...newData.ind,\n            left: level * INDENT_SIZE + left,\n          };\n        }\n      }\n      controller.command(Commands.setNodeByKey, element.key, { data: newData });\n    }\n  });\n\n  return controller;\n}\n"],"file":"list2Paragraph.js"}