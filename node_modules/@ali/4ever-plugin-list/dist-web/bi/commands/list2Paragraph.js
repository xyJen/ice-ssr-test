import _extends from "@babel/runtime/helpers/extends";
import { Commands } from '@ali/4ever-cangjie';
import { INDENT_SIZE } from '@ali/4ever-utils';
import { omit } from 'lodash-es';
import { getCurrentItem, getListItemsBySelection } from "../utils";
export default function list2Paragraph(controller) {
  var _currentList$;

  var listSelections = controller.value.data.listSelections;
  var currentList = listSelections != null && listSelections.length ? getListItemsBySelection(controller) : getCurrentItem(controller);
  var data = (_currentList$ = currentList[0]) == null ? void 0 : _currentList$.data;
  if (!data || !data.list) return controller;
  currentList.forEach(function (element) {
    if (element && element.data) {
      var oldData = element.data;
      var newData = omit(oldData, 'list'); // 列表普通段落之间切换，保持缩进

      if (oldData.list) {
        var level = oldData.list.level;

        if (level && level > 0) {
          var _oldData$ind;

          var left = Number((_oldData$ind = oldData.ind) == null ? void 0 : _oldData$ind.left) || 0;
          newData.ind = _extends({}, newData.ind, {
            left: level * INDENT_SIZE + left
          });
        }
      }

      controller.command(Commands.setNodeByKey, element.key, {
        data: newData
      });
    }
  });
  return controller;
}
//# sourceMappingURL=list2Paragraph.js.map