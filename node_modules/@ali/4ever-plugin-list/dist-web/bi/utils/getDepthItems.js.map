{"version":3,"sources":["../../../../src/bi/utils/getDepthItems.ts"],"names":["Block","getCurrentItem","controller","value","document","depthItems","firstItem","data","list","listId","isTaskList","parents","getParent","key","nodes","firstItemData","find","n","isBlock","level","hasFirstStart","allListItems","filter"],"mappings":"AAAA,SAASA,KAAT,QAAkC,oBAAlC;AACA,OAAOC,cAAP;AAEA,gBAAe,UACbC,UADa,EAKV;AAAA,MACKC,KADL,GACeD,UADf,CACKC,KADL;AAAA,MAEKC,QAFL,GAEkBD,KAFlB,CAEKC,QAFL;AAGH,MAAMC,UAAU,GAAGJ,cAAc,CAACC,UAAD,CAAjC;AACA,MAAMI,SAAS,GAAGD,UAAU,CAAC,CAAD,CAA5B;;AAEA,MAAIC,SAAS,IAAIA,SAAS,CAACC,IAAV,CAAeC,IAAhC,EAAsC;AAAA,+BACLF,SAAS,CAACC,IAAV,CAAeC,IADV;AAAA,QAC5BC,MAD4B,wBAC5BA,MAD4B;AAAA,QACpBC,UADoB,wBACpBA,UADoB;AAEpC,QAAMC,OAAO,GAAGP,QAAQ,CAACQ,SAAT,CAAmBN,SAAS,CAACO,GAA7B,CAAhB;AACA,QAAMC,KAAK,GAAG,CAACH,OAAO,IAAIP,QAAZ,EAAsBU,KAApC;AACA,QAAMC,aAAa,GAAGD,KAAK,CAACE,IAAN,CAAW,UAACC,CAAD,EAAO;AACtC,UAAI,CAACjB,KAAK,CAACkB,OAAN,CAAcD,CAAd,CAAD,IAAqB,CAACA,CAAC,CAACV,IAAF,CAAOC,IAAjC,EAAuC;AACrC,eAAO,KAAP;AACD;;AACD,aAAOS,CAAC,CAACV,IAAF,CAAOC,IAAP,CAAYC,MAAZ,KAAuBA,MAAvB,IAAiCQ,CAAC,CAACV,IAAF,CAAOC,IAAP,CAAYW,KAAZ,KAAsB,CAA9D;AACD,KALqB,CAAtB,CAJoC,CAUpC;AACA;;AACA,QAAMC,aAAa,GAAG,CAAAL,aAAa,QAAb,YAAAA,aAAa,CAAEF,GAAf,MAAuBP,SAAS,CAACO,GAAvD;;AACA,QAAIO,aAAJ,EAAmB;AACjB,UAAMC,YAAY,GAAGP,KAAK,CAACQ,MAAN,CAAa,UAACL,CAAD;AAAA;;AAAA,eAAOjB,KAAK,CAACkB,OAAN,CAAcD,CAAd,KAAoB,iBAAAA,CAAC,CAACV,IAAF,CAAOC,IAAP,kCAAaC,MAAb,MAAwBA,MAAnD;AAAA,OAAb,CAArB;AACA,aAAO;AACLW,QAAAA,aAAa,EAAbA,aADK;AAELf,QAAAA,UAAU,EAAEK,UAAU,GAAGL,UAAH,GAAgBgB;AAFjC,OAAP;AAID;AACF;;AAED,SAAO;AACLhB,IAAAA,UAAU,EAAVA,UADK;AAELe,IAAAA,aAAa,EAAE;AAFV,GAAP;AAID,CArCD","sourcesContent":["import { Block, Controller } from '@ali/4ever-cangjie';\nimport getCurrentItem from './getCurrentItem';\n\nexport default (\n  controller: Controller,\n): {\n  depthItems: Array<Block | null>;\n  hasFirstStart: boolean;\n} => {\n  const { value } = controller;\n  const { document } = value;\n  const depthItems = getCurrentItem(controller);\n  const firstItem = depthItems[0];\n\n  if (firstItem && firstItem.data.list) {\n    const { listId, isTaskList } = firstItem.data.list;\n    const parents = document.getParent(firstItem.key);\n    const nodes = (parents || document).nodes;\n    const firstItemData = nodes.find((n) => {\n      if (!Block.isBlock(n) || !n.data.list) {\n        return false;\n      }\n      return n.data.list.listId === listId && n.data.list.level === 0;\n    });\n    // 这里需要判断 firstItem 是否为列表中的第一项\n    // 第一项指的是 level 为 0 的第一个，如果列表中没有一项的 level 为 0，则没有第一项\n    const hasFirstStart = firstItemData?.key === firstItem.key;\n    if (hasFirstStart) {\n      const allListItems = nodes.filter((n) => Block.isBlock(n) && n.data.list?.listId === listId) as Block[];\n      return {\n        hasFirstStart,\n        depthItems: isTaskList ? depthItems : allListItems,\n      };\n    }\n  }\n\n  return {\n    depthItems,\n    hasFirstStart: false,\n  };\n};\n"],"file":"getDepthItems.js"}