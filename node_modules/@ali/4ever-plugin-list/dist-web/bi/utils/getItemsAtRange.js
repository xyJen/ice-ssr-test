import getCurrentItem from "./getCurrentItem";
import isList from "./isList"; // 看起来已弃用，没有地方调用

export default (function (controller, range) {
  var value = controller.value;
  var valueRange = range || value.selection;

  if (!valueRange.anchor.key) {
    return [];
  }

  var document = value.document;
  var startBlock = document.getClosestBlock(valueRange.anchor.key);
  var endBlock = document.getClosestBlock(valueRange.focus.key);

  if (!startBlock || !endBlock) {
    return [];
  }

  if (startBlock === endBlock) {
    var item = getCurrentItem(controller);
    return item ? [item] : [];
  }

  var ancestor = document.getCommonAncestor(startBlock.key, endBlock.key);

  if (isList(ancestor) && ancestor) {
    var startPath = ancestor.getPath(startBlock.key);
    var endPath = ancestor.getPath(endBlock.key);

    if (startPath && endPath) {
      return ancestor.nodes.slice(startPath[0], endPath[0] + 1);
    }
  }

  if ((ancestor == null ? void 0 : ancestor.type) === 'list-item') {
    return [ancestor];
  }

  return [];
});
//# sourceMappingURL=getItemsAtRange.js.map