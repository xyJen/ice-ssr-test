import { Block } from '@ali/4ever-cangjie';
import getCurrentItem from "./getCurrentItem";
export default (function (controller) {
  var value = controller.value;
  var document = value.document;
  var depthItems = getCurrentItem(controller);
  var firstItem = depthItems[0];

  if (firstItem && firstItem.data.list) {
    var _firstItem$data$list = firstItem.data.list,
        listId = _firstItem$data$list.listId,
        isTaskList = _firstItem$data$list.isTaskList;
    var parents = document.getParent(firstItem.key);
    var nodes = (parents || document).nodes;
    var firstItemData = nodes.find(function (n) {
      if (!Block.isBlock(n) || !n.data.list) {
        return false;
      }

      return n.data.list.listId === listId && n.data.list.level === 0;
    }); // 这里需要判断 firstItem 是否为列表中的第一项
    // 第一项指的是 level 为 0 的第一个，如果列表中没有一项的 level 为 0，则没有第一项

    var hasFirstStart = (firstItemData == null ? void 0 : firstItemData.key) === firstItem.key;

    if (hasFirstStart) {
      var allListItems = nodes.filter(function (n) {
        var _n$data$list;

        return Block.isBlock(n) && ((_n$data$list = n.data.list) == null ? void 0 : _n$data$list.listId) === listId;
      });
      return {
        hasFirstStart: hasFirstStart,
        depthItems: isTaskList ? depthItems : allListItems
      };
    }
  }

  return {
    depthItems: depthItems,
    hasFirstStart: false
  };
});
//# sourceMappingURL=getDepthItems.js.map