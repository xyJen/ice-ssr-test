import logger from '@ali/4ever-logger';
import isList from "./isList";
import { getHighestSelectedBlocks } from '@ali/4ever-plugin-indent';
export default function getWholeListItemSelected(value) {
  var document = value.document,
      startBlock = value.startBlock,
      endBlock = value.endBlock;
  var selection = value.selection;
  if (!selection || !startBlock || !endBlock) return [];
  var selectedBlocks = getHighestSelectedBlocks(value);
  if (selectedBlocks.length === 0) return [];
  var startPoint = selection.getStart(document);
  var isAtStartofParagraph = startPoint.isAtStartOfNode(startBlock);
  var endPoint = selection.getEnd(document);
  var isAtEndofParagraph = endPoint.isAtEndOfNode(endBlock);
  var unWholeSelected = new Set();

  if (!isAtStartofParagraph) {
    unWholeSelected.add(selectedBlocks[0].key);
  }

  if (!isAtEndofParagraph) {
    try {
      unWholeSelected.add(selectedBlocks[selectedBlocks.length - 1].key);
    } catch (e) {
      logger.error({
        type: 'listError',
        name: 'getWholeListItemSelected',
        value: selectedBlocks[selectedBlocks.length - 1]
      });
      return [];
    }
  }

  return selectedBlocks.filter(function (block) {
    return isList(block) && !unWholeSelected.has(block.key);
  });
}
//# sourceMappingURL=getWholeListItemSelected.js.map