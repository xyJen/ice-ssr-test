{"version":3,"sources":["../../../src/utils/renderStyledListItem.tsx"],"names":["React","useMemo","useState","useEffect","styled","ListCheckBox","getSymbolRightSpace","getStickerSymbol","STICKER_REG","SYMBOL_MAGIC_OFFSET_Y_MAP","SYMBOL_MAGIC_SIZE_MAP","SELECTION_COLOR","ItemSymbolWrapper","span","props","marginRight","style","backgroundColor","isOrdered","undefined","Symbol","RenderStyledListItem","children","hideSymbol","isSelect","listSymbol","onSelectSymbol","symbolAlign","symbolStyle","taskListConfig","symbolSelected","setSymbolSelected","symbolRef","useRef","isTaskList","onSelect","String","taskListBox","isChecked","handleChange","classNames","push","symString","symStyle","wrapperStyle","transform","fontSize","parseInt","matchSticker","match","sym","symbolOverlay","symbolContent","itemSymbol","join"],"mappings":"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","sourcesContent":["import React, { PropsWithChildren, useMemo, useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { ListCheckBox } from '../component/checkbox';\nimport { getSymbolRightSpace } from './getSymbolRightSpace';\nimport getStickerSymbol from './getStickerSymbol';\nimport { STICKER_REG, SYMBOL_MAGIC_OFFSET_Y_MAP, SYMBOL_MAGIC_SIZE_MAP } from './constant';\n\nexport interface IrenderStyledListItemProps {\n  listSymbol: string | number;\n  hideSymbol: boolean;\n  isSelect?: boolean;\n  symbolAlign: string;\n  showSelection?: boolean | undefined;\n  symbolStyle: React.CSSProperties;\n  contentStyle?: React.CSSProperties;\n  onSelectSymbol?: Function;\n  clearSelection?: Function;\n  taskListConfig?: {\n    isTaskList: boolean;\n    isChecked: boolean;\n    isOrdered: boolean;\n    handleChange?: (checked: boolean) => void;\n  };\n}\n\n// TODO: import from Cangjie\nconst SELECTION_COLOR = 'rgba(1, 134, 251, 0.3)';\nconst ItemSymbolWrapper = styled.span<{\n  marginRight: number;\n  isOrdered: boolean;\n  style: React.CSSProperties;\n}>`\n  display: inline-block;\n  margin-right: ${(props) => {\n    return props.marginRight;\n  }}px;\n  white-space: nowrap;\n  &.symbol-align-right {\n    background-color: unset !important;\n    position: relative;\n    & .list-symbol {\n      background-color: ${(props) => props.style.backgroundColor || 'unset'};\n      position: absolute;\n      right: 0;\n      bottom: -0.3em;\n      line-height: 1.54;\n      transform: translateY(3px);\n    }\n  }\n  &.isSelected .list-symbol-overlay {\n    background: ${SELECTION_COLOR};\n  }\n  font-family: Arial${(props) => {\n    if (props.isOrdered === undefined) return '';\n    return props.isOrdered ? '' : '!important';\n  }};\n  line-height: 1.4;\n`;\n\nconst Symbol = styled.span`\n  width: fit-content;\n  line-height: initial;\n`;\n\nexport const RenderStyledListItem: React.FC<IrenderStyledListItemProps> = (\n  props: PropsWithChildren<IrenderStyledListItemProps>,\n) => {\n  const {\n    children,\n    hideSymbol,\n    isSelect,\n    listSymbol,\n    onSelectSymbol,\n    symbolAlign = 'left',\n    symbolStyle = {},\n    taskListConfig,\n  } = props;\n  const [symbolSelected, setSymbolSelected] = useState(false);\n  const symbolRef = React.useRef<HTMLSpanElement>(null);\n  const isTaskList = taskListConfig?.isTaskList;\n  const isOrdered = taskListConfig?.isOrdered;\n  const onSelect = () => {\n    if (!isTaskList && onSelectSymbol) {\n      onSelectSymbol(!symbolSelected);\n    }\n  };\n\n  const marginRight = useMemo(() => {\n    return isTaskList\n      ? 0\n      : getSymbolRightSpace(symbolAlign, String(listSymbol), symbolStyle);\n  }, [isTaskList, listSymbol, symbolAlign, symbolStyle]);\n\n  useEffect(() => {\n    setSymbolSelected(!!isSelect);\n  }, [isSelect]);\n\n  let taskListBox;\n  if (taskListConfig) {\n    const { isChecked, handleChange } = taskListConfig;\n    taskListBox = isTaskList && (\n      <ListCheckBox checked={isChecked} onChange={handleChange} />\n    );\n  }\n  const classNames = [`symbol-align-${symbolAlign}`];\n  if (symbolSelected) {\n    classNames.push('isSelected');\n  }\n\n  // TODO: HACK 目前无序原点垂直不居中，后续@灯少替换新的 unicode 后这里可以去掉\n  const symString = taskListBox || listSymbol;\n  const symStyle = isTaskList ? {} : symbolStyle;\n  const wrapperStyle: React.CSSProperties = { ...symStyle };\n  if (SYMBOL_MAGIC_OFFSET_Y_MAP[symString]) {\n    wrapperStyle.transform = `translateY(-${SYMBOL_MAGIC_OFFSET_Y_MAP[symString]}%)`;\n  }\n  if (SYMBOL_MAGIC_SIZE_MAP[symString]) {\n    wrapperStyle.fontSize = `${(parseInt(wrapperStyle.fontSize as string, 10) || 11) - SYMBOL_MAGIC_SIZE_MAP[symString]}pt`;\n    if (SYMBOL_MAGIC_SIZE_MAP[symString] > 2) {\n      wrapperStyle.transform = `${wrapperStyle.transform || ''} scale(0.8)`;\n    }\n  }\n\n  // const wrapperStyle = useMemo(() =>)\n  const matchSticker = symString?.match?.(STICKER_REG);\n  const sym = matchSticker ? getStickerSymbol(matchSticker[1], symStyle.fontSize as string) : symString;\n\n  const symbolOverlay = symbolSelected ? (\n    <span className=\"list-symbol-overlay\">{sym}</span>\n  ) : (\n    sym\n  );\n\n  const symbolContent =\n    symbolAlign === 'right' ? (\n      <Symbol\n        data-testid=\"list-symbol\"\n        className=\"list-symbol\"\n        style={symStyle}\n      >\n        {symbolOverlay}\n      </Symbol>\n    ) : symbolOverlay;\n\n  const itemSymbol = !hideSymbol && listSymbol !== 'undefined.' && (\n    isTaskList ? taskListBox : (\n      <ItemSymbolWrapper\n        ref={symbolRef}\n        className={classNames.join(' ')}\n        isOrdered={isOrdered!}\n        marginRight={marginRight}\n        style={wrapperStyle}\n        onMouseDown={onSelect}\n        data-testid=\"symbol-wrapper\"\n      >\n        {symbolContent}\n      </ItemSymbolWrapper>\n    )\n  );\n  return (\n    <>\n      {itemSymbol}\n      {children}\n    </>\n  );\n};\n"],"file":"renderStyledListItem.js"}