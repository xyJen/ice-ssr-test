{"version":3,"sources":["../../../../../../src/mo/serializer/htmlToJsonML/utils/msWordParseSymbol.ts"],"names":["arabic2Roma","LETTER_LIST","DEFAULT_BULLET_LIST_ARRAY","DEFAULT_NUMBER_LIST_ARRAY","symbol_text_microsoft","symbol_type_miscrosoft","CHINESE_LIST","ARABIC_LIST","ROMAN_LIST","decsMap","msWordParseSymbol","symbol","numId","level","isOrdered","start","length","includes","end","format","text","type","pointNum","match","symContent","slice","toLowerCase"],"mappings":"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","sourcesContent":["import { arabic2Roma, LETTER_LIST } from '../../../../utils/transformNumber';\nimport {\n  DEFAULT_BULLET_LIST_ARRAY,\n  DEFAULT_NUMBER_LIST_ARRAY,\n  symbol_text_microsoft,\n  symbol_type_miscrosoft,\n} from '../../../../utils/listStyleMapping';\n \nconst CHINESE_LIST = '零一二三四五六七八九十百千万亿';\nconst ARABIC_LIST = '123456789';\nconst ROMAN_LIST = 'IVXLCDM';\nconst decsMap = {\n  1: '%1.',\n  2: '%1.%2',\n  0: '%1.%2.%3',\n};\n\nexport default function msWordParseSymbol(\n  symbol: string,\n  numId: number,\n  level: number,\n  isOrdered: boolean,\n) {\n  let start = symbol[0];\n  if (symbol_text_microsoft[symbol]) {\n    return [\n      'bullet',\n      symbol_text_microsoft[symbol],\n      symbol_type_miscrosoft[symbol],\n    ];\n  }\n  if (symbol.length === 1) {\n    if (ARABIC_LIST.includes(start)) {\n      return ['decimal', '%1.', DEFAULT_NUMBER_LIST_ARRAY[2]];\n    }\n    return ['bullet', '\\u25cf', DEFAULT_BULLET_LIST_ARRAY[0]];\n  }\n  const end = symbol[symbol.length - 1];\n  let format = 'decimal';\n  let text = '%1.';\n  let type = '';\n  const pointNum = symbol.match(/\\./g)?.length;\n  if (end === '.' && pointNum === 1) {\n    const symContent = symbol.slice(0, symbol.length - 1);\n    if (\n      ARABIC_LIST.includes(start) &&\n      arabic2Roma(numId, 'lower') === symContent\n    ) {\n      format = 'decimal';\n      type = DEFAULT_NUMBER_LIST_ARRAY[0];\n    } else if (\n      ROMAN_LIST.includes(start) &&\n      arabic2Roma(numId, 'upper') === symContent\n    ) {\n      format = 'upperRoman';\n      type = DEFAULT_NUMBER_LIST_ARRAY[4];\n    } else if (ROMAN_LIST.toLowerCase().includes(start)) {\n      format = 'lowerRoman';\n      type = DEFAULT_NUMBER_LIST_ARRAY[0];\n    } else if (LETTER_LIST.includes(start)) {\n      format = 'upperLetter';\n      type = DEFAULT_NUMBER_LIST_ARRAY[3];\n    } else if (LETTER_LIST.toLowerCase().includes(start)) {\n      format = 'lowerLetter';\n      type = DEFAULT_NUMBER_LIST_ARRAY[8];\n    }\n  } else if (\n    (start !== '(' && end === ')') ||\n    (start !== '（' && end === '）')\n  ) {\n    if (ARABIC_LIST.includes(start)) {\n      format = 'decimal';\n      type = DEFAULT_NUMBER_LIST_ARRAY[1];\n    } else if (LETTER_LIST.includes(start)) {\n      format = 'upperLetter';\n      type = DEFAULT_NUMBER_LIST_ARRAY[3];\n    } else if (LETTER_LIST.toLowerCase().includes(start)) {\n      format = 'lowerLetter';\n      type = DEFAULT_NUMBER_LIST_ARRAY[10];\n    }\n    text = '%1)';\n  } else if (\n    (start === '(' && end === ')') ||\n    (start === '（' && end === '）')\n  ) {\n    const symContent = symbol.slice(1, symbol.length - 1);\n    start = symContent[0];\n    if (ARABIC_LIST.includes(start)) {\n      format = 'decimal';\n      type = DEFAULT_NUMBER_LIST_ARRAY[9];\n    } else if (CHINESE_LIST.includes(start)) {\n      format = 'chineseCountingThousand';\n      type = DEFAULT_NUMBER_LIST_ARRAY[12];\n    }\n    text = '(%1)';\n  } else if (end === '、') {\n    if (CHINESE_LIST.includes(start)) {\n      format = 'chineseCountingThousand';\n      type = DEFAULT_NUMBER_LIST_ARRAY[13];\n    }\n    text = '%1、';\n  } else if (symbol.includes('.')) {\n    if (ARABIC_LIST.includes(start)) {\n      return ['decimal', decsMap[level % 3], DEFAULT_NUMBER_LIST_ARRAY[2]];\n    }\n  } else if (isOrdered !== null) {\n    format = 'bullet';\n    text = '\\u25cf';\n    type = DEFAULT_BULLET_LIST_ARRAY[0];\n  }\n  return [format, text, type];\n}\n"],"file":"msWordParseSymbol.js"}