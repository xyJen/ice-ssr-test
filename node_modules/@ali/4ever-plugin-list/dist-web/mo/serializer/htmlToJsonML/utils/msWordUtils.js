import { getLastChild, unitsConverter, indent } from '@ali/4ever-utils';

var isElement = function isElement(ele) {
  return Array.isArray(ele) && typeof ele[0] === 'string';
}; // word一个level的缩进单位


var WORD_INDENT = 21;
/**
 * @description word缩进单位与仓颉的缩进单位不同，此函数做单位转换
 * */

export function transfromIndLeft(marginLeft, level) {
  var INDENT_SIZE = indent.size;
  var indLeft = unitsConverter.toPT(marginLeft);
  return Math.round((indLeft - (level + 1) * WORD_INDENT) / WORD_INDENT) * INDENT_SIZE;
}
/**
 * @description 移除掉word 节点中项目符号相关的文本，只保留列表内容
 * */

export function removeSymbolText(state, preTxt) {
  var parent = state.peek();
  var prevSibling = getLastChild(parent);

  if (prevSibling) {
    var asl = prevSibling.find(function (item) {
      return isElement(item);
    });
    var symbolTextTrimed = '';
    var symbolTxt = typeof asl[2] === 'string' ? asl[2] : asl[2][2];

    if (symbolTxt.indexOf(preTxt) === 0) {
      symbolTextTrimed = symbolTxt.slice(preTxt.length).trim();
    } else {
      symbolTextTrimed = symbolTxt.trim();
    }

    if (typeof asl[2] === 'string') {
      asl[2] = symbolTextTrimed;
    } else {
      asl[2][2] = symbolTextTrimed;
    }
  }
}
/**
 * @description 通过style判断是否为word列表项
 * */

export function isMsWordList(style) {
  if (!style) return false;
  return (style == null ? void 0 : style.includes('mso-list')) && style.includes('level') && style.includes('lfo');
}
//# sourceMappingURL=msWordUtils.js.map