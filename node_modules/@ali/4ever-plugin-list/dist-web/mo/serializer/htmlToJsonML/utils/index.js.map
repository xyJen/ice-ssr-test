{"version":3,"sources":["../../../../../../src/mo/serializer/htmlToJsonML/utils/index.ts"],"names":["getTagName","getAttributes","getChildren","paragraphTags","isMsWordList","transfromIndLeft","removeSymbolText","listTags","ol","ul","li","getRandomId","process","env","NODE_ENV","Math","random","toString","slice","shouldFlattenChildren","children","some","child","childTagName","getFlattenedChildren","map","index"],"mappings":";AAAA,SAEEA,UAFF,EAGEC,aAHF,EAIEC,WAJF,EAKEC,aALF,QAMO,kBANP;AAQA,SACEC,YADF,EAEEC,gBAFF,EAGEC,gBAHF;AAMA,OAAO,IAAMC,QAAgC,GAAG;AAC9CC,EAAAA,EAAE,EAAE,IAD0C;AAE9CC,EAAAA,EAAE,EAAE,IAF0C;AAG9CC,EAAAA,EAAE,EAAE;AAH0C,CAAzC,C,CAMP;;AACA,OAAO,SAASC,WAAT,GAA+B;AACpC,MAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,MAA7B,EAAqC,OAAO,MAAP;AACrC,SAAOC,IAAI,CAACC,MAAL,GAAcC,QAAd,CAAuB,EAAvB,EAA2BC,KAA3B,CAAiC,CAAjC,CAAP;AACD;AAED,OAAO,SAASC,qBAAT,CAA+BT,EAA/B,EAAoD;AACzD,MAAMU,QAAQ,GAAGlB,WAAW,CAACQ,EAAD,CAA5B;AACA,SAAOU,QAAQ,CAACC,IAAT,CAAc,UAACC,KAAD,EAA4B;AAC/C,QAAMC,YAAY,GAAGvB,UAAU,CAACsB,KAAD,CAA/B;AACA,WAAO,CAAC,CAACnB,aAAa,CAACoB,YAAD,CAAf,IAAiCA,YAAY,KAAK,OAAzD;AACD,GAHM,CAAP;AAID;AAED,OAAO,SAASC,oBAAT,CAA8Bd,EAA9B,EAAoD;AACzD,MAAMU,QAAQ,GAAGlB,WAAW,CAACQ,EAAD,CAA5B;AACA,SAAOU,QAAQ,CAACK,GAAT,CACL,UAACH,KAAD,EAAgBI,KAAhB,EAA0C;AACxC,QAAIA,KAAK,KAAK,CAAd,EAAiB;AACf,UAAI1B,UAAU,CAACsB,KAAD,CAAV,KAAsB,GAA1B,EAA+B;AAC7B,gBACE,GADF,eAGOrB,aAAa,CAAMS,EAAN,CAHpB,EAIOT,aAAa,CAAMqB,KAAN,CAJpB,UAMKpB,WAAW,CAACoB,KAAD,CANhB;AAQD;;AAED,aAAO,CACL,GADK,eAGArB,aAAa,CAAMS,EAAN,CAHb,GAKLY,KALK,CAAP;AAOD;;AACD,WAAOA,KAAP;AACD,GAvBI,CAAP;AAyBD","sourcesContent":["import {\n  JsonML,\n  getTagName,\n  getAttributes,\n  getChildren,\n  paragraphTags,\n} from '@ali/4ever-utils';\n\nexport {\n  isMsWordList,\n  transfromIndLeft,\n  removeSymbolText,\n} from './msWordUtils';\n\nexport const listTags: Record<string, string> = {\n  ol: 'ol',\n  ul: 'ul',\n  li: 'li',\n};\n\n// Refactor: 与 Bi 共用\nexport function getRandomId(): string {\n  if (process.env.NODE_ENV === 'test') return 'test';\n  return Math.random().toString(36).slice(2);\n}\n\nexport function shouldFlattenChildren(li: JsonML): boolean {\n  const children = getChildren(li);\n  return children.some((child: JsonML): boolean => {\n    const childTagName = getTagName(child);\n    return !!paragraphTags[childTagName] || childTagName === 'table';\n  });\n}\n\nexport function getFlattenedChildren(li: JsonML): JsonML[] {\n  const children = getChildren(li);\n  return children.map(\n    (child: JsonML, index: number): JsonML => {\n      if (index === 0) {\n        if (getTagName(child) === 'p') {\n          return [\n            'p',\n            {\n              ...getAttributes<any>(li),\n              ...getAttributes<any>(child),\n            },\n            ...getChildren(child),\n          ] as JsonML;\n        }\n\n        return [\n          'p',\n          {\n            ...getAttributes<any>(li),\n          },\n          child,\n        ] as JsonML;\n      }\n      return child;\n    },\n  );\n}\n"],"file":"index.js"}