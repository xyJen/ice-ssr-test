{"version":3,"sources":["../../../../src/utils/utils/getImageMaxWidth.ts"],"names":["getClosestContainerBlock","getInnerWidth","getImageMaxWidth","value","node","closestBlock","maxWidth","first","nodes","maybeImage","ind","data","text","type","key","firstLine","Math","max"],"mappings":"AACA,SAASA,wBAAT,EAAmCC,aAAnC,QAAwD,kBAAxD;AAEA,OAAO,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,KAAD,EAAeC,IAAf,EAAiC;AAC/D,MAAMC,YAAY,GAAGL,wBAAwB,CAACG,KAAD,EAAQC,IAAR,CAA7C;AACA,MAAIE,QAAQ,GAAGL,aAAa,CAACI,YAAD,CAA5B;AACA,MAAME,KAAK,GAAGF,YAAY,CAACG,KAAb,CAAmB,CAAnB,CAAd;AACA,MAAMC,UAAU,GAAGJ,YAAY,CAACG,KAAb,CAAmB,CAAnB,CAAnB;AAJ+D,MAKvDE,GALuD,GAK/CL,YAAY,CAACM,IALkC,CAKvDD,GALuD;;AAM/D,MAAIH,KAAK,CAACK,IAAN,KAAe,EAAf,IAAqBH,UAArB,IACCA,UAAU,CAACI,IAAX,KAAoB,OADrB,IAECJ,UAAU,CAACK,GAAX,MAAmBV,IAAnB,oBAAmBA,IAAI,CAAEU,GAAzB,CAFL,EAEmC;AACjC,QAAI,OAAOJ,GAAP,KAAe,QAAnB,EAA6B;AAAA,iBACDA,GAAG,IAAI,EADN;AAAA,gCACnBK,SADmB;AAAA,UACnBA,SADmB,+BACP,CADO;;AAE3BT,MAAAA,QAAQ,IAAIS,SAAZ;AACD;AACF;;AACD,SAAOC,IAAI,CAACC,GAAL,CAASX,QAAQ,GAAG,CAApB,EAAuB,CAAvB,CAAP;AACD,CAfM","sourcesContent":["import { Value, Inline } from '@ali/4ever-cangjie';\nimport { getClosestContainerBlock, getInnerWidth } from '@ali/4ever-utils';\n\nexport const getImageMaxWidth = (value: Value, node?: Inline) => {\n  const closestBlock = getClosestContainerBlock(value, node)!;\n  let maxWidth = getInnerWidth(closestBlock)!;\n  const first = closestBlock.nodes[0];\n  const maybeImage = closestBlock.nodes[1] as Inline;\n  const { ind } = closestBlock.data;\n  if (first.text === '' && maybeImage\n    && maybeImage.type === 'image'\n    && maybeImage.key === node?.key) {\n    if (typeof ind === 'object') {\n      const { firstLine = 0 } = ind || {};\n      maxWidth -= firstLine;\n    }\n  }\n  return Math.max(maxWidth - 2, 0);\n};\n"],"file":"getImageMaxWidth.js"}