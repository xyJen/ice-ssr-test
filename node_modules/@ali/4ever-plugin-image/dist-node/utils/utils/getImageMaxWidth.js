"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getImageMaxWidth = void 0;

var _everUtils = require("@ali/4ever-utils");

const getImageMaxWidth = (value, node) => {
  const closestBlock = (0, _everUtils.getClosestContainerBlock)(value, node);
  let maxWidth = (0, _everUtils.getInnerWidth)(closestBlock);
  const first = closestBlock.nodes[0];
  const maybeImage = closestBlock.nodes[1];
  const {
    ind
  } = closestBlock.data;

  if (first.text === '' && maybeImage && maybeImage.type === 'image' && maybeImage.key === node?.key) {
    if (typeof ind === 'object') {
      const {
        firstLine = 0
      } = ind || {};
      maxWidth -= firstLine;
    }
  }

  return Math.max(maxWidth - 2, 0);
};

exports.getImageMaxWidth = getImageMaxWidth;
//# sourceMappingURL=getImageMaxWidth.js.map