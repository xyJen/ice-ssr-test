{"version":3,"sources":["../../../../src/utils/utils/getImageMaxWidth.ts"],"names":["getImageMaxWidth","value","node","closestBlock","maxWidth","first","nodes","maybeImage","ind","data","text","type","key","firstLine","Math","max"],"mappings":";;;;;;;AACA;;AAEO,MAAMA,gBAAgB,GAAG,CAACC,KAAD,EAAeC,IAAf,KAAiC;AAC/D,QAAMC,YAAY,GAAG,yCAAyBF,KAAzB,EAAgCC,IAAhC,CAArB;AACA,MAAIE,QAAQ,GAAG,8BAAcD,YAAd,CAAf;AACA,QAAME,KAAK,GAAGF,YAAY,CAACG,KAAb,CAAmB,CAAnB,CAAd;AACA,QAAMC,UAAU,GAAGJ,YAAY,CAACG,KAAb,CAAmB,CAAnB,CAAnB;AACA,QAAM;AAAEE,IAAAA;AAAF,MAAUL,YAAY,CAACM,IAA7B;;AACA,MAAIJ,KAAK,CAACK,IAAN,KAAe,EAAf,IAAqBH,UAArB,IACCA,UAAU,CAACI,IAAX,KAAoB,OADrB,IAECJ,UAAU,CAACK,GAAX,KAAmBV,IAAI,EAAEU,GAF9B,EAEmC;AACjC,QAAI,OAAOJ,GAAP,KAAe,QAAnB,EAA6B;AAC3B,YAAM;AAAEK,QAAAA,SAAS,GAAG;AAAd,UAAoBL,GAAG,IAAI,EAAjC;AACAJ,MAAAA,QAAQ,IAAIS,SAAZ;AACD;AACF;;AACD,SAAOC,IAAI,CAACC,GAAL,CAASX,QAAQ,GAAG,CAApB,EAAuB,CAAvB,CAAP;AACD,CAfM","sourcesContent":["import { Value, Inline } from '@ali/4ever-cangjie';\nimport { getClosestContainerBlock, getInnerWidth } from '@ali/4ever-utils';\n\nexport const getImageMaxWidth = (value: Value, node?: Inline) => {\n  const closestBlock = getClosestContainerBlock(value, node)!;\n  let maxWidth = getInnerWidth(closestBlock)!;\n  const first = closestBlock.nodes[0];\n  const maybeImage = closestBlock.nodes[1] as Inline;\n  const { ind } = closestBlock.data;\n  if (first.text === '' && maybeImage\n    && maybeImage.type === 'image'\n    && maybeImage.key === node?.key) {\n    if (typeof ind === 'object') {\n      const { firstLine = 0 } = ind || {};\n      maxWidth -= firstLine;\n    }\n  }\n  return Math.max(maxWidth - 2, 0);\n};\n"],"file":"getImageMaxWidth.js"}