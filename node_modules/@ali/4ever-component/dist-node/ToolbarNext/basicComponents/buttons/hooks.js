"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useRecentColors = void 0;

var _react = _interopRequireDefault(require("react"));

const useRecentColors = () => {
  const RECENT_COLOR_STORAGE_KEY = 'toolbar-recent-color';
  const recentColorsStorage = localStorage.getItem(RECENT_COLOR_STORAGE_KEY);
  let initRecentColors;

  try {
    initRecentColors = recentColorsStorage ? JSON.parse(recentColorsStorage) : [];
  } catch {
    initRecentColors = [];
  }

  const [recentColors, setRecentColors] = _react.default.useState(initRecentColors);

  _react.default.useEffect(() => {
    try {
      localStorage.setItem(RECENT_COLOR_STORAGE_KEY, JSON.stringify(recentColors));
    } catch (e) {
      // 空间不足
      console.error(e);
    }
  }, [recentColors]);

  _react.default.useEffect(() => {
    setRecentColors(initRecentColors);
  }, [recentColorsStorage]);

  const addRecentColor = color => {
    const newRecentColors = Array.from(new Set([color, ...recentColors])).splice(0, 10);
    setRecentColors(newRecentColors);
  };

  return [recentColors, addRecentColor];
};

exports.useRecentColors = useRecentColors;
//# sourceMappingURL=hooks.js.map