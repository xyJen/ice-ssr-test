"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = useContentScroll;

var _react = _interopRequireDefault(require("react"));

var _everCangjie = require("@ali/4ever-cangjie");

var _constant = require("../constant");

// 在打开二级浮出菜单、底部二级面板时候，处理正文的滚动，避免光标被遮挡
function useContentScroll(subLine, panelItem, controller, top) {
  const content = (0, _everCangjie.useScrollableContent)();
  const container = (0, _everCangjie.useScrollableContainer)();

  _react.default.useEffect(() => {
    let visualHeight = 0;

    if (subLine) {
      visualHeight = top - _constant.SUBLINE_MARGIN_BOTTOM;
    } else if (panelItem) {
      visualHeight = top + _constant.BOTTOM_BAR_SIZE;
    } // @ts-ignore


    window._visualHeight = visualHeight;
    return () => {
      // @ts-ignore
      window._visualHeight = 0;
    };
  }, [panelItem, subLine, top]);

  _react.default.useEffect(() => {
    if (subLine) {
      const {
        selection
      } = controller.value;
      const defaultEle = window.document.documentElement;
      const cnt = content || defaultEle;
      const scroller = (container instanceof Window ? defaultEle : container) || defaultEle;

      _everCangjie.domUtils.scrollToSelection(selection, cnt, scroller, controller);
    }
  }, [subLine, controller, content, container]);
}
//# sourceMappingURL=useContentScroll.js.map