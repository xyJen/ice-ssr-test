{"version":3,"sources":["../../../src/leftToolbar/LeftToolbar.tsx"],"names":["isEnterHotKey","mouseMoveHandler","event","container","updateHoverBlock","controller","contains","target","blockKey","block","value","document","getNode","type","getParent","Block","isBlock","LeftToolbar","props","config","getScrollableContent","initController","Controller","useController","plugins","window","body","isMoveDisabled","React","useRef","focusBlock","selection","state","actions","preventMouseMove","isPreventMouseMove","canLeftToolbarVisibleRef","zoom","current","disable","query","node","position","undefined","offsetWithFocus","error","logger","warn","offset","fixedPosition","right","Number","x","top","y","onKeyDown","onScroll","handleMouseMove","onMouseMove","shouldDisabledLeftToolbar","handleCustomEvent","useCallback","e","enable","clear","detail","addEventListener","LEGAL_EVENT","leftToolbarEnable","removeEventListener","arrays","array","listenerArrays","reduce","arr","p","leftToolbarHandlers","push","handler","cancel","getHandler","forEach","la","splice","indexOf","renderToolBtn","map","item","btn","plugin","hash","key","leftToolbar","ToolBtn","ReactDOM","createPortal"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback, useMemo } from 'react';\nimport ReactDOM from 'react-dom';\nimport { throttle } from 'lodash-es';\nimport { Controller, Block, useZoom, BiPlugin, ScrollableContentContext } from '@ali/4ever-cangjie';\nimport logger from '@ali/4ever-logger';\nimport { usePlugins } from '../PluginsContext';\nimport findBlockKeyFromEvent from './utils/findBlockKeyFromEvent';\nimport calcCurrentPos from './utils/calcCurrentPos';\nimport { LeftToolbarWrapper } from './styled';\nimport { useLeftToolbar, LeftToolbarProvider } from './leftToolbarContext';\nimport { LEGAL_EVENT } from '@ali/4ever-utils';\nimport { isKeyHotkey } from 'is-hotkey';\n\nconst isEnterHotKey = isKeyHotkey('enter');\n\ninterface ToolbarBtn {\n  /**\n   * 对应的 plugin key\n   */\n  key: string;\n  /**\n   * 可以支持自定义工具栏按钮\n   */\n  btn?: JSX.Element;\n  // 偏移\n  offset?: number;\n}\n\n// 需要支持配置项传入， 这样可以给后面拆出拖拽提供可能性, 还可以在配置项中控制宽高\ninterface ILeftToolbarProps {\n  config: ToolbarBtn[];\n  getScrollableContent: () => HTMLElement;\n  controller: Controller;\n}\n\nconst mouseMoveHandler = (event, container, updateHoverBlock, controller) => {\n  if (!container.contains(event.target)) {\n    updateHoverBlock();\n    return;\n  }\n  const blockKey = findBlockKeyFromEvent(event, container, controller);\n  let block = controller.value.document.getNode(blockKey);\n  // 如果leftToolbar的findBlockKeyFromEvent没有找到对应block，则再通过hoverBlock的方法进行查找\n  // TODO 两套方法各自维护一套findBlockKeyFromEvent方法，后面需要统一\n  if (block?.type === 'line') {\n    block = controller.value.document.getParent(blockKey);\n  }\n  if (Block.isBlock(block)) {\n    updateHoverBlock(block);\n  }\n};\n\nconst LeftToolbar: React.FC<ILeftToolbarProps> = (props) => {\n  const { config, getScrollableContent, controller: initController } = props;\n\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  const controller = initController || Controller.useController();\n  const plugins = usePlugins();\n  const container = getScrollableContent() || window.document.body;\n  const isMoveDisabled = React.useRef(false);\n  const { focusBlock, selection } = controller.value;\n  const [state, actions] = useLeftToolbar();\n  const { block, preventMouseMove } = state;\n  const isPreventMouseMove = React.useRef(preventMouseMove);\n  const canLeftToolbarVisibleRef = React.useRef(true);\n  const zoom = useZoom();\n  isPreventMouseMove.current = preventMouseMove;\n\n  const disable = controller.query('disableLeftToolbar', { node: block! });\n\n  const position = useMemo(() => {\n    if (!block) return undefined;\n    // 插件检测是否需要偏移\n    return calcCurrentPos(block, container)!;\n  }, [block, container, controller]);\n\n  const offsetWithFocus = useMemo(() => {\n    if (!block) return undefined;\n    // 用于表格的场景，在focus的时候也要精确位置计算\n    // query 过程中 controller 可能会变为 undefined\n    try {\n      return controller.query('getLeftToolbarOffsetWithFocus', { node: block });\n    } catch (error) {\n      logger.warn(error as Error);\n    }\n    return undefined;\n  }, [block, controller, focusBlock]);\n\n  const offset = useMemo(() => {\n    if (!block) return undefined;\n    // query 过程中 controller 可能会变为 undefined\n    try {\n      return controller.query('getLeftToolbarOffset', { node: block });\n    } catch (error) {\n      logger.warn(error as Error);\n    }\n    return undefined;\n  }, [block, controller]);\n\n  const fixedPosition = useMemo(() => {\n    const value = offsetWithFocus || offset;\n    return value ? {\n      ...position,\n      right: (Number(position?.right) - value.x || 0),\n      // @ts-ignore\n      top: position?.top + value.y || 0,\n    } : position;\n  }, [position, offset, offsetWithFocus]);\n\n  const onKeyDown = useCallback((event: KeyboardEvent) => {\n    if (isEnterHotKey(event)) {\n      actions.updateHoverBlock();\n    }\n  }, [actions]);\n\n  const onScroll = useCallback(throttle(() => {\n    if (isPreventMouseMove.current) return;\n    actions.updateHoverBlock();\n  }, 1000), [actions]);\n\n  const handleMouseMove = useCallback(throttle(mouseMoveHandler, 50), []);\n\n  // 确保依赖是稳定的，不然会频繁监听和卸载事件监听\n  const onMouseMove = useCallback((event: MouseEvent) => {\n    // 如果外部组件比如SelectionBar设置了需要禁用左侧工具栏，则需要将左侧工具栏隐藏\n    // 浮动工具栏显示到时候需要隐藏掉左侧工具栏按钮\n    const shouldDisabledLeftToolbar = !canLeftToolbarVisibleRef.current;\n    if (isPreventMouseMove.current || isMoveDisabled.current || shouldDisabledLeftToolbar) {\n      if (shouldDisabledLeftToolbar) {\n        actions.updateHoverBlock();\n      }\n      return;\n    }\n    handleMouseMove(event, container, actions.updateHoverBlock, controller);\n  }, [handleMouseMove, container, actions.updateHoverBlock, controller]);\n\n  // 提供一个对外的事件，方便操作左侧工具栏的状态，原先leftToolbarHandlers的方式过于复杂\n  const handleCustomEvent = React.useCallback((e: any) => {\n    const { enable, clear } = e.detail;\n    if (clear) {\n      actions.updateHoverBlock();\n    }\n    canLeftToolbarVisibleRef.current = enable;\n  }, [actions.updateHoverBlock]);\n\n  useEffect(() => {\n    actions.updateHoverBlock();\n  }, [zoom, actions.updateHoverBlock]);\n\n  useEffect(() => {\n    // 新的产品逻辑要求输入的时候左侧工具栏不隐藏\n    window.document.addEventListener('mousemove', onMouseMove);\n    window.document.addEventListener('keydown', onKeyDown);\n    window.document.addEventListener('scroll', onScroll, true);\n    window.document.body.addEventListener(LEGAL_EVENT.leftToolbarEnable, handleCustomEvent);\n    return () => {\n      window.document.removeEventListener('mousemove', onMouseMove);\n      window.document.removeEventListener('keydown', onKeyDown);\n      window.document.removeEventListener('scroll', onScroll, true);\n      window.document.body.removeEventListener(LEGAL_EVENT.leftToolbarEnable, handleCustomEvent);\n    };\n  }, [onMouseMove, handleCustomEvent, onKeyDown, onScroll]);\n\n  // 把拖拽的临时启动、禁用，提供给外部使用。\n  // 其他可能与拖拽冲突的插件，就可以控制拖拽杆的禁用、隐藏。\n  useEffect(() => {\n    const arrays = plugins?.array || [];\n    const listenerArrays = arrays.reduce<Function[][]>((arr, p) => {\n      // @ts-ignore\n      const array = p?.leftToolbarHandlers as Function[] | undefined;\n      if (array) {\n        arr.push(array);\n      }\n      return arr;\n    }, []);\n    const handler = {\n      disable: () => {\n        actions.updateHoverBlock();\n        handleMouseMove.cancel();\n        isMoveDisabled.current = true;\n      },\n      enable: () => {\n        isMoveDisabled.current = false;\n      },\n      clear: () => {\n        actions.updateHoverBlock();\n        isMoveDisabled.current = false;\n      },\n    };\n    const getHandler = () => {\n      return handler;\n    };\n    listenerArrays.forEach((la) => la.push(getHandler));\n    return () => {\n      listenerArrays.forEach((la) => la.splice(la.indexOf(getHandler), 1));\n    };\n  }, [actions, plugins, controller, handleMouseMove]);\n\n  const renderToolBtn = useMemo(() => {\n    if (!plugins || !block || !config) {\n      return null;\n    }\n    return config.map((item) => {\n      if (item.btn) {\n        return item.btn;\n      }\n      const plugin = plugins?.hash[item.key] as BiPlugin | undefined;\n      if (plugin && plugin.leftToolbar) {\n        const ToolBtn = plugin.leftToolbar;\n        return (\n          <ToolBtn\n            key={`${item.key}_${block.key}`}\n            controller={controller}\n            currentBlock={block}\n          />\n        );\n      }\n      return null;\n    });\n  }, [plugins, block, config, controller, selection]);\n\n  if (!renderToolBtn || disable) return null;\n\n  return (\n    <LeftToolbarWrapper style={fixedPosition}>\n      {renderToolBtn}\n    </LeftToolbarWrapper>\n  );\n};\n\nexport default (props: ILeftToolbarProps) => {\n  const { getScrollableContent } = props;\n  const container = getScrollableContent?.() || window.document.body;\n  return ReactDOM.createPortal(\n    <ScrollableContentContext.Provider value={container}>\n      <LeftToolbarProvider>\n        <LeftToolbar {...props} />\n      </LeftToolbarProvider>\n    </ScrollableContentContext.Provider>\n    , container,\n  );\n};\n"],"file":"LeftToolbar.js"}