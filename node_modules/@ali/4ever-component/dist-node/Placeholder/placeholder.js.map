{"version":3,"sources":["../../../src/Placeholder/placeholder.tsx"],"names":["Placeholder","React","Component","constructor","props","placeholderRef","isSelected","editor","isCollapsed","value","selection","renderText","node","name","data","placeholderText","createRef","shouldComponentUpdate","nextProps","isChange","render","attributes","handleRemoveNode","text","isCurrSelected","current"],"mappings":";;;;;;;;;;;AACA;;AACA;;AACA;;AACA;;uBAH4B,a;;AAgBrB,MAAMA,WAAN,SAA0BC,eAAMC,SAAhC,CAAkD;AAGvDC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AADiB,SAFnBC,cAEmB;;AAAA,SAwBnBC,UAxBmB,GAwBN,MAAM;AACjB,YAAM;AAAEA,QAAAA,UAAF;AAAcC,QAAAA;AAAd,UAAyB,KAAKH,KAApC;AACA,YAAM;AAAEI,QAAAA;AAAF,UAAkBD,MAAM,CAACE,KAAP,CAAaC,SAArC;AACA,aAAOJ,UAAU,IAAIE,WAArB;AACD,KA5BkB;;AAAA,SA8BnBG,UA9BmB,GA8BN,MAAM;AACjB,YAAM;AAAEA,QAAAA,UAAF;AAAcC,QAAAA;AAAd,UAAuB,KAAKR,KAAlC;AACA,YAAM;AAAES,QAAAA;AAAF,UAAWD,IAAI,CAACE,IAAtB;AACA,UAAIC,eAAe,GAAG,EAAtB;;AACA,UAAI,OAAOJ,UAAP,KAAsB,UAA1B,EAAsC;AACpCI,QAAAA,eAAe,GAAGJ,UAAU,CAACE,IAAD,CAA5B;AACD;;AACD,aAAOE,eAAe,IAAK,GAAEF,IAAI,IAAI,EAAG,OAAxC;AACD,KAtCkB;;AAEjB,SAAKR,cAAL,gBAAsBJ,eAAMe,SAAN,EAAtB;AACD;;AAEDC,EAAAA,qBAAqB,CAACC,SAAD,EAA8B;AACjD,UAAM;AAAEd,MAAAA;AAAF,QAAY,IAAlB;AACA,UAAMe,QAAQ,GAAG,CAAC,qBAChB;AACEb,MAAAA,UAAU,EAAEY,SAAS,CAACZ,UADxB;AAEEE,MAAAA,WAAW,EAAEU,SAAS,CAACX,MAAV,CAAiBE,KAAjB,CAAuBC,SAAvB,CAAiCF,WAFhD;AAGEG,MAAAA,UAAU,EAAEO,SAAS,CAACP,UAHxB;AAIEC,MAAAA,IAAI,EAAEM,SAAS,CAACN;AAJlB,KADgB,EAOhB;AACEN,MAAAA,UAAU,EAAEF,KAAK,CAACE,UADpB;AAEEE,MAAAA,WAAW,EAAEJ,KAAK,CAACG,MAAN,CAAaE,KAAb,CAAmBC,SAAnB,CAA6BF,WAF5C;AAGEG,MAAAA,UAAU,EAAEP,KAAK,CAACO,UAHpB;AAIEC,MAAAA,IAAI,EAAER,KAAK,CAACQ;AAJd,KAPgB,CAAlB;AAcA,WAAOO,QAAP;AACD;;AAkBDC,EAAAA,MAAM,GAAG;AACP,UAAM;AAAEC,MAAAA,UAAF;AAAcf,MAAAA,UAAd;AAA0BgB,MAAAA;AAA1B,QAA+C,KAAKlB,KAA1D;AACA,UAAMmB,IAAI,GAAG,KAAKZ,UAAL,EAAb;AACA,UAAMa,cAAc,GAAG,KAAKlB,UAAL,EAAvB;AACA,wBACE,eAAC,cAAD,CAAO,QAAP,QACGkB,cAAc,gBACb,eAAC,iCAAD;AACE,MAAA,uBAAuB,EAAEF,gBAD3B;AAEE,MAAA,WAAW,EAAE,KAAKjB,cAAL,CAAoBoB;AAFnC,MADa,GAIR,IALT,eAME,eAAC,qCAAD;AACE,MAAA,GAAG,EAAE,KAAKpB;AADZ,OAEMgB,UAFN;AAGE,MAAA,UAAU,EAAEf,UAHd;AAIE,MAAA,KAAK,EAAEiB;AAJT,QAMGA,IANH,CANF,CADF;AAiBD;;AAhEsD","sourcesContent":["import { Controller } from '@ali/4ever-cangjie';\nimport React from 'react';\nimport PlaceholderInlineToolbar from './PlaceholderInlineToolbar';\nimport { isEqual } from 'lodash-es';\nimport { PlaceholderWrapper } from './bambooPlaceholder';\n\ninterface IProps {\n  handleRemoveNode: () => void;\n  editor: Controller;\n  renderText?: (name: string) => string;\n  node: any;\n  attributes: any;\n  isSelected: boolean;\n  scrollableContainer?: HTMLElement;\n  locale?: Record<string, any>;\n}\n\nexport class Placeholder extends React.Component<IProps> {\n  placeholderRef: React.RefObject<any>;\n\n  constructor(props) {\n    super(props);\n    this.placeholderRef = React.createRef();\n  }\n\n  shouldComponentUpdate(nextProps: Readonly<IProps>) {\n    const { props } = this;\n    const isChange = !isEqual(\n      {\n        isSelected: nextProps.isSelected,\n        isCollapsed: nextProps.editor.value.selection.isCollapsed,\n        renderText: nextProps.renderText,\n        node: nextProps.node,\n      },\n      {\n        isSelected: props.isSelected,\n        isCollapsed: props.editor.value.selection.isCollapsed,\n        renderText: props.renderText,\n        node: props.node,\n      },\n    );\n    return isChange;\n  }\n\n  isSelected = () => {\n    const { isSelected, editor } = this.props;\n    const { isCollapsed } = editor.value.selection;\n    return isSelected && isCollapsed;\n  };\n\n  renderText = () => {\n    const { renderText, node } = this.props;\n    const { name } = node.data;\n    let placeholderText = '';\n    if (typeof renderText === 'function') {\n      placeholderText = renderText(name);\n    }\n    return placeholderText || `${name || ''}暂无法解析`;\n  };\n\n  render() {\n    const { attributes, isSelected, handleRemoveNode } = this.props;\n    const text = this.renderText();\n    const isCurrSelected = this.isSelected();\n    return (\n      <React.Fragment>\n        {isCurrSelected ?\n          <PlaceholderInlineToolbar\n            handleRemovePlaceholder={handleRemoveNode}\n            triggerNode={this.placeholderRef.current}\n          /> : null}\n        <PlaceholderWrapper\n          ref={this.placeholderRef}\n          {...attributes}\n          isSelected={isSelected}\n          title={text}\n        >\n          {text}\n        </PlaceholderWrapper>\n      </React.Fragment>\n    );\n  }\n}\n"],"file":"placeholder.js"}