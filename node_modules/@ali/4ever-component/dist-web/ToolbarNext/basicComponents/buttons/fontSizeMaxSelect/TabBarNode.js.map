{"version":3,"sources":["../../../../../../src/ToolbarNext/basicComponents/buttons/fontSizeMaxSelect/TabBarNode.tsx"],"names":["React","Component","fastdom","ArrowIconDown","classnames","setTransform","noop","NavContainer","NavWrap","Nav","PrevButton","NextButton","TabBarNode","props","offset","lastNextPrevShown","lastWheelDirection","tabList","tabSizeMap","wrapperOffsetWH","wrapperScrollWH","prevTransitionEnd","e","propertyName","container","getRef","scrollToActiveTab","target","currentTarget","activeTab","navWrap","needToScroll","isNextPrevShown","activeTabWH","getScrollWH","navWrapNodeWH","getOffsetWH","wrapOffset","getOffsetLT","activeTabOffset","setOffset","setNextPrev","minOffset","maxOffset","newOffset","Math","min","max","prev","onPrevClick","navWrapNode","next","onNextClick","handleWheel","deltaX","deltaY","mixed","absX","abs","absY","preventDefault","handleResize","measure","wrapper","tabs","offsetWidth","scrollWidth","getTabList","panes","Children","forEach","child","isValidElement","push","key","tab","updateTabSizes","activeKey","Map","Promise","resolve","btnNode","set","width","height","offsetHeight","left","offsetLeft","top","offsetTop","getPrevNext","state","testid","showNextPrev","prevCallback","nextCallback","prevButton","undefined","disabled","show","transform","transformOrigin","nextButton","excessTabsHelper","visibleStart","visibleEnd","componentDidMount","componentDidUpdate","navWrapper","addEventListener","prevProps","then","nextPrev","setState","componentWillUnmount","removeEventListener","navNode","navNodeWH","containerWH","mutate","realOffset","setNext","setPrev","node","getBoundingClientRect","navOffset","navStyle","style","value","v","render","children","saveRef","scrolling","defaultProps","prefixCls"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport fastdom from 'fastdom';\nimport { ArrowIconDown } from './icon';\nimport classnames from 'classnames';\nimport { setTransform, noop, ITabsProps, ISaveRef, IGetRef } from './utils';\nimport {\n  NavContainer,\n  NavWrap,\n  Nav,\n  PrevButton,\n  NextButton,\n} from './style';\nimport { ITabPaneProps } from './TabPane';\n\ninterface ITabBarNodeProps extends ITabsProps {\n  saveRef: ISaveRef;\n  getRef: IGetRef;\n  panes: React.ReactNode;\n}\n\ninterface ITabBarNodeState {\n  next: boolean;\n  prev: boolean;\n  visibleStart: number;\n  visibleEnd: number;\n}\n\ninterface TabSize {\n  width: number;\n  height: number;\n  left: number;\n  top: number;\n}\n\ntype TabSizeMap = Map<React.Key, TabSize>;\n\nexport default class TabBarNode extends Component<\nITabBarNodeProps,\nITabBarNodeState\n> {\n  static defaultProps = {\n    prefixCls: '',\n    onPrevClick: noop,\n    onNextClick: noop,\n  };\n\n  private offset: number;\n\n  private lastNextPrevShown: any;\n\n  private lastWheelDirection: 'x' | 'y' | undefined;\n\n  private readonly tabList: Array<{ key: React.Key; tab: React.ReactNode }>;\n\n  private tabSizeMap: TabSizeMap;\n\n  private wrapperOffsetWH = 0;\n  private wrapperScrollWH = 0;\n\n  constructor(props: ITabBarNodeProps) {\n    super(props);\n    this.offset = 0;\n    this.tabList = [];\n    this.tabSizeMap = new Map();\n    this.state = {\n      next: false,\n      prev: false,\n      visibleStart: 0,\n      visibleEnd: 0,\n    };\n  }\n\n  componentDidMount() {\n    const { getRef } = this.props;\n    this.componentDidUpdate();\n    const navWrapper = getRef('navWrap');\n    if (navWrapper) {\n      navWrapper.addEventListener('wheel', this.handleWheel);\n    }\n  }\n\n  componentDidUpdate(prevProps?: any) {\n    const { props } = this;\n    this.setNextPrev().then((nextPrev: any) => {\n      // wait next, prev show hide\n      if (this.isNextPrevShown(this.state) !== this.isNextPrevShown(nextPrev)) {\n        this.setState({}, this.scrollToActiveTab);\n      } else if (!prevProps || props.activeKey !== prevProps.activeKey) {\n        this.scrollToActiveTab();\n      }\n    });\n\n    if (!prevProps) {\n      this.updateTabSizes().then(() => {\n        this.handleResize();\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    const { getRef } = this.props;\n    const navWrapper = getRef('navWrap');\n    if (navWrapper) {\n      navWrapper.removeEventListener('wheel', this.handleWheel);\n    }\n  }\n\n  /**\n   * 检测左右按钮的激活状态，并调整 offset\n   */\n  setNextPrev() {\n    return new Promise((resolve) => {\n      fastdom.measure(() => {\n        const { getRef } = this.props;\n        const navNode = getRef('nav');\n        const navNodeWH = this.getScrollWH(navNode);\n        // Add 1px to fix `offsetWidth` with decimal in Chrome not correct handle\n        const containerWH = this.getOffsetWH(getRef('container')) + 1;\n        const navWrapNodeWH = this.getOffsetWH(getRef('navWrap'));\n\n        fastdom.mutate(() => {\n          let { offset } = this;\n          const minOffset = containerWH - navNodeWH;\n          let { next, prev } = this.state;\n\n          if (minOffset >= 0) {\n            next = false;\n            this.setOffset(0);\n            offset = 0;\n          } else if (minOffset < offset) {\n            next = true;\n          } else {\n            next = false;\n            const realOffset = navWrapNodeWH - navNodeWH;\n            this.setOffset(realOffset);\n            offset = realOffset;\n          }\n\n          if (offset < 0) {\n            prev = true;\n          } else {\n            prev = false;\n          }\n\n          this.setNext(next);\n          this.setPrev(prev);\n          resolve({\n            next,\n            prev,\n          });\n        });\n      });\n    });\n  }\n\n  /**\n   * 获取节点的宽度\n   *\n   * @param {HTMLElement} node\n   * @return {number} offsetWidth\n   */\n  getOffsetWH(node: HTMLElement) {\n    return node.offsetWidth;\n  }\n\n  /**\n   * 获取节点的滚动宽度\n   *\n   * @param {HTMLElement} node\n   * @return {number} scrollWidth\n   */\n  getScrollWH(node: HTMLElement) {\n    return node.scrollWidth;\n  }\n\n  /**\n   * 获取节点的偏移量\n   *\n   * @param {HTMLElement} node\n   * @return {number} clientRect.left\n   */\n  getOffsetLT(node: HTMLElement) {\n    return node.getBoundingClientRect().left;\n  }\n\n  /**\n   * 设置偏移量\n   *\n   */\n  setOffset(offset: number) {\n    const { getRef } = this.props;\n    const target: number = Math.min(0, offset);\n    if (this.offset !== target) {\n      this.offset = target;\n      let navOffset: any = {};\n      const navStyle = getRef('nav').style;\n      navOffset = {\n        value: `translate3d(${target}px,0,0)`,\n      };\n      setTransform(navStyle, navOffset.value);\n    }\n  }\n\n  setPrev(v: boolean) {\n    if (this.state.prev !== v) {\n      this.setState({\n        prev: v,\n      });\n    }\n  }\n\n  setNext(v: boolean) {\n    if (this.state.next !== v) {\n      this.setState({\n        next: v,\n      });\n    }\n  }\n\n  prevTransitionEnd = (e: React.TransitionEvent<HTMLElement>) => {\n    if (e.propertyName !== 'opacity') {\n      return;\n    }\n    const container = this.props.getRef('container');\n    this.scrollToActiveTab({\n      target: container,\n      currentTarget: container,\n    });\n  };\n\n  scrollToActiveTab = (e?: any) => {\n    const { getRef } = this.props;\n    const activeTab = getRef('activeTab');\n    const navWrap = getRef('navWrap');\n    if ((e && e.target !== e.currentTarget) || !activeTab) {\n      return;\n    }\n\n    // when not scrollable or enter scrollable first time, don't emit scrolling\n    const needToScroll = this.isNextPrevShown() && this.lastNextPrevShown;\n    this.lastNextPrevShown = this.isNextPrevShown();\n    if (!needToScroll) {\n      return;\n    }\n\n    const activeTabWH = this.getScrollWH(activeTab);\n    const navWrapNodeWH = this.getOffsetWH(navWrap);\n    let { offset } = this;\n    const wrapOffset = this.getOffsetLT(navWrap);\n    const activeTabOffset = this.getOffsetLT(activeTab);\n    if (wrapOffset > activeTabOffset) {\n      // activeTab 在 wrap 的可见区域左侧\n      offset += wrapOffset - activeTabOffset;\n      this.setOffset(offset);\n      this.setNextPrev();\n    } else if (wrapOffset + navWrapNodeWH < activeTabOffset + activeTabWH) {\n      // activeTab 在 wrap 的可见区域右侧\n      offset -= activeTabOffset + activeTabWH - (wrapOffset + navWrapNodeWH);\n      const minOffset = this.wrapperOffsetWH - this.wrapperScrollWH;\n      const maxOffset = 0;\n      const newOffset = Math.min(\n        Math.max(offset, minOffset),\n        maxOffset,\n      );\n      this.setOffset(newOffset);\n      this.setNextPrev();\n    }\n  };\n\n  /** 点击左箭头的事件处理函数 */\n  prev = (e: React.MouseEvent<HTMLElement>) => {\n    const { onPrevClick, getRef } = this.props;\n    if (onPrevClick) {\n      onPrevClick(e);\n    }\n    const navWrapNode = getRef('navWrap');\n    const navWrapNodeWH = this.getOffsetWH(navWrapNode);\n    const { offset } = this;\n    this.setOffset(offset + navWrapNodeWH);\n    this.setNextPrev();\n  };\n\n  /** 点击右箭头的事件处理函数 */\n  next = (e: React.MouseEvent<HTMLElement>) => {\n    const { onNextClick, getRef } = this.props;\n    if (onNextClick) {\n      onNextClick(e);\n    }\n    const navWrapNode = getRef('navWrap');\n    const navWrapNodeWH = this.getOffsetWH(navWrapNode);\n    const { offset } = this;\n    this.setOffset(offset - navWrapNodeWH);\n    this.setNextPrev();\n  };\n\n  /**\n   * 判断左右的按钮是否显示\n   */\n  isNextPrevShown(state?: { next: boolean; prev: boolean }) {\n    if (state) {\n      return state.next || state.prev;\n    }\n    const { next, prev } = this.state;\n    return next || prev;\n  }\n\n  handleWheel = (e: WheelEvent) => {\n    if (e) {\n      const { wrapperOffsetWH, wrapperScrollWH } = this;\n      if (wrapperOffsetWH >= wrapperScrollWH) {\n        return false;\n      }\n      const { deltaX, deltaY } = e;\n      // Convert both to x & y since wheel only happened on PC\n      let mixed = 0;\n      const absX = Math.abs(deltaX);\n      const absY = Math.abs(deltaY);\n      if (absX === absY) {\n        mixed = this.lastWheelDirection === 'x' ? deltaX : deltaY;\n      } else if (absX > absY) {\n        mixed = deltaX;\n        this.lastWheelDirection = 'x';\n      } else {\n        mixed = deltaY;\n        this.lastWheelDirection = 'y';\n      }\n      const minOffset = wrapperOffsetWH - wrapperScrollWH;\n      const maxOffset = 0;\n      const newOffset = Math.min(\n        Math.max(-mixed + this.offset, minOffset),\n        maxOffset,\n      );\n      this.setOffset(newOffset);\n      e.preventDefault();\n      return true;\n    } else { return false; }\n  };\n\n  handleResize = () => {\n    fastdom.measure(() => {\n      const { getRef } = this.props;\n      const wrapper = getRef('navWrap');\n      const tabs = getRef('nav');\n      this.wrapperOffsetWH = wrapper.offsetWidth || 0;\n      this.wrapperScrollWH = tabs.scrollWidth || 0;\n    });\n  };\n\n  getTabList = (panes: React.ReactNode) => {\n    const tabList: Array<{ key: React.Key; tab: React.ReactNode }> = [];\n    React.Children.forEach(\n      panes as React.ReactElement[],\n      (child: React.ReactElement<ITabPaneProps>) => {\n        if (child && React.isValidElement(child)) {\n          tabList.push({\n            key: child.key as React.Key,\n            tab: child.props.tab,\n          });\n        }\n      },\n    );\n    return tabList;\n  };\n\n  updateTabSizes = () => {\n    const { getRef, activeKey } = this.props;\n    const tabSizeMap: TabSizeMap = new Map();\n    return new Promise<void>((resolve) => {\n      fastdom.measure(() => {\n        this.tabList.forEach(({ key }) => {\n          let btnNode;\n          if (activeKey === key) {\n            btnNode = getRef('activeTab');\n          } else {\n            btnNode = getRef(`tab_${key}`);\n          }\n          if (btnNode) {\n            tabSizeMap.set(key, {\n              width: btnNode.offsetWidth || 0,\n              height: btnNode.offsetHeight || 0,\n              left: btnNode.offsetLeft || 0,\n              top: btnNode.offsetTop || 0,\n            });\n          }\n        });\n        this.tabSizeMap = tabSizeMap;\n        resolve();\n      });\n    });\n  };\n\n  getPrevNext = () => {\n    const { prev, next } = this.state;\n    const { testid } = this.props;\n    const showNextPrev = prev || next;\n    const { prev: prevCallback, next: nextCallback, prevTransitionEnd } = this;\n    const prevButton = (\n      <PrevButton\n        style={{\n          left: 0,\n        }}\n        onClick={prev ? prevCallback : undefined}\n        className={classnames('prevbutton', {\n          disabled: !prev,\n          show: showNextPrev,\n        })}\n        onTransitionEnd={prevTransitionEnd}\n        data-testid={`${testid || ''}_pre`}\n      >\n        <div\n          style={{\n            transform: 'rotate(90deg)',\n            transformOrigin: 'center center',\n          }}\n        >\n          <ArrowIconDown />\n        </div>\n      </PrevButton>\n    );\n\n    const nextButton = (\n      <NextButton\n        onClick={next ? nextCallback : undefined}\n        className={classnames('nextbutton', {\n          disabled: !next,\n          show: showNextPrev,\n        })}\n        data-testid={`${testid || ''}_next`}\n      >\n        <div\n          style={{\n            transform: 'rotate(-90deg)',\n            transformOrigin: 'center center',\n          }}\n        >\n          <ArrowIconDown />\n        </div>\n      </NextButton>\n    );\n\n    return (\n      <>\n        {prevButton}\n        {nextButton}\n      </>\n    );\n  };\n\n  excessTabsHelper = (showNextPrev: Boolean) => {\n    return showNextPrev ? this.getPrevNext() : null;\n  };\n\n\n  render() {\n    const { prev, next } = this.state;\n    const {\n      children,\n      saveRef,\n    } = this.props;\n    const showNextPrev = prev || next;\n\n    return (\n      <NavContainer\n        className={classnames({\n          scrolling: showNextPrev,\n        })}\n        ref={saveRef('container')}\n      >\n        <NavWrap\n          ref={saveRef('navWrap')}\n        >\n          <Nav\n            ref={saveRef('nav')}\n          >\n            {children}\n          </Nav>\n        </NavWrap>\n        {this.excessTabsHelper(showNextPrev)}\n      </NavContainer>\n    );\n  }\n}\n"],"file":"TabBarNode.js"}