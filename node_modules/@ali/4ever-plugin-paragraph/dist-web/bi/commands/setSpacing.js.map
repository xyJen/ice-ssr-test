{"version":3,"sources":["../../../../src/bi/commands/setSpacing.ts"],"names":["Commands","isEqualWithDefault","getBlocksFromEditor","canSetParagraphAttr","DEFAULT_SPACING","setParagraphSpacing","controller","data","selectedBlocks","length","forEach","node","spacing","beforeLines","afterLines","type","command","setNodeByKey","key"],"mappings":";AAAA,SAAqBA,QAArB,QAAqC,oBAArC;AACA,SAASC,kBAAT,EAA6BC,mBAA7B,QAA2E,kBAA3E;AACA,SAASC,mBAAT,EAA8BC,eAA9B;AAGA,eAAe,SAASC,mBAAT,CAA6BC,UAA7B,EAAqDC,IAArD,EAAmF;AAAA,MAA9BA,IAA8B;AAA9BA,IAAAA,IAA8B,GAAJ,EAAI;AAAA;;AAChG,MAAMC,cAAc,GAAGN,mBAAmB,CAACI,UAAD,CAA1C;AACA,MAAI,CAACE,cAAc,CAACC,MAApB,EAA4B,OAAOH,UAAP;AAE5BE,EAAAA,cAAc,CAACE,OAAf,CAAuB,UAACC,IAAD,EAAU;AAC/B,QAAMC,OAAO,gBACRD,IAAI,CAACJ,IAAL,CAAUK,OADF,CAAb,CAD+B,CAK/B;;;AACA,QAAI,YAAYL,IAAZ,IAAoB,EAAE,iBAAiBA,IAAnB,CAAxB,EAAkD;AAChD;AACA,aAAOK,OAAO,CAACC,WAAf;AACD;;AACD,QAAI,WAAWN,IAAX,IAAmB,EAAE,gBAAgBA,IAAlB,CAAvB,EAAgD;AAC9C,aAAOK,OAAO,CAACE,UAAf;AACD;;AAED,QAAIb,kBAAkB,cAAMW,OAAN,EAAkBL,IAAlB,GAA0BI,IAAI,CAACJ,IAAL,CAAUK,OAApC,EAA6CR,eAA7C,CAAtB,EAAqF;AACnF;AACD;;AAED,QAAID,mBAAmB,CAACQ,IAAI,CAACI,IAAN,CAAvB,EAAoC;AAClCT,MAAAA,UAAU,CAACU,OAAX,CAAmBhB,QAAQ,CAACiB,YAA5B,EAA0CN,IAAI,CAACO,GAA/C,EAAoD;AAClDX,QAAAA,IAAI,eACCI,IAAI,CAACJ,IADN;AAEFK,UAAAA,OAAO,eACFA,OADE,EAEFL,IAFE;AAFL;AAD8C,OAApD;AASD;AACF,GA7BD;AA8BA,SAAOD,UAAP;AACD","sourcesContent":["import { Controller, Commands } from '@ali/4ever-cangjie';\nimport { isEqualWithDefault, getBlocksFromEditor, SpacingProperties } from '@ali/4ever-utils';\nimport { canSetParagraphAttr, DEFAULT_SPACING } from '../../utils';\n\n\nexport default function setParagraphSpacing(controller: Controller, data: SpacingProperties = {}) {\n  const selectedBlocks = getBlocksFromEditor(controller);\n  if (!selectedBlocks.length) return controller;\n\n  selectedBlocks.forEach((node) => {\n    const spacing = {\n      ...node.data.spacing,\n    };\n\n    // 处理互斥关系\n    if ('before' in data && !('beforeLines' in data)) {\n      // 设置 before 时清除 beforeLines（因为 lines 单位优先级更高）\n      delete spacing.beforeLines;\n    }\n    if ('after' in data && !('afterLines' in data)) {\n      delete spacing.afterLines;\n    }\n\n    if (isEqualWithDefault({ ...spacing, ...data }, node.data.spacing, DEFAULT_SPACING)) {\n      return;\n    }\n\n    if (canSetParagraphAttr(node.type)) {\n      controller.command(Commands.setNodeByKey, node.key, {\n        data: {\n          ...node.data,\n          spacing: {\n            ...spacing,\n            ...data,\n          },\n        },\n      });\n    }\n  });\n  return controller;\n}\n"],"file":"setSpacing.js"}