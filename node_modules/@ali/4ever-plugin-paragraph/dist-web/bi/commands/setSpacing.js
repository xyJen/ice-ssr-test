import _extends from "@babel/runtime/helpers/extends";
import { Commands } from '@ali/4ever-cangjie';
import { isEqualWithDefault, getBlocksFromEditor } from '@ali/4ever-utils';
import { canSetParagraphAttr, DEFAULT_SPACING } from "../../utils";
export default function setParagraphSpacing(controller, data) {
  if (data === void 0) {
    data = {};
  }

  var selectedBlocks = getBlocksFromEditor(controller);
  if (!selectedBlocks.length) return controller;
  selectedBlocks.forEach(function (node) {
    var spacing = _extends({}, node.data.spacing); // 处理互斥关系


    if ('before' in data && !('beforeLines' in data)) {
      // 设置 before 时清除 beforeLines（因为 lines 单位优先级更高）
      delete spacing.beforeLines;
    }

    if ('after' in data && !('afterLines' in data)) {
      delete spacing.afterLines;
    }

    if (isEqualWithDefault(_extends({}, spacing, data), node.data.spacing, DEFAULT_SPACING)) {
      return;
    }

    if (canSetParagraphAttr(node.type)) {
      controller.command(Commands.setNodeByKey, node.key, {
        data: _extends({}, node.data, {
          spacing: _extends({}, spacing, data)
        })
      });
    }
  });
  return controller;
}
//# sourceMappingURL=setSpacing.js.map