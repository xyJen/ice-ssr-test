import _extends from "@babel/runtime/helpers/extends";
import { Commands } from '@ali/4ever-cangjie';
import { isEqualWithDefault, getBlocksFromEditor } from '@ali/4ever-utils';
import { canSetParagraphAttr, DEFAULT_INDENT_FULL } from "../../utils";
export default function setParagraphInd(controller, data) {
  if (data === void 0) {
    data = {};
  }

  var selectedBlocks = getBlocksFromEditor(controller);
  if (!selectedBlocks.length) return controller;
  selectedBlocks.forEach(function (node) {
    var ind = _extends({}, node.data.ind); // 处理互斥关系


    if ('hanging' in data || 'hangingChars' in data) {
      // 首行与悬挂互斥
      delete ind.firstLine;
      delete ind.firstLineChars;
    } else if ('firstLine' in data || 'firstLineChars' in data) {
      delete ind.hanging;
      delete ind.hangingChars;
    }

    if ('left' in data && !('leftChars' in data)) {
      // 设置 left 时清除 leftChars（带单位优先级更高）
      delete ind.leftChars;
    }

    if ('right' in data && !('rightChars' in data)) {
      delete ind.rightChars;
    }

    if ('firstLine' in data && !('firstLineChars' in data)) {
      delete ind.firstLineChars;
    }

    if ('hanging' in data && !('hangingChars' in data)) {
      delete ind.hangingChars;
    }

    if (isEqualWithDefault(_extends({}, ind, data), node.data.ind, DEFAULT_INDENT_FULL)) {
      return;
    }

    if (canSetParagraphAttr(node.type)) {
      controller.command(Commands.setNodeByKey, node.key, {
        data: _extends({}, node.data, {
          ind: _extends({}, ind, data)
        })
      });
    }
  });
  return controller;
}
//# sourceMappingURL=setInd.js.map