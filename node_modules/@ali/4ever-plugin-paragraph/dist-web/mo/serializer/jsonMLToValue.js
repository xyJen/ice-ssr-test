import { getTagName, getAttributes } from '@ali/4ever-utils';
import Paragraph from "../models";
export default {
  name: Paragraph.TYPE,
  match: function match(node, parent) {
    var tag = getTagName(node);

    if (tag === 'p') {
      return true;
    } else if (parent) {
      var parentTagName = getTagName(parent);

      if (parentTagName === 'tc' || parentTagName === 'root') {
        console.warn(tag + " under " + parentTagName + " is not supported, forcely revert to paragraph");
        return true;
      }
    }

    return false;
  },
  convert: function convert(node) {
    var data = getAttributes(node) || {};

    if (data.ind && typeof data.ind.firstline === 'number') {
      data.ind.firstLine = data.ind.firstline;
      delete data.ind.firstline;
    } // 序列化时对不合法 level 进行矫正


    if (data.list) {
      var hasInvalidLevel = function hasInvalidLevel(list) {
        var level = list.level;
        return !/\d/g.test(String(level)) || level < 0;
      };

      if (hasInvalidLevel(data.list)) {
        data.list.level = 0;
      }
    }

    return Paragraph.create({
      data: data
    });
  }
};
//# sourceMappingURL=jsonMLToValue.js.map