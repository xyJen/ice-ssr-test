"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = setParagraphSpacing;

var _everCangjie = require("@ali/4ever-cangjie");

var _everUtils = require("@ali/4ever-utils");

var _utils = require("../../utils");

function setParagraphSpacing(controller, data = {}) {
  const selectedBlocks = (0, _everUtils.getBlocksFromEditor)(controller);
  if (!selectedBlocks.length) return controller;
  selectedBlocks.forEach(node => {
    const spacing = { ...node.data.spacing
    }; // 处理互斥关系

    if ('before' in data && !('beforeLines' in data)) {
      // 设置 before 时清除 beforeLines（因为 lines 单位优先级更高）
      delete spacing.beforeLines;
    }

    if ('after' in data && !('afterLines' in data)) {
      delete spacing.afterLines;
    }

    if ((0, _everUtils.isEqualWithDefault)({ ...spacing,
      ...data
    }, node.data.spacing, _utils.DEFAULT_SPACING)) {
      return;
    }

    if ((0, _utils.canSetParagraphAttr)(node.type)) {
      controller.command(_everCangjie.Commands.setNodeByKey, node.key, {
        data: { ...node.data,
          spacing: { ...spacing,
            ...data
          }
        }
      });
    }
  });
  return controller;
}
//# sourceMappingURL=setSpacing.js.map