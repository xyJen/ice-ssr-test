{"version":3,"sources":["../../../../src/bi/commands/setSpacing.ts"],"names":["setParagraphSpacing","controller","data","selectedBlocks","length","forEach","node","spacing","beforeLines","afterLines","DEFAULT_SPACING","type","command","Commands","setNodeByKey","key"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAGe,SAASA,mBAAT,CAA6BC,UAA7B,EAAqDC,IAAuB,GAAG,EAA/E,EAAmF;AAChG,QAAMC,cAAc,GAAG,oCAAoBF,UAApB,CAAvB;AACA,MAAI,CAACE,cAAc,CAACC,MAApB,EAA4B,OAAOH,UAAP;AAE5BE,EAAAA,cAAc,CAACE,OAAf,CAAwBC,IAAD,IAAU;AAC/B,UAAMC,OAAO,GAAG,EACd,GAAGD,IAAI,CAACJ,IAAL,CAAUK;AADC,KAAhB,CAD+B,CAK/B;;AACA,QAAI,YAAYL,IAAZ,IAAoB,EAAE,iBAAiBA,IAAnB,CAAxB,EAAkD;AAChD;AACA,aAAOK,OAAO,CAACC,WAAf;AACD;;AACD,QAAI,WAAWN,IAAX,IAAmB,EAAE,gBAAgBA,IAAlB,CAAvB,EAAgD;AAC9C,aAAOK,OAAO,CAACE,UAAf;AACD;;AAED,QAAI,mCAAmB,EAAE,GAAGF,OAAL;AAAc,SAAGL;AAAjB,KAAnB,EAA4CI,IAAI,CAACJ,IAAL,CAAUK,OAAtD,EAA+DG,sBAA/D,CAAJ,EAAqF;AACnF;AACD;;AAED,QAAI,gCAAoBJ,IAAI,CAACK,IAAzB,CAAJ,EAAoC;AAClCV,MAAAA,UAAU,CAACW,OAAX,CAAmBC,sBAASC,YAA5B,EAA0CR,IAAI,CAACS,GAA/C,EAAoD;AAClDb,QAAAA,IAAI,EAAE,EACJ,GAAGI,IAAI,CAACJ,IADJ;AAEJK,UAAAA,OAAO,EAAE,EACP,GAAGA,OADI;AAEP,eAAGL;AAFI;AAFL;AAD4C,OAApD;AASD;AACF,GA7BD;AA8BA,SAAOD,UAAP;AACD","sourcesContent":["import { Controller, Commands } from '@ali/4ever-cangjie';\nimport { isEqualWithDefault, getBlocksFromEditor, SpacingProperties } from '@ali/4ever-utils';\nimport { canSetParagraphAttr, DEFAULT_SPACING } from '../../utils';\n\n\nexport default function setParagraphSpacing(controller: Controller, data: SpacingProperties = {}) {\n  const selectedBlocks = getBlocksFromEditor(controller);\n  if (!selectedBlocks.length) return controller;\n\n  selectedBlocks.forEach((node) => {\n    const spacing = {\n      ...node.data.spacing,\n    };\n\n    // 处理互斥关系\n    if ('before' in data && !('beforeLines' in data)) {\n      // 设置 before 时清除 beforeLines（因为 lines 单位优先级更高）\n      delete spacing.beforeLines;\n    }\n    if ('after' in data && !('afterLines' in data)) {\n      delete spacing.afterLines;\n    }\n\n    if (isEqualWithDefault({ ...spacing, ...data }, node.data.spacing, DEFAULT_SPACING)) {\n      return;\n    }\n\n    if (canSetParagraphAttr(node.type)) {\n      controller.command(Commands.setNodeByKey, node.key, {\n        data: {\n          ...node.data,\n          spacing: {\n            ...spacing,\n            ...data,\n          },\n        },\n      });\n    }\n  });\n  return controller;\n}\n"],"file":"setSpacing.js"}