import { createTextWithString } from '@ali/4ever-cangjie';
import { createLinkify, matchesLink } from '@ali/4ever-utils';
var linkify = createLinkify();
export default {
  name: 'link',
  match: function match(line) {
    return !!matchesLink(linkify, line);
  },
  convert: function convert(line) {
    var matches = matchesLink(linkify, line);
    var children = [];
    var lastIndex = 0;
    matches.forEach(function (match) {
      if (match.index > lastIndex) {
        children.push(createTextWithString(line.substring(lastIndex, match.index)));
      }

      if (match.index === 0) {
        children.push(createTextWithString(''));
      }

      children.push(['a', {
        href: match.url
      }, createTextWithString(line.substring(match.index, match.lastIndex))]);

      if (match.lastIndex === line.length) {
        children.push(createTextWithString(''));
      }

      lastIndex = match.lastIndex;
    });

    if (lastIndex < line.length) {
      children.push(createTextWithString(line.substring(lastIndex)));
    }

    return children;
  }
};
//# sourceMappingURL=textToJsonML.js.map