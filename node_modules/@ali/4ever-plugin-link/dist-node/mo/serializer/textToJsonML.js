"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _everCangjie = require("@ali/4ever-cangjie");

var _everUtils = require("@ali/4ever-utils");

const linkify = (0, _everUtils.createLinkify)();
var _default = {
  name: 'link',
  match: line => {
    return !!(0, _everUtils.matchesLink)(linkify, line);
  },
  convert: line => {
    const matches = (0, _everUtils.matchesLink)(linkify, line);
    const children = [];
    let lastIndex = 0;
    matches.forEach(match => {
      if (match.index > lastIndex) {
        children.push((0, _everCangjie.createTextWithString)(line.substring(lastIndex, match.index)));
      }

      if (match.index === 0) {
        children.push((0, _everCangjie.createTextWithString)(''));
      }

      children.push(['a', {
        href: match.url
      }, (0, _everCangjie.createTextWithString)(line.substring(match.index, match.lastIndex))]);

      if (match.lastIndex === line.length) {
        children.push((0, _everCangjie.createTextWithString)(''));
      }

      lastIndex = match.lastIndex;
    });

    if (lastIndex < line.length) {
      children.push((0, _everCangjie.createTextWithString)(line.substring(lastIndex)));
    }

    return children;
  }
};
exports.default = _default;
//# sourceMappingURL=textToJsonML.js.map