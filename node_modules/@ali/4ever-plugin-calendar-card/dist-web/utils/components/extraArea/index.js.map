{"version":3,"sources":["../../../../../src/utils/components/extraArea/index.tsx"],"names":["React","useState","useRef","useCallback","Dropdown","LoadingNormalNormal","Tooltip","GotoNormalNormal","RefreshNormalNormal","preventDefaultOnClick","ExtraButtonWrapper","ExtraWrapper","IconWrapper","DEFAULT_ICON_STYLE","RefreshTips","renderViewCalendardetails","jumpToCalendar","viewCalendardetails","RefreshExtra","props","refreshCalendar","isLoading","tipsNode","iconRef","loading","current","RefreshIconWithTips","isChangeData","refreshToast","refreshTips","container","disableTip","offsetX","setOffsetX","getContainer","document","body","ExtraArea","isShanhui","isOnlyRefresh","isPlaceholder","createCalendarBtn","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useCallback, ReactNode } from 'react';\nimport { Dropdown, LoadingNormalNormal, Tooltip } from '@ali/we-design';\nimport { GotoNormalNormal, RefreshNormalNormal } from '@ali/we-icon';\nimport preventDefaultOnClick from '../../uitls/preventDefaultOnClick';\nimport { CommonMouseEvent } from '../../type';\nimport { ExtraButtonWrapper, ExtraWrapper, IconWrapper } from './styled';\nimport { DEFAULT_ICON_STYLE } from '../../constants';\nimport RefreshTips from './RefreshTips';\n\nfunction renderViewCalendardetails(\n  jumpToCalendar?: CommonMouseEvent,\n  viewCalendardetails?: string,\n) {\n  if (!jumpToCalendar) return null;\n  return (\n    <Tooltip title={viewCalendardetails}>\n      <IconWrapper onMouseDown={jumpToCalendar} onClick={preventDefaultOnClick}>\n        <GotoNormalNormal testid=\"goto\" title={'viewCalendardetails'} style={DEFAULT_ICON_STYLE} />\n      </IconWrapper>\n    </Tooltip>\n  );\n}\n\ninterface IRefreshExtraProps {\n  refreshCalendar?: CommonMouseEvent;\n  refreshMessage?: string;\n  isLoading?: boolean;\n  tipsNode?: string | ReactNode | null; // 外层业务控制 tip 信息，优先级最高\n  isChangeData?: boolean;\n  refreshToast?: string;\n  refreshTips?: string;\n  disableTip?: boolean;\n}\n\nconst RefreshExtra: React.FC<IRefreshExtraProps> = (props) => {\n  const { refreshCalendar, isLoading, tipsNode } = props;\n  const iconRef = useRef<HTMLSpanElement>(null);\n  if (!refreshCalendar) return null;\n  const loading = isLoading ?\n    (<LoadingNormalNormal style={DEFAULT_ICON_STYLE} />) :\n    (<RefreshIconWithTips {...props} tipsNode={tipsNode} container={iconRef.current} />);\n  return (\n    <IconWrapper\n      ref={iconRef}\n      onMouseDown={refreshCalendar}\n      onTouchEnd={refreshCalendar}\n      onClick={preventDefaultOnClick}\n    >\n      {loading}\n    </IconWrapper>\n  );\n};\n\nconst RefreshIconWithTips: React.FC<{\n  isChangeData?: boolean;\n  refreshToast?: string;\n  refreshTips?: string;\n  container?: HTMLElement | null;\n  tipsNode?: string | ReactNode | null;\n  disableTip?: boolean;\n}> = (props) => {\n  const { isChangeData = false, refreshToast, refreshTips, container, tipsNode, disableTip } = props;\n\n  const [offsetX, setOffsetX] = useState<number>(0);\n\n  const getContainer = useCallback(() => container || document.body, [container]);\n\n  if ((!isChangeData && !tipsNode) || disableTip) {\n    return (\n      <Tooltip title={refreshToast}>\n        <span>\n          <RefreshNormalNormal testid=\"refresh\" style={DEFAULT_ICON_STYLE} />\n        </span>\n      </Tooltip>\n    );\n  }\n  return (\n    <Dropdown\n      offsetX={offsetX}\n      placement=\"bottom\"\n      visible={true}\n      getContainer={getContainer}\n      overlay={(<RefreshTips\n        offsetX={offsetX}\n        refreshTips={refreshTips}\n        tipsNode={tipsNode}\n        onChangeOffsetX={setOffsetX}\n      />)}\n    >\n      <span>\n        <RefreshNormalNormal testid=\"refresh\" style={DEFAULT_ICON_STYLE} />\n      </span>\n    </Dropdown>\n  );\n};\n\ninterface IProps {\n  isShanhui?: boolean;\n  isOnlyRefresh?: boolean; // 移动端编辑态仅保留刷新icon\n  isLoading?: boolean;\n  isPlaceholder?: boolean;\n  isChangeData?: boolean;\n  viewCalendardetails?: string;\n  refreshToast?: string;\n  refreshTips?: string;\n  tipsNode?: string | ReactNode | null;\n  jumpToCalendar?: CommonMouseEvent;\n  refreshCalendar?: CommonMouseEvent;\n  createCalendarBtn?: () => ReactNode;\n}\nexport const ExtraArea: React.FC<IProps> = (props) => {\n  const {\n    isShanhui,\n    isOnlyRefresh,\n    jumpToCalendar,\n    refreshCalendar,\n    viewCalendardetails,\n    isLoading,\n    isPlaceholder,\n    refreshToast,\n    isChangeData,\n    refreshTips,\n    tipsNode,\n    createCalendarBtn,\n  } = props;\n\n  if (isPlaceholder && createCalendarBtn) {\n    return isShanhui ? (\n      <ExtraButtonWrapper style={{ marginTop: 2 }}>\n        {createCalendarBtn()}\n      </ExtraButtonWrapper>\n    ) : <ExtraWrapper>{createCalendarBtn()}</ExtraWrapper>;\n  }\n  return (\n    <ExtraWrapper>\n      <RefreshExtra\n        tipsNode={tipsNode}\n        refreshCalendar={refreshCalendar}\n        isLoading={isLoading}\n        isChangeData={isChangeData}\n        refreshToast={refreshToast}\n        refreshTips={refreshTips}\n        disableTip={isShanhui}\n      />\n      {isOnlyRefresh ? null : renderViewCalendardetails(jumpToCalendar, viewCalendardetails)}\n    </ExtraWrapper>\n  );\n};\n"],"file":"index.js"}